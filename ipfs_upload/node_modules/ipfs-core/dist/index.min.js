(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsCore = factory()}(typeof self !== 'undefined' ? self : this, function () {
var IpfsCore=(()=>{var ZAe=Object.create;var Hm=Object.defineProperty;var JAe=Object.getOwnPropertyDescriptor;var eIe=Object.getOwnPropertyNames;var tIe=Object.getPrototypeOf,rIe=Object.prototype.hasOwnProperty;var Kk=t=>Hm(t,"__esModule",{value:!0});var aa=t=>{if(typeof require!="undefined")return require(t);throw new Error('Dynamic require of "'+t+'" is not supported')};var Ge=(t,e)=>()=>(t&&(e=t(t=0)),e);var p=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Gt=(t,e)=>{Kk(t);for(var r in e)Hm(t,r,{get:e[r],enumerable:!0})},iIe=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of eIe(e))!rIe.call(t,i)&&i!=="default"&&Hm(t,i,{get:()=>e[i],enumerable:!(r=JAe(e,i))||r.enumerable});return t},jk=t=>iIe(Kk(Hm(t!=null?ZAe(tIe(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Hk=p($m=>{f();"use strict";$m.byteLength=sIe;$m.toByteArray=aIe;$m.fromByteArray=lIe;var ca=[],Ss=[],nIe=typeof Uint8Array!="undefined"?Uint8Array:Array,y6="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Wl=0,Vk=y6.length;Wl<Vk;++Wl)ca[Wl]=y6[Wl],Ss[y6.charCodeAt(Wl)]=Wl;var Wl,Vk;Ss["-".charCodeAt(0)]=62;Ss["_".charCodeAt(0)]=63;function zk(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var i=r===e?0:4-r%4;return[r,i]}function sIe(t){var e=zk(t),r=e[0],i=e[1];return(r+i)*3/4-i}function oIe(t,e,r){return(e+r)*3/4-r}function aIe(t){var e,r=zk(t),i=r[0],n=r[1],s=new nIe(oIe(t,i,n)),o=0,a=n>0?i-4:i,c;for(c=0;c<a;c+=4)e=Ss[t.charCodeAt(c)]<<18|Ss[t.charCodeAt(c+1)]<<12|Ss[t.charCodeAt(c+2)]<<6|Ss[t.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return n===2&&(e=Ss[t.charCodeAt(c)]<<2|Ss[t.charCodeAt(c+1)]>>4,s[o++]=e&255),n===1&&(e=Ss[t.charCodeAt(c)]<<10|Ss[t.charCodeAt(c+1)]<<4|Ss[t.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function cIe(t){return ca[t>>18&63]+ca[t>>12&63]+ca[t>>6&63]+ca[t&63]}function uIe(t,e,r){for(var i,n=[],s=e;s<r;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),n.push(cIe(i));return n.join("")}function lIe(t){for(var e,r=t.length,i=r%3,n=[],s=16383,o=0,a=r-i;o<a;o+=s)n.push(uIe(t,o,o+s>a?a:o+s));return i===1?(e=t[r-1],n.push(ca[e>>2]+ca[e<<4&63]+"==")):i===2&&(e=(t[r-2]<<8)+t[r-1],n.push(ca[e>>10]+ca[e>>4&63]+ca[e<<2&63]+"=")),n.join("")}});var $k=p(g6=>{f();g6.read=function(t,e,r,i,n){var s,o,a=n*8-i-1,c=(1<<a)-1,l=c>>1,u=-7,h=r?n-1:0,d=r?-1:1,y=t[e+h];for(h+=d,s=y&(1<<-u)-1,y>>=-u,u+=a;u>0;s=s*256+t[e+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=o*256+t[e+h],h+=d,u-=8);if(s===0)s=1-l;else{if(s===c)return o?NaN:(y?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-l}return(y?-1:1)*o*Math.pow(2,s-i)};g6.write=function(t,e,r,i,n,s){var o,a,c,l=s*8-n-1,u=(1<<l)-1,h=u>>1,d=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=i?0:s-1,g=i?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+h>=1?e+=d/c:e+=d*Math.pow(2,1-h),e*c>=2&&(o++,c/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(e*c-1)*Math.pow(2,n),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,n),o=0));n>=8;t[r+y]=a&255,y+=g,a/=256,n-=8);for(o=o<<n|a,l+=n;l>0;t[r+y]=o&255,y+=g,o/=256,l-=8);t[r+y-g]|=m*128}});var ft=p(Wh=>{f();"use strict";var b6=Hk(),Hh=$k(),Gk=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Wh.Buffer=le;Wh.SlowBuffer=gIe;Wh.INSPECT_MAX_BYTES=50;var Gm=2147483647;Wh.kMaxLength=Gm;le.TYPED_ARRAY_SUPPORT=fIe();!le.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function fIe(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch(t){return!1}}Object.defineProperty(le.prototype,"parent",{enumerable:!0,get:function(){if(!!le.isBuffer(this))return this.buffer}});Object.defineProperty(le.prototype,"offset",{enumerable:!0,get:function(){if(!!le.isBuffer(this))return this.byteOffset}});function _c(t){if(t>Gm)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,le.prototype),e}function le(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m6(t)}return Wk(t,e,r)}le.poolSize=8192;function Wk(t,e,r){if(typeof t=="string")return dIe(t,e);if(ArrayBuffer.isView(t))return pIe(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(ua(t,ArrayBuffer)||t&&ua(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(ua(t,SharedArrayBuffer)||t&&ua(t.buffer,SharedArrayBuffer)))return w6(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=t.valueOf&&t.valueOf();if(i!=null&&i!==t)return le.from(i,e,r);let n=yIe(t);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return le.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}le.from=function(t,e,r){return Wk(t,e,r)};Object.setPrototypeOf(le.prototype,Uint8Array.prototype);Object.setPrototypeOf(le,Uint8Array);function Yk(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function hIe(t,e,r){return Yk(t),t<=0?_c(t):e!==void 0?typeof r=="string"?_c(t).fill(e,r):_c(t).fill(e):_c(t)}le.alloc=function(t,e,r){return hIe(t,e,r)};function m6(t){return Yk(t),_c(t<0?0:_6(t)|0)}le.allocUnsafe=function(t){return m6(t)};le.allocUnsafeSlow=function(t){return m6(t)};function dIe(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!le.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=Xk(t,e)|0,i=_c(r),n=i.write(t,e);return n!==r&&(i=i.slice(0,n)),i}function v6(t){let e=t.length<0?0:_6(t.length)|0,r=_c(e);for(let i=0;i<e;i+=1)r[i]=t[i]&255;return r}function pIe(t){if(ua(t,Uint8Array)){let e=new Uint8Array(t);return w6(e.buffer,e.byteOffset,e.byteLength)}return v6(t)}function w6(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&r===void 0?i=new Uint8Array(t):r===void 0?i=new Uint8Array(t,e):i=new Uint8Array(t,e,r),Object.setPrototypeOf(i,le.prototype),i}function yIe(t){if(le.isBuffer(t)){let e=_6(t.length)|0,r=_c(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||x6(t.length)?_c(0):v6(t);if(t.type==="Buffer"&&Array.isArray(t.data))return v6(t.data)}function _6(t){if(t>=Gm)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Gm.toString(16)+" bytes");return t|0}function gIe(t){return+t!=t&&(t=0),le.alloc(+t)}le.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==le.prototype};le.compare=function(e,r){if(ua(e,Uint8Array)&&(e=le.from(e,e.offset,e.byteLength)),ua(r,Uint8Array)&&(r=le.from(r,r.offset,r.byteLength)),!le.isBuffer(e)||!le.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let i=e.length,n=r.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==r[s]){i=e[s],n=r[s];break}return i<n?-1:n<i?1:0};le.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};le.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return le.alloc(0);let i;if(r===void 0)for(r=0,i=0;i<e.length;++i)r+=e[i].length;let n=le.allocUnsafe(r),s=0;for(i=0;i<e.length;++i){let o=e[i];if(ua(o,Uint8Array))s+o.length>n.length?(le.isBuffer(o)||(o=le.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(le.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function Xk(t,e){if(le.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||ua(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&r===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return S6(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return cq(t).length;default:if(n)return i?-1:S6(t).length;e=(""+e).toLowerCase(),n=!0}}le.byteLength=Xk;function bIe(t,e,r){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return TIe(this,e,r);case"utf8":case"utf-8":return Jk(this,e,r);case"ascii":return AIe(this,e,r);case"latin1":case"binary":return IIe(this,e,r);case"base64":return SIe(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return RIe(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}le.prototype._isBuffer=!0;function Yl(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}le.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)Yl(this,r,r+1);return this};le.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)Yl(this,r,r+3),Yl(this,r+1,r+2);return this};le.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)Yl(this,r,r+7),Yl(this,r+1,r+6),Yl(this,r+2,r+5),Yl(this,r+3,r+4);return this};le.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?Jk(this,0,e):bIe.apply(this,arguments)};le.prototype.toLocaleString=le.prototype.toString;le.prototype.equals=function(e){if(!le.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:le.compare(this,e)===0};le.prototype.inspect=function(){let e="",r=Wh.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};Gk&&(le.prototype[Gk]=le.prototype.inspect);le.prototype.compare=function(e,r,i,n,s){if(ua(e,Uint8Array)&&(e=le.from(e,e.offset,e.byteLength)),!le.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),r<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&r>=i)return 0;if(n>=s)return-1;if(r>=i)return 1;if(r>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,a=i-r,c=Math.min(o,a),l=this.slice(n,s),u=e.slice(r,i);for(let h=0;h<c;++h)if(l[h]!==u[h]){o=l[h],a=u[h];break}return o<a?-1:a<o?1:0};function Qk(t,e,r,i,n){if(t.length===0)return-1;if(typeof r=="string"?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,x6(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0)if(n)r=0;else return-1;if(typeof e=="string"&&(e=le.from(e,i)),le.isBuffer(e))return e.length===0?-1:Zk(t,e,r,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Zk(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function Zk(t,e,r,i,n){let s=1,o=t.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,a/=2,r/=2}function c(u,h){return s===1?u[h]:u.readUInt16BE(h*s)}let l;if(n){let u=-1;for(l=r;l<o;l++)if(c(t,l)===c(e,u===-1?0:l-u)){if(u===-1&&(u=l),l-u+1===a)return u*s}else u!==-1&&(l-=l-u),u=-1}else for(r+a>o&&(r=o-a),l=r;l>=0;l--){let u=!0;for(let h=0;h<a;h++)if(c(t,l+h)!==c(e,h)){u=!1;break}if(u)return l}return-1}le.prototype.includes=function(e,r,i){return this.indexOf(e,r,i)!==-1};le.prototype.indexOf=function(e,r,i){return Qk(this,e,r,i,!0)};le.prototype.lastIndexOf=function(e,r,i){return Qk(this,e,r,i,!1)};function mIe(t,e,r,i){r=Number(r)||0;let n=t.length-r;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let a=parseInt(e.substr(o*2,2),16);if(x6(a))return o;t[r+o]=a}return o}function vIe(t,e,r,i){return Wm(S6(e,t.length-r),t,r,i)}function wIe(t,e,r,i){return Wm(kIe(e),t,r,i)}function _Ie(t,e,r,i){return Wm(cq(e),t,r,i)}function EIe(t,e,r,i){return Wm(qIe(e,t.length-r),t,r,i)}le.prototype.write=function(e,r,i,n){if(r===void 0)n="utf8",i=this.length,r=0;else if(i===void 0&&typeof r=="string")n=r,i=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-r;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return mIe(this,e,r,i);case"utf8":case"utf-8":return vIe(this,e,r,i);case"ascii":case"latin1":case"binary":return wIe(this,e,r,i);case"base64":return _Ie(this,e,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return EIe(this,e,r,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};le.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function SIe(t,e,r){return e===0&&r===t.length?b6.fromByteArray(t):b6.fromByteArray(t.slice(e,r))}function Jk(t,e,r){r=Math.min(t.length,r);let i=[],n=e;for(;n<r;){let s=t[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=r){let c,l,u,h;switch(a){case 1:s<128&&(o=s);break;case 2:c=t[n+1],(c&192)==128&&(h=(s&31)<<6|c&63,h>127&&(o=h));break;case 3:c=t[n+1],l=t[n+2],(c&192)==128&&(l&192)==128&&(h=(s&15)<<12|(c&63)<<6|l&63,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:c=t[n+1],l=t[n+2],u=t[n+3],(c&192)==128&&(l&192)==128&&(u&192)==128&&(h=(s&15)<<18|(c&63)<<12|(l&63)<<6|u&63,h>65535&&h<1114112&&(o=h))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return xIe(i)}var eq=4096;function xIe(t){let e=t.length;if(e<=eq)return String.fromCharCode.apply(String,t);let r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=eq));return r}function AIe(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]&127);return i}function IIe(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function TIe(t,e,r){let i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);let n="";for(let s=e;s<r;++s)n+=BIe[t[s]];return n}function RIe(t,e,r){let i=t.slice(e,r),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}le.prototype.slice=function(e,r){let i=this.length;e=~~e,r=r===void 0?i:~~r,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),r<0?(r+=i,r<0&&(r=0)):r>i&&(r=i),r<e&&(r=e);let n=this.subarray(e,r);return Object.setPrototypeOf(n,le.prototype),n};function ki(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}le.prototype.readUintLE=le.prototype.readUIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||ki(e,r,this.length);let n=this[e],s=1,o=0;for(;++o<r&&(s*=256);)n+=this[e+o]*s;return n};le.prototype.readUintBE=le.prototype.readUIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||ki(e,r,this.length);let n=this[e+--r],s=1;for(;r>0&&(s*=256);)n+=this[e+--r]*s;return n};le.prototype.readUint8=le.prototype.readUInt8=function(e,r){return e=e>>>0,r||ki(e,1,this.length),this[e]};le.prototype.readUint16LE=le.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||ki(e,2,this.length),this[e]|this[e+1]<<8};le.prototype.readUint16BE=le.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||ki(e,2,this.length),this[e]<<8|this[e+1]};le.prototype.readUint32LE=le.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||ki(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};le.prototype.readUint32BE=le.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||ki(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};le.prototype.readBigUInt64LE=Eu(function(e){e=e>>>0,Gh(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Ky(e,this.length-8);let n=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});le.prototype.readBigUInt64BE=Eu(function(e){e=e>>>0,Gh(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Ky(e,this.length-8);let n=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});le.prototype.readIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||ki(e,r,this.length);let n=this[e],s=1,o=0;for(;++o<r&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*r)),n};le.prototype.readIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||ki(e,r,this.length);let n=r,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};le.prototype.readInt8=function(e,r){return e=e>>>0,r||ki(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};le.prototype.readInt16LE=function(e,r){e=e>>>0,r||ki(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};le.prototype.readInt16BE=function(e,r){e=e>>>0,r||ki(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};le.prototype.readInt32LE=function(e,r){return e=e>>>0,r||ki(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};le.prototype.readInt32BE=function(e,r){return e=e>>>0,r||ki(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};le.prototype.readBigInt64LE=Eu(function(e){e=e>>>0,Gh(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Ky(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});le.prototype.readBigInt64BE=Eu(function(e){e=e>>>0,Gh(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Ky(e,this.length-8);let n=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});le.prototype.readFloatLE=function(e,r){return e=e>>>0,r||ki(e,4,this.length),Hh.read(this,e,!0,23,4)};le.prototype.readFloatBE=function(e,r){return e=e>>>0,r||ki(e,4,this.length),Hh.read(this,e,!1,23,4)};le.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||ki(e,8,this.length),Hh.read(this,e,!0,52,8)};le.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||ki(e,8,this.length),Hh.read(this,e,!1,52,8)};function Ln(t,e,r,i,n,s){if(!le.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}le.prototype.writeUintLE=le.prototype.writeUIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Ln(this,e,r,i,a,0)}let s=1,o=0;for(this[r]=e&255;++o<i&&(s*=256);)this[r+o]=e/s&255;return r+i};le.prototype.writeUintBE=le.prototype.writeUIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Ln(this,e,r,i,a,0)}let s=i-1,o=1;for(this[r+s]=e&255;--s>=0&&(o*=256);)this[r+s]=e/o&255;return r+i};le.prototype.writeUint8=le.prototype.writeUInt8=function(e,r,i){return e=+e,r=r>>>0,i||Ln(this,e,r,1,255,0),this[r]=e&255,r+1};le.prototype.writeUint16LE=le.prototype.writeUInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||Ln(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};le.prototype.writeUint16BE=le.prototype.writeUInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||Ln(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};le.prototype.writeUint32LE=le.prototype.writeUInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||Ln(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};le.prototype.writeUint32BE=le.prototype.writeUInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||Ln(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function tq(t,e,r,i,n){aq(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,r}function rq(t,e,r,i,n){aq(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s=s>>8,t[r+6]=s,s=s>>8,t[r+5]=s,s=s>>8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o=o>>8,t[r+2]=o,o=o>>8,t[r+1]=o,o=o>>8,t[r]=o,r+8}le.prototype.writeBigUInt64LE=Eu(function(e,r=0){return tq(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeBigUInt64BE=Eu(function(e,r=0){return rq(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let c=Math.pow(2,8*i-1);Ln(this,e,r,i,c-1,-c)}let s=0,o=1,a=0;for(this[r]=e&255;++s<i&&(o*=256);)e<0&&a===0&&this[r+s-1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+i};le.prototype.writeIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let c=Math.pow(2,8*i-1);Ln(this,e,r,i,c-1,-c)}let s=i-1,o=1,a=0;for(this[r+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[r+s+1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+i};le.prototype.writeInt8=function(e,r,i){return e=+e,r=r>>>0,i||Ln(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};le.prototype.writeInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||Ln(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};le.prototype.writeInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||Ln(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};le.prototype.writeInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||Ln(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};le.prototype.writeInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||Ln(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};le.prototype.writeBigInt64LE=Eu(function(e,r=0){return tq(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});le.prototype.writeBigInt64BE=Eu(function(e,r=0){return rq(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function iq(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function nq(t,e,r,i,n){return e=+e,r=r>>>0,n||iq(t,e,r,4,34028234663852886e22,-34028234663852886e22),Hh.write(t,e,r,i,23,4),r+4}le.prototype.writeFloatLE=function(e,r,i){return nq(this,e,r,!0,i)};le.prototype.writeFloatBE=function(e,r,i){return nq(this,e,r,!1,i)};function sq(t,e,r,i,n){return e=+e,r=r>>>0,n||iq(t,e,r,8,17976931348623157e292,-17976931348623157e292),Hh.write(t,e,r,i,52,8),r+8}le.prototype.writeDoubleLE=function(e,r,i){return sq(this,e,r,!0,i)};le.prototype.writeDoubleBE=function(e,r,i){return sq(this,e,r,!1,i)};le.prototype.copy=function(e,r,i,n){if(!le.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),r>=e.length&&(r=e.length),r||(r=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-r<n-i&&(n=e.length-r+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),r),s};le.prototype.fill=function(e,r,i,n){if(typeof e=="string"){if(typeof r=="string"?(n=r,r=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!le.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<i)throw new RangeError("Out of range index");if(i<=r)return this;r=r>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=r;s<i;++s)this[s]=e;else{let o=le.isBuffer(e)?e:le.from(e,n),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-r;++s)this[s+r]=o[s%a]}return this};var $h={};function E6(t,e,r){$h[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}E6("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);E6("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);E6("ERR_OUT_OF_RANGE",function(t,e,r){let i=`The value of "${t}" is out of range.`,n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=oq(String(r)):typeof r=="bigint"&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=oq(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function oq(t){let e="",r=t.length,i=t[0]==="-"?1:0;for(;r>=i+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function PIe(t,e,r){Gh(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&Ky(e,t.length-(r+1))}function aq(t,e,r,i,n,s){if(t>r||t<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${r}${o}`,new $h.ERR_OUT_OF_RANGE("value",a,t)}PIe(i,n,s)}function Gh(t,e){if(typeof t!="number")throw new $h.ERR_INVALID_ARG_TYPE(e,"number",t)}function Ky(t,e,r){throw Math.floor(t)!==t?(Gh(t,r),new $h.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new $h.ERR_BUFFER_OUT_OF_BOUNDS:new $h.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var CIe=/[^+/0-9A-Za-z-_]/g;function OIe(t){if(t=t.split("=")[0],t=t.trim().replace(CIe,""),t.length<2)return"";for(;t.length%4!=0;)t=t+"=";return t}function S6(t,e){e=e||1/0;let r,i=t.length,n=null,s=[];for(let o=0;o<i;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function kIe(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function qIe(t,e){let r,i,n,s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i);return s}function cq(t){return b6.toByteArray(OIe(t))}function Wm(t,e,r,i){let n;for(n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}function ua(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function x6(t){return t!==t}var BIe=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let i=r*16;for(let n=0;n<16;++n)e[i+n]=t[r]+t[n]}return e}();function Eu(t){return typeof BigInt=="undefined"?NIe:t}function NIe(){throw new Error("BigInt not supported")}});var dq=p((C6t,hq)=>{f();var ii=hq.exports={},la,fa;function A6(){throw new Error("setTimeout has not been defined")}function I6(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?la=setTimeout:la=A6}catch(t){la=A6}try{typeof clearTimeout=="function"?fa=clearTimeout:fa=I6}catch(t){fa=I6}})();function uq(t){if(la===setTimeout)return setTimeout(t,0);if((la===A6||!la)&&setTimeout)return la=setTimeout,setTimeout(t,0);try{return la(t,0)}catch(e){try{return la.call(null,t,0)}catch(r){return la.call(this,t,0)}}}function DIe(t){if(fa===clearTimeout)return clearTimeout(t);if((fa===I6||!fa)&&clearTimeout)return fa=clearTimeout,clearTimeout(t);try{return fa(t)}catch(e){try{return fa.call(null,t)}catch(r){return fa.call(this,t)}}}var Ec=[],Yh=!1,Xl,Ym=-1;function MIe(){!Yh||!Xl||(Yh=!1,Xl.length?Ec=Xl.concat(Ec):Ym=-1,Ec.length&&lq())}function lq(){if(!Yh){var t=uq(MIe);Yh=!0;for(var e=Ec.length;e;){for(Xl=Ec,Ec=[];++Ym<e;)Xl&&Xl[Ym].run();Ym=-1,e=Ec.length}Xl=null,Yh=!1,DIe(t)}}ii.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Ec.push(new fq(t,e)),Ec.length===1&&!Yh&&uq(lq)};function fq(t,e){this.fun=t,this.array=e}fq.prototype.run=function(){this.fun.apply(null,this.array)};ii.title="browser";ii.browser=!0;ii.env={};ii.argv=[];ii.version="";ii.versions={};function Sc(){}ii.on=Sc;ii.addListener=Sc;ii.once=Sc;ii.off=Sc;ii.removeListener=Sc;ii.removeAllListeners=Sc;ii.emit=Sc;ii.prependListener=Sc;ii.prependOnceListener=Sc;ii.listeners=function(t){return[]};ii.binding=function(t){throw new Error("process.binding is not supported")};ii.cwd=function(){return"/"};ii.chdir=function(t){throw new Error("process.chdir is not supported")};ii.umask=function(){return 0}});var Buffer,process,f=Ge(()=>{({Buffer}=ft()),process=dq()});var T6=p(()=>{f()});var R6=p(Xm=>{f();"use strict";var pq=class extends Error{constructor(e="Request timed out"){super(e);this.name="TimeoutError"}};Xm.TimeoutError=pq;var yq=class extends Error{constructor(e="The operation was aborted."){super(e);this.name="AbortError"}};Xm.AbortError=yq;var gq=class extends Error{constructor(e){super(e.statusText);this.name="HTTPError",this.response=e}};Xm.HTTPError=gq});var P6=p((N6t,bq)=>{f();function LIe(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}bq.exports=LIe});var Vy=p((D6t,mq)=>{f();"use strict";var UIe=P6(),Qm=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,jy=UIe(),FIe=Qm&&!jy,KIe=jy&&!Qm,jIe=jy&&Qm,VIe=typeof aa=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!jy,zIe=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,HIe=typeof process!="undefined"&&typeof process.env!="undefined"&&!1,$Ie=typeof navigator!="undefined"&&navigator.product==="ReactNative";mq.exports={isTest:HIe,isElectron:jy,isElectronMain:KIe,isElectronRenderer:jIe,isNode:VIe,isBrowser:FIe,isWebWorker:zIe,isEnvWithDom:Qm,isReactNative:$Ie}});var vq=p(()=>{f()});var zy=p((Xh,wq)=>{f();"use strict";var GIe=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof xc!="undefined")return xc;throw new Error("unable to locate global object")},xc=GIe();wq.exports=Xh=xc.fetch;xc.fetch&&(Xh.default=xc.fetch.bind(xc));Xh.Headers=xc.Headers;Xh.Request=xc.Request;Xh.Response=xc.Response});var O6=p((U6t,C6)=>{f();"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?C6.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:C6.exports={default:zy().default,Headers:zy().Headers,Request:zy().Request,Response:zy().Response}});var _q=p((F6t,k6)=>{f();"use strict";var{isElectronMain:WIe}=Vy();WIe?k6.exports=vq():k6.exports=O6()});var Aq=p((K6t,xq)=>{f();"use strict";var{TimeoutError:YIe,AbortError:XIe}=R6(),{Response:Eq,Request:QIe,Headers:q6,default:ZIe}=_q(),JIe=(t,e={})=>{let r=new XMLHttpRequest;r.open(e.method||"GET",t.toString(),!0);let{timeout:i,headers:n}=e;if(i&&i>0&&i<1/0&&(r.timeout=i),e.overrideMimeType!=null&&r.overrideMimeType(e.overrideMimeType),n)for(let[s,o]of new q6(n))r.setRequestHeader(s,o);return e.signal&&(e.signal.onabort=()=>r.abort()),e.onUploadProgress&&(r.upload.onprogress=e.onUploadProgress),r.responseType="arraybuffer",new Promise((s,o)=>{let a=c=>{switch(c.type){case"error":{s(Eq.error());break}case"load":{s(new Sq(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:r4e(r.getAllResponseHeaders())}));break}case"timeout":{o(new YIe);break}case"abort":{o(new XIe);break}default:break}};r.onerror=a,r.onload=a,r.ontimeout=a,r.onabort=a,r.send(e.body)})},e4e=ZIe,t4e=(t,e={})=>e.onUploadProgress!=null?JIe(t,e):e4e(t,e),r4e=t=>{let e=new q6;for(let r of t.trim().split(/[\r\n]+/)){let i=r.indexOf(": ");i>0&&e.set(r.slice(0,i),r.slice(i+1))}return e},Sq=class extends Eq{constructor(e,r,i){super(r,i);Object.defineProperty(this,"url",{value:e})}};xq.exports={fetch:t4e,Request:QIe,Headers:q6}});var Tq=p((j6t,Iq)=>{f();"use strict";Iq.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var wr=p((Oq,kq)=>{f();"use strict";var Zm=Tq(),{hasOwnProperty:Rq}=Object.prototype,{propertyIsEnumerable:i4e}=Object,Qh=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),n4e=Oq,Pq={concatArrays:!1,ignoreUndefined:!1},Jm=t=>{let e=[];for(let r in t)Rq.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let i of r)i4e.call(t,i)&&e.push(i)}return e};function Zh(t){return Array.isArray(t)?s4e(t):Zm(t)?o4e(t):t}function s4e(t){let e=t.slice(0,0);return Jm(t).forEach(r=>{Qh(e,r,Zh(t[r]))}),e}function o4e(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return Jm(t).forEach(r=>{Qh(e,r,Zh(t[r]))}),e}var Cq=(t,e,r,i)=>(r.forEach(n=>{typeof e[n]=="undefined"&&i.ignoreUndefined||(n in t&&t[n]!==Object.getPrototypeOf(t)?Qh(t,n,B6(t[n],e[n],i)):Qh(t,n,Zh(e[n])))}),t),a4e=(t,e,r)=>{let i=t.slice(0,0),n=0;return[t,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!Rq.call(s,a)||(o.push(String(a)),s===t?Qh(i,n++,s[a]):Qh(i,n++,Zh(s[a])));i=Cq(i,s,Jm(s).filter(a=>!o.includes(a)),r)}),i};function B6(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?a4e(t,e,r):!Zm(e)||!Zm(t)?Zh(e):Cq(t,e,Jm(e),r)}kq.exports=function(...t){let e=B6(Zh(Pq),this!==n4e&&this||{},Pq),r={_:{}};for(let i of t)if(i!==void 0){if(!Zm(i))throw new TypeError("`"+i+"` is not an Option Object");r=B6(r,{_:i},e)}return r._}});var N6=p((V6t,Nq)=>{f();"use strict";var c4e=typeof navigator!="undefined"&&navigator.product==="ReactNative";function u4e(){return c4e?"http://localhost":self.location.protocol+"//"+self.location.host}var Hy=self.URL,qq=u4e(),Bq=class{constructor(e="",r=qq){this.super=new Hy(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return Hy.createObjectURL(e)}static revokeObjectURL(e){Hy.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function l4e(t){if(typeof t=="string")return new Hy(t).toString();if(!(t instanceof Hy)){let e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",i=t.port?":"+t.port:"",n=t.protocol?t.protocol+"//":"",s=t.host||"",o=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),c=t.hash||"",l=t.pathname||"",u=t.path||l+a;return`${n}${e||r}${s||o+i}${u}${c}`}}Nq.exports={URLWithLegacySupport:Bq,URLSearchParams:self.URLSearchParams,defaultBase:qq,format:l4e}});var Lq=p((z6t,Mq)=>{f();"use strict";var{URLWithLegacySupport:Dq,format:f4e}=N6();Mq.exports=(t,e={},r={},i)=>{let n=e.protocol?e.protocol.replace(":",""):"http";n=(r[n]||i||n)+":";let s;try{s=new Dq(t)}catch(a){s={}}let o=Object.assign({},e,{protocol:n||s.protocol,host:e.host||s.host});return new Dq(t,f4e(o)).toString()}});var ev=p((H6t,Uq)=>{f();"use strict";var{URLWithLegacySupport:h4e,format:d4e,URLSearchParams:p4e,defaultBase:y4e}=N6(),g4e=Lq();Uq.exports={URL:h4e,URLSearchParams:p4e,format:d4e,relative:g4e,defaultBase:y4e}});var Ql=p(($6t,tv)=>{f();"use strict";var{AbortController:Fq,AbortSignal:b4e}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;tv.exports=Fq;tv.exports.AbortSignal=b4e;tv.exports.default=Fq});var sn=p((G6t,Kq)=>{f();"use strict";var rv;globalThis.AbortController&&globalThis.AbortSignal?rv=globalThis:rv=Ql();Kq.exports={AbortController:rv.AbortController,AbortSignal:rv.AbortSignal}});var Zl=p((W6t,D6)=>{f();var{AbortController:m4e}=sn();function jq(t){let e=new m4e;function r(){e.abort();for(let i of t)!i||!i.removeEventListener||i.removeEventListener("abort",r)}for(let i of t)if(!(!i||!i.addEventListener)){if(i.aborted){r();break}i.addEventListener("abort",r)}return e.signal}D6.exports=jq;D6.exports.anySignal=jq});var $y=p((Y6t,Wq)=>{f();"use strict";var{fetch:v4e,Request:w4e,Headers:_4e}=Aq(),{TimeoutError:M6,HTTPError:Vq}=R6(),zq=wr().bind({ignoreUndefined:!0}),{URL:Hq,URLSearchParams:$q}=ev(),{AbortController:E4e}=sn(),S4e=Zl(),x4e=(t,e,r)=>{if(e===void 0)return t;let i=Date.now(),n=()=>Date.now()-i>=e;return new Promise((s,o)=>{let a=setTimeout(()=>{n()&&(o(new M6),r.abort())},e),c=l=>h=>{if(clearTimeout(a),n()){o(new M6);return}l(h)};t.then(c(s),c(o))})},A4e={throwHttpErrors:!0,credentials:"same-origin"},Sn=class{constructor(e={}){this.opts=zq(A4e,e)}async fetch(e,r={}){let i=zq(this.opts,r),n=new _4e(i.headers);if(typeof e!="string"&&!(e instanceof Hq||e instanceof w4e))throw new TypeError("`resource` must be a string, URL, or Request");let s=new Hq(e.toString(),i.base),{searchParams:o,transformSearchParams:a,json:c}=i;o&&(typeof a=="function"?s.search=a(new $q(i.searchParams)):s.search=new $q(i.searchParams)),c&&(i.body=JSON.stringify(i.json),n.set("content-type","application/json"));let l=new E4e,u=S4e([l.signal,i.signal]),h=await x4e(v4e(s.toString(),{...i,signal:u,timeout:void 0,headers:n}),i.timeout,l);if(!h.ok&&i.throwHttpErrors)throw i.handleError&&await i.handleError(h),new Vq(h);return h.iterator=function(){return Gq(h.body)},h.ndjson=async function*(){for await(let d of I4e(h.iterator()))r.transform?yield r.transform(d):yield d},h}post(e,r={}){return this.fetch(e,{...r,method:"POST"})}get(e,r={}){return this.fetch(e,{...r,method:"GET"})}put(e,r={}){return this.fetch(e,{...r,method:"PUT"})}delete(e,r={}){return this.fetch(e,{...r,method:"DELETE"})}options(e,r={}){return this.fetch(e,{...r,method:"OPTIONS"})}},I4e=async function*(t){let e=new TextDecoder,r="";for await(let i of t){r+=e.decode(i,{stream:!0});let n=r.split(/\r?\n/);for(let s=0;s<n.length-1;s++){let o=n[s].trim();o.length>0&&(yield JSON.parse(o))}r=n[n.length-1]}r+=e.decode(),r=r.trim(),r.length!==0&&(yield JSON.parse(r))},Gq=t=>{if(P4e(t)){let e=t[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:e.next.bind(e),return(r){return t.destroy(),typeof e.return=="function"?e.return():Promise.resolve({done:!0,value:r})}}}}}if(R4e(t)){let e=t.getReader();return async function*(){try{for(;;){let{done:r,value:i}=await e.read();if(r)return;i&&(yield i)}}finally{e.releaseLock()}}()}if(T4e(t))return t;throw new TypeError("Body can't be converted to AsyncIterable")},T4e=t=>typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function",R4e=t=>t&&typeof t.getReader=="function",P4e=t=>Object.prototype.hasOwnProperty.call(t,"readable")&&Object.prototype.hasOwnProperty.call(t,"writable");Sn.HTTPError=Vq;Sn.TimeoutError=M6;Sn.streamToAsyncIterator=Gq;Sn.post=(t,e)=>new Sn(e).post(t,e);Sn.get=(t,e)=>new Sn(e).get(t,e);Sn.put=(t,e)=>new Sn(e).put(t,e);Sn.delete=(t,e)=>new Sn(e).delete(t,e);Sn.options=(t,e)=>new Sn(e).options(t,e);Wq.exports=Sn});var L6=p((X6t,Yq)=>{f();"use strict";var C4e=$y(),O4e=(t,e)=>({path:decodeURIComponent(new URL(t).pathname.split("/").pop()||""),content:k4e(t,e)});async function*k4e(t,e){yield*(await new C4e().get(t,e)).iterator()}Yq.exports=O4e});function Qq(t,e,r){e=e||[],r=r||0;for(var i=r;t>=D4e;)e[r++]=t&255|Xq,t/=128;for(;t&N4e;)e[r++]=t&255|Xq,t>>>=7;return e[r]=t|0,Qq.bytes=r-i+1,e}function U6(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o)throw U6.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&Zq)<<i:(s&Zq)*Math.pow(2,i),i+=7}while(s>=L4e);return U6.bytes=n-e,r}var q4e,Xq,B4e,N4e,D4e,M4e,L4e,Zq,U4e,F4e,K4e,j4e,V4e,z4e,H4e,$4e,G4e,W4e,Y4e,X4e,Gy,Jq=Ge(()=>{f();q4e=Qq,Xq=128,B4e=127,N4e=~B4e,D4e=Math.pow(2,31);M4e=U6,L4e=128,Zq=127;U4e=Math.pow(2,7),F4e=Math.pow(2,14),K4e=Math.pow(2,21),j4e=Math.pow(2,28),V4e=Math.pow(2,35),z4e=Math.pow(2,42),H4e=Math.pow(2,49),$4e=Math.pow(2,56),G4e=Math.pow(2,63),W4e=function(t){return t<U4e?1:t<F4e?2:t<K4e?3:t<j4e?4:t<V4e?5:t<z4e?6:t<H4e?7:t<$4e?8:t<G4e?9:10},Y4e={encode:q4e,decode:M4e,encodingLength:W4e},X4e=Y4e,Gy=X4e});var Wy={};Gt(Wy,{decode:()=>Jh,encodeTo:()=>Jl,encodingLength:()=>ef});var Jh,Jl,ef,iv=Ge(()=>{f();Jq();Jh=t=>[Gy.decode(t),Gy.decode.bytes],Jl=(t,e,r=0)=>(Gy.encode(t,e,r),e),ef=t=>Gy.encodingLength(t)});var tf={};Gt(tf,{coerce:()=>po,empty:()=>eB,equals:()=>F6,fromHex:()=>Z4e,fromString:()=>K6,isBinary:()=>J4e,toHex:()=>Q4e,toString:()=>j6});var eB,Q4e,Z4e,F6,po,J4e,K6,j6,Su=Ge(()=>{f();eB=new Uint8Array(0),Q4e=t=>t.reduce((e,r)=>e+r.toString(16).padStart(2,"0"),""),Z4e=t=>{let e=t.match(/../g);return e?new Uint8Array(e.map(r=>parseInt(r,16))):eB},F6=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},po=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},J4e=t=>t instanceof ArrayBuffer||ArrayBuffer.isView(t),K6=t=>new TextEncoder().encode(t),j6=t=>new TextDecoder().decode(t)});var xn={};Gt(xn,{Digest:()=>td,create:()=>Yy,decode:()=>ed,equals:()=>V6});var Yy,ed,V6,td,An=Ge(()=>{f();Su();iv();Yy=(t,e)=>{let r=e.byteLength,i=ef(t),n=i+ef(r),s=new Uint8Array(n+r);return Jl(t,s,0),Jl(r,s,i),s.set(e,n),new td(t,r,e,s)},ed=t=>{let e=po(t),[r,i]=Jh(e),[n,s]=Jh(e.subarray(i)),o=e.subarray(i+s);if(o.byteLength!==n)throw new Error("Incorrect length");return new td(r,n,o,e)},V6=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&F6(t.bytes,e.bytes),td=class{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}});function e5e(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var m=0,E=0,v=0,A=g.length;v!==A&&g[v]===0;)v++,m++;for(var R=(A-v)*u+1>>>0,F=new Uint8Array(R);v!==A;){for(var q=g[v],B=0,z=R-1;(q!==0||B<E)&&z!==-1;z--,B++)q+=256*F[z]>>>0,F[z]=q%a>>>0,q=q/a>>>0;if(q!==0)throw new Error("Non-zero carry");E=B,v++}for(var G=R-E;G!==R&&F[G]===0;)G++;for(var Y=c.repeat(m);G<R;++G)Y+=t.charAt(F[G]);return Y}function d(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var m=0;if(g[m]!==" "){for(var E=0,v=0;g[m]===c;)E++,m++;for(var A=(g.length-m)*l+1>>>0,R=new Uint8Array(A);g[m];){var F=r[g.charCodeAt(m)];if(F===255)return;for(var q=0,B=A-1;(F!==0||q<v)&&B!==-1;B--,q++)F+=a*R[B]>>>0,R[B]=F%256>>>0,F=F/256>>>0;if(F!==0)throw new Error("Non-zero carry");v=q,m++}if(g[m]!==" "){for(var z=A-v;z!==A&&R[z]===0;)z++;for(var G=new Uint8Array(E+(A-z)),Y=E;z!==A;)G[Y++]=R[z++];return G}}}function y(g){var m=d(g);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:y}}var t5e,r5e,tB,rB=Ge(()=>{f();t5e=e5e,r5e=t5e,tB=r5e});var iB,nB,nv,sB,sv,xu,i5e,n5e,Hr,ha=Ge(()=>{f();rB();Su();iB=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},nB=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseDecode=i}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){let r={[this.prefix]:this,...e.decoders||{[e.prefix]:e}};return new nv(r)}},nv=class{constructor(e){this.decoders=e}or(e){let r=e.decoders||{[e.prefix]:e};return new nv({...this.decoders,...r})}decode(e){let r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},sB=class{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new iB(e,r,i),this.decoder=new nB(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},sv=({name:t,prefix:e,encode:r,decode:i})=>new sB(t,e,r,i),xu=({prefix:t,name:e,alphabet:r})=>{let{encode:i,decode:n}=tB(r,e);return sv({prefix:t,name:e,encode:i,decode:s=>po(n(s))})},i5e=(t,e,r,i)=>{let n={};for(let u=0;u<e.length;++u)n[e[u]]=u;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,l=0;for(let u=0;u<s;++u){let h=n[t[u]];if(h===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},n5e=(t,e,r)=>{let i=e[e.length-1]==="=",n=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},Hr=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>sv({prefix:e,name:t,encode(n){return n5e(n,i,r)},decode(n){return i5e(n,i,r,t)}})});var ni={};Gt(ni,{base58btc:()=>da,base58flickr:()=>s5e});var da,s5e,si=Ge(()=>{f();ha();da=xu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s5e=xu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var on={};Gt(on,{base32:()=>rd,base32hex:()=>u5e,base32hexpad:()=>f5e,base32hexpadupper:()=>h5e,base32hexupper:()=>l5e,base32pad:()=>a5e,base32padupper:()=>c5e,base32upper:()=>o5e,base32z:()=>d5e});var rd,o5e,a5e,c5e,u5e,l5e,f5e,h5e,d5e,an=Ge(()=>{f();ha();rd=Hr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),o5e=Hr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),a5e=Hr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),c5e=Hr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),u5e=Hr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),l5e=Hr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),f5e=Hr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h5e=Hr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d5e=Hr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var Ce={};Gt(Ce,{CID:()=>rt});var rt,p5e,y5e,g5e,Xy,b5e,oB,aB,ov,av,m5e,v5e,w5e,Ae=Ge(()=>{f();iv();An();si();an();Su();rt=class{constructor(e,r,i,n){this.code=r,this.version=e,this.multihash=i,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:av,byteLength:av,code:ov,version:ov,multihash:ov,bytes:ov,_baseCache:av,asCID:av})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Xy)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==b5e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return rt.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,i=Yy(e,r);return rt.createV1(this.code,i)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&V6(this.multihash,e.multihash)}toString(e){let{bytes:r,version:i,_baseCache:n}=this;switch(i){case 0:return y5e(r,n,e||da.encoder);default:return g5e(r,n,e||rd.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return v5e(/^0\.0/,w5e),!!(e&&(e[aB]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof rt)return e;if(e!=null&&e.asCID===e){let{version:r,code:i,multihash:n,bytes:s}=e;return new rt(r,i,n,s||oB(r,i,n.bytes))}else if(e!=null&&e[aB]===!0){let{version:r,multihash:i,code:n}=e,s=ed(i);return rt.create(r,n,s)}else return null}static create(e,r,i){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Xy)throw new Error(`Version 0 CID must use dag-pb (code: ${Xy}) block encoding`);return new rt(e,r,i,i.bytes)}case 1:{let n=oB(e,r,i.bytes);return new rt(e,r,i,n)}default:throw new Error("Invalid version")}}static createV0(e){return rt.create(0,Xy,e)}static createV1(e,r){return rt.create(1,e,r)}static decode(e){let[r,i]=rt.decodeFirst(e);if(i.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=rt.inspectBytes(e),i=r.size-r.multihashSize,n=po(e.subarray(i,i+r.multihashSize));if(n.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=n.subarray(r.multihashSize-r.digestSize),o=new td(r.multihashCode,r.digestSize,s,n);return[r.version===0?rt.createV0(o):rt.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,i=()=>{let[h,d]=Jh(e.subarray(r));return r+=d,h},n=i(),s=Xy;if(n===18?(n=0,r=0):n===1&&(s=i()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let o=r,a=i(),c=i(),l=r+c,u=l-o;return{version:n,codec:s,multihashCode:a,digestSize:c,multihashSize:u,size:l}}static parse(e,r){let[i,n]=p5e(e,r),s=rt.decode(n);return s._baseCache.set(i,e),s}},p5e=(t,e)=>{switch(t[0]){case"Q":{let r=e||da;return[da.prefix,r.decode(`${da.prefix}${t}`)]}case da.prefix:{let r=e||da;return[da.prefix,r.decode(t)]}case rd.prefix:{let r=e||rd;return[rd.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},y5e=(t,e,r)=>{let{prefix:i}=r;if(i!==da.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let n=e.get(i);if(n==null){let s=r.encode(t).slice(1);return e.set(i,s),s}else return n},g5e=(t,e,r)=>{let{prefix:i}=r,n=e.get(i);if(n==null){let s=r.encode(t);return e.set(i,s),s}else return n},Xy=112,b5e=18,oB=(t,e,r)=>{let i=ef(t),n=i+ef(e),s=new Uint8Array(n+r.byteLength);return Jl(t,s,0),Jl(e,s,i),s.set(r,n),s},aB=Symbol.for("@ipld/js-cid/CID"),ov={writable:!1,configurable:!1,enumerable:!0},av={writable:!1,enumerable:!1,configurable:!1},m5e="0.0.0-dev",v5e=(t,e)=>{if(t.test(m5e))console.warn(e);else throw new Error(e)},w5e=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var cv={};Gt(cv,{base36:()=>_5e,base36upper:()=>E5e});var _5e,E5e,z6=Ge(()=>{f();ha();_5e=xu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),E5e=xu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var id={};Gt(id,{base64:()=>S5e,base64pad:()=>x5e,base64url:()=>A5e,base64urlpad:()=>I5e});var S5e,x5e,A5e,I5e,Qy=Ge(()=>{f();ha();S5e=Hr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),x5e=Hr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),A5e=Hr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),I5e=Hr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var uv={};Gt(uv,{base16:()=>T5e,base16upper:()=>R5e});var T5e,R5e,H6=Ge(()=>{f();ha();T5e=Hr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),R5e=Hr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var uB=p((yxt,cB)=>{f();"use strict";cB.exports=P5e;function P5e(t,e){for(var r=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)r[i++]=arguments[n++];return new Promise(function(a,c){r[i]=function(u){if(s)if(s=!1,u)c(u);else{for(var h=new Array(arguments.length-1),d=0;d<h.length;)h[d++]=arguments[d];a.apply(null,h)}};try{t.apply(e||null,r)}catch(l){s&&(s=!1,c(l))}})}});var dB=p(hB=>{f();"use strict";var lv=hB;lv.length=function(e){var r=e.length;if(!r)return 0;for(var i=0;--r%4>1&&e.charAt(r)==="=";)++i;return Math.ceil(e.length*3)/4-i};var nd=new Array(64),lB=new Array(123);for(yo=0;yo<64;)lB[nd[yo]=yo<26?yo+65:yo<52?yo+71:yo<62?yo-4:yo-59|43]=yo++;var yo;lv.encode=function(e,r,i){for(var n=null,s=[],o=0,a=0,c;r<i;){var l=e[r++];switch(a){case 0:s[o++]=nd[l>>2],c=(l&3)<<4,a=1;break;case 1:s[o++]=nd[c|l>>4],c=(l&15)<<2,a=2;break;case 2:s[o++]=nd[c|l>>6],s[o++]=nd[l&63],a=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=nd[c],s[o++]=61,a===1&&(s[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var fB="invalid encoding";lv.decode=function(e,r,i){for(var n=i,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=lB[c])===void 0)throw Error(fB);switch(s){case 0:o=c,s=1;break;case 1:r[i++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:r[i++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:r[i++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(fB);return i-n};lv.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var yB=p((bxt,pB)=>{f();"use strict";pB.exports=fv;function fv(){this._listeners={}}fv.prototype.on=function(e,r,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:i||this}),this};fv.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===r?i.splice(n,1):++n;return this};fv.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<r.length;)r[n].fn.apply(r[n++].ctx,i)}return this}});var EB=p((mxt,_B)=>{f();"use strict";_B.exports=gB(gB);function gB(t){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),i=r[3]===128;function n(c,l,u){e[0]=c,l[u]=r[0],l[u+1]=r[1],l[u+2]=r[2],l[u+3]=r[3]}function s(c,l,u){e[0]=c,l[u]=r[3],l[u+1]=r[2],l[u+2]=r[1],l[u+3]=r[0]}t.writeFloatLE=i?n:s,t.writeFloatBE=i?s:n;function o(c,l){return r[0]=c[l],r[1]=c[l+1],r[2]=c[l+2],r[3]=c[l+3],e[0]}function a(c,l){return r[3]=c[l],r[2]=c[l+1],r[1]=c[l+2],r[0]=c[l+3],e[0]}t.readFloatLE=i?o:a,t.readFloatBE=i?a:o}():function(){function e(i,n,s,o){var a=n<0?1:0;if(a&&(n=-n),n===0)i(1/n>0?0:2147483648,s,o);else if(isNaN(n))i(2143289344,s,o);else if(n>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(n<11754943508222875e-54)i((a<<31|Math.round(n/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(n)/Math.LN2),l=Math.round(n*Math.pow(2,-c)*8388608)&8388607;i((a<<31|c+127<<23|l)>>>0,s,o)}}t.writeFloatLE=e.bind(null,bB),t.writeFloatBE=e.bind(null,mB);function r(i,n,s){var o=i(n,s),a=(o>>31)*2+1,c=o>>>23&255,l=o&8388607;return c===255?l?NaN:a*(1/0):c===0?a*1401298464324817e-60*l:a*Math.pow(2,c-150)*(l+8388608)}t.readFloatLE=r.bind(null,vB),t.readFloatBE=r.bind(null,wB)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),i=r[7]===128;function n(c,l,u){e[0]=c,l[u]=r[0],l[u+1]=r[1],l[u+2]=r[2],l[u+3]=r[3],l[u+4]=r[4],l[u+5]=r[5],l[u+6]=r[6],l[u+7]=r[7]}function s(c,l,u){e[0]=c,l[u]=r[7],l[u+1]=r[6],l[u+2]=r[5],l[u+3]=r[4],l[u+4]=r[3],l[u+5]=r[2],l[u+6]=r[1],l[u+7]=r[0]}t.writeDoubleLE=i?n:s,t.writeDoubleBE=i?s:n;function o(c,l){return r[0]=c[l],r[1]=c[l+1],r[2]=c[l+2],r[3]=c[l+3],r[4]=c[l+4],r[5]=c[l+5],r[6]=c[l+6],r[7]=c[l+7],e[0]}function a(c,l){return r[7]=c[l],r[6]=c[l+1],r[5]=c[l+2],r[4]=c[l+3],r[3]=c[l+4],r[2]=c[l+5],r[1]=c[l+6],r[0]=c[l+7],e[0]}t.readDoubleLE=i?o:a,t.readDoubleBE=i?a:o}():function(){function e(i,n,s,o,a,c){var l=o<0?1:0;if(l&&(o=-o),o===0)i(0,a,c+n),i(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))i(0,a,c+n),i(2146959360,a,c+s);else if(o>17976931348623157e292)i(0,a,c+n),i((l<<31|2146435072)>>>0,a,c+s);else{var u;if(o<22250738585072014e-324)u=o/5e-324,i(u>>>0,a,c+n),i((l<<31|u/4294967296)>>>0,a,c+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),u=o*Math.pow(2,-h),i(u*4503599627370496>>>0,a,c+n),i((l<<31|h+1023<<20|u*1048576&1048575)>>>0,a,c+s)}}}t.writeDoubleLE=e.bind(null,bB,0,4),t.writeDoubleBE=e.bind(null,mB,4,0);function r(i,n,s,o,a){var c=i(o,a+n),l=i(o,a+s),u=(l>>31)*2+1,h=l>>>20&2047,d=4294967296*(l&1048575)+c;return h===2047?d?NaN:u*(1/0):h===0?u*5e-324*d:u*Math.pow(2,h-1075)*(d+4503599627370496)}t.readDoubleLE=r.bind(null,vB,0,4),t.readDoubleBE=r.bind(null,wB,4,0)}(),t}function bB(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function mB(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function vB(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function wB(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var SB=p((exports,module)=>{f();"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var AB=p(xB=>{f();"use strict";var $6=xB;$6.length=function(e){for(var r=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?r+=1:i<2048?r+=2:(i&64512)==55296&&(e.charCodeAt(n+1)&64512)==56320?(++n,r+=4):r+=3;return r};$6.read=function(e,r,i){var n=i-r;if(n<1)return"";for(var s=null,o=[],a=0,c;r<i;)c=e[r++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};$6.write=function(e,r,i){for(var n=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128);return i-n}});var TB=p((wxt,IB)=>{f();"use strict";IB.exports=C5e;function C5e(t,e,r){var i=r||8192,n=i>>>1,s=null,o=i;return function(c){if(c<1||c>n)return t(c);o+c>i&&(s=t(i),o=0);var l=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),l}}});var PB=p((_xt,RB)=>{f();"use strict";RB.exports=qi;var Zy=Iu();function qi(t,e){this.lo=t>>>0,this.hi=e>>>0}var rf=qi.zero=new qi(0,0);rf.toNumber=function(){return 0};rf.zzEncode=rf.zzDecode=function(){return this};rf.length=function(){return 1};var O5e=qi.zeroHash="\0\0\0\0\0\0\0\0";qi.fromNumber=function(e){if(e===0)return rf;var r=e<0;r&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return r&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new qi(i,n)};qi.from=function(e){if(typeof e=="number")return qi.fromNumber(e);if(Zy.isString(e))if(Zy.Long)e=Zy.Long.fromString(e);else return qi.fromNumber(parseInt(e,10));return e.low||e.high?new qi(e.low>>>0,e.high>>>0):rf};qi.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,i=~this.hi>>>0;return r||(i=i+1>>>0),-(r+i*4294967296)}return this.lo+this.hi*4294967296};qi.prototype.toLong=function(e){return Zy.Long?new Zy.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Au=String.prototype.charCodeAt;qi.fromHash=function(e){return e===O5e?rf:new qi((Au.call(e,0)|Au.call(e,1)<<8|Au.call(e,2)<<16|Au.call(e,3)<<24)>>>0,(Au.call(e,4)|Au.call(e,5)<<8|Au.call(e,6)<<16|Au.call(e,7)<<24)>>>0)};qi.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};qi.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};qi.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};qi.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:i<128?9:10}});var Iu=p(G6=>{f();"use strict";var He=G6;He.asPromise=uB();He.base64=dB();He.EventEmitter=yB();He.float=EB();He.inquire=SB();He.utf8=AB();He.pool=TB();He.LongBits=PB();He.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);He.global=He.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||G6;He.emptyArray=Object.freeze?Object.freeze([]):[];He.emptyObject=Object.freeze?Object.freeze({}):{};He.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};He.isString=function(e){return typeof e=="string"||e instanceof String};He.isObject=function(e){return e&&typeof e=="object"};He.isset=He.isSet=function(e,r){var i=e[r];return i!=null&&e.hasOwnProperty(r)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};He.Buffer=function(){try{var t=He.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(e){return null}}();He._Buffer_from=null;He._Buffer_allocUnsafe=null;He.newBuffer=function(e){return typeof e=="number"?He.Buffer?He._Buffer_allocUnsafe(e):new He.Array(e):He.Buffer?He._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};He.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;He.Long=He.global.dcodeIO&&He.global.dcodeIO.Long||He.global.Long||He.inquire("long");He.key2Re=/^true|false|0|1$/;He.key32Re=/^-?(?:0|[1-9][0-9]*)$/;He.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;He.longToHash=function(e){return e?He.LongBits.from(e).toHash():He.LongBits.zeroHash};He.longFromHash=function(e,r){var i=He.LongBits.fromHash(e);return He.Long?He.Long.fromBits(i.lo,i.hi,r):i.toNumber(Boolean(r))};function CB(t,e,r){for(var i=Object.keys(e),n=0;n<i.length;++n)(t[i[n]]===void 0||!r)&&(t[i[n]]=e[i[n]]);return t}He.merge=CB;He.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function OB(t){function e(r,i){if(!(this instanceof e))return new e(r,i);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&CB(this,i)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}He.newError=OB;He.ProtocolError=OB("ProtocolError");He.oneOfGetter=function(e){for(var r={},i=0;i<e.length;++i)r[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(r[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};He.oneOfSetter=function(e){return function(r){for(var i=0;i<e.length;++i)e[i]!==r&&delete this[e[i]]}};He.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};He._configure=function(){var t=He.Buffer;if(!t){He._Buffer_from=He._Buffer_allocUnsafe=null;return}He._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,i){return new t(r,i)},He._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var ex=p((Sxt,NB)=>{f();"use strict";NB.exports=Ot;var xs=Iu(),W6,hv=xs.LongBits,kB=xs.base64,qB=xs.utf8;function Jy(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Y6(){}function k5e(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Ot(){this.len=0,this.head=new Jy(Y6,0,0),this.tail=this.head,this.states=null}var BB=function(){return xs.Buffer?function(){return(Ot.create=function(){return new W6})()}:function(){return new Ot}};Ot.create=BB();Ot.alloc=function(e){return new xs.Array(e)};xs.Array!==Array&&(Ot.alloc=xs.pool(Ot.alloc,xs.Array.prototype.subarray));Ot.prototype._push=function(e,r,i){return this.tail=this.tail.next=new Jy(e,r,i),this.len+=r,this};function X6(t,e,r){e[r]=t&255}function q5e(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Q6(t,e){this.len=t,this.next=void 0,this.val=e}Q6.prototype=Object.create(Jy.prototype);Q6.prototype.fn=q5e;Ot.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Q6((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Ot.prototype.int32=function(e){return e<0?this._push(Z6,10,hv.fromNumber(e)):this.uint32(e)};Ot.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Z6(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}Ot.prototype.uint64=function(e){var r=hv.from(e);return this._push(Z6,r.length(),r)};Ot.prototype.int64=Ot.prototype.uint64;Ot.prototype.sint64=function(e){var r=hv.from(e).zzEncode();return this._push(Z6,r.length(),r)};Ot.prototype.bool=function(e){return this._push(X6,1,e?1:0)};function J6(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}Ot.prototype.fixed32=function(e){return this._push(J6,4,e>>>0)};Ot.prototype.sfixed32=Ot.prototype.fixed32;Ot.prototype.fixed64=function(e){var r=hv.from(e);return this._push(J6,4,r.lo)._push(J6,4,r.hi)};Ot.prototype.sfixed64=Ot.prototype.fixed64;Ot.prototype.float=function(e){return this._push(xs.float.writeFloatLE,4,e)};Ot.prototype.double=function(e){return this._push(xs.float.writeDoubleLE,8,e)};var B5e=xs.Array.prototype.set?function(e,r,i){r.set(e,i)}:function(e,r,i){for(var n=0;n<e.length;++n)r[i+n]=e[n]};Ot.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(X6,1,0);if(xs.isString(e)){var i=Ot.alloc(r=kB.length(e));kB.decode(e,i,0),e=i}return this.uint32(r)._push(B5e,r,e)};Ot.prototype.string=function(e){var r=qB.length(e);return r?this.uint32(r)._push(qB.write,r,e):this._push(X6,1,0)};Ot.prototype.fork=function(){return this.states=new k5e(this),this.head=this.tail=new Jy(Y6,0,0),this.len=0,this};Ot.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Jy(Y6,0,0),this.len=0),this};Ot.prototype.ldelim=function(){var e=this.head,r=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=r,this.len+=i),this};Ot.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,r,i),i+=e.len,e=e.next;return r};Ot._configure=function(t){W6=t,Ot.create=BB(),W6._configure()}});var LB=p((xxt,MB)=>{f();"use strict";MB.exports=pa;var DB=ex();(pa.prototype=Object.create(DB.prototype)).constructor=pa;var Tu=Iu();function pa(){DB.call(this)}pa._configure=function(){pa.alloc=Tu._Buffer_allocUnsafe,pa.writeBytesBuffer=Tu.Buffer&&Tu.Buffer.prototype instanceof Uint8Array&&Tu.Buffer.prototype.set.name==="set"?function(e,r,i){r.set(e,i)}:function(e,r,i){if(e.copy)e.copy(r,i,0,e.length);else for(var n=0;n<e.length;)r[i++]=e[n++]}};pa.prototype.bytes=function(e){Tu.isString(e)&&(e=Tu._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(pa.writeBytesBuffer,r,e),this};function N5e(t,e,r){t.length<40?Tu.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}pa.prototype.string=function(e){var r=Tu.Buffer.byteLength(e);return this.uint32(r),r&&this._push(N5e,r,e),this};pa._configure()});var ix=p((Axt,VB)=>{f();"use strict";VB.exports=oi;var ya=Iu(),tx,UB=ya.LongBits,D5e=ya.utf8;function go(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function oi(t){this.buf=t,this.pos=0,this.len=t.length}var FB=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new oi(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new oi(e);throw Error("illegal buffer")},KB=function(){return ya.Buffer?function(r){return(oi.create=function(n){return ya.Buffer.isBuffer(n)?new tx(n):FB(n)})(r)}:FB};oi.create=KB();oi.prototype._slice=ya.Array.prototype.subarray||ya.Array.prototype.slice;oi.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,go(this,10);return e}}();oi.prototype.int32=function(){return this.uint32()|0};oi.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function rx(){var t=new UB(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw go(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw go(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}oi.prototype.bool=function(){return this.uint32()!==0};function dv(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}oi.prototype.fixed32=function(){if(this.pos+4>this.len)throw go(this,4);return dv(this.buf,this.pos+=4)};oi.prototype.sfixed32=function(){if(this.pos+4>this.len)throw go(this,4);return dv(this.buf,this.pos+=4)|0};function jB(){if(this.pos+8>this.len)throw go(this,8);return new UB(dv(this.buf,this.pos+=4),dv(this.buf,this.pos+=4))}oi.prototype.float=function(){if(this.pos+4>this.len)throw go(this,4);var e=ya.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};oi.prototype.double=function(){if(this.pos+8>this.len)throw go(this,4);var e=ya.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};oi.prototype.bytes=function(){var e=this.uint32(),r=this.pos,i=this.pos+e;if(i>this.len)throw go(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,i):r===i?new this.buf.constructor(0):this._slice.call(this.buf,r,i)};oi.prototype.string=function(){var e=this.bytes();return D5e.read(e,0,e.length)};oi.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw go(this,e);this.pos+=e}else do if(this.pos>=this.len)throw go(this);while(this.buf[this.pos++]&128);return this};oi.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!=4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};oi._configure=function(t){tx=t,oi.create=KB(),tx._configure();var e=ya.Long?"toLong":"toNumber";ya.merge(oi.prototype,{int64:function(){return rx.call(this)[e](!1)},uint64:function(){return rx.call(this)[e](!0)},sint64:function(){return rx.call(this).zzDecode()[e](!1)},fixed64:function(){return jB.call(this)[e](!0)},sfixed64:function(){return jB.call(this)[e](!1)}})}});var GB=p((Ixt,$B)=>{f();"use strict";$B.exports=nf;var zB=ix();(nf.prototype=Object.create(zB.prototype)).constructor=nf;var HB=Iu();function nf(t){zB.call(this,t)}nf._configure=function(){HB.Buffer&&(nf.prototype._slice=HB.Buffer.prototype.slice)};nf.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};nf._configure()});var YB=p((Txt,WB)=>{f();"use strict";WB.exports=eg;var nx=Iu();(eg.prototype=Object.create(nx.EventEmitter.prototype)).constructor=eg;function eg(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");nx.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}eg.prototype.rpcCall=function t(e,r,i,n,s){if(!n)throw TypeError("request must be specified");var o=this;if(!s)return nx.asPromise(t,o,e,r,i,n);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(c,l){if(c)return o.emit("error",c,e),s(c);if(l===null){o.end(!0);return}if(!(l instanceof i))try{l=i[o.responseDelimited?"decodeDelimited":"decode"](l)}catch(u){return o.emit("error",u,e),s(u)}return o.emit("data",l,e),s(null,l)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};eg.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var QB=p(XB=>{f();"use strict";var M5e=XB;M5e.Service=YB()});var JB=p((Pxt,ZB)=>{f();"use strict";ZB.exports={}});var rN=p(tN=>{f();"use strict";var Un=tN;Un.build="minimal";Un.Writer=ex();Un.BufferWriter=LB();Un.Reader=ix();Un.BufferReader=GB();Un.util=Iu();Un.rpc=QB();Un.roots=JB();Un.configure=eN;function eN(){Un.util._configure(),Un.Writer._configure(Un.BufferWriter),Un.Reader._configure(Un.BufferReader)}eN()});var Bi=p((Oxt,iN)=>{f();"use strict";iN.exports=rN()});var yv=p((kxt,sN)=>{f();"use strict";var sf=Bi(),pv=sf.Reader,nN=sf.Writer,cn=sf.util,As=sf.roots["libp2p-crypto-keys"]||(sf.roots["libp2p-crypto-keys"]={});As.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();As.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=cn.newBuffer([]),t.encode=function(r,i){return i||(i=nN.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof pv||(r=pv.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new As.PublicKey;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw cn.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw cn.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof As.PublicKey)return r;var i=new As.PublicKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?cn.base64.decode(r.Data,i.Data=cn.newBuffer(cn.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=cn.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?As.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?cn.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,sf.util.toJSONOptions)},t}();As.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=cn.newBuffer([]),t.encode=function(r,i){return i||(i=nN.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof pv||(r=pv.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new As.PrivateKey;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw cn.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw cn.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof As.PrivateKey)return r;var i=new As.PrivateKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?cn.base64.decode(r.Data,i.Data=cn.newBuffer(cn.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=cn.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?As.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?cn.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,sf.util.toJSONOptions)},t}();sN.exports=As});var lt=p((qxt,oN)=>{f();oN.exports={options:{usePureJavaScript:!1}}});var uN=p((Bxt,cN)=>{f();var sx={};cN.exports=sx;var aN={};sx.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(t instanceof Uint8Array))i=L5e(t,e);else{var n=0,s=e.length,o=e.charAt(0),a=[0];for(n=0;n<t.length;++n){for(var c=0,l=t[n];c<a.length;++c)l+=a[c]<<8,a[c]=l%s,l=l/s|0;for(;l>0;)a.push(l%s),l=l/s|0}for(n=0;t[n]===0&&n<t.length-1;++n)i+=o;for(n=a.length-1;n>=0;--n)i+=e[a[n]]}if(r){var u=new RegExp(".{1,"+r+"}","g");i=i.match(u).join(`\r
`)}return i};sx.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=aN[e];if(!r){r=aN[e]=[];for(var i=0;i<e.length;++i)r[e.charCodeAt(i)]=i}t=t.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),o=[0],i=0;i<t.length;i++){var a=r[t.charCodeAt(i)];if(a===void 0)return;for(var c=0,l=a;c<o.length;++c)l+=o[c]*n,o[c]=l&255,l>>=8;for(;l>0;)o.push(l&255),l>>=8}for(var u=0;t[u]===s&&u<t.length-1;++u)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function L5e(t,e){var r=0,i=e.length,n=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%i,a=a/i|0;for(;a>0;)s.push(a%i),a=a/i|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=n;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Wt=p((Nxt,dN)=>{f();var lN=lt(),fN=uN(),re=dN.exports=lN.util=lN.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){re.nextTick=process.nextTick,typeof setImmediate=="function"?re.setImmediate=setImmediate:re.setImmediate=re.nextTick;return}if(typeof setImmediate=="function"){re.setImmediate=function(){return setImmediate.apply(void 0,arguments)},re.nextTick=function(a){return setImmediate(a)};return}if(re.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var l=e.slice();e.length=0,l.forEach(function(u){u()})}};var o=a,t="forge.setImmediate",e=[];re.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(l){l()})}).observe(n,{attributes:!0});var s=re.setImmediate;re.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&n.setAttribute("a",i=!i))}}re.nextTick=re.setImmediate})();re.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;re.globalScope=function(){return re.isNodejs?globalThis:typeof self=="undefined"?window:self}();re.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};re.isArrayBuffer=function(t){return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer};re.isArrayBufferView=function(t){return t&&re.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function tg(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}re.ByteBuffer=ox;function ox(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(re.isArrayBuffer(t)||re.isArrayBufferView(t))if(typeof Buffer!="undefined"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof ox||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}re.ByteStringBuffer=ox;var U5e=4096;re.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>U5e&&(this.data.substr(0,1),this._constructedStringLength=0)};re.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};re.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};re.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};re.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};re.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};re.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(re.encodeUtf8(t))};re.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};re.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};re.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};re.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};re.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};re.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};re.ByteStringBuffer.prototype.putInt=function(t,e){tg(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};re.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};re.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};re.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};re.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};re.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};re.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};re.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};re.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};re.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};re.ByteStringBuffer.prototype.getInt=function(t){tg(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};re.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};re.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};re.ByteStringBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};re.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};re.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};re.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};re.ByteStringBuffer.prototype.copy=function(){var t=re.createBuffer(this.data);return t.read=this.read,t};re.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};re.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};re.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};re.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};re.ByteStringBuffer.prototype.toString=function(){return re.decodeUtf8(this.bytes())};function F5e(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=re.isArrayBuffer(t),i=re.isArrayBufferView(t);if(r||i){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}re.DataBuffer=F5e;re.DataBuffer.prototype.length=function(){return this.write-this.read};re.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};re.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(r),this.data=new DataView(i.buffer),this};re.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};re.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};re.DataBuffer.prototype.putBytes=function(t,e){if(re.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=r.byteLength-r.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(r),this.write+=i,this}if(re.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof re.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&re.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var n=new Uint8Array(t.data.byteLength,this.write);return n.set(r),this.write+=r.byteLength,this}if(t instanceof re.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=re.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=re.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};re.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};re.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};re.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};re.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};re.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};re.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};re.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};re.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};re.DataBuffer.prototype.putInt=function(t,e){tg(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};re.DataBuffer.prototype.putSignedInt=function(t,e){return tg(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};re.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};re.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};re.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};re.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};re.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};re.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};re.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};re.DataBuffer.prototype.getInt=function(t){tg(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};re.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};re.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};re.DataBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};re.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};re.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};re.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};re.DataBuffer.prototype.copy=function(){return new re.DataBuffer(this)};re.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};re.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};re.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};re.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};re.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return re.binary.raw.encode(e);if(t==="hex")return re.binary.hex.encode(e);if(t==="base64")return re.binary.base64.encode(e);if(t==="utf8")return re.text.utf8.decode(e);if(t==="utf16")return re.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};re.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=re.encodeUtf8(t)),new re.ByteBuffer(t)};re.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};re.xorBytes=function(t,e,r){for(var i="",n="",s="",o=0,a=0;r>0;--r,++o)n=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(i+=s,s="",a=0),s+=String.fromCharCode(n),++a;return i+=s,i};re.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};re.bytesToHex=function(t){return re.createBuffer(t).toHex()};re.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Ru="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Pu=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],hN="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";re.encode64=function(t,e){for(var r="",i="",n,s,o,a=0;a<t.length;)n=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=Ru.charAt(n>>2),r+=Ru.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Ru.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Ru.charAt(o&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};re.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,i,n,s,o=0;o<t.length;)r=Pu[t.charCodeAt(o++)-43],i=Pu[t.charCodeAt(o++)-43],n=Pu[t.charCodeAt(o++)-43],s=Pu[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};re.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};re.decodeUtf8=function(t){return decodeURIComponent(escape(t))};re.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:fN.encode,decode:fN.decode}};re.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};re.binary.raw.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};re.binary.hex.encode=re.bytesToHex;re.binary.hex.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var n=0,s=r;for(t.length&1&&(n=1,i[s++]=parseInt(t[0],16));n<t.length;n+=2)i[s++]=parseInt(t.substr(n,2),16);return e?s-r:i};re.binary.base64.encode=function(t,e){for(var r="",i="",n,s,o,a=0;a<t.byteLength;)n=t[a++],s=t[a++],o=t[a++],r+=Ru.charAt(n>>2),r+=Ru.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Ru.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Ru.charAt(o&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};re.binary.base64.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var n,s,o,a,c=0,l=r;c<t.length;)n=Pu[t.charCodeAt(c++)-43],s=Pu[t.charCodeAt(c++)-43],o=Pu[t.charCodeAt(c++)-43],a=Pu[t.charCodeAt(c++)-43],i[l++]=n<<2|s>>4,o!==64&&(i[l++]=(s&15)<<4|o>>2,a!==64&&(i[l++]=(o&3)<<6|a));return e?l-r:i.subarray(0,l)};re.binary.base58.encode=function(t,e){return re.binary.baseN.encode(t,hN,e)};re.binary.base58.decode=function(t,e){return re.binary.baseN.decode(t,hN,e)};re.text={utf8:{},utf16:{}};re.text.utf8.encode=function(t,e,r){t=re.encodeUtf8(t);var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};re.text.utf8.decode=function(t){return re.decodeUtf8(String.fromCharCode.apply(null,t))};re.text.utf16.encode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length*2));var n=new Uint16Array(i.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)n[o++]=t.charCodeAt(a),s+=2;return e?s-r:i};re.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};re.deflate=function(t,e,r){if(e=re.decode64(t.deflate(re.encode64(e)).rval),r){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};re.inflate=function(t,e,r){var i=t.inflate(re.encode64(e)).rval;return i===null?null:re.decode64(i)};var ax=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var i;if(r===null?i=t.removeItem(e):(r=re.encode64(JSON.stringify(r)),i=t.setItem(e,r)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},cx=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(re.decode64(r))),r},K5e=function(t,e,r,i){var n=cx(t,e);n===null&&(n={}),n[r]=i,ax(t,e,n)},j5e=function(t,e,r){var i=cx(t,e);return i!==null&&(i=r in i?i[r]:null),i},V5e=function(t,e,r){var i=cx(t,e);if(i!==null&&r in i){delete i[r];var n=!0;for(var s in i){n=!1;break}n&&(i=null),ax(t,e,i)}},z5e=function(t,e){ax(t,e,null)},gv=function(t,e,r){var i=null;typeof r=="undefined"&&(r=["web","flash"]);var n,s=!1,o=null;for(var a in r){n=r[a];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=t.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=t.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return i};re.setItem=function(t,e,r,i,n){gv(K5e,arguments,n)};re.getItem=function(t,e,r,i){return gv(j5e,arguments,i)};re.removeItem=function(t,e,r,i){gv(V5e,arguments,i)};re.clearItems=function(t,e,r){gv(z5e,arguments,r)};re.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var r=e.exec(t),i=r===null?null:{full:t,scheme:r[1],host:r[2],port:r[3],path:r[4]};return i&&(i.fullHost=i.host,i.port?(i.port!==80&&i.scheme==="http"||i.port!==443&&i.scheme==="https")&&(i.fullHost+=":"+i.port):i.scheme==="http"?i.port=80:i.scheme==="https"&&(i.port=443),i.full=i.scheme+"://"+i.fullHost),i};var bv=null;re.getQueryVariables=function(t){var e=function(i){for(var n={},s=i.split("&"),o=0;o<s.length;o++){var a=s[o].indexOf("="),c,l;a>0?(c=s[o].substring(0,a),l=s[o].substring(a+1)):(c=s[o],l=null),c in n||(n[c]=[]),!(c in Object.prototype)&&l!==null&&n[c].push(unescape(l))}return n},r;return typeof t=="undefined"?(bv===null&&(typeof window!="undefined"&&window.location&&window.location.search?bv=e(window.location.search.substring(1)):bv={}),r=bv):r=e(t),r};re.parseFragment=function(t){var e=t,r="",i=t.indexOf("?");i>0&&(e=t.substring(0,i),r=t.substring(i+1));var n=e.split("/");n.length>0&&n[0]===""&&n.shift();var s=r===""?{}:re.getQueryVariables(r);return{pathString:e,queryString:r,path:n,query:s}};re.makeRequest=function(t){var e=re.parseFragment(t),r={path:e.pathString,query:e.queryString,getPath:function(i){return typeof i=="undefined"?e.path:e.path[i]},getQuery:function(i,n){var s;return typeof i=="undefined"?s=e.query:(s=e.query[i],s&&typeof n!="undefined"&&(s=s[n])),s},getQueryLast:function(i,n){var s,o=r.getQuery(i);return o?s=o[o.length-1]:s=n,s}};return r};re.makeLink=function(t,e,r){t=jQuery.isArray(t)?t.join("/"):t;var i=jQuery.param(e||{});return r=r||"",t+(i.length>0?"?"+i:"")+(r.length>0?"#"+r:"")};re.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};re.format=function(t){for(var e=/%./g,r,i,n=0,s=[],o=0;r=e.exec(t);){i=t.substring(o,e.lastIndex-2),i.length>0&&s.push(i),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};re.formatNumber=function(t,e,r,i){var n=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=i===void 0?".":i,c=n<0?"-":"",l=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",u=l.length>3?l.length%3:0;return c+(u?l.substr(0,u)+a:"")+l.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(n-l).toFixed(s).slice(2):"")};re.formatSize=function(t){return t>=1073741824?t=re.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=re.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=re.formatNumber(t/1024,0)+" KiB":t=re.formatNumber(t,0)+" bytes",t};re.bytesFromIP=function(t){return t.indexOf(".")!==-1?re.bytesFromIPv4(t):t.indexOf(":")!==-1?re.bytesFromIPv6(t):null};re.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=re.createBuffer(),r=0;r<t.length;++r){var i=parseInt(t[r],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};re.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,i=re.createBuffer(),n=0;n<8;++n){if(!t[n]||t[n].length===0){i.fillWithByte(0,r),r=0;continue}var s=re.hexToBytes(t[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};re.bytesToIP=function(t){return t.length===4?re.bytesToIPv4(t):t.length===16?re.bytesToIPv6(t):null};re.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};re.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],i=0,n=0;n<t.length;n+=2){for(var s=re.bytesToHex(t[n]+t[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[i].end-r[i].start&&(i=r.length-1))}e.push(s)}if(r.length>0){var c=r[i];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};re.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in re&&!t.update)return e(null,re.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return re.cores=navigator.hardwareConcurrency,e(null,re.cores);if(typeof Worker=="undefined")return re.cores=1,e(null,re.cores);if(typeof Blob=="undefined")return re.cores=2,e(null,re.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(o,a,c){if(a===0){var l=Math.floor(o.reduce(function(u,h){return u+h},0)/o.length);return re.cores=Math.max(1,l),URL.revokeObjectURL(r),e(null,re.cores)}n(c,function(u,h){o.push(s(c,h)),i(o,a-1,c)})}function n(o,a){for(var c=[],l=[],u=0;u<o;++u){var h=new Worker(r);h.addEventListener("message",function(d){if(l.push(d.data),l.length===o){for(var y=0;y<o;++y)c[y].terminate();a(null,l)}}),c.push(h)}for(var u=0;u<o;++u)c[u].postMessage(u)}function s(o,a){for(var c=[],l=0;l<o;++l)for(var u=a[l],h=c[l]=[],d=0;d<o;++d)if(l!==d){var y=a[d];(u.st>y.st&&u.st<y.et||y.st>u.st&&y.st<u.et)&&h.push(d)}return c.reduce(function(g,m){return Math.max(g,m.length)},0)}}});var sd=p((Dxt,pN)=>{f();var rg=lt();rg.pki=rg.pki||{};var ux=pN.exports=rg.pki.oids=rg.oids=rg.oids||{};function xe(t,e){ux[t]=e,ux[e]=t}function jt(t,e){ux[t]=e}xe("1.2.840.113549.1.1.1","rsaEncryption");xe("1.2.840.113549.1.1.4","md5WithRSAEncryption");xe("1.2.840.113549.1.1.5","sha1WithRSAEncryption");xe("1.2.840.113549.1.1.7","RSAES-OAEP");xe("1.2.840.113549.1.1.8","mgf1");xe("1.2.840.113549.1.1.9","pSpecified");xe("1.2.840.113549.1.1.10","RSASSA-PSS");xe("1.2.840.113549.1.1.11","sha256WithRSAEncryption");xe("1.2.840.113549.1.1.12","sha384WithRSAEncryption");xe("1.2.840.113549.1.1.13","sha512WithRSAEncryption");xe("1.3.101.112","EdDSA25519");xe("1.2.840.10040.4.3","dsa-with-sha1");xe("1.3.14.3.2.7","desCBC");xe("1.3.14.3.2.26","sha1");xe("2.16.840.1.101.3.4.2.1","sha256");xe("2.16.840.1.101.3.4.2.2","sha384");xe("2.16.840.1.101.3.4.2.3","sha512");xe("1.2.840.113549.2.5","md5");xe("1.2.840.113549.1.7.1","data");xe("1.2.840.113549.1.7.2","signedData");xe("1.2.840.113549.1.7.3","envelopedData");xe("1.2.840.113549.1.7.4","signedAndEnvelopedData");xe("1.2.840.113549.1.7.5","digestedData");xe("1.2.840.113549.1.7.6","encryptedData");xe("1.2.840.113549.1.9.1","emailAddress");xe("1.2.840.113549.1.9.2","unstructuredName");xe("1.2.840.113549.1.9.3","contentType");xe("1.2.840.113549.1.9.4","messageDigest");xe("1.2.840.113549.1.9.5","signingTime");xe("1.2.840.113549.1.9.6","counterSignature");xe("1.2.840.113549.1.9.7","challengePassword");xe("1.2.840.113549.1.9.8","unstructuredAddress");xe("1.2.840.113549.1.9.14","extensionRequest");xe("1.2.840.113549.1.9.20","friendlyName");xe("1.2.840.113549.1.9.21","localKeyId");xe("1.2.840.113549.1.9.22.1","x509Certificate");xe("1.2.840.113549.1.12.10.1.1","keyBag");xe("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");xe("1.2.840.113549.1.12.10.1.3","certBag");xe("1.2.840.113549.1.12.10.1.4","crlBag");xe("1.2.840.113549.1.12.10.1.5","secretBag");xe("1.2.840.113549.1.12.10.1.6","safeContentsBag");xe("1.2.840.113549.1.5.13","pkcs5PBES2");xe("1.2.840.113549.1.5.12","pkcs5PBKDF2");xe("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");xe("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");xe("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");xe("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");xe("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");xe("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");xe("1.2.840.113549.2.7","hmacWithSHA1");xe("1.2.840.113549.2.8","hmacWithSHA224");xe("1.2.840.113549.2.9","hmacWithSHA256");xe("1.2.840.113549.2.10","hmacWithSHA384");xe("1.2.840.113549.2.11","hmacWithSHA512");xe("1.2.840.113549.3.7","des-EDE3-CBC");xe("2.16.840.1.101.3.4.1.2","aes128-CBC");xe("2.16.840.1.101.3.4.1.22","aes192-CBC");xe("2.16.840.1.101.3.4.1.42","aes256-CBC");xe("2.5.4.3","commonName");xe("2.5.4.5","serialName");xe("2.5.4.6","countryName");xe("2.5.4.7","localityName");xe("2.5.4.8","stateOrProvinceName");xe("2.5.4.9","streetAddress");xe("2.5.4.10","organizationName");xe("2.5.4.11","organizationalUnitName");xe("2.5.4.13","description");xe("2.5.4.15","businessCategory");xe("2.5.4.17","postalCode");xe("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");xe("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");xe("2.16.840.1.113730.1.1","nsCertType");xe("2.16.840.1.113730.1.13","nsComment");jt("2.5.29.1","authorityKeyIdentifier");jt("2.5.29.2","keyAttributes");jt("2.5.29.3","certificatePolicies");jt("2.5.29.4","keyUsageRestriction");jt("2.5.29.5","policyMapping");jt("2.5.29.6","subtreesConstraint");jt("2.5.29.7","subjectAltName");jt("2.5.29.8","issuerAltName");jt("2.5.29.9","subjectDirectoryAttributes");jt("2.5.29.10","basicConstraints");jt("2.5.29.11","nameConstraints");jt("2.5.29.12","policyConstraints");jt("2.5.29.13","basicConstraints");xe("2.5.29.14","subjectKeyIdentifier");xe("2.5.29.15","keyUsage");jt("2.5.29.16","privateKeyUsagePeriod");xe("2.5.29.17","subjectAltName");xe("2.5.29.18","issuerAltName");xe("2.5.29.19","basicConstraints");jt("2.5.29.20","cRLNumber");jt("2.5.29.21","cRLReason");jt("2.5.29.22","expirationDate");jt("2.5.29.23","instructionCode");jt("2.5.29.24","invalidityDate");jt("2.5.29.25","cRLDistributionPoints");jt("2.5.29.26","issuingDistributionPoint");jt("2.5.29.27","deltaCRLIndicator");jt("2.5.29.28","issuingDistributionPoint");jt("2.5.29.29","certificateIssuer");jt("2.5.29.30","nameConstraints");xe("2.5.29.31","cRLDistributionPoints");xe("2.5.29.32","certificatePolicies");jt("2.5.29.33","policyMappings");jt("2.5.29.34","policyConstraints");xe("2.5.29.35","authorityKeyIdentifier");jt("2.5.29.36","policyConstraints");xe("2.5.29.37","extKeyUsage");jt("2.5.29.46","freshestCRL");jt("2.5.29.54","inhibitAnyPolicy");xe("1.3.6.1.4.1.11129.2.4.2","timestampList");xe("1.3.6.1.5.5.7.1.1","authorityInfoAccess");xe("1.3.6.1.5.5.7.3.1","serverAuth");xe("1.3.6.1.5.5.7.3.2","clientAuth");xe("1.3.6.1.5.5.7.3.3","codeSigning");xe("1.3.6.1.5.5.7.3.4","emailProtection");xe("1.3.6.1.5.5.7.3.8","timeStamping")});var Ac=p((Mxt,gN)=>{f();var _r=lt();Wt();sd();var De=gN.exports=_r.asn1=_r.asn1||{};De.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};De.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};De.create=function(t,e,r,i,n){if(_r.util.isArray(i)){for(var s=[],o=0;o<i.length;++o)i[o]!==void 0&&s.push(i[o]);i=s}var a={tagClass:t,type:e,constructed:r,composed:r||_r.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(a.bitStringContents=n.bitStringContents,a.original=De.copy(a)),a};De.copy=function(t,e){var r;if(_r.util.isArray(t)){r=[];for(var i=0;i<t.length;++i)r.push(De.copy(t[i],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:De.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};De.equals=function(t,e,r){if(_r.util.isArray(t)){if(!_r.util.isArray(e)||t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!De.equals(t[i],e[i]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var n=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&De.equals(t.value,e.value);return r&&r.includeBitStringContents&&(n=n&&t.bitStringContents===e.bitStringContents),n};De.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,i=e&128;return i?r=t.getInt((e&127)<<3):r=e,r}};function ig(t,e,r){if(r>e){var i=new Error("Too few bytes to parse DER.");throw i.available=t.length(),i.remaining=e,i.requested=r,i}}var H5e=function(t,e){var r=t.getByte();if(e--,r!==128){var i,n=r&128;if(!n)i=r;else{var s=r&127;ig(t,e,s),i=t.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};De.fromDer=function(t,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=_r.util.createBuffer(t)),mv(t,t.length(),0,e)};function mv(t,e,r,i){var n;ig(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;n=t.length();var c=H5e(t,e);if(e-=n-t.length(),c!==void 0&&c>e){if(i.strict){var l=new Error("Too few bytes to read ASN.1 value.");throw l.available=t.length(),l.remaining=e,l.requested=c,l}c=e}var u,h,d=(s&32)==32;if(d)if(u=[],c===void 0)for(;;){if(ig(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}n=t.length(),u.push(mv(t,e,r+1,i)),e-=n-t.length()}else for(;c>0;)n=t.length(),u.push(mv(t,c,r+1,i)),e-=n-t.length(),c-=n-t.length();if(u===void 0&&o===De.Class.UNIVERSAL&&a===De.Type.BITSTRING&&(h=t.bytes(c)),u===void 0&&i.decodeBitStrings&&o===De.Class.UNIVERSAL&&a===De.Type.BITSTRING&&c>1){var y=t.read,g=e,m=0;if(a===De.Type.BITSTRING&&(ig(t,e,1),m=t.getByte(),e--),m===0)try{n=t.length();var E={verbose:i.verbose,strict:!0,decodeBitStrings:!0},v=mv(t,e,r+1,E),A=n-t.length();e-=A,a==De.Type.BITSTRING&&A++;var R=v.tagClass;A===c&&(R===De.Class.UNIVERSAL||R===De.Class.CONTEXT_SPECIFIC)&&(u=[v])}catch(q){}u===void 0&&(t.read=y,e=g)}if(u===void 0){if(c===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===De.Type.BMPSTRING)for(u="";c>0;c-=2)ig(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(c)}var F=h===void 0?null:{bitStringContents:h};return De.create(o,a,d,u,F)}De.toDer=function(t){var e=_r.util.createBuffer(),r=t.tagClass|t.type,i=_r.util.createBuffer(),n=!1;if("bitStringContents"in t&&(n=!0,t.original&&(n=De.equals(t,t.original))),n)i.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:i.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&i.putBuffer(De.toDer(t.value[s]))}else if(t.type===De.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)i.putInt16(t.value.charCodeAt(s));else t.type===De.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)==0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)==128)?i.putBytes(t.value.substr(1)):i.putBytes(t.value);if(e.putByte(r),i.length()<=127)e.putByte(i.length()&127);else{var o=i.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(i),e};De.oidToDer=function(t){var e=t.split("."),r=_r.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,o,a=2;a<e.length;++a){i=!0,n=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,i||(o|=128),n.push(o),i=!1;while(s>0);for(var c=n.length-1;c>=0;--c)r.putByte(n[c])}return r};De.derToOid=function(t){var e;typeof t=="string"&&(t=_r.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var i=0;t.length()>0;)r=t.getByte(),i=i<<7,r&128?i+=r&127:(e+="."+(i+r),i=0);return e};De.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var i=parseInt(t.substr(2,2),10)-1,n=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),l=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),l+=2)}if(e.setUTCFullYear(r,i,n),e.setUTCHours(s,o,a,0),l&&(c=t.charAt(l),c==="+"||c==="-")){var u=parseInt(t.substr(l+1,2),10),h=parseInt(t.substr(l+4,2),10),d=u*60+h;d*=6e4,c==="+"?e.setTime(+e-d):e.setTime(+e+d)}return e};De.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),i=parseInt(t.substr(4,2),10)-1,n=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,l=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,d=t.charAt(h);if(d==="+"||d==="-"){var y=parseInt(t.substr(h+1,2),10),g=parseInt(t.substr(h+4,2),10);l=y*60+g,l*=6e4,d==="+"&&(l*=-1),u=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,i,n),e.setUTCHours(s,o,a,c),e.setTime(+e+l)):(e.setFullYear(r,i,n),e.setHours(s,o,a,c)),e};De.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};De.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};De.integerToDer=function(t){var e=_r.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};De.derToInteger=function(t){typeof t=="string"&&(t=_r.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};De.validate=function(t,e,r,i){var n=!1;if((t.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(t.type===e.type||typeof e.type=="undefined"))if(t.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&_r.util.isArray(e.value))for(var s=0,o=0;n&&o<e.value.length;++o)n=e.value[o].optional||!1,t.value[s]&&(n=De.validate(t.value[s],e.value[o],r,i),n?++s:e.value[o].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(n&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else i&&(t.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return n};var yN=/[^\\u0000-\\u00ff]/;De.prettyPrint=function(t,e,r){var i="";e=e||0,r=r||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*r;++s)n+=" ";switch(i+=n+"Tag: ",t.tagClass){case De.Class.UNIVERSAL:i+="Universal:";break;case De.Class.APPLICATION:i+="Application:";break;case De.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case De.Class.PRIVATE:i+="Private:";break}if(t.tagClass===De.Class.UNIVERSAL)switch(i+=t.type,t.type){case De.Type.NONE:i+=" (None)";break;case De.Type.BOOLEAN:i+=" (Boolean)";break;case De.Type.INTEGER:i+=" (Integer)";break;case De.Type.BITSTRING:i+=" (Bit string)";break;case De.Type.OCTETSTRING:i+=" (Octet string)";break;case De.Type.NULL:i+=" (Null)";break;case De.Type.OID:i+=" (Object Identifier)";break;case De.Type.ODESC:i+=" (Object Descriptor)";break;case De.Type.EXTERNAL:i+=" (External or Instance of)";break;case De.Type.REAL:i+=" (Real)";break;case De.Type.ENUMERATED:i+=" (Enumerated)";break;case De.Type.EMBEDDED:i+=" (Embedded PDV)";break;case De.Type.UTF8:i+=" (UTF8)";break;case De.Type.ROID:i+=" (Relative Object Identifier)";break;case De.Type.SEQUENCE:i+=" (Sequence)";break;case De.Type.SET:i+=" (Set)";break;case De.Type.PRINTABLESTRING:i+=" (Printable String)";break;case De.Type.IA5String:i+=" (IA5String (ASCII))";break;case De.Type.UTCTIME:i+=" (UTC time)";break;case De.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case De.Type.BMPSTRING:i+=" (BMP String)";break}else i+=t.type;if(i+=`
`,i+=n+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=De.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));i+=n+"Sub values: "+o+a}else{if(i+=n+"Value: ",t.type===De.Type.OID){var c=De.derToOid(t.value);i+=c,_r.pki&&_r.pki.oids&&c in _r.pki.oids&&(i+=" ("+_r.pki.oids[c]+") ")}if(t.type===De.Type.INTEGER)try{i+=De.derToInteger(t.value)}catch(u){i+="0x"+_r.util.bytesToHex(t.value)}else if(t.type===De.Type.BITSTRING){if(t.value.length>1?i+="0x"+_r.util.bytesToHex(t.value.slice(1)):i+="(none)",t.value.length>0){var l=t.value.charCodeAt(0);l==1?i+=" (1 unused bit shown)":l>1&&(i+=" ("+l+" unused bits shown)")}}else t.type===De.Type.OCTETSTRING?(yN.test(t.value)||(i+="("+t.value+") "),i+="0x"+_r.util.bytesToHex(t.value)):t.type===De.Type.UTF8?i+=_r.util.decodeUtf8(t.value):t.type===De.Type.PRINTABLESTRING||t.type===De.Type.IA5String?i+=t.value:yN.test(t.value)?i+="0x"+_r.util.bytesToHex(t.value):t.value.length===0?i+="[null]":i+=t.value}return i}});var fx=p((Lxt,bN)=>{f();var Ni=lt();Wt();bN.exports=Ni.cipher=Ni.cipher||{};Ni.cipher.algorithms=Ni.cipher.algorithms||{};Ni.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ni.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ni.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Ni.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ni.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ni.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Ni.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Ni.cipher.algorithms[t]=e};Ni.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Ni.cipher.algorithms?Ni.cipher.algorithms[t]:null};var lx=Ni.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};lx.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Ni.util.createBuffer(),this.output=t.output||Ni.util.createBuffer(),this.mode.start(e)};lx.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};lx.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var dx=p((Uxt,mN)=>{f();var Di=lt();Wt();Di.cipher=Di.cipher||{};var bt=mN.exports=Di.cipher.modes=Di.cipher.modes||{};bt.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};bt.ecb.prototype.start=function(t){};bt.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};bt.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};bt.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};bt.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};bt.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};bt.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=vv(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};bt.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};bt.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};bt.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};bt.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};bt.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Di.util.createBuffer(),this._partialBytes=0};bt.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=vv(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};bt.cfb.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};bt.cfb.prototype.decrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};bt.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Di.util.createBuffer(),this._partialBytes=0};bt.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=vv(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};bt.ofb.prototype.encrypt=function(t,e,r){var i=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};bt.ofb.prototype.decrypt=bt.ofb.prototype.encrypt;bt.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Di.util.createBuffer(),this._partialBytes=0};bt.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=vv(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};bt.ctr.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}wv(this._inBlock)};bt.ctr.prototype.decrypt=bt.ctr.prototype.encrypt;bt.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Di.util.createBuffer(),this._partialBytes=0,this._R=3774873600};bt.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Di.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Di.util.createBuffer(t.additionalData):r=Di.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Di.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(hx(i*8)))}this._inBlock=this._j0.slice(0),wv(this._inBlock),this._partialBytes=0,r=Di.util.createBuffer(r),this._aDataLength=hx(r.length()*8);var n=r.length()%this.blockSize;for(n&&r.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};bt.gcm.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s<=0||r){if(r){var o=i%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),wv(this._inBlock)};bt.gcm.prototype.decrypt=function(t,e,r){var i=t.length();if(i<this.blockSize&&!(r&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),wv(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};bt.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Di.util.createBuffer();var i=this._aDataLength.concat(hx(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};bt.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=t[n/32|0]&1<<31-n%32;s&&(r[0]^=i[0],r[1]^=i[1],r[2]^=i[2],r[3]^=i[3]),this.pow(i,i)}return r};bt.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,i=3;i>0;--i)e[i]=t[i]>>>1|(t[i-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};bt.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var i=r/8|0,n=t[i]>>>(7-r%8)*4&15,s=this._m[r][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};bt.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};bt.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,i=4*r,n=16*r,s=new Array(n),o=0;o<n;++o){var a=[0,0,0,0],c=o/i|0,l=(i-1-o%i)*e;a[c]=1<<e-1<<l,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};bt.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,i=r>>>1,n=new Array(r);n[i]=t.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var o=1;o<s;++o){var a=n[s],c=n[o];n[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<r;++s){var l=n[s^i];n[s]=[t[0]^l[0],t[1]^l[1],t[2]^l[2],t[3]^l[3]]}return n};function vv(t,e){if(typeof t=="string"&&(t=Di.util.createBuffer(t)),Di.util.isArray(t)&&t.length>4){var r=t;t=Di.util.createBuffer();for(var i=0;i<r.length;++i)t.putByte(r[i])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Di.util.isArray(t)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(t.getInt32());t=n}return t}function wv(t){t[t.length-1]=t[t.length-1]+1&4294967295}function hx(t){return[t/4294967296|0,t&4294967295]}});var cd=p((Fxt,EN)=>{f();var rr=lt();fx();dx();Wt();EN.exports=rr.aes=rr.aes||{};rr.aes.startEncrypting=function(t,e,r,i){var n=_v({key:t,output:r,decrypt:!1,mode:i});return n.start(e),n};rr.aes.createEncryptionCipher=function(t,e){return _v({key:t,output:null,decrypt:!1,mode:e})};rr.aes.startDecrypting=function(t,e,r,i){var n=_v({key:t,output:r,decrypt:!0,mode:i});return n.start(e),n};rr.aes.createDecryptionCipher=function(t,e){return _v({key:t,output:null,decrypt:!0,mode:e})};rr.aes.Algorithm=function(t,e){px||wN();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return gx(r._w,i,n,!1)},decrypt:function(i,n){return gx(r._w,i,n,!0)}}}),r._init=!1};rr.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=rr.util.createBuffer(e);else if(rr.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=rr.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(!rr.util.isArray(e)){r=e,e=[];var n=r.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(r.getInt32())}}if(!rr.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=_N(e,t.decrypt&&!o),this._init=!0}};rr.aes._expandKey=function(t,e){return px||wN(),_N(t,e)};rr.aes._updateBlock=gx;od("AES-ECB",rr.cipher.modes.ecb);od("AES-CBC",rr.cipher.modes.cbc);od("AES-CFB",rr.cipher.modes.cfb);od("AES-OFB",rr.cipher.modes.ofb);od("AES-CTR",rr.cipher.modes.ctr);od("AES-GCM",rr.cipher.modes.gcm);function od(t,e){var r=function(){return new rr.aes.Algorithm(t,e)};rr.cipher.registerAlgorithm(t,r)}var px=!1,ad=4,In,yx,vN,of,bo;function wN(){px=!0,vN=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;In=new Array(256),yx=new Array(256),of=new Array(4),bo=new Array(4);for(var e=0;e<4;++e)of[e]=new Array(256),bo[e]=new Array(256);for(var r=0,i=0,n,s,o,a,c,l,u,e=0;e<256;++e){a=i^i<<1^i<<2^i<<3^i<<4,a=a>>8^a&255^99,In[r]=a,yx[a]=r,c=t[a],n=t[r],s=t[n],o=t[s],l=c<<24^a<<16^a<<8^(a^c),u=(n^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^n^o);for(var h=0;h<4;++h)of[h][r]=l,bo[h][a]=u,l=l<<24|l>>>8,u=u<<24|u>>>8;r===0?r=i=1:(r=n^t[t[t[n^o]]],i^=t[t[i]])}}function _N(t,e){for(var r=t.slice(0),i,n=1,s=r.length,o=s+6+1,a=ad*o,c=s;c<a;++c)i=r[c-1],c%s==0?(i=In[i>>>16&255]<<24^In[i>>>8&255]<<16^In[i&255]<<8^In[i>>>24]^vN[n]<<24,n++):s>6&&c%s==4&&(i=In[i>>>24]<<24^In[i>>>16&255]<<16^In[i>>>8&255]<<8^In[i&255]),r[c]=r[c-s]^i;if(e){var l,u=bo[0],h=bo[1],d=bo[2],y=bo[3],g=r.slice(0);a=r.length;for(var c=0,m=a-ad;c<a;c+=ad,m-=ad)if(c===0||c===a-ad)g[c]=r[m],g[c+1]=r[m+3],g[c+2]=r[m+2],g[c+3]=r[m+1];else for(var E=0;E<ad;++E)l=r[m+E],g[c+(3&-E)]=u[In[l>>>24]]^h[In[l>>>16&255]]^d[In[l>>>8&255]]^y[In[l&255]];r=g}return r}function gx(t,e,r,i){var n=t.length/4-1,s,o,a,c,l;i?(s=bo[0],o=bo[1],a=bo[2],c=bo[3],l=yx):(s=of[0],o=of[1],a=of[2],c=of[3],l=In);var u,h,d,y,g,m,E;u=e[0]^t[0],h=e[i?3:1]^t[1],d=e[2]^t[2],y=e[i?1:3]^t[3];for(var v=3,A=1;A<n;++A)g=s[u>>>24]^o[h>>>16&255]^a[d>>>8&255]^c[y&255]^t[++v],m=s[h>>>24]^o[d>>>16&255]^a[y>>>8&255]^c[u&255]^t[++v],E=s[d>>>24]^o[y>>>16&255]^a[u>>>8&255]^c[h&255]^t[++v],y=s[y>>>24]^o[u>>>16&255]^a[h>>>8&255]^c[d&255]^t[++v],u=g,h=m,d=E;r[0]=l[u>>>24]<<24^l[h>>>16&255]<<16^l[d>>>8&255]<<8^l[y&255]^t[++v],r[i?3:1]=l[h>>>24]<<24^l[d>>>16&255]<<16^l[y>>>8&255]<<8^l[u&255]^t[++v],r[2]=l[d>>>24]<<24^l[y>>>16&255]<<16^l[u>>>8&255]<<8^l[h&255]^t[++v],r[i?1:3]=l[y>>>24]<<24^l[u>>>16&255]<<16^l[h>>>8&255]<<8^l[d&255]^t[++v]}function _v(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,i;t.decrypt?i=rr.cipher.createDecipher(r,t.key):i=rr.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof rr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var Sv=p((Kxt,xN)=>{f();var Er=lt();fx();dx();Wt();xN.exports=Er.des=Er.des||{};Er.des.startEncrypting=function(t,e,r,i){var n=Ev({key:t,output:r,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};Er.des.createEncryptionCipher=function(t,e){return Ev({key:t,output:null,decrypt:!1,mode:e})};Er.des.startDecrypting=function(t,e,r,i){var n=Ev({key:t,output:r,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};Er.des.createDecryptionCipher=function(t,e){return Ev({key:t,output:null,decrypt:!0,mode:e})};Er.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return SN(r._keys,i,n,!1)},decrypt:function(i,n){return SN(r._keys,i,n,!0)}}}),r._init=!1};Er.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=Er.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=eTe(e),this._init=!0}};ga("DES-ECB",Er.cipher.modes.ecb);ga("DES-CBC",Er.cipher.modes.cbc);ga("DES-CFB",Er.cipher.modes.cfb);ga("DES-OFB",Er.cipher.modes.ofb);ga("DES-CTR",Er.cipher.modes.ctr);ga("3DES-ECB",Er.cipher.modes.ecb);ga("3DES-CBC",Er.cipher.modes.cbc);ga("3DES-CFB",Er.cipher.modes.cfb);ga("3DES-OFB",Er.cipher.modes.ofb);ga("3DES-CTR",Er.cipher.modes.ctr);function ga(t,e){var r=function(){return new Er.des.Algorithm(t,e)};Er.cipher.registerAlgorithm(t,r)}var $5e=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],G5e=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],W5e=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Y5e=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],X5e=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Q5e=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Z5e=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],J5e=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function eTe(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=t.length()>8?3:1,E=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],A=0,R,F=0;F<m;F++){var q=t.getInt32(),B=t.getInt32();R=(q>>>4^B)&252645135,B^=R,q^=R<<4,R=(B>>>-16^q)&65535,q^=R,B^=R<<-16,R=(q>>>2^B)&858993459,B^=R,q^=R<<2,R=(B>>>-16^q)&65535,q^=R,B^=R<<-16,R=(q>>>1^B)&1431655765,B^=R,q^=R<<1,R=(B>>>8^q)&16711935,q^=R,B^=R<<8,R=(q>>>1^B)&1431655765,B^=R,q^=R<<1,R=q<<8|B>>>20&240,q=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=R;for(var z=0;z<v.length;++z){v[z]?(q=q<<2|q>>>26,B=B<<2|B>>>26):(q=q<<1|q>>>27,B=B<<1|B>>>27),q&=-15,B&=-15;var G=e[q>>>28]|r[q>>>24&15]|i[q>>>20&15]|n[q>>>16&15]|s[q>>>12&15]|o[q>>>8&15]|a[q>>>4&15],Y=c[B>>>28]|l[B>>>24&15]|u[B>>>20&15]|h[B>>>16&15]|d[B>>>12&15]|y[B>>>8&15]|g[B>>>4&15];R=(Y>>>16^G)&65535,E[A++]=G^R,E[A++]=Y^R<<16}}return E}function SN(t,e,r,i){var n=t.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var l=0;l<n;l+=3){for(var u=s[l+1],h=s[l+2],d=s[l];d!=u;d+=h){var y=c^t[d],g=(c>>>4|c<<28)^t[d+1];o=a,a=c,c=o^(G5e[y>>>24&63]|Y5e[y>>>16&63]|Q5e[y>>>8&63]|J5e[y&63]|$5e[g>>>24&63]|W5e[g>>>16&63]|X5e[g>>>8&63]|Z5e[g&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function Ev(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,i;t.decrypt?i=Er.cipher.createDecipher(r,t.key):i=Er.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof Er.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var Cu=p((jxt,AN)=>{f();var xv=lt();AN.exports=xv.md=xv.md||{};xv.md.algorithms=xv.md.algorithms||{}});var TN=p((Vxt,IN)=>{f();var Ic=lt();Cu();Wt();var tTe=IN.exports=Ic.hmac=Ic.hmac||{};tTe.create=function(){var t=null,e=null,r=null,i=null,n={};return n.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Ic.md.algorithms)e=Ic.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=Ic.util.createBuffer(o);else if(Ic.util.isArray(o)){var a=o;o=Ic.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var l=o.length();l>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=Ic.util.createBuffer(),i=Ic.util.createBuffer(),l=o.length();for(var c=0;c<l;++c){var a=o.at(c);r.putByte(54^a),i.putByte(92^a)}if(l<e.blockLength)for(var a=e.blockLength-l,c=0;c<a;++c)r.putByte(54),i.putByte(92);t=o,r=r.bytes(),i=i.bytes()}e.start(),e.update(r)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var ud=p(()=>{f()});var bx=p(($xt,RN)=>{f();var Tn=lt();TN();Cu();Wt();var rTe=Tn.pkcs5=Tn.pkcs5||{},Tc;Tn.util.isNodejs&&!Tn.options.usePureJavaScript&&(Tc=ud());RN.exports=Tn.pbkdf2=rTe.pbkdf2=function(t,e,r,i,n,s){if(typeof n=="function"&&(s=n,n=null),Tn.util.isNodejs&&!Tn.options.usePureJavaScript&&Tc.pbkdf2&&(n===null||typeof n!="object")&&(Tc.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?Tc.pbkdf2Sync.length===4?Tc.pbkdf2(t,e,r,i,function(R,F){if(R)return s(R);s(null,F.toString("binary"))}):Tc.pbkdf2(t,e,r,i,n,function(R,F){if(R)return s(R);s(null,F.toString("binary"))}):Tc.pbkdf2Sync.length===4?Tc.pbkdf2Sync(t,e,r,i).toString("binary"):Tc.pbkdf2Sync(t,e,r,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in Tn.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=Tn.md[n].create()}var o=n.digestLength;if(i>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(i/o),l=i-(c-1)*o,u=Tn.hmac.create();u.start(n,t);var h="",d,y,g;if(!s){for(var m=1;m<=c;++m){u.start(null,null),u.update(e),u.update(Tn.util.int32ToBytes(m)),d=g=u.digest().getBytes();for(var E=2;E<=r;++E)u.start(null,null),u.update(g),y=u.digest().getBytes(),d=Tn.util.xorBytes(d,y,o),g=y;h+=m<c?d:d.substr(0,l)}return h}var m=1,E;function v(){if(m>c)return s(null,h);u.start(null,null),u.update(e),u.update(Tn.util.int32ToBytes(m)),d=g=u.digest().getBytes(),E=2,A()}function A(){if(E<=r)return u.start(null,null),u.update(g),y=u.digest().getBytes(),d=Tn.util.xorBytes(d,y,o),g=y,++E,Tn.util.setImmediate(A);h+=m<c?d:d.substr(0,l),++m,v()}v()}});var Tv=p((Gxt,CN)=>{f();var Av=lt();Wt();var PN=CN.exports=Av.pem=Av.pem||{};PN.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,i;if(t.procType&&(i={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Iv(i)),t.contentDomain&&(i={name:"Content-Domain",values:[t.contentDomain]},r+=Iv(i)),t.dekInfo&&(i={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&i.values.push(t.dekInfo.parameters),r+=Iv(i)),t.headers)for(var n=0;n<t.headers.length;++n)r+=Iv(t.headers[n]);return t.procType&&(r+=`\r
`),r+=Av.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};PN.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=r.exec(t),!!s;){var o={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:Av.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var a=s[2].split(n),c=0;s&&c<a.length;){for(var l=a[c].replace(/\s+$/,""),u=c+1;u<a.length;++u){var h=a[u];if(!/\s/.test(h[0]))break;l+=h,c=u}if(s=l.match(i),s){for(var d={name:s[1],values:[]},y=s[2].split(","),g=0;g<y.length;++g)d.values.push(iTe(y[g]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=y[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:y[0],parameters:y[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:y[0],type:y[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Iv(t){for(var e=t.name+": ",r=[],i=function(c,l){return" "+l},n=0;n<t.values.length;++n)r.push(t.values[n].replace(/^(\S+\r\n)/,i));e+=r.join(",")+`\r
`;for(var s=0,o=-1,n=0;n<e.length;++n,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=n-o-1,o=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(o=n);return e}function iTe(t){return t.replace(/^\s+/,"")}});var DN=p((Wxt,NN)=>{f();var ba=lt();Cu();Wt();var ON=NN.exports=ba.sha256=ba.sha256||{};ba.md.sha256=ba.md.algorithms.sha256=ON;ON.create=function(){kN||nTe();var t=null,e=ba.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=ba.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=ba.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),BN(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=ba.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(mx.substr(0,i.blockLength-o));for(var a,c,l=i.fullMessageLength[0]*8,u=0;u<i.fullMessageLength.length-1;++u)a=i.fullMessageLength[u+1]*8,c=a/4294967296>>>0,l+=c,n.putInt32(l>>>0),l=a>>>0;n.putInt32(l);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};BN(h,r,n);var d=ba.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d.putInt32(h.h5),d.putInt32(h.h6),d.putInt32(h.h7),d},i};var mx=null,kN=!1,qN=null;function nTe(){mx=String.fromCharCode(128),mx+=ba.util.fillString(String.fromCharCode(0),64),qN=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],kN=!0}function BN(t,e,r){for(var i,n,s,o,a,c,l,u,h,d,y,g,m,E,v,A=r.length();A>=64;){for(l=0;l<16;++l)e[l]=r.getInt32();for(;l<64;++l)i=e[l-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[l-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[l]=i+e[l-7]+n+e[l-16]|0;for(u=t.h0,h=t.h1,d=t.h2,y=t.h3,g=t.h4,m=t.h5,E=t.h6,v=t.h7,l=0;l<64;++l)o=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),a=E^g&(m^E),s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),c=u&h|d&(u^h),i=v+o+a+qN[l]+e[l],n=s+c,v=E,E=m,m=g,g=y+i>>>0,y=d,d=h,h=u,u=i+n>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+d|0,t.h3=t.h3+y|0,t.h4=t.h4+g|0,t.h5=t.h5+m|0,t.h6=t.h6+E|0,t.h7=t.h7+v|0,A-=64}}});var LN=p((Yxt,MN)=>{f();var ma=lt();Wt();var Rv=null;ma.util.isNodejs&&!ma.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Rv=ud());var sTe=MN.exports=ma.prng=ma.prng||{};sTe.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,i=new Array(32),n=0;n<32;++n)i[n]=r.create();e.pools=i,e.pool=0,e.generate=function(l,u){if(!u)return e.generateSync(l);var h=e.plugin.cipher,d=e.plugin.increment,y=e.plugin.formatKey,g=e.plugin.formatSeed,m=ma.util.createBuffer();e.key=null,E();function E(v){if(v)return u(v);if(m.length()>=l)return u(null,m.getBytes(l));if(e.generated>1048575&&(e.key=null),e.key===null)return ma.util.nextTick(function(){s(E)});var A=h(e.key,e.seed);e.generated+=A.length,m.putBytes(A),e.key=y(h(e.key,d(e.seed))),e.seed=g(h(e.key,e.seed)),ma.util.setImmediate(E)}},e.generateSync=function(l){var u=e.plugin.cipher,h=e.plugin.increment,d=e.plugin.formatKey,y=e.plugin.formatSeed;e.key=null;for(var g=ma.util.createBuffer();g.length()<l;){e.generated>1048575&&(e.key=null),e.key===null&&o();var m=u(e.key,e.seed);e.generated+=m.length,g.putBytes(m),e.key=d(u(e.key,h(e.seed))),e.seed=y(u(e.key,e.seed))}return g.getBytes(l)};function s(l){if(e.pools[0].messageLength>=32)return a(),l();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,d){if(h)return l(h);e.collect(d),a(),l()})}function o(){if(e.pools[0].messageLength>=32)return a();var l=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(l)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var l=e.plugin.md.create();l.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u==0&&(l.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=l.digest().getBytes(),l.start(),l.update(e.keyBytes);var d=l.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(d),e.generated=0}function c(l){var u=null,h=ma.util.globalScope,d=h.crypto||h.msCrypto;d&&d.getRandomValues&&(u=function(q){return d.getRandomValues(q)});var y=ma.util.createBuffer();if(u)for(;y.length()<l;){var g=Math.max(1,Math.min(l-y.length(),65536)/4),m=new Uint32Array(Math.floor(g));try{u(m);for(var E=0;E<m.length;++E)y.putInt32(m[E])}catch(q){if(!(typeof QuotaExceededError!="undefined"&&q instanceof QuotaExceededError))throw q}}if(y.length()<l)for(var v,A,R,F=Math.floor(Math.random()*65536);y.length()<l;){A=16807*(F&65535),v=16807*(F>>16),A+=(v&32767)<<16,A+=v>>15,A=(A&2147483647)+(A>>31),F=A&4294967295;for(var E=0;E<3;++E)R=F>>>(E<<3),R^=Math.floor(Math.random()*256),y.putByte(String.fromCharCode(R&255))}return y.getBytes(l)}return Rv?(e.seedFile=function(l,u){Rv.randomBytes(l,function(h,d){if(h)return u(h);u(null,d.toString())})},e.seedFileSync=function(l){return Rv.randomBytes(l).toString()}):(e.seedFile=function(l,u){try{u(null,c(l))}catch(h){u(h)}},e.seedFileSync=c),e.collect=function(l){for(var u=l.length,h=0;h<u;++h)e.pools[e.pool].update(l.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(l,u){for(var h="",d=0;d<u;d+=8)h+=String.fromCharCode(l>>d&255);e.collect(h)},e.registerWorker=function(l){if(l===self)e.seedFile=function(h,d){function y(g){var m=g.data;m.forge&&m.forge.prng&&(self.removeEventListener("message",y),d(m.forge.prng.err,m.forge.prng.bytes))}self.addEventListener("message",y),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var d=h.data;d.forge&&d.forge.prng&&e.seedFile(d.forge.prng.needed,function(y,g){l.postMessage({forge:{prng:{err:y,bytes:g}}})})};l.addEventListener("message",u)}},e}});var Ou=p((Xxt,vx)=>{f();var Mi=lt();cd();DN();LN();Wt();(function(){if(Mi.random&&Mi.random.getBytes){vx.exports=Mi.random;return}(function(t){var e={},r=new Array(4),i=Mi.util.createBuffer();e.formatKey=function(h){var d=Mi.util.createBuffer(h);return h=new Array(4),h[0]=d.getInt32(),h[1]=d.getInt32(),h[2]=d.getInt32(),h[3]=d.getInt32(),Mi.aes._expandKey(h,!1)},e.formatSeed=function(h){var d=Mi.util.createBuffer(h);return h=new Array(4),h[0]=d.getInt32(),h[1]=d.getInt32(),h[2]=d.getInt32(),h[3]=d.getInt32(),h},e.cipher=function(h,d){return Mi.aes._updateBlock(h,d,r,!1),i.putInt32(r[0]),i.putInt32(r[1]),i.putInt32(r[2]),i.putInt32(r[3]),i.getBytes()},e.increment=function(h){return++h[3],h},e.md=Mi.md.sha256;function n(){var h=Mi.prng.create(e);return h.getBytes=function(d,y){return h.generate(d,y)},h.getBytesSync=function(d){return h.generate(d)},h}var s=n(),o=null,a=Mi.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(h){return c.getRandomValues(h)}),Mi.options.usePureJavaScript||!Mi.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var l="";for(var u in navigator)try{typeof navigator[u]=="string"&&(l+=navigator[u])}catch(h){}s.collect(l),l=null}t&&(t().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),t().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!Mi.random)Mi.random=s;else for(var u in s)Mi.random[u]=s[u];Mi.random.createInstance=n,vx.exports=Mi.random})(typeof jQuery!="undefined"?jQuery:null)})()});var jN=p((Qxt,KN)=>{f();var Fn=lt();Wt();var wx=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],UN=[1,2,3,5],oTe=function(t,e){return t<<e&65535|(t&65535)>>16-e},aTe=function(t,e){return(t&65535)>>e|t<<16-e&65535};KN.exports=Fn.rc2=Fn.rc2||{};Fn.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Fn.util.createBuffer(t)),e=e||128;var r=t,i=t.length(),n=e,s=Math.ceil(n/8),o=255>>(n&7),a;for(a=i;a<128;a++)r.putByte(wx[r.at(a-1)+r.at(a-i)&255]);for(r.setAt(128-s,wx[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,wx[r.at(a+1)^r.at(a+s)]);return r};var FN=function(t,e,r){var i=!1,n=null,s=null,o=null,a,c,l,u,h=[];for(t=Fn.rc2.expandKey(t,e),l=0;l<64;l++)h.push(t.getInt16Le());r?(a=function(g){for(l=0;l<4;l++)g[l]+=h[u]+(g[(l+3)%4]&g[(l+2)%4])+(~g[(l+3)%4]&g[(l+1)%4]),g[l]=oTe(g[l],UN[l]),u++},c=function(g){for(l=0;l<4;l++)g[l]+=h[g[(l+3)%4]&63]}):(a=function(g){for(l=3;l>=0;l--)g[l]=aTe(g[l],UN[l]),g[l]-=h[u]+(g[(l+3)%4]&g[(l+2)%4])+(~g[(l+3)%4]&g[(l+1)%4]),u--},c=function(g){for(l=3;l>=0;l--)g[l]-=h[g[(l+3)%4]&63]});var d=function(g){var m=[];for(l=0;l<4;l++){var E=n.getInt16Le();o!==null&&(r?E^=o.getInt16Le():o.putInt16Le(E)),m.push(E&65535)}u=r?0:63;for(var v=0;v<g.length;v++)for(var A=0;A<g[v][0];A++)g[v][1](m);for(l=0;l<4;l++)o!==null&&(r?o.putInt16Le(m[l]):m[l]^=o.getInt16Le()),s.putInt16Le(m[l])},y=null;return y={start:function(g,m){g&&typeof g=="string"&&(g=Fn.util.createBuffer(g)),i=!1,n=Fn.util.createBuffer(),s=m||new Fn.util.createBuffer,o=g,y.output=s},update:function(g){for(i||n.putBuffer(g);n.length()>=8;)d([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(g){var m=!0;if(r)if(g)m=g(8,n,!r);else{var E=n.length()===8?8:8-n.length();n.fillWithByte(E,E)}if(m&&(i=!0,y.update()),!r&&(m=n.length()===0,m))if(g)m=g(8,s,!r);else{var v=s.length(),A=s.at(v-1);A>v?m=!1:s.truncate(A)}return m}},y};Fn.rc2.startEncrypting=function(t,e,r){var i=Fn.rc2.createEncryptionCipher(t,128);return i.start(e,r),i};Fn.rc2.createEncryptionCipher=function(t,e){return FN(t,e,!0)};Fn.rc2.startDecrypting=function(t,e,r){var i=Fn.rc2.createDecryptionCipher(t,128);return i.start(e,r),i};Fn.rc2.createDecryptionCipher=function(t,e){return FN(t,e,!1)}});var sg=p((Zxt,XN)=>{f();var _x=lt();XN.exports=_x.jsbn=_x.jsbn||{};var Rc,cTe=244837814094590,VN=(cTe&16777215)==15715070;function we(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}_x.jsbn.BigInteger=we;function kt(){return new we(null)}function uTe(t,e,r,i,n,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[i]+n;n=Math.floor(o/67108864),r.data[i++]=o&67108863}return n}function lTe(t,e,r,i,n,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[t]&32767,l=this.data[t++]>>15,u=a*c+l*o;c=o*c+((u&32767)<<15)+r.data[i]+(n&1073741823),n=(c>>>30)+(u>>>15)+a*l+(n>>>30),r.data[i++]=c&1073741823}return n}function zN(t,e,r,i,n,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[t]&16383,l=this.data[t++]>>14,u=a*c+l*o;c=o*c+((u&16383)<<14)+r.data[i]+n,n=(c>>28)+(u>>14)+a*l,r.data[i++]=c&268435455}return n}typeof navigator=="undefined"?(we.prototype.am=zN,Rc=28):VN&&navigator.appName=="Microsoft Internet Explorer"?(we.prototype.am=lTe,Rc=30):VN&&navigator.appName!="Netscape"?(we.prototype.am=uTe,Rc=26):(we.prototype.am=zN,Rc=28);we.prototype.DB=Rc;we.prototype.DM=(1<<Rc)-1;we.prototype.DV=1<<Rc;var Ex=52;we.prototype.FV=Math.pow(2,Ex);we.prototype.F1=Ex-Rc;we.prototype.F2=2*Rc-Ex;var fTe="0123456789abcdefghijklmnopqrstuvwxyz",Pv=new Array,ld,Is;ld="0".charCodeAt(0);for(Is=0;Is<=9;++Is)Pv[ld++]=Is;ld="a".charCodeAt(0);for(Is=10;Is<36;++Is)Pv[ld++]=Is;ld="A".charCodeAt(0);for(Is=10;Is<36;++Is)Pv[ld++]=Is;function HN(t){return fTe.charAt(t)}function $N(t,e){var r=Pv[t.charCodeAt(e)];return r??-1}function hTe(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function dTe(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function ku(t){var e=kt();return e.fromInt(t),e}function pTe(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var i=t.length,n=!1,s=0;--i>=0;){var o=r==8?t[i]&255:$N(t,i);if(o<0){t.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&we.ZERO.subTo(this,this)}function yTe(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function gTe(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,i,n=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(i=this.data[o]>>a)>0&&(n=!0,s=HN(i));o>=0;)a<e?(i=(this.data[o]&(1<<a)-1)<<e-a,i|=this.data[--o]>>(a+=this.DB-e)):(i=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),i>0&&(n=!0),n&&(s+=HN(i));return n?s:"0"}function bTe(){var t=kt();return we.ZERO.subTo(this,t),t}function mTe(){return this.s<0?this.negate():this}function vTe(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Cv(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function wTe(){return this.t<=0?0:this.DB*(this.t-1)+Cv(this.data[this.t-1]^this.s&this.DM)}function _Te(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function ETe(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function STe(t,e){var r=t%this.DB,i=this.DB-r,n=(1<<i)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>i|o,o=(this.data[a]&n)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function xTe(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var i=t%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[r]>>i;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<n,e.data[o-r]=this.data[o]>>i;i>0&&(e.data[this.t-r-1]|=(this.s&s)<<n),e.t=this.t-r,e.clamp()}function ATe(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]-t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e.data[r++]=this.DV+i:i>0&&(e.data[r++]=i),e.t=r,e.clamp()}function ITe(t,e){var r=this.abs(),i=t.abs(),n=r.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+r.t]=r.am(0,i.data[n],e,n,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&we.ZERO.subTo(e,e)}function TTe(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function RTe(t,e,r){var i=t.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=kt());var s=kt(),o=this.s,a=t.s,c=this.DB-Cv(i.data[i.t-1]);c>0?(i.lShiftTo(c,s),n.lShiftTo(c,r)):(i.copyTo(s),n.copyTo(r));var l=s.t,u=s.data[l-1];if(u!=0){var h=u*(1<<this.F1)+(l>1?s.data[l-2]>>this.F2:0),d=this.FV/h,y=(1<<this.F1)/h,g=1<<this.F2,m=r.t,E=m-l,v=e??kt();for(s.dlShiftTo(E,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),we.ONE.dlShiftTo(l,v),v.subTo(s,s);s.t<l;)s.data[s.t++]=0;for(;--E>=0;){var A=r.data[--m]==u?this.DM:Math.floor(r.data[m]*d+(r.data[m-1]+g)*y);if((r.data[m]+=s.am(0,A,r,E,0,l))<A)for(s.dlShiftTo(E,v),r.subTo(v,r);r.data[m]<--A;)r.subTo(v,r)}e!=null&&(r.drShiftTo(l,e),o!=a&&we.ZERO.subTo(e,e)),r.t=l,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&we.ZERO.subTo(r,r)}}}function PTe(t){var e=kt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(we.ZERO)>0&&t.subTo(e,e),e}function af(t){this.m=t}function CTe(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function OTe(t){return t}function kTe(t){t.divRemTo(this.m,null,t)}function qTe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function BTe(t,e){t.squareTo(e),this.reduce(e)}af.prototype.convert=CTe;af.prototype.revert=OTe;af.prototype.reduce=kTe;af.prototype.mulTo=qTe;af.prototype.sqrTo=BTe;function NTe(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function cf(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function DTe(t){var e=kt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(we.ZERO)>0&&this.m.subTo(e,e),e}function MTe(t){var e=kt();return t.copyTo(e),this.reduce(e),e}function LTe(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,i=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,i,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function UTe(t,e){t.squareTo(e),this.reduce(e)}function FTe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}cf.prototype.convert=DTe;cf.prototype.revert=MTe;cf.prototype.reduce=LTe;cf.prototype.mulTo=FTe;cf.prototype.sqrTo=UTe;function KTe(){return(this.t>0?this.data[0]&1:this.s)==0}function jTe(t,e){if(t>4294967295||t<1)return we.ONE;var r=kt(),i=kt(),n=e.convert(this),s=Cv(t)-1;for(n.copyTo(r);--s>=0;)if(e.sqrTo(r,i),(t&1<<s)>0)e.mulTo(i,n,r);else{var o=r;r=i,i=o}return e.revert(r)}function VTe(t,e){var r;return t<256||e.isEven()?r=new af(e):r=new cf(e),this.exp(t,r)}we.prototype.copyTo=hTe;we.prototype.fromInt=dTe;we.prototype.fromString=pTe;we.prototype.clamp=yTe;we.prototype.dlShiftTo=_Te;we.prototype.drShiftTo=ETe;we.prototype.lShiftTo=STe;we.prototype.rShiftTo=xTe;we.prototype.subTo=ATe;we.prototype.multiplyTo=ITe;we.prototype.squareTo=TTe;we.prototype.divRemTo=RTe;we.prototype.invDigit=NTe;we.prototype.isEven=KTe;we.prototype.exp=jTe;we.prototype.toString=gTe;we.prototype.negate=bTe;we.prototype.abs=mTe;we.prototype.compareTo=vTe;we.prototype.bitLength=wTe;we.prototype.mod=PTe;we.prototype.modPowInt=VTe;we.ZERO=ku(0);we.ONE=ku(1);function zTe(){var t=kt();return this.copyTo(t),t}function HTe(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function $Te(){return this.t==0?this.s:this.data[0]<<24>>24}function GTe(){return this.t==0?this.s:this.data[0]<<16>>16}function WTe(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function YTe(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function XTe(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=ku(r),n=kt(),s=kt(),o="";for(this.divRemTo(i,n,s);n.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,n.divRemTo(i,n,s);return s.intValue().toString(t)+o}function QTe(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),n=!1,s=0,o=0,a=0;a<t.length;++a){var c=$N(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(n=!0);continue}o=e*o+c,++s>=r&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),n&&we.ZERO.subTo(this,this)}function ZTe(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(we.ONE.shiftLeft(t-1),Sx,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(we.ONE.shiftLeft(t-1),this);else{var i=new Array,n=t&7;i.length=(t>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function JTe(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,i,n=0;if(t-- >0)for(r<this.DB&&(i=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[n++]=i|this.s<<this.DB-r);t>=0;)r<8?(i=(this.data[t]&(1<<r)-1)<<8-r,i|=this.data[--t]>>(r+=this.DB-8)):(i=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function eRe(t){return this.compareTo(t)==0}function tRe(t){return this.compareTo(t)<0?this:t}function rRe(t){return this.compareTo(t)>0?this:t}function iRe(t,e,r){var i,n,s=Math.min(t.t,this.t);for(i=0;i<s;++i)r.data[i]=e(this.data[i],t.data[i]);if(t.t<this.t){for(n=t.s&this.DM,i=s;i<this.t;++i)r.data[i]=e(this.data[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=s;i<t.t;++i)r.data[i]=e(n,t.data[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function nRe(t,e){return t&e}function sRe(t){var e=kt();return this.bitwiseTo(t,nRe,e),e}function Sx(t,e){return t|e}function oRe(t){var e=kt();return this.bitwiseTo(t,Sx,e),e}function GN(t,e){return t^e}function aRe(t){var e=kt();return this.bitwiseTo(t,GN,e),e}function WN(t,e){return t&~e}function cRe(t){var e=kt();return this.bitwiseTo(t,WN,e),e}function uRe(){for(var t=kt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function lRe(t){var e=kt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function fRe(t){var e=kt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function hRe(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function dRe(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+hRe(this.data[t]);return this.s<0?this.t*this.DB:-1}function pRe(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function yRe(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=pRe(this.data[r]^e);return t}function gRe(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function bRe(t,e){var r=we.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function mRe(t){return this.changeBit(t,Sx)}function vRe(t){return this.changeBit(t,WN)}function wRe(t){return this.changeBit(t,GN)}function _Re(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]+t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e.data[r++]=i:i<-1&&(e.data[r++]=this.DV+i),e.t=r,e.clamp()}function ERe(t){var e=kt();return this.addTo(t,e),e}function SRe(t){var e=kt();return this.subTo(t,e),e}function xRe(t){var e=kt();return this.multiplyTo(t,e),e}function ARe(t){var e=kt();return this.divRemTo(t,e,null),e}function IRe(t){var e=kt();return this.divRemTo(t,null,e),e}function TRe(t){var e=kt(),r=kt();return this.divRemTo(t,e,r),new Array(e,r)}function RRe(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function PRe(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function ng(){}function YN(t){return t}function CRe(t,e,r){t.multiplyTo(e,r)}function ORe(t,e){t.squareTo(e)}ng.prototype.convert=YN;ng.prototype.revert=YN;ng.prototype.mulTo=CRe;ng.prototype.sqrTo=ORe;function kRe(t){return this.exp(t,new ng)}function qRe(t,e,r){var i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;var n;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,t.data[i],r,i,0,this.t);for(n=Math.min(t.t,e);i<n;++i)this.am(0,t.data[i],r,i,0,e-i);r.clamp()}function BRe(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r.data[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r.data[this.t+i-e]=this.am(e-i,t.data[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)}function fd(t){this.r2=kt(),this.q3=kt(),we.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function NRe(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=kt();return t.copyTo(e),this.reduce(e),e}function DRe(t){return t}function MRe(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function LRe(t,e){t.squareTo(e),this.reduce(e)}function URe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}fd.prototype.convert=NRe;fd.prototype.revert=DRe;fd.prototype.reduce=MRe;fd.prototype.mulTo=URe;fd.prototype.sqrTo=LRe;function FRe(t,e){var r=t.bitLength(),i,n=ku(1),s;if(r<=0)return n;r<18?i=1:r<48?i=3:r<144?i=4:r<768?i=5:i=6,r<8?s=new af(e):e.isEven()?s=new fd(e):s=new cf(e);var o=new Array,a=3,c=i-1,l=(1<<i)-1;if(o[1]=s.convert(this),i>1){var u=kt();for(s.sqrTo(o[1],u);a<=l;)o[a]=kt(),s.mulTo(u,o[a-2],o[a]),a+=2}var h=t.t-1,d,y=!0,g=kt(),m;for(r=Cv(t.data[h])-1;h>=0;){for(r>=c?d=t.data[h]>>r-c&l:(d=(t.data[h]&(1<<r+1)-1)<<c-r,h>0&&(d|=t.data[h-1]>>this.DB+r-c)),a=i;(d&1)==0;)d>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),y)o[d].copyTo(n),y=!1;else{for(;a>1;)s.sqrTo(n,g),s.sqrTo(g,n),a-=2;a>0?s.sqrTo(n,g):(m=n,n=g,g=m),s.mulTo(g,o[d],n)}for(;h>=0&&(t.data[h]&1<<r)==0;)s.sqrTo(n,g),m=n,n=g,g=m,--r<0&&(r=this.DB-1,--h)}return s.revert(n)}function KRe(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function jRe(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this.data[i])%t;return r}function VRe(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return we.ZERO;for(var r=t.clone(),i=this.clone(),n=ku(1),s=ku(0),o=ku(0),a=ku(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(i)>=0?(r.subTo(i,r),e&&n.subTo(o,n),s.subTo(a,s)):(i.subTo(r,i),e&&o.subTo(n,o),a.subTo(s,a))}if(i.compareTo(we.ONE)!=0)return we.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var mo=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],zRe=(1<<26)/mo[mo.length-1];function HRe(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=mo[mo.length-1]){for(e=0;e<mo.length;++e)if(r.data[0]==mo[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<mo.length;){for(var i=mo[e],n=e+1;n<mo.length&&i<zRe;)i*=mo[n++];for(i=r.modInt(i);e<n;)if(i%mo[e++]==0)return!1}return r.millerRabin(t)}function $Re(t){var e=this.subtract(we.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var i=e.shiftRight(r),n=GRe(),s,o=0;o<t;++o){do s=new we(this.bitLength(),n);while(s.compareTo(we.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(i,this);if(a.compareTo(we.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(we.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function GRe(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}we.prototype.chunkSize=WTe;we.prototype.toRadix=XTe;we.prototype.fromRadix=QTe;we.prototype.fromNumber=ZTe;we.prototype.bitwiseTo=iRe;we.prototype.changeBit=bRe;we.prototype.addTo=_Re;we.prototype.dMultiply=RRe;we.prototype.dAddOffset=PRe;we.prototype.multiplyLowerTo=qRe;we.prototype.multiplyUpperTo=BRe;we.prototype.modInt=jRe;we.prototype.millerRabin=$Re;we.prototype.clone=zTe;we.prototype.intValue=HTe;we.prototype.byteValue=$Te;we.prototype.shortValue=GTe;we.prototype.signum=YTe;we.prototype.toByteArray=JTe;we.prototype.equals=eRe;we.prototype.min=tRe;we.prototype.max=rRe;we.prototype.and=sRe;we.prototype.or=oRe;we.prototype.xor=aRe;we.prototype.andNot=cRe;we.prototype.not=uRe;we.prototype.shiftLeft=lRe;we.prototype.shiftRight=fRe;we.prototype.getLowestSetBit=dRe;we.prototype.bitCount=yRe;we.prototype.testBit=gRe;we.prototype.setBit=mRe;we.prototype.clearBit=vRe;we.prototype.flipBit=wRe;we.prototype.add=ERe;we.prototype.subtract=SRe;we.prototype.multiply=xRe;we.prototype.divide=ARe;we.prototype.remainder=IRe;we.prototype.divideAndRemainder=TRe;we.prototype.modPow=FRe;we.prototype.modInverse=VRe;we.prototype.pow=kRe;we.prototype.gcd=KRe;we.prototype.isProbablePrime=HRe});var tD=p((Jxt,eD)=>{f();var va=lt();Cu();Wt();var QN=eD.exports=va.sha1=va.sha1||{};va.md.sha1=va.md.algorithms.sha1=QN;QN.create=function(){ZN||WRe();var t=null,e=va.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=va.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=va.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),JN(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=va.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(xx.substr(0,i.blockLength-o));for(var a,c,l=i.fullMessageLength[0]*8,u=0;u<i.fullMessageLength.length-1;++u)a=i.fullMessageLength[u+1]*8,c=a/4294967296>>>0,l+=c,n.putInt32(l>>>0),l=a>>>0;n.putInt32(l);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};JN(h,r,n);var d=va.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d},i};var xx=null,ZN=!1;function WRe(){xx=String.fromCharCode(128),xx+=va.util.fillString(String.fromCharCode(0),64),ZN=!0}function JN(t,e,r){for(var i,n,s,o,a,c,l,u,h=r.length();h>=64;){for(n=t.h0,s=t.h1,o=t.h2,a=t.h3,c=t.h4,u=0;u<16;++u)i=r.getInt32(),e[u]=i,l=a^s&(o^a),i=(n<<5|n>>>27)+l+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;u<20;++u)i=e[u-3]^e[u-8]^e[u-14]^e[u-16],i=i<<1|i>>>31,e[u]=i,l=a^s&(o^a),i=(n<<5|n>>>27)+l+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;u<32;++u)i=e[u-3]^e[u-8]^e[u-14]^e[u-16],i=i<<1|i>>>31,e[u]=i,l=s^o^a,i=(n<<5|n>>>27)+l+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;u<40;++u)i=e[u-6]^e[u-16]^e[u-28]^e[u-32],i=i<<2|i>>>30,e[u]=i,l=s^o^a,i=(n<<5|n>>>27)+l+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;u<60;++u)i=e[u-6]^e[u-16]^e[u-28]^e[u-32],i=i<<2|i>>>30,e[u]=i,l=s&o|a&(s^o),i=(n<<5|n>>>27)+l+c+2400959708+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;u<80;++u)i=e[u-6]^e[u-16]^e[u-28]^e[u-32],i=i<<2|i>>>30,e[u]=i,l=s^o^a,i=(n<<5|n>>>27)+l+c+3395469782+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;t.h0=t.h0+n|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,h-=64}}});var nD=p((eAt,iD)=>{f();var wa=lt();Wt();Ou();tD();var rD=iD.exports=wa.pkcs1=wa.pkcs1||{};rD.encode_rsa_oaep=function(t,e,r){var i,n,s,o;typeof r=="string"?(i=r,n=arguments[3]||void 0,s=arguments[4]||void 0):r&&(i=r.label||void 0,n=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=wa.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var l=new Error("RSAES-OAEP input message length is too long.");throw l.length=e.length,l.maxLength=c,l}i||(i=""),s.update(i,"raw");for(var u=s.digest(),h="",d=c-e.length,y=0;y<d;y++)h+="\0";var g=u.getBytes()+h+""+e;if(!n)n=wa.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var l=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw l.seedLength=n.length,l.digestLength=s.digestLength,l}var m=Ov(n,a-s.digestLength-1,o),E=wa.util.xorBytes(g,m,g.length),v=Ov(E,s.digestLength,o),A=wa.util.xorBytes(n,v,n.length);return"\0"+A+E};rD.decode_rsa_oaep=function(t,e,r){var i,n,s;typeof r=="string"?(i=r,n=arguments[3]||void 0):r&&(i=r.label||void 0,n=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var E=new Error("RSAES-OAEP encoded message length is invalid.");throw E.length=e.length,E.expectedLength=o,E}if(n===void 0?n=wa.md.sha1.create():n.start(),s||(s=n),o<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var a=n.digest().getBytes(),c=e.charAt(0),l=e.substring(1,n.digestLength+1),u=e.substring(1+n.digestLength),h=Ov(u,n.digestLength,s),d=wa.util.xorBytes(l,h,l.length),y=Ov(d,o-n.digestLength-1,s),g=wa.util.xorBytes(u,y,u.length),m=g.substring(0,n.digestLength),E=c!=="\0",v=0;v<n.digestLength;++v)E|=a.charAt(v)!==m.charAt(v);for(var A=1,R=n.digestLength,F=n.digestLength;F<g.length;F++){var q=g.charCodeAt(F),B=q&1^1,z=A?65534:0;E|=q&z,A=A&B,R+=A}if(E||g.charCodeAt(R)!==1)throw new Error("Invalid RSAES-OAEP padding.");return g.substring(R+1)};function Ov(t,e,r){r||(r=wa.md.sha1.create());for(var i="",n=Math.ceil(e/r.digestLength),s=0;s<n;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),i+=r.digest().getBytes()}return i.substring(0,e)}});var sD=p((tAt,Ax)=>{f();var qu=lt();Wt();sg();Ou();(function(){if(qu.prime){Ax.exports=qu.prime;return}var t=Ax.exports=qu.prime=qu.prime||{},e=qu.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(h,d){return h|d};t.generateProbablePrime=function(h,d,y){typeof d=="function"&&(y=d,d={}),d=d||{};var g=d.algorithm||"PRIMEINC";typeof g=="string"&&(g={name:g}),g.options=g.options||{};var m=d.prng||qu.random,E={nextBytes:function(v){for(var A=m.getBytesSync(v.length),R=0;R<v.length;++R)v[R]=A.charCodeAt(R)}};if(g.name==="PRIMEINC")return s(h,E,g.options,y);throw new Error("Invalid prime generation algorithm: "+g.name)};function s(h,d,y,g){return"workers"in y?c(h,d,y,g):o(h,d,y,g)}function o(h,d,y,g){var m=l(h,d),E=0,v=u(m.bitLength());"millerRabinTests"in y&&(v=y.millerRabinTests);var A=10;"maxBlockTime"in y&&(A=y.maxBlockTime),a(m,h,d,E,v,A,g)}function a(h,d,y,g,m,E,v){var A=+new Date;do{if(h.bitLength()>d&&(h=l(d,y)),h.isProbablePrime(m))return v(null,h);h.dAddOffset(r[g++%8],0)}while(E<0||+new Date-A<E);qu.util.setImmediate(function(){a(h,d,y,g,m,E,v)})}function c(h,d,y,g){if(typeof Worker=="undefined")return o(h,d,y,g);var m=l(h,d),E=y.workers,v=y.workLoad||100,A=v*30/8,R=y.workerScript||"forge/prime.worker.js";if(E===-1)return qu.util.estimateCores(function(q,B){q&&(B=2),E=B-1,F()});F();function F(){E=Math.max(1,E);for(var q=[],B=0;B<E;++B)q[B]=new Worker(R);for(var z=E,B=0;B<E;++B)q[B].addEventListener("message",Y);var G=!1;function Y(P){if(!G){--z;var b=P.data;if(b.found){for(var w=0;w<q.length;++w)q[w].terminate();return G=!0,g(null,new e(b.prime,16))}m.bitLength()>h&&(m=l(h,d));var S=m.toString(16);P.target.postMessage({hex:S,workLoad:v}),m.dAddOffset(A,0)}}}}function l(h,d){var y=new e(h,d),g=h-1;return y.testBit(g)||y.bitwiseTo(e.ONE.shiftLeft(g),n,y),y.dAddOffset(31-y.mod(i).byteValue(),0),y}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var og=p((rAt,hD)=>{f();var ot=lt();Ac();sg();sd();nD();sD();Ou();Wt();typeof Rt=="undefined"&&(Rt=ot.jsbn.BigInteger);var Rt,Ix=ot.util.isNodejs?ud():null,se=ot.asn1,Ts=ot.util;ot.pki=ot.pki||{};hD.exports=ot.pki.rsa=ot.rsa=ot.rsa||{};var at=ot.pki,YRe=[6,4,2,4,2,4,6,2],XRe={name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},QRe={name:"RSAPrivateKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},ZRe={name:"RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},JRe=ot.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},e8e=function(t){var e;if(t.algorithm in at.oids)e=at.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var i=se.oidToDer(e).getBytes(),n=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]),s=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]);s.value.push(se.create(se.Class.UNIVERSAL,se.Type.OID,!1,i)),s.value.push(se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,""));var o=se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,t.digest().getBytes());return n.value.push(s),n.value.push(o),se.toDer(n).getBytes()},oD=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Rt.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Rt.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new Rt(ot.util.bytesToHex(ot.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals(Rt.ONE));t=t.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var o=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(i.modInverse(e.n)).mod(e.n),o};at.rsa.encrypt=function(t,e,r){var i=r,n,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(i=r===2,n=aD(t,e,r)):(n=ot.util.createBuffer(),n.putBytes(t));for(var o=new Rt(n.toHex(),16),a=oD(o,e,i),c=a.toString(16),l=ot.util.createBuffer(),u=s-Math.ceil(c.length/2);u>0;)l.putByte(0),--u;return l.putBytes(ot.util.hexToBytes(c)),l.getBytes()};at.rsa.decrypt=function(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8);if(t.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=n,s}var o=new Rt(ot.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=oD(o,e,r),c=a.toString(16),l=ot.util.createBuffer(),u=n-Math.ceil(c.length/2);u>0;)l.putByte(0),--u;return l.putBytes(ot.util.hexToBytes(c)),i!==!1?kv(l.getBytes(),e,r):l.getBytes()};at.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var i=r.prng||ot.random,n={nextBytes:function(a){for(var c=i.getBytesSync(a.length),l=0;l<a.length;++l)a[l]=c.charCodeAt(l)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:n,eInt:e||65537,e:new Rt(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};at.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Rt(null);r.fromInt(30);for(var i=0,n=function(h,d){return h|d},s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,l=c-1;t.pqState===0?(t.num=new Rt(c,t.rng),t.num.testBit(l)||t.num.bitwiseTo(Rt.ONE.shiftLeft(l),n,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),i=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(r8e(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(YRe[i++%8],0):t.pqState===2?t.pqState=t.num.subtract(Rt.ONE).gcd(t.e).compareTo(Rt.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Rt.ONE),t.q1=t.q.subtract(Rt.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Rt.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:at.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:at.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};at.rsa.generateKeyPair=function(t,e,r,i){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(i=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,i=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(i=r,r=void 0):(i=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!ot.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(i){if(cD("generateKeyPair"))return Ix.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,l){if(a)return i(a);i(null,{privateKey:at.privateKeyFromPem(l),publicKey:at.publicKeyFromPem(c)})});if(uD("generateKey")&&uD("exportKey"))return Ts.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:fD(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Ts.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){i(a)}).then(function(a){if(a){var c=at.privateKeyFromAsn1(se.fromDer(ot.util.createBuffer(a)));i(null,{privateKey:c,publicKey:at.setRsaPublicKey(c.n,c.e)})}});if(lD("generateKey")&&lD("exportKey")){var n=Ts.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:fD(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(a){var c=a.target.result,l=Ts.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);l.oncomplete=function(u){var h=u.target.result,d=at.privateKeyFromAsn1(se.fromDer(ot.util.createBuffer(h)));i(null,{privateKey:d,publicKey:at.setRsaPublicKey(d.n,d.e)})},l.onerror=function(u){i(u)}},n.onerror=function(a){i(a)};return}}else if(cD("generateKeyPairSync")){var s=Ix.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:at.privateKeyFromPem(s.privateKey),publicKey:at.publicKeyFromPem(s.publicKey)}}}var o=at.rsa.createKeyPairGenerationState(t,e,r);if(!i)return at.rsa.stepKeyPairGenerationState(o,0),o.keys;t8e(o,r,i)};at.setRsaPublicKey=at.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(a,c,l){return aD(a,c,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(a,c){return ot.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(a){return a}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var o=n.encode(i,r,!0);return at.rsa.encrypt(o,r,!0)},r.verify=function(i,n,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(a,c){c=kv(c,r,!0);var l=se.fromDer(c);return a===l.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(a,c){return c=kv(c,r,!0),a===c}});var o=at.rsa.decrypt(n,r,!0,!1);return s.verify(i,o,r.n.bitLength())},r};at.setRsaPrivateKey=at.rsa.setPrivateKey=function(t,e,r,i,n,s,o,a){var c={n:t,e,d:r,p:i,q:n,dP:s,dQ:o,qInv:a};return c.decrypt=function(l,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var d=at.rsa.decrypt(l,c,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:kv};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(y,g){return ot.pkcs1.decode_rsa_oaep(g,y,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(y){return y}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(d,c,!1)},c.sign=function(l,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:e8e},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return l}},h=1);var d=u.encode(l,c.n.bitLength());return at.rsa.encrypt(d,c,h)},c};at.wrapRsaPrivateKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(at.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,se.toDer(t).getBytes())])};at.privateKeyFromAsn1=function(t){var e={},r=[];if(se.validate(t,XRe,e,r)&&(t=se.fromDer(ot.util.createBuffer(e.privateKey))),e={},r=[],!se.validate(t,QRe,e,r)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=r,i}var n,s,o,a,c,l,u,h;return n=ot.util.createBuffer(e.privateKeyModulus).toHex(),s=ot.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=ot.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=ot.util.createBuffer(e.privateKeyPrime1).toHex(),c=ot.util.createBuffer(e.privateKeyPrime2).toHex(),l=ot.util.createBuffer(e.privateKeyExponent1).toHex(),u=ot.util.createBuffer(e.privateKeyExponent2).toHex(),h=ot.util.createBuffer(e.privateKeyCoefficient).toHex(),at.setRsaPrivateKey(new Rt(n,16),new Rt(s,16),new Rt(o,16),new Rt(a,16),new Rt(c,16),new Rt(l,16),new Rt(u,16),new Rt(h,16))};at.privateKeyToAsn1=at.privateKeyToRSAPrivateKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,_a(t.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,_a(t.e)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,_a(t.d)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,_a(t.p)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,_a(t.q)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,_a(t.dP)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,_a(t.dQ)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,_a(t.qInv))])};at.publicKeyFromAsn1=function(t){var e={},r=[];if(se.validate(t,JRe,e,r)){var i=se.derToOid(e.publicKeyOid);if(i!==at.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}t=e.rsaPublicKey}if(r=[],!se.validate(t,ZRe,e,r)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=r,n}var s=ot.util.createBuffer(e.publicKeyModulus).toHex(),o=ot.util.createBuffer(e.publicKeyExponent).toHex();return at.setRsaPublicKey(new Rt(s,16),new Rt(o,16))};at.publicKeyToAsn1=at.publicKeyToSubjectPublicKeyInfo=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(at.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.BITSTRING,!1,[at.publicKeyToRSAPublicKey(t)])])};at.publicKeyToRSAPublicKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,_a(t.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,_a(t.e))])};function aD(t,e,r){var i=ot.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(t.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=n-11,s}i.putByte(0),i.putByte(r);var o=n-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)i.putByte(a)}else for(;o>0;){for(var l=0,u=ot.random.getBytes(o),c=0;c<o;++c)a=u.charCodeAt(c),a===0?++l:i.putByte(a);o=l}return i.putByte(0),i.putBytes(t),i}function kv(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8),s=ot.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=n-3-i;for(var l=0;l<c;++l)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var u=s.getByte();if(u!==0||c!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function t8e(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return o(a,t.q);s(t.qBits,o)})}function s(a,c){ot.prime.generateProbablePrime(a,i,c)}function o(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var l=t.p;t.p=t.q,t.q=l}if(t.p.subtract(Rt.ONE).gcd(t.e).compareTo(Rt.ONE)!==0){t.p=null,n();return}if(t.q.subtract(Rt.ONE).gcd(t.e).compareTo(Rt.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(Rt.ONE),t.q1=t.q.subtract(Rt.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Rt.ONE)!==0){t.p=t.q=null,n();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:at.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:at.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function _a(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=ot.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function r8e(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function cD(t){return ot.util.isNodejs&&typeof Ix[t]=="function"}function uD(t){return typeof Ts.globalScope!="undefined"&&typeof Ts.globalScope.crypto=="object"&&typeof Ts.globalScope.crypto.subtle=="object"&&typeof Ts.globalScope.crypto.subtle[t]=="function"}function lD(t){return typeof Ts.globalScope!="undefined"&&typeof Ts.globalScope.msCrypto=="object"&&typeof Ts.globalScope.msCrypto.subtle=="object"&&typeof Ts.globalScope.msCrypto.subtle[t]=="function"}function fD(t){for(var e=ot.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),i=0;i<e.length;++i)r[i]=e.charCodeAt(i);return r}});var Tx=p((iAt,bD)=>{f();var Le=lt();cd();Ac();Sv();Cu();sd();bx();Tv();Ou();jN();og();Wt();typeof dD=="undefined"&&(dD=Le.jsbn.BigInteger);var dD,fe=Le.asn1,ut=Le.pki=Le.pki||{};bD.exports=ut.pbe=Le.pbe=Le.pbe||{};var uf=ut.oids,i8e={name:"EncryptedPrivateKeyInfo",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},n8e={name:"PBES2Algorithms",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},s8e={name:"pkcs-12PbeParams",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"iterations"}]};ut.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i=Le.random.getBytesSync(r.saltSize),n=r.count,s=fe.integerToDer(n),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var l,u,h;switch(r.algorithm){case"aes128":o=16,l=16,u=uf["aes128-CBC"],h=Le.aes.createEncryptionCipher;break;case"aes192":o=24,l=16,u=uf["aes192-CBC"],h=Le.aes.createEncryptionCipher;break;case"aes256":o=32,l=16,u=uf["aes256-CBC"],h=Le.aes.createEncryptionCipher;break;case"des":o=8,l=8,u=uf.desCBC,h=Le.des.createEncryptionCipher;break;default:var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var y="hmacWith"+r.prfAlgorithm.toUpperCase(),g=gD(y),m=Le.pkcs5.pbkdf2(e,i,n,o,g),E=Le.random.getBytesSync(l),v=h(m);v.start(E),v.update(fe.toDer(t)),v.finish(),c=v.output.getBytes();var A=o8e(i,s,o,y);a=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(uf.pkcs5PBES2).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(uf.pkcs5PBKDF2).getBytes()),A]),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(u).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,E)])])])}else if(r.algorithm==="3des"){o=24;var R=new Le.util.ByteBuffer(i),m=ut.pbe.generatePkcs12Key(e,R,1,n,o),E=ut.pbe.generatePkcs12Key(e,R,2,n,o),v=Le.des.createEncryptionCipher(m);v.start(E),v.update(fe.toDer(t)),v.finish(),c=v.output.getBytes(),a=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(uf["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,i),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,s.getBytes())])])}else{var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var F=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[a,fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,c)]);return F};ut.decryptPrivateKeyInfo=function(t,e){var r=null,i={},n=[];if(!fe.validate(t,i8e,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=fe.derToOid(i.encryptionOid),a=ut.pbe.getCipher(o,i.encryptionParams,e),c=Le.util.createBuffer(i.encryptedData);return a.update(c),a.finish()&&(r=fe.fromDer(a.output)),r};ut.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:fe.toDer(t).getBytes()};return Le.pem.encode(r,{maxline:e})};ut.encryptedPrivateKeyFromPem=function(t){var e=Le.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return fe.fromDer(e.body)};ut.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var i=ut.wrapRsaPrivateKey(ut.privateKeyToAsn1(t));return i=ut.encryptPrivateKeyInfo(i,e,r),ut.encryptedPrivateKeyToPem(i)}var n,s,o,a;switch(r.algorithm){case"aes128":n="AES-128-CBC",o=16,s=Le.random.getBytesSync(16),a=Le.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",o=24,s=Le.random.getBytesSync(16),a=Le.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",o=32,s=Le.random.getBytesSync(16),a=Le.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",o=24,s=Le.random.getBytesSync(8),a=Le.des.createEncryptionCipher;break;case"des":n="DES-CBC",o=8,s=Le.random.getBytesSync(8),a=Le.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var l=Le.pbe.opensslDeriveBytes(e,s.substr(0,8),o),u=a(l);u.start(s),u.update(fe.toDer(ut.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:Le.util.bytesToHex(s).toUpperCase()},body:u.output.getBytes()};return Le.pem.encode(h)};ut.decryptRsaPrivateKey=function(t,e){var r=null,i=Le.pem.decode(t)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,o;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,o=Le.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=Le.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=Le.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=Le.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=Le.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return Le.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return Le.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return Le.rc2.createDecryptionCipher(h,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var a=Le.util.hexToBytes(i.dekInfo.parameters),c=Le.pbe.opensslDeriveBytes(e,a.substr(0,8),s),l=o(c);if(l.start(a),l.update(Le.util.createBuffer(i.body)),l.finish())r=l.output.getBytes();else return r}else r=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?r=ut.decryptPrivateKeyInfo(fe.fromDer(r),e):r=fe.fromDer(r),r!==null&&(r=ut.privateKeyFromAsn1(r)),r};ut.pbe.generatePkcs12Key=function(t,e,r,i,n,s){var o,a;if(typeof s=="undefined"||s===null){if(!("sha1"in Le.md))throw new Error('"sha1" hash algorithm unavailable.');s=Le.md.sha1.create()}var c=s.digestLength,l=s.blockLength,u=new Le.util.ByteBuffer,h=new Le.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var d=h.length(),y=e.length(),g=new Le.util.ByteBuffer;g.fillWithByte(r,l);var m=l*Math.ceil(y/l),E=new Le.util.ByteBuffer;for(a=0;a<m;a++)E.putByte(e.at(a%y));var v=l*Math.ceil(d/l),A=new Le.util.ByteBuffer;for(a=0;a<v;a++)A.putByte(h.at(a%d));var R=E;R.putBuffer(A);for(var F=Math.ceil(n/c),q=1;q<=F;q++){var B=new Le.util.ByteBuffer;B.putBytes(g.bytes()),B.putBytes(R.bytes());for(var z=0;z<i;z++)s.start(),s.update(B.getBytes()),B=s.digest();var G=new Le.util.ByteBuffer;for(a=0;a<l;a++)G.putByte(B.at(a%c));var Y=Math.ceil(y/l)+Math.ceil(d/l),P=new Le.util.ByteBuffer;for(o=0;o<Y;o++){var b=new Le.util.ByteBuffer(R.getBytes(l)),w=511;for(a=G.length()-1;a>=0;a--)w=w>>8,w+=G.at(a)+b.at(a),b.setAt(a,w&255);P.putBuffer(b)}R=P,u.putBuffer(B)}return u.truncate(u.length()-n),u};ut.pbe.getCipher=function(t,e,r){switch(t){case ut.oids.pkcs5PBES2:return ut.pbe.getCipherForPBES2(t,e,r);case ut.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case ut.oids["pbewithSHAAnd40BitRC2-CBC"]:return ut.pbe.getCipherForPKCS12PBE(t,e,r);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=t,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};ut.pbe.getCipherForPBES2=function(t,e,r){var i={},n=[];if(!fe.validate(e,n8e,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(t=fe.derToOid(i.kdfOid),t!==ut.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=fe.derToOid(i.encOid),t!==ut.oids["aes128-CBC"]&&t!==ut.oids["aes192-CBC"]&&t!==ut.oids["aes256-CBC"]&&t!==ut.oids["des-EDE3-CBC"]&&t!==ut.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=i.kdfSalt,a=Le.util.createBuffer(i.kdfIterationCount);a=a.getInt(a.length()<<3);var c,l;switch(ut.oids[t]){case"aes128-CBC":c=16,l=Le.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,l=Le.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,l=Le.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,l=Le.des.createDecryptionCipher;break;case"desCBC":c=8,l=Le.des.createDecryptionCipher;break}var u=yD(i.prfOid),h=Le.pkcs5.pbkdf2(r,o,a,c,u),d=i.encIv,y=l(h);return y.start(d),y};ut.pbe.getCipherForPKCS12PBE=function(t,e,r){var i={},n=[];if(!fe.validate(e,s8e,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=Le.util.createBuffer(i.salt),a=Le.util.createBuffer(i.iterations);a=a.getInt(a.length()<<3);var c,l,u;switch(t){case ut.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,l=8,u=Le.des.startDecrypting;break;case ut.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,l=8,u=function(m,E){var v=Le.rc2.createDecryptionCipher(m,40);return v.start(E,null),v};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var h=yD(i.prfOid),d=ut.pbe.generatePkcs12Key(r,o,1,a,c,h);h.start();var y=ut.pbe.generatePkcs12Key(r,o,2,a,l,h);return u(d,y)};ut.pbe.opensslDeriveBytes=function(t,e,r,i){if(typeof i=="undefined"||i===null){if(!("md5"in Le.md))throw new Error('"md5" hash algorithm unavailable.');i=Le.md.md5.create()}e===null&&(e="");for(var n=[pD(i,t+e)],s=16,o=1;s<r;++o,s+=16)n.push(pD(i,n[o-1]+t+e));return n.join("").substr(0,r)};function pD(t,e){return t.start().update(e).digest().getBytes()}function yD(t){var e;if(!t)e="hmacWithSHA1";else if(e=ut.oids[fe.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return gD(e)}function gD(t){var e=Le.md;switch(t){case"hmacWithSHA224":e=Le.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function o8e(t,e,r,i){var n=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,t),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,Le.util.hexToBytes(r.toString(16))),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(ut.oids[i]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.NULL,!1,"")])),n}});var ae=p((nAt,vD)=>{f();"use strict";function mD(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function a8e(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return mD(t,r)}catch(i){r.message=t.message,r.stack=t.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(t)),mD(new n,r)}}vD.exports=a8e});var Rx={};Gt(Rx,{identity:()=>c8e});var c8e,wD=Ge(()=>{f();ha();Su();c8e=sv({prefix:"\0",name:"identity",encode:t=>j6(t),decode:t=>K6(t)})});var Px={};Gt(Px,{base2:()=>u8e});var u8e,_D=Ge(()=>{f();ha();u8e=Hr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var Cx={};Gt(Cx,{base8:()=>l8e});var l8e,ED=Ge(()=>{f();ha();l8e=Hr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var Ox={};Gt(Ox,{base10:()=>f8e});var f8e,SD=Ge(()=>{f();ha();f8e=xu({prefix:"9",name:"base10",alphabet:"0123456789"})});var ag={};Gt(ag,{Hasher:()=>kx,from:()=>hd});var hd,kx,qv=Ge(()=>{f();An();hd=({name:t,code:e,encode:r})=>new kx(t,e,r),kx=class{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}async digest(e){if(e instanceof Uint8Array){let r=await this.encode(e);return Yy(this.code,r)}else throw Error("Unknown type, must be binary type")}}});var $r={};Gt($r,{sha256:()=>h8e,sha512:()=>d8e});var xD,h8e,d8e,ai=Ge(()=>{f();qv();xD=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),h8e=hd({name:"sha2-256",code:18,encode:xD("SHA-256")}),d8e=hd({name:"sha2-512",code:19,encode:xD("SHA-512")})});var Ea={};Gt(Ea,{identity:()=>p8e});var p8e,Pc=Ge(()=>{f();qv();Su();p8e=hd({name:"identity",code:0,encode:t=>po(t)})});var ns={};Gt(ns,{code:()=>g8e,decode:()=>m8e,encode:()=>b8e,name:()=>y8e});var AD,y8e,g8e,b8e,m8e,Rs=Ge(()=>{f();Su();AD=t=>po(t),{name:y8e,code:g8e,encode:b8e,decode:m8e}={name:"raw",code:85,decode:AD,encode:AD}});var Bv={};Gt(Bv,{code:()=>w8e,decode:()=>E8e,encode:()=>_8e,name:()=>v8e});var v8e,w8e,_8e,E8e,qx=Ge(()=>{f();({name:v8e,code:w8e,encode:_8e,decode:E8e}={name:"json",code:512,encode:t=>new TextEncoder().encode(JSON.stringify(t)),decode:t=>JSON.parse(new TextDecoder().decode(t))})});var dd={};Gt(dd,{CID:()=>rt,bytes:()=>tf,digest:()=>xn,hasher:()=>ag,varint:()=>Wy});var Bu=Ge(()=>{f();Ae();iv();Su();qv();An()});var Nv={};Gt(Nv,{CID:()=>rt,bases:()=>S8e,bytes:()=>tf,codecs:()=>A8e,digest:()=>xn,hasher:()=>ag,hashes:()=>x8e,varint:()=>Wy});var S8e,x8e,A8e,Dv=Ge(()=>{f();wD();_D();ED();SD();H6();an();z6();si();Qy();ai();Pc();Rs();qx();Bu();S8e={...Rx,...Px,...Cx,...Ox,...uv,...on,...cv,...ni,...id},x8e={...$r,...Ea},A8e={raw:ns,json:Bv}});var Nx=p((bAt,PD)=>{f();"use strict";var{bases:ID}=(Dv(),Nv);function TD(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}var RD=TD("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Bx=TD("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),I8e={utf8:RD,"utf-8":RD,hex:ID.base16,latin1:Bx,ascii:Bx,binary:Bx,...ID};PD.exports=I8e});var ct=p((mAt,CD)=>{f();"use strict";var T8e=Nx();function R8e(t,e="utf8"){let r=T8e[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}CD.exports=R8e});var un=p((vAt,OD)=>{f();"use strict";function P8e(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));let r=new Uint8Array(e),i=0;for(let n of t)r.set(n,i),i+=n.length;return r}OD.exports=P8e});var cg=p(kD=>{f();"use strict";kD.get=(t=self)=>{let e=t.crypto||t.msCrypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var Dx=p((_At,BD)=>{f();"use strict";var C8e=un(),qD=ct(),O8e=cg();function k8e({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let o=O8e.get();r*=8;async function a(l,u){let h=o.getRandomValues(new Uint8Array(n)),d=o.getRandomValues(new Uint8Array(e)),y={name:t,iv:d},g={name:"PBKDF2",salt:h,iterations:s,hash:{name:i}},m=await o.subtle.importKey("raw",qD(u),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),E=await o.subtle.deriveKey(g,m,{name:t,length:r},!0,["encrypt"]),v=await o.subtle.encrypt(y,E,l);return C8e([h,y.iv,new Uint8Array(v)])}async function c(l,u){let h=l.slice(0,n),d=l.slice(n,n+e),y=l.slice(n+e),g={name:t,iv:d},m={name:"PBKDF2",salt:h,iterations:s,hash:{name:i}},E=await o.subtle.importKey("raw",qD(u),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await o.subtle.deriveKey(m,E,{name:t,length:r},!0,["decrypt"]),A=await o.subtle.decrypt(g,v,y);return new Uint8Array(A)}return{encrypt:a,decrypt:c}}BD.exports={create:k8e}});var DD=p((EAt,ND)=>{f();"use strict";var{base64:q8e}=(Qy(),id),B8e=Dx();ND.exports={import:async function(t,e){let r=q8e.decode(t);return await B8e.create().decrypt(r,e)}}});var yi=p((SAt,MD)=>{f();"use strict";function N8e(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}MD.exports=N8e});var Je=p((xAt,LD)=>{f();"use strict";var D8e=Nx();function M8e(t,e="utf8"){let r=D8e[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}LD.exports=M8e});var Mv=p((AAt,jD)=>{f();var mr=lt();Cu();Wt();var ug=jD.exports=mr.sha512=mr.sha512||{};mr.md.sha512=mr.md.algorithms.sha512=ug;var UD=mr.sha384=mr.sha512.sha384=mr.sha512.sha384||{};UD.create=function(){return ug.create("SHA-384")};mr.md.sha384=mr.md.algorithms.sha384=UD;mr.sha512.sha256=mr.sha512.sha256||{create:function(){return ug.create("SHA-512/256")}};mr.md["sha512/256"]=mr.md.algorithms["sha512/256"]=mr.sha512.sha256;mr.sha512.sha224=mr.sha512.sha224||{create:function(){return ug.create("SHA-512/224")}};mr.md["sha512/224"]=mr.md.algorithms["sha512/224"]=mr.sha512.sha224;ug.create=function(t){if(FD||L8e(),typeof t=="undefined"&&(t="SHA-512"),!(t in lf))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=lf[t],r=null,i=mr.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,l=0;l<c;++l)a.fullMessageLength.push(0);i=mr.util.createBuffer(),r=new Array(e.length);for(var l=0;l<e.length;++l)r[l]=e[l].slice(0);return a},a.start(),a.update=function(c,l){l==="utf8"&&(c=mr.util.encodeUtf8(c));var u=c.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return i.putBytes(c),KD(r,n,i),(i.read>2048||i.length()===0)&&i.compact(),a},a.digest=function(){var c=mr.util.createBuffer();c.putBytes(i.bytes());var l=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=l&a.blockLength-1;c.putBytes(Mx.substr(0,a.blockLength-u));for(var h,d,y=a.fullMessageLength[0]*8,g=0;g<a.fullMessageLength.length-1;++g)h=a.fullMessageLength[g+1]*8,d=h/4294967296>>>0,y+=d,c.putInt32(y>>>0),y=h>>>0;c.putInt32(y);for(var m=new Array(r.length),g=0;g<r.length;++g)m[g]=r[g].slice(0);KD(m,n,c);var E=mr.util.createBuffer(),v;t==="SHA-512"?v=m.length:t==="SHA-384"?v=m.length-2:v=m.length-4;for(var g=0;g<v;++g)E.putInt32(m[g][0]),(g!==v-1||t!=="SHA-512/224")&&E.putInt32(m[g][1]);return E},a};var Mx=null,FD=!1,Lx=null,lf=null;function L8e(){Mx=String.fromCharCode(128),Mx+=mr.util.fillString(String.fromCharCode(0),128),Lx=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],lf={},lf["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],lf["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],lf["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],lf["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],FD=!0}function KD(t,e,r){for(var i,n,s,o,a,c,l,u,h,d,y,g,m,E,v,A,R,F,q,B,z,G,Y,P,b,w,S,C,D,W,j,M,_,L,ce,X=r.length();X>=128;){for(D=0;D<16;++D)e[D][0]=r.getInt32()>>>0,e[D][1]=r.getInt32()>>>0;for(;D<80;++D)M=e[D-2],W=M[0],j=M[1],i=((W>>>19|j<<13)^(j>>>29|W<<3)^W>>>6)>>>0,n=((W<<13|j>>>19)^(j<<3|W>>>29)^(W<<26|j>>>6))>>>0,L=e[D-15],W=L[0],j=L[1],s=((W>>>1|j<<31)^(W>>>8|j<<24)^W>>>7)>>>0,o=((W<<31|j>>>1)^(W<<24|j>>>8)^(W<<25|j>>>7))>>>0,_=e[D-7],ce=e[D-16],j=n+_[1]+o+ce[1],e[D][0]=i+_[0]+s+ce[0]+(j/4294967296>>>0)>>>0,e[D][1]=j>>>0;for(m=t[0][0],E=t[0][1],v=t[1][0],A=t[1][1],R=t[2][0],F=t[2][1],q=t[3][0],B=t[3][1],z=t[4][0],G=t[4][1],Y=t[5][0],P=t[5][1],b=t[6][0],w=t[6][1],S=t[7][0],C=t[7][1],D=0;D<80;++D)l=((z>>>14|G<<18)^(z>>>18|G<<14)^(G>>>9|z<<23))>>>0,u=((z<<18|G>>>14)^(z<<14|G>>>18)^(G<<23|z>>>9))>>>0,h=(b^z&(Y^b))>>>0,d=(w^G&(P^w))>>>0,a=((m>>>28|E<<4)^(E>>>2|m<<30)^(E>>>7|m<<25))>>>0,c=((m<<4|E>>>28)^(E<<30|m>>>2)^(E<<25|m>>>7))>>>0,y=(m&v|R&(m^v))>>>0,g=(E&A|F&(E^A))>>>0,j=C+u+d+Lx[D][1]+e[D][1],i=S+l+h+Lx[D][0]+e[D][0]+(j/4294967296>>>0)>>>0,n=j>>>0,j=c+g,s=a+y+(j/4294967296>>>0)>>>0,o=j>>>0,S=b,C=w,b=Y,w=P,Y=z,P=G,j=B+n,z=q+i+(j/4294967296>>>0)>>>0,G=j>>>0,q=R,B=F,R=v,F=A,v=m,A=E,j=n+o,m=i+s+(j/4294967296>>>0)>>>0,E=j>>>0;j=t[0][1]+E,t[0][0]=t[0][0]+m+(j/4294967296>>>0)>>>0,t[0][1]=j>>>0,j=t[1][1]+A,t[1][0]=t[1][0]+v+(j/4294967296>>>0)>>>0,t[1][1]=j>>>0,j=t[2][1]+F,t[2][0]=t[2][0]+R+(j/4294967296>>>0)>>>0,t[2][1]=j>>>0,j=t[3][1]+B,t[3][0]=t[3][0]+q+(j/4294967296>>>0)>>>0,t[3][1]=j>>>0,j=t[4][1]+G,t[4][0]=t[4][0]+z+(j/4294967296>>>0)>>>0,t[4][1]=j>>>0,j=t[5][1]+P,t[5][0]=t[5][0]+Y+(j/4294967296>>>0)>>>0,t[5][1]=j>>>0,j=t[6][1]+w,t[6][0]=t[6][0]+b+(j/4294967296>>>0)>>>0,t[6][1]=j>>>0,j=t[7][1]+C,t[7][0]=t[7][0]+S+(j/4294967296>>>0)>>>0,t[7][1]=j>>>0,X-=128}}});var VD=p(Ux=>{f();var U8e=lt();Ac();var Li=U8e.asn1;Ux.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Li.Class.UNIVERSAL,type:Li.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Li.Class.UNIVERSAL,type:Li.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Li.Class.UNIVERSAL,type:Li.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Li.Class.UNIVERSAL,type:Li.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Li.Class.UNIVERSAL,type:Li.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};Ux.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Li.Class.UNIVERSAL,type:Li.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Li.Class.UNIVERSAL,type:Li.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Li.Class.UNIVERSAL,type:Li.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Li.Class.UNIVERSAL,type:Li.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var Wx=p((TAt,t7)=>{f();var Yi=lt();sg();Ou();Mv();Wt();var zD=VD(),F8e=zD.publicKeyValidator,K8e=zD.privateKeyValidator;typeof HD=="undefined"&&(HD=Yi.jsbn.BigInteger);var HD,Fx=Yi.util.ByteBuffer,Kn=typeof Buffer=="undefined"?Uint8Array:Buffer;Yi.pki=Yi.pki||{};t7.exports=Yi.pki.ed25519=Yi.ed25519=Yi.ed25519||{};var mt=Yi.ed25519;mt.constants={};mt.constants.PUBLIC_KEY_BYTE_LENGTH=32;mt.constants.PRIVATE_KEY_BYTE_LENGTH=64;mt.constants.SEED_BYTE_LENGTH=32;mt.constants.SIGN_BYTE_LENGTH=64;mt.constants.HASH_BYTE_LENGTH=64;mt.generateKeyPair=function(t){t=t||{};var e=t.seed;if(e===void 0)e=Yi.random.getBytesSync(mt.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==mt.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+mt.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=Cc({message:e,encoding:"binary"});for(var r=new Kn(mt.constants.PUBLIC_KEY_BYTE_LENGTH),i=new Kn(mt.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;n<32;++n)i[n]=e[n];return H8e(r,i),{publicKey:r,privateKey:i}};mt.privateKeyFromAsn1=function(t){var e={},r=[],i=Yi.asn1.validate(t,K8e,e,r);if(!i){var n=new Error("Invalid Key.");throw n.errors=r,n}var s=Yi.asn1.derToOid(e.privateKeyOid),o=Yi.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.privateKey,c=Cc({message:Yi.asn1.fromDer(a).value,encoding:"binary"});return{privateKeyBytes:c}};mt.publicKeyFromAsn1=function(t){var e={},r=[],i=Yi.asn1.validate(t,F8e,e,r);if(!i){var n=new Error("Invalid Key.");throw n.errors=r,n}var s=Yi.asn1.derToOid(e.publicKeyOid),o=Yi.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.ed25519PublicKey;if(a.length!==mt.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return Cc({message:a,encoding:"binary"})};mt.publicKeyFromPrivateKey=function(t){t=t||{};var e=Cc({message:t.privateKey,encoding:"binary"});if(e.length!==mt.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+mt.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new Kn(mt.constants.PUBLIC_KEY_BYTE_LENGTH),i=0;i<r.length;++i)r[i]=e[32+i];return r};mt.sign=function(t){t=t||{};var e=Cc(t),r=Cc({message:t.privateKey,encoding:"binary"});if(r.length===mt.constants.SEED_BYTE_LENGTH){var i=mt.generateKeyPair({seed:r});r=i.privateKey}else if(r.length!==mt.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+mt.constants.SEED_BYTE_LENGTH+" or "+mt.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new Kn(mt.constants.SIGN_BYTE_LENGTH+e.length);$8e(n,e,e.length,r);for(var s=new Kn(mt.constants.SIGN_BYTE_LENGTH),o=0;o<s.length;++o)s[o]=n[o];return s};mt.verify=function(t){t=t||{};var e=Cc(t);if(t.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=Cc({message:t.signature,encoding:"binary"});if(r.length!==mt.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+mt.constants.SIGN_BYTE_LENGTH);var i=Cc({message:t.publicKey,encoding:"binary"});if(i.length!==mt.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+mt.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new Kn(mt.constants.SIGN_BYTE_LENGTH+e.length),s=new Kn(mt.constants.SIGN_BYTE_LENGTH+e.length),o;for(o=0;o<mt.constants.SIGN_BYTE_LENGTH;++o)n[o]=r[o];for(o=0;o<e.length;++o)n[o+mt.constants.SIGN_BYTE_LENGTH]=e[o];return G8e(s,n,n.length,i)>=0};function Cc(t){var e=t.message;if(e instanceof Uint8Array||e instanceof Kn)return e;var r=t.encoding;if(e===void 0)if(t.md)e=t.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer!="undefined")return Buffer.from(e,r);e=new Fx(e,r)}else if(!(e instanceof Fx))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var i=new Kn(e.length()),n=0;n<i.length;++n)i[n]=e.at(n);return i}var Kx=Ye(),Lv=Ye([1]),j8e=Ye([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),V8e=Ye([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),$D=Ye([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),GD=Ye([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),jx=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),z8e=Ye([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function lg(t,e){var r=Yi.md.sha512.create(),i=new Fx(t);r.update(i.getBytes(e),"binary");var n=r.digest().getBytes();if(typeof Buffer!="undefined")return Buffer.from(n,"binary");for(var s=new Kn(mt.constants.HASH_BYTE_LENGTH),o=0;o<64;++o)s[o]=n.charCodeAt(o);return s}function H8e(t,e){var r=[Ye(),Ye(),Ye(),Ye()],i,n=lg(e,32);for(n[0]&=248,n[31]&=127,n[31]|=64,$x(r,n),Hx(t,r),i=0;i<32;++i)e[i+32]=t[i];return 0}function $8e(t,e,r,i){var n,s,o=new Float64Array(64),a=[Ye(),Ye(),Ye(),Ye()],c=lg(i,32);c[0]&=248,c[31]&=127,c[31]|=64;var l=r+64;for(n=0;n<r;++n)t[64+n]=e[n];for(n=0;n<32;++n)t[32+n]=c[32+n];var u=lg(t.subarray(32),r+32);for(Vx(u),$x(a,u),Hx(t,a),n=32;n<64;++n)t[n]=i[n];var h=lg(t,r+64);for(Vx(h),n=32;n<64;++n)o[n]=0;for(n=0;n<32;++n)o[n]=u[n];for(n=0;n<32;++n)for(s=0;s<32;s++)o[n+s]+=h[n]*c[s];return WD(t.subarray(32),o),l}function G8e(t,e,r,i){var n,s,o=new Kn(32),a=[Ye(),Ye(),Ye(),Ye()],c=[Ye(),Ye(),Ye(),Ye()];if(s=-1,r<64||W8e(c,i))return-1;for(n=0;n<r;++n)t[n]=e[n];for(n=0;n<32;++n)t[n+32]=i[n];var l=lg(t,r);if(Vx(l),JD(a,c,l),$x(c,e.subarray(32)),zx(a,c),Hx(o,a),r-=64,QD(e,0,o,0)){for(n=0;n<r;++n)t[n]=0;return-1}for(n=0;n<r;++n)t[n]=e[n+64];return s=r,s}function WD(t,e){var r,i,n,s;for(i=63;i>=32;--i){for(r=0,n=i-32,s=i-12;n<s;++n)e[n]+=r-16*e[i]*jx[n-(i-32)],r=e[n]+128>>8,e[n]-=r*256;e[n]+=r,e[i]=0}for(r=0,n=0;n<32;++n)e[n]+=r-(e[31]>>4)*jx[n],r=e[n]>>8,e[n]&=255;for(n=0;n<32;++n)e[n]-=r*jx[n];for(i=0;i<32;++i)e[i+1]+=e[i]>>8,t[i]=e[i]&255}function Vx(t){for(var e=new Float64Array(64),r=0;r<64;++r)e[r]=t[r],t[r]=0;WD(t,e)}function zx(t,e){var r=Ye(),i=Ye(),n=Ye(),s=Ye(),o=Ye(),a=Ye(),c=Ye(),l=Ye(),u=Ye();yd(r,t[1],t[0]),yd(u,e[1],e[0]),Yt(r,r,u),pd(i,t[0],t[1]),pd(u,e[0],e[1]),Yt(i,i,u),Yt(n,t[3],e[3]),Yt(n,n,V8e),Yt(s,t[2],e[2]),pd(s,s,s),yd(o,i,r),yd(a,s,n),pd(c,s,n),pd(l,i,r),Yt(t[0],o,a),Yt(t[1],l,c),Yt(t[2],c,a),Yt(t[3],o,l)}function YD(t,e,r){for(var i=0;i<4;++i)e7(t[i],e[i],r)}function Hx(t,e){var r=Ye(),i=Ye(),n=Ye();Z8e(n,e[2]),Yt(r,e[0],n),Yt(i,e[1],n),Uv(t,i),t[31]^=ZD(r)<<7}function Uv(t,e){var r,i,n,s=Ye(),o=Ye();for(r=0;r<16;++r)o[r]=e[r];for(Gx(o),Gx(o),Gx(o),i=0;i<2;++i){for(s[0]=o[0]-65517,r=1;r<15;++r)s[r]=o[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=o[15]-32767-(s[14]>>16&1),n=s[15]>>16&1,s[14]&=65535,e7(o,s,1-n)}for(r=0;r<16;r++)t[2*r]=o[r]&255,t[2*r+1]=o[r]>>8}function W8e(t,e){var r=Ye(),i=Ye(),n=Ye(),s=Ye(),o=Ye(),a=Ye(),c=Ye();return Nu(t[2],Lv),Y8e(t[1],e),ff(n,t[1]),Yt(s,n,j8e),yd(n,n,t[2]),pd(s,t[2],s),ff(o,s),ff(a,o),Yt(c,a,o),Yt(r,c,n),Yt(r,r,s),X8e(r,r),Yt(r,r,n),Yt(r,r,s),Yt(r,r,s),Yt(t[0],r,s),ff(i,t[0]),Yt(i,i,s),XD(i,n)&&Yt(t[0],t[0],z8e),ff(i,t[0]),Yt(i,i,s),XD(i,n)?-1:(ZD(t[0])===e[31]>>7&&yd(t[0],Kx,t[0]),Yt(t[3],t[0],t[1]),0)}function Y8e(t,e){var r;for(r=0;r<16;++r)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function X8e(t,e){var r=Ye(),i;for(i=0;i<16;++i)r[i]=e[i];for(i=250;i>=0;--i)ff(r,r),i!==1&&Yt(r,r,e);for(i=0;i<16;++i)t[i]=r[i]}function XD(t,e){var r=new Kn(32),i=new Kn(32);return Uv(r,t),Uv(i,e),QD(r,0,i,0)}function QD(t,e,r,i){return Q8e(t,e,r,i,32)}function Q8e(t,e,r,i,n){var s,o=0;for(s=0;s<n;++s)o|=t[e+s]^r[i+s];return(1&o-1>>>8)-1}function ZD(t){var e=new Kn(32);return Uv(e,t),e[0]&1}function JD(t,e,r){var i,n;for(Nu(t[0],Kx),Nu(t[1],Lv),Nu(t[2],Lv),Nu(t[3],Kx),n=255;n>=0;--n)i=r[n/8|0]>>(n&7)&1,YD(t,e,i),zx(e,t),zx(t,t),YD(t,e,i)}function $x(t,e){var r=[Ye(),Ye(),Ye(),Ye()];Nu(r[0],$D),Nu(r[1],GD),Nu(r[2],Lv),Yt(r[3],$D,GD),JD(t,r,e)}function Nu(t,e){var r;for(r=0;r<16;r++)t[r]=e[r]|0}function Z8e(t,e){var r=Ye(),i;for(i=0;i<16;++i)r[i]=e[i];for(i=253;i>=0;--i)ff(r,r),i!==2&&i!==4&&Yt(r,r,e);for(i=0;i<16;++i)t[i]=r[i]}function Gx(t){var e,r,i=1;for(e=0;e<16;++e)r=t[e]+i+65535,i=Math.floor(r/65536),t[e]=r-i*65536;t[0]+=i-1+37*(i-1)}function e7(t,e,r){for(var i,n=~(r-1),s=0;s<16;++s)i=n&(t[s]^e[s]),t[s]^=i,e[s]^=i}function Ye(t){var e,r=new Float64Array(16);if(t)for(e=0;e<t.length;++e)r[e]=t[e];return r}function pd(t,e,r){for(var i=0;i<16;++i)t[i]=e[i]+r[i]}function yd(t,e,r){for(var i=0;i<16;++i)t[i]=e[i]-r[i]}function ff(t,e){Yt(t,e,e)}function Yt(t,e,r){var i,n,s=0,o=0,a=0,c=0,l=0,u=0,h=0,d=0,y=0,g=0,m=0,E=0,v=0,A=0,R=0,F=0,q=0,B=0,z=0,G=0,Y=0,P=0,b=0,w=0,S=0,C=0,D=0,W=0,j=0,M=0,_=0,L=r[0],ce=r[1],X=r[2],ne=r[3],oe=r[4],de=r[5],pe=r[6],_e=r[7],k=r[8],K=r[9],$=r[10],Z=r[11],I=r[12],U=r[13],V=r[14],N=r[15];i=e[0],s+=i*L,o+=i*ce,a+=i*X,c+=i*ne,l+=i*oe,u+=i*de,h+=i*pe,d+=i*_e,y+=i*k,g+=i*K,m+=i*$,E+=i*Z,v+=i*I,A+=i*U,R+=i*V,F+=i*N,i=e[1],o+=i*L,a+=i*ce,c+=i*X,l+=i*ne,u+=i*oe,h+=i*de,d+=i*pe,y+=i*_e,g+=i*k,m+=i*K,E+=i*$,v+=i*Z,A+=i*I,R+=i*U,F+=i*V,q+=i*N,i=e[2],a+=i*L,c+=i*ce,l+=i*X,u+=i*ne,h+=i*oe,d+=i*de,y+=i*pe,g+=i*_e,m+=i*k,E+=i*K,v+=i*$,A+=i*Z,R+=i*I,F+=i*U,q+=i*V,B+=i*N,i=e[3],c+=i*L,l+=i*ce,u+=i*X,h+=i*ne,d+=i*oe,y+=i*de,g+=i*pe,m+=i*_e,E+=i*k,v+=i*K,A+=i*$,R+=i*Z,F+=i*I,q+=i*U,B+=i*V,z+=i*N,i=e[4],l+=i*L,u+=i*ce,h+=i*X,d+=i*ne,y+=i*oe,g+=i*de,m+=i*pe,E+=i*_e,v+=i*k,A+=i*K,R+=i*$,F+=i*Z,q+=i*I,B+=i*U,z+=i*V,G+=i*N,i=e[5],u+=i*L,h+=i*ce,d+=i*X,y+=i*ne,g+=i*oe,m+=i*de,E+=i*pe,v+=i*_e,A+=i*k,R+=i*K,F+=i*$,q+=i*Z,B+=i*I,z+=i*U,G+=i*V,Y+=i*N,i=e[6],h+=i*L,d+=i*ce,y+=i*X,g+=i*ne,m+=i*oe,E+=i*de,v+=i*pe,A+=i*_e,R+=i*k,F+=i*K,q+=i*$,B+=i*Z,z+=i*I,G+=i*U,Y+=i*V,P+=i*N,i=e[7],d+=i*L,y+=i*ce,g+=i*X,m+=i*ne,E+=i*oe,v+=i*de,A+=i*pe,R+=i*_e,F+=i*k,q+=i*K,B+=i*$,z+=i*Z,G+=i*I,Y+=i*U,P+=i*V,b+=i*N,i=e[8],y+=i*L,g+=i*ce,m+=i*X,E+=i*ne,v+=i*oe,A+=i*de,R+=i*pe,F+=i*_e,q+=i*k,B+=i*K,z+=i*$,G+=i*Z,Y+=i*I,P+=i*U,b+=i*V,w+=i*N,i=e[9],g+=i*L,m+=i*ce,E+=i*X,v+=i*ne,A+=i*oe,R+=i*de,F+=i*pe,q+=i*_e,B+=i*k,z+=i*K,G+=i*$,Y+=i*Z,P+=i*I,b+=i*U,w+=i*V,S+=i*N,i=e[10],m+=i*L,E+=i*ce,v+=i*X,A+=i*ne,R+=i*oe,F+=i*de,q+=i*pe,B+=i*_e,z+=i*k,G+=i*K,Y+=i*$,P+=i*Z,b+=i*I,w+=i*U,S+=i*V,C+=i*N,i=e[11],E+=i*L,v+=i*ce,A+=i*X,R+=i*ne,F+=i*oe,q+=i*de,B+=i*pe,z+=i*_e,G+=i*k,Y+=i*K,P+=i*$,b+=i*Z,w+=i*I,S+=i*U,C+=i*V,D+=i*N,i=e[12],v+=i*L,A+=i*ce,R+=i*X,F+=i*ne,q+=i*oe,B+=i*de,z+=i*pe,G+=i*_e,Y+=i*k,P+=i*K,b+=i*$,w+=i*Z,S+=i*I,C+=i*U,D+=i*V,W+=i*N,i=e[13],A+=i*L,R+=i*ce,F+=i*X,q+=i*ne,B+=i*oe,z+=i*de,G+=i*pe,Y+=i*_e,P+=i*k,b+=i*K,w+=i*$,S+=i*Z,C+=i*I,D+=i*U,W+=i*V,j+=i*N,i=e[14],R+=i*L,F+=i*ce,q+=i*X,B+=i*ne,z+=i*oe,G+=i*de,Y+=i*pe,P+=i*_e,b+=i*k,w+=i*K,S+=i*$,C+=i*Z,D+=i*I,W+=i*U,j+=i*V,M+=i*N,i=e[15],F+=i*L,q+=i*ce,B+=i*X,z+=i*ne,G+=i*oe,Y+=i*de,P+=i*pe,b+=i*_e,w+=i*k,S+=i*K,C+=i*$,D+=i*Z,W+=i*I,j+=i*U,M+=i*V,_+=i*N,s+=38*q,o+=38*B,a+=38*z,c+=38*G,l+=38*Y,u+=38*P,h+=38*b,d+=38*w,y+=38*S,g+=38*C,m+=38*D,E+=38*W,v+=38*j,A+=38*M,R+=38*_,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),t[0]=s,t[1]=o,t[2]=a,t[3]=c,t[4]=l,t[5]=u,t[6]=h,t[7]=d,t[8]=y,t[9]=g,t[10]=m,t[11]=E,t[12]=v,t[13]=A,t[14]=R,t[15]=F}});var i7=p((RAt,r7)=>{f();"use strict";var Fv=65536;function J8e(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>Fv)for(;r<t;)r+Fv>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+Fv)),r+=Fv);else crypto.getRandomValues(e);return e}r7.exports=J8e});var fg=p((PAt,n7)=>{f();"use strict";var ePe=i7(),tPe=ae();n7.exports=function(t){if(isNaN(t)||t<=0)throw tPe(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return ePe(t)}});var Kv=p(hg=>{f();"use strict";Wt();sg();var rPe=lt(),iPe=ct(),s7=Je(),o7=un();hg.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=o7([new Uint8Array(e-r.length),r])}return s7(r,"base64url")};hg.base64urlToBigInteger=t=>{let e=hg.base64urlToBuffer(t);return new rPe.jsbn.BigInteger(s7(e,"base16"),16)};hg.base64urlToBuffer=(t,e)=>{let r=iPe(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=o7([new Uint8Array(e-r.length),r])}return r}});var u7=p(dg=>{f();"use strict";Ac();og();var Du=lt(),{bigIntegerToUintBase64url:Sa,base64urlToBigInteger:xa}=Kv(),a7=ct(),c7=Je();dg.pkcs1ToJwk=function(t){let e=Du.asn1.fromDer(c7(t,"ascii")),r=Du.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Sa(r.n),e:Sa(r.e),d:Sa(r.d),p:Sa(r.p),q:Sa(r.q),dp:Sa(r.dP),dq:Sa(r.dQ),qi:Sa(r.qInv),alg:"RS256",kid:"2011-04-29"}};dg.jwkToPkcs1=function(t){let e=Du.pki.privateKeyToAsn1({n:xa(t.n),e:xa(t.e),d:xa(t.d),p:xa(t.p),q:xa(t.q),dP:xa(t.dp),dQ:xa(t.dq),qInv:xa(t.qi)});return a7(Du.asn1.toDer(e).getBytes(),"ascii")};dg.pkixToJwk=function(t){let e=Du.asn1.fromDer(c7(t,"ascii")),r=Du.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Sa(r.n),e:Sa(r.e),alg:"RS256",kid:"2011-04-29"}};dg.jwkToPkix=function(t){let e=Du.pki.publicKeyToAsn1({n:xa(t.n),e:xa(t.e)});return a7(Du.asn1.toDer(e).getBytes(),"ascii")}});var d7=p((kAt,h7)=>{f();"use strict";og();var l7=lt(),{base64urlToBigInteger:nPe}=Kv();function f7(t,e){return e.map(r=>nPe(t[r]))}function sPe(t){return l7.pki.setRsaPrivateKey(...f7(t,["n","e","d","p","q","dp","dq","qi"]))}function oPe(t){return l7.pki.setRsaPublicKey(...f7(t,["n","e"]))}h7.exports={jwk2pub:oPe,jwk2priv:sPe}});var g7=p(kc=>{f();"use strict";var Oc=cg(),aPe=fg(),cPe=Je(),uPe=ct();kc.utils=u7();kc.generateKey=async function(t){let e=await Oc.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await p7(e);return{privateKey:r[0],publicKey:r[1]}};kc.unmarshalPrivateKey=async function(t){let r=[await Oc.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await lPe(t)],i=await p7({privateKey:r[0],publicKey:r[1]});return{privateKey:i[0],publicKey:i[1]}};kc.getRandomValues=aPe;kc.hashAndSign=async function(t,e){let r=await Oc.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await Oc.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};kc.hashAndVerify=async function(t,e,r){let i=await Oc.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Oc.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,r)};function p7(t){return Promise.all([Oc.get().subtle.exportKey("jwk",t.privateKey),Oc.get().subtle.exportKey("jwk",t.publicKey)])}function lPe(t){return Oc.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:fPe,jwk2priv:hPe}=d7();function y7(t,e,r,i){let n=e?fPe(t):hPe(t),s=cPe(Uint8Array.from(r),"ascii"),o=i(s,n);return uPe(o,"ascii")}kc.encrypt=function(t,e){return y7(t,!0,e,(r,i)=>i.encrypt(r))};kc.decrypt=function(t,e){return y7(t,!1,e,(r,i)=>i.decrypt(r))}});var jv=p((BAt,b7)=>{f();"use strict";var{base64:dPe}=(Qy(),id),pPe=Dx();b7.exports={export:async function(t,e){let i=await pPe.create().encrypt(t,e);return dPe.encode(i)}}});var E7=p((NAt,_7)=>{f();"use strict";var{sha256:m7}=(ai(),$r),v7=ae(),w7=yi(),yPe=Je();Mv();Wx();var Vv=lt(),Ps=g7(),zv=yv(),gPe=jv(),Hv=class{constructor(e){this._key=e}async verify(e,r){return Ps.hashAndVerify(this._key,r,e)}marshal(){return Ps.utils.jwkToPkix(this._key)}get bytes(){return zv.PublicKey.encode({Type:zv.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return Ps.encrypt(this._key,e)}equals(e){return w7(this.bytes,e.bytes)}async hash(){let{bytes:e}=await m7.digest(this.bytes);return e}},pg=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Ps.getRandomValues(16)}async sign(e){return Ps.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw v7(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Hv(this._publicKey)}decrypt(e){return Ps.decrypt(this._key,e)}marshal(){return Ps.utils.jwkToPkcs1(this._key)}get bytes(){return zv.PrivateKey.encode({Type:zv.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return w7(this.bytes,e.bytes)}async hash(){let{bytes:e}=await m7.digest(this.bytes);return e}async id(){let e=await this.public.hash();return yPe(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let i=new Vv.util.ByteBuffer(this.marshal()),n=Vv.asn1.fromDer(i),s=Vv.pki.privateKeyFromAsn1(n),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Vv.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return gPe.export(this.bytes,e);throw v7(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function bPe(t){let e=Ps.utils.pkcs1ToJwk(t),r=await Ps.unmarshalPrivateKey(e);return new pg(r.privateKey,r.publicKey)}function mPe(t){let e=Ps.utils.pkixToJwk(t);return new Hv(e)}async function vPe(t){let e=await Ps.unmarshalPrivateKey(t);return new pg(e.privateKey,e.publicKey)}async function wPe(t){let e=await Ps.generateKey(t);return new pg(e.privateKey,e.publicKey)}_7.exports={RsaPublicKey:Hv,RsaPrivateKey:pg,unmarshalRsaPublicKey:mPe,unmarshalRsaPrivateKey:bPe,generateKeyPair:wPe,fromJwk:vPe}});var S7=p(hf=>{f();"use strict";Wx();var gd=lt();hf.publicKeyLength=gd.pki.ed25519.constants.PUBLIC_KEY_BYTE_LENGTH;hf.privateKeyLength=gd.pki.ed25519.constants.PRIVATE_KEY_BYTE_LENGTH;hf.generateKey=async function(){return gd.pki.ed25519.generateKeyPair()};hf.generateKeyFromSeed=async function(t){return gd.pki.ed25519.generateKeyPair({seed:t})};hf.hashAndSign=async function(t,e){return gd.pki.ed25519.sign({message:e,privateKey:t})};hf.hashAndVerify=async function(t,e,r){return gd.pki.ed25519.verify({signature:e,message:r,publicKey:t})}});var R7=p((MAt,T7)=>{f();"use strict";var x7=ae(),A7=yi(),{sha256:I7}=(ai(),$r),{base58btc:_Pe}=(si(),ni),{identity:EPe}=(Pc(),Ea),ln=S7(),$v=yv(),SPe=jv(),Gv=class{constructor(e){this._key=md(e,ln.publicKeyLength)}async verify(e,r){return ln.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return $v.PublicKey.encode({Type:$v.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return A7(this.bytes,e.bytes)}async hash(){let{bytes:e}=await I7.digest(this.bytes);return e}},bd=class{constructor(e,r){this._key=md(e,ln.privateKeyLength),this._publicKey=md(r,ln.publicKeyLength)}async sign(e){return ln.hashAndSign(this._key,e)}get public(){return new Gv(this._publicKey)}marshal(){return this._key}get bytes(){return $v.PrivateKey.encode({Type:$v.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return A7(this.bytes,e.bytes)}async hash(){let{bytes:e}=await I7.digest(this.bytes);return e}async id(){let e=await EPe.digest(this.public.bytes);return _Pe.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return SPe.export(this.bytes,e);throw x7(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function xPe(t){if(t.length>ln.privateKeyLength){t=md(t,ln.privateKeyLength+ln.publicKeyLength);let i=t.slice(0,ln.privateKeyLength),n=t.slice(ln.privateKeyLength,t.length);return new bd(i,n)}t=md(t,ln.privateKeyLength);let e=t.slice(0,ln.privateKeyLength),r=t.slice(ln.publicKeyLength);return new bd(e,r)}function APe(t){return t=md(t,ln.publicKeyLength),new Gv(t)}async function IPe(){let{privateKey:t,publicKey:e}=await ln.generateKey();return new bd(t,e)}async function TPe(t){let{privateKey:e,publicKey:r}=await ln.generateKeyFromSeed(t);return new bd(e,r)}function md(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw x7(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}T7.exports={Ed25519PublicKey:Gv,Ed25519PrivateKey:bd,unmarshalEd25519PrivateKey:xPe,unmarshalEd25519PublicKey:APe,generateKeyPair:IPe,generateKeyPairFromSeed:TPe}});var C7=p((LAt,P7)=>{f();var Nt={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function Cs(t,e){if(!t)throw new Error(e)}function Pt(t,e,r){if(Cs(e instanceof Uint8Array,`Expected ${t} to be an Uint8Array`),r!==void 0)if(Array.isArray(r)){let i=r.join(", "),n=`Expected ${t} to be an Uint8Array with length [${i}]`;Cs(r.includes(e.length),n)}else{let i=`Expected ${t} to be an Uint8Array with length ${r}`;Cs(e.length===r,i)}}function df(t){Cs(vd(t)==="Boolean","Expected compressed to be a Boolean")}function vo(t=r=>new Uint8Array(r),e){return typeof t=="function"&&(t=t(e)),Pt("output",t,e),t}function vd(t){return Object.prototype.toString.call(t).slice(8,-1)}P7.exports=t=>({contextRandomize(e){switch(Cs(e===null||e instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),e!==null&&Pt("seed",e,32),t.contextRandomize(e)){case 1:throw new Error(Nt.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(e){return Pt("private key",e,32),t.privateKeyVerify(e)===0},privateKeyNegate(e){switch(Pt("private key",e,32),t.privateKeyNegate(e)){case 0:return e;case 1:throw new Error(Nt.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(e,r){switch(Pt("private key",e,32),Pt("tweak",r,32),t.privateKeyTweakAdd(e,r)){case 0:return e;case 1:throw new Error(Nt.TWEAK_ADD)}},privateKeyTweakMul(e,r){switch(Pt("private key",e,32),Pt("tweak",r,32),t.privateKeyTweakMul(e,r)){case 0:return e;case 1:throw new Error(Nt.TWEAK_MUL)}},publicKeyVerify(e){return Pt("public key",e,[33,65]),t.publicKeyVerify(e)===0},publicKeyCreate(e,r=!0,i){switch(Pt("private key",e,32),df(r),i=vo(i,r?33:65),t.publicKeyCreate(i,e)){case 0:return i;case 1:throw new Error(Nt.SECKEY_INVALID);case 2:throw new Error(Nt.PUBKEY_SERIALIZE)}},publicKeyConvert(e,r=!0,i){switch(Pt("public key",e,[33,65]),df(r),i=vo(i,r?33:65),t.publicKeyConvert(i,e)){case 0:return i;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.PUBKEY_SERIALIZE)}},publicKeyNegate(e,r=!0,i){switch(Pt("public key",e,[33,65]),df(r),i=vo(i,r?33:65),t.publicKeyNegate(i,e)){case 0:return i;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.IMPOSSIBLE_CASE);case 3:throw new Error(Nt.PUBKEY_SERIALIZE)}},publicKeyCombine(e,r=!0,i){Cs(Array.isArray(e),"Expected public keys to be an Array"),Cs(e.length>0,"Expected public keys array will have more than zero items");for(let n of e)Pt("public key",n,[33,65]);switch(df(r),i=vo(i,r?33:65),t.publicKeyCombine(i,e)){case 0:return i;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.PUBKEY_COMBINE);case 3:throw new Error(Nt.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(e,r,i=!0,n){switch(Pt("public key",e,[33,65]),Pt("tweak",r,32),df(i),n=vo(n,i?33:65),t.publicKeyTweakAdd(n,e,r)){case 0:return n;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.TWEAK_ADD)}},publicKeyTweakMul(e,r,i=!0,n){switch(Pt("public key",e,[33,65]),Pt("tweak",r,32),df(i),n=vo(n,i?33:65),t.publicKeyTweakMul(n,e,r)){case 0:return n;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.TWEAK_MUL)}},signatureNormalize(e){switch(Pt("signature",e,64),t.signatureNormalize(e)){case 0:return e;case 1:throw new Error(Nt.SIG_PARSE)}},signatureExport(e,r){Pt("signature",e,64),r=vo(r,72);let i={output:r,outputlen:72};switch(t.signatureExport(i,e)){case 0:return r.slice(0,i.outputlen);case 1:throw new Error(Nt.SIG_PARSE);case 2:throw new Error(Nt.IMPOSSIBLE_CASE)}},signatureImport(e,r){switch(Pt("signature",e),r=vo(r,64),t.signatureImport(r,e)){case 0:return r;case 1:throw new Error(Nt.SIG_PARSE);case 2:throw new Error(Nt.IMPOSSIBLE_CASE)}},ecdsaSign(e,r,i={},n){Pt("message",e,32),Pt("private key",r,32),Cs(vd(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Pt("options.data",i.data),i.noncefn!==void 0&&Cs(vd(i.noncefn)==="Function","Expected options.noncefn to be a Function"),n=vo(n,64);let s={signature:n,recid:null};switch(t.ecdsaSign(s,e,r,i.data,i.noncefn)){case 0:return s;case 1:throw new Error(Nt.SIGN);case 2:throw new Error(Nt.IMPOSSIBLE_CASE)}},ecdsaVerify(e,r,i){switch(Pt("signature",e,64),Pt("message",r,32),Pt("public key",i,[33,65]),t.ecdsaVerify(e,r,i)){case 0:return!0;case 3:return!1;case 1:throw new Error(Nt.SIG_PARSE);case 2:throw new Error(Nt.PUBKEY_PARSE)}},ecdsaRecover(e,r,i,n=!0,s){switch(Pt("signature",e,64),Cs(vd(r)==="Number"&&r>=0&&r<=3,"Expected recovery id to be a Number within interval [0, 3]"),Pt("message",i,32),df(n),s=vo(s,n?33:65),t.ecdsaRecover(s,e,r,i)){case 0:return s;case 1:throw new Error(Nt.SIG_PARSE);case 2:throw new Error(Nt.RECOVER);case 3:throw new Error(Nt.IMPOSSIBLE_CASE)}},ecdh(e,r,i={},n){switch(Pt("public key",e,[33,65]),Pt("private key",r,32),Cs(vd(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Pt("options.data",i.data),i.hashfn!==void 0?(Cs(vd(i.hashfn)==="Function","Expected options.hashfn to be a Function"),i.xbuf!==void 0&&Pt("options.xbuf",i.xbuf,32),i.ybuf!==void 0&&Pt("options.ybuf",i.ybuf,32),Pt("output",n)):n=vo(n,32),t.ecdh(n,e,r,i.data,i.hashfn,i.xbuf,i.ybuf)){case 0:return n;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.ECDH)}}})});var O7=p((UAt,RPe)=>{RPe.exports={_from:"elliptic@^6.5.2",_id:"elliptic@6.5.4",_inBundle:!1,_integrity:"sha512-iLhC6ULemrljPZb+QutR5TQGB+pdW6KGD5RSegS+8sorOZT+rdQFbsQFJgvN3eRqNALqJer4oQ16YvJHlU8hzQ==",_location:"/elliptic",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"elliptic@^6.5.2",name:"elliptic",escapedName:"elliptic",rawSpec:"^6.5.2",saveSpec:null,fetchSpec:"^6.5.2"},_requiredBy:["/secp256k1"],_resolved:"https://registry.npmjs.org/elliptic/-/elliptic-6.5.4.tgz",_shasum:"da37cebd31e79a1367e941b592ed1fbebd58abbb",_spec:"elliptic@^6.5.2",_where:"/Users/alex/Documents/Workspaces/ipfs/js-ipfs/node_modules/secp256k1",author:{name:"Fedor Indutny",email:"fedor@indutny.com"},bugs:{url:"https://github.com/indutny/elliptic/issues"},bundleDependencies:!1,dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},deprecated:!1,description:"EC cryptography",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},files:["lib"],homepage:"https://github.com/indutny/elliptic",keywords:["EC","Elliptic","curve","Cryptography"],license:"MIT",main:"lib/elliptic.js",name:"elliptic",repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/index.js",version:"grunt dist && git add dist/"},version:"6.5.4"}});var k7=p(()=>{f()});var Aa=p((q7,Yx)=>{f();(function(t,e){"use strict";function r(P,b){if(!P)throw new Error(b||"Assertion failed")}function i(P,b){P.super_=b;var w=function(){};w.prototype=b.prototype,P.prototype=new w,P.prototype.constructor=P}function n(P,b,w){if(n.isBN(P))return P;this.negative=0,this.words=null,this.length=0,this.red=null,P!==null&&((b==="le"||b==="be")&&(w=b,b=10),this._init(P||0,b||10,w||"be"))}typeof t=="object"?t.exports=n:e.BN=n,n.BN=n,n.wordSize=26;var s;try{typeof window!="undefined"&&typeof window.Buffer!="undefined"?s=window.Buffer:s=k7().Buffer}catch(P){}n.isBN=function(b){return b instanceof n?!0:b!==null&&typeof b=="object"&&b.constructor.wordSize===n.wordSize&&Array.isArray(b.words)},n.max=function(b,w){return b.cmp(w)>0?b:w},n.min=function(b,w){return b.cmp(w)<0?b:w},n.prototype._init=function(b,w,S){if(typeof b=="number")return this._initNumber(b,w,S);if(typeof b=="object")return this._initArray(b,w,S);w==="hex"&&(w=16),r(w===(w|0)&&w>=2&&w<=36),b=b.toString().replace(/\s+/g,"");var C=0;b[0]==="-"&&(C++,this.negative=1),C<b.length&&(w===16?this._parseHex(b,C,S):(this._parseBase(b,w,C),S==="le"&&this._initArray(this.toArray(),w,S)))},n.prototype._initNumber=function(b,w,S){b<0&&(this.negative=1,b=-b),b<67108864?(this.words=[b&67108863],this.length=1):b<4503599627370496?(this.words=[b&67108863,b/67108864&67108863],this.length=2):(r(b<9007199254740992),this.words=[b&67108863,b/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),w,S)},n.prototype._initArray=function(b,w,S){if(r(typeof b.length=="number"),b.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(b.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var D,W,j=0;if(S==="be")for(C=b.length-1,D=0;C>=0;C-=3)W=b[C]|b[C-1]<<8|b[C-2]<<16,this.words[D]|=W<<j&67108863,this.words[D+1]=W>>>26-j&67108863,j+=24,j>=26&&(j-=26,D++);else if(S==="le")for(C=0,D=0;C<b.length;C+=3)W=b[C]|b[C+1]<<8|b[C+2]<<16,this.words[D]|=W<<j&67108863,this.words[D+1]=W>>>26-j&67108863,j+=24,j>=26&&(j-=26,D++);return this.strip()};function o(P,b){var w=P.charCodeAt(b);return w>=65&&w<=70?w-55:w>=97&&w<=102?w-87:w-48&15}function a(P,b,w){var S=o(P,w);return w-1>=b&&(S|=o(P,w-1)<<4),S}n.prototype._parseHex=function(b,w,S){this.length=Math.ceil((b.length-w)/6),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var D=0,W=0,j;if(S==="be")for(C=b.length-1;C>=w;C-=2)j=a(b,w,C)<<D,this.words[W]|=j&67108863,D>=18?(D-=18,W+=1,this.words[W]|=j>>>26):D+=8;else{var M=b.length-w;for(C=M%2==0?w+1:w;C<b.length;C+=2)j=a(b,w,C)<<D,this.words[W]|=j&67108863,D>=18?(D-=18,W+=1,this.words[W]|=j>>>26):D+=8}this.strip()};function c(P,b,w,S){for(var C=0,D=Math.min(P.length,w),W=b;W<D;W++){var j=P.charCodeAt(W)-48;C*=S,j>=49?C+=j-49+10:j>=17?C+=j-17+10:C+=j}return C}n.prototype._parseBase=function(b,w,S){this.words=[0],this.length=1;for(var C=0,D=1;D<=67108863;D*=w)C++;C--,D=D/w|0;for(var W=b.length-S,j=W%C,M=Math.min(W,W-j)+S,_=0,L=S;L<M;L+=C)_=c(b,L,L+C,w),this.imuln(D),this.words[0]+_<67108864?this.words[0]+=_:this._iaddn(_);if(j!==0){var ce=1;for(_=c(b,L,b.length,w),L=0;L<j;L++)ce*=w;this.imuln(ce),this.words[0]+_<67108864?this.words[0]+=_:this._iaddn(_)}this.strip()},n.prototype.copy=function(b){b.words=new Array(this.length);for(var w=0;w<this.length;w++)b.words[w]=this.words[w];b.length=this.length,b.negative=this.negative,b.red=this.red},n.prototype.clone=function(){var b=new n(null);return this.copy(b),b},n.prototype._expand=function(b){for(;this.length<b;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(b,w){b=b||10,w=w|0||1;var S;if(b===16||b==="hex"){S="";for(var C=0,D=0,W=0;W<this.length;W++){var j=this.words[W],M=((j<<C|D)&16777215).toString(16);D=j>>>24-C&16777215,D!==0||W!==this.length-1?S=l[6-M.length]+M+S:S=M+S,C+=2,C>=26&&(C-=26,W--)}for(D!==0&&(S=D.toString(16)+S);S.length%w!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(b===(b|0)&&b>=2&&b<=36){var _=u[b],L=h[b];S="";var ce=this.clone();for(ce.negative=0;!ce.isZero();){var X=ce.modn(L).toString(b);ce=ce.idivn(L),ce.isZero()?S=X+S:S=l[_-X.length]+X+S}for(this.isZero()&&(S="0"+S);S.length%w!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}r(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var b=this.words[0];return this.length===2?b+=this.words[1]*67108864:this.length===3&&this.words[2]===1?b+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-b:b},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(b,w){return r(typeof s!="undefined"),this.toArrayLike(s,b,w)},n.prototype.toArray=function(b,w){return this.toArrayLike(Array,b,w)},n.prototype.toArrayLike=function(b,w,S){var C=this.byteLength(),D=S||Math.max(1,C);r(C<=D,"byte array longer than desired length"),r(D>0,"Requested array length <= 0"),this.strip();var W=w==="le",j=new b(D),M,_,L=this.clone();if(W){for(_=0;!L.isZero();_++)M=L.andln(255),L.iushrn(8),j[_]=M;for(;_<D;_++)j[_]=0}else{for(_=0;_<D-C;_++)j[_]=0;for(_=0;!L.isZero();_++)M=L.andln(255),L.iushrn(8),j[D-_-1]=M}return j},Math.clz32?n.prototype._countBits=function(b){return 32-Math.clz32(b)}:n.prototype._countBits=function(b){var w=b,S=0;return w>=4096&&(S+=13,w>>>=13),w>=64&&(S+=7,w>>>=7),w>=8&&(S+=4,w>>>=4),w>=2&&(S+=2,w>>>=2),S+w},n.prototype._zeroBits=function(b){if(b===0)return 26;var w=b,S=0;return(w&8191)==0&&(S+=13,w>>>=13),(w&127)==0&&(S+=7,w>>>=7),(w&15)==0&&(S+=4,w>>>=4),(w&3)==0&&(S+=2,w>>>=2),(w&1)==0&&S++,S},n.prototype.bitLength=function(){var b=this.words[this.length-1],w=this._countBits(b);return(this.length-1)*26+w};function d(P){for(var b=new Array(P.bitLength()),w=0;w<b.length;w++){var S=w/26|0,C=w%26;b[w]=(P.words[S]&1<<C)>>>C}return b}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var b=0,w=0;w<this.length;w++){var S=this._zeroBits(this.words[w]);if(b+=S,S!==26)break}return b},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(b){return this.negative!==0?this.abs().inotn(b).iaddn(1):this.clone()},n.prototype.fromTwos=function(b){return this.testn(b-1)?this.notn(b).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(b){for(;this.length<b.length;)this.words[this.length++]=0;for(var w=0;w<b.length;w++)this.words[w]=this.words[w]|b.words[w];return this.strip()},n.prototype.ior=function(b){return r((this.negative|b.negative)==0),this.iuor(b)},n.prototype.or=function(b){return this.length>b.length?this.clone().ior(b):b.clone().ior(this)},n.prototype.uor=function(b){return this.length>b.length?this.clone().iuor(b):b.clone().iuor(this)},n.prototype.iuand=function(b){var w;this.length>b.length?w=b:w=this;for(var S=0;S<w.length;S++)this.words[S]=this.words[S]&b.words[S];return this.length=w.length,this.strip()},n.prototype.iand=function(b){return r((this.negative|b.negative)==0),this.iuand(b)},n.prototype.and=function(b){return this.length>b.length?this.clone().iand(b):b.clone().iand(this)},n.prototype.uand=function(b){return this.length>b.length?this.clone().iuand(b):b.clone().iuand(this)},n.prototype.iuxor=function(b){var w,S;this.length>b.length?(w=this,S=b):(w=b,S=this);for(var C=0;C<S.length;C++)this.words[C]=w.words[C]^S.words[C];if(this!==w)for(;C<w.length;C++)this.words[C]=w.words[C];return this.length=w.length,this.strip()},n.prototype.ixor=function(b){return r((this.negative|b.negative)==0),this.iuxor(b)},n.prototype.xor=function(b){return this.length>b.length?this.clone().ixor(b):b.clone().ixor(this)},n.prototype.uxor=function(b){return this.length>b.length?this.clone().iuxor(b):b.clone().iuxor(this)},n.prototype.inotn=function(b){r(typeof b=="number"&&b>=0);var w=Math.ceil(b/26)|0,S=b%26;this._expand(w),S>0&&w--;for(var C=0;C<w;C++)this.words[C]=~this.words[C]&67108863;return S>0&&(this.words[C]=~this.words[C]&67108863>>26-S),this.strip()},n.prototype.notn=function(b){return this.clone().inotn(b)},n.prototype.setn=function(b,w){r(typeof b=="number"&&b>=0);var S=b/26|0,C=b%26;return this._expand(S+1),w?this.words[S]=this.words[S]|1<<C:this.words[S]=this.words[S]&~(1<<C),this.strip()},n.prototype.iadd=function(b){var w;if(this.negative!==0&&b.negative===0)return this.negative=0,w=this.isub(b),this.negative^=1,this._normSign();if(this.negative===0&&b.negative!==0)return b.negative=0,w=this.isub(b),b.negative=1,w._normSign();var S,C;this.length>b.length?(S=this,C=b):(S=b,C=this);for(var D=0,W=0;W<C.length;W++)w=(S.words[W]|0)+(C.words[W]|0)+D,this.words[W]=w&67108863,D=w>>>26;for(;D!==0&&W<S.length;W++)w=(S.words[W]|0)+D,this.words[W]=w&67108863,D=w>>>26;if(this.length=S.length,D!==0)this.words[this.length]=D,this.length++;else if(S!==this)for(;W<S.length;W++)this.words[W]=S.words[W];return this},n.prototype.add=function(b){var w;return b.negative!==0&&this.negative===0?(b.negative=0,w=this.sub(b),b.negative^=1,w):b.negative===0&&this.negative!==0?(this.negative=0,w=b.sub(this),this.negative=1,w):this.length>b.length?this.clone().iadd(b):b.clone().iadd(this)},n.prototype.isub=function(b){if(b.negative!==0){b.negative=0;var w=this.iadd(b);return b.negative=1,w._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(b),this.negative=1,this._normSign();var S=this.cmp(b);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;var C,D;S>0?(C=this,D=b):(C=b,D=this);for(var W=0,j=0;j<D.length;j++)w=(C.words[j]|0)-(D.words[j]|0)+W,W=w>>26,this.words[j]=w&67108863;for(;W!==0&&j<C.length;j++)w=(C.words[j]|0)+W,W=w>>26,this.words[j]=w&67108863;if(W===0&&j<C.length&&C!==this)for(;j<C.length;j++)this.words[j]=C.words[j];return this.length=Math.max(this.length,j),C!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(b){return this.clone().isub(b)};function y(P,b,w){w.negative=b.negative^P.negative;var S=P.length+b.length|0;w.length=S,S=S-1|0;var C=P.words[0]|0,D=b.words[0]|0,W=C*D,j=W&67108863,M=W/67108864|0;w.words[0]=j;for(var _=1;_<S;_++){for(var L=M>>>26,ce=M&67108863,X=Math.min(_,b.length-1),ne=Math.max(0,_-P.length+1);ne<=X;ne++){var oe=_-ne|0;C=P.words[oe]|0,D=b.words[ne]|0,W=C*D+ce,L+=W/67108864|0,ce=W&67108863}w.words[_]=ce|0,M=L|0}return M!==0?w.words[_]=M|0:w.length--,w.strip()}var g=function(b,w,S){var C=b.words,D=w.words,W=S.words,j=0,M,_,L,ce=C[0]|0,X=ce&8191,ne=ce>>>13,oe=C[1]|0,de=oe&8191,pe=oe>>>13,_e=C[2]|0,k=_e&8191,K=_e>>>13,$=C[3]|0,Z=$&8191,I=$>>>13,U=C[4]|0,V=U&8191,N=U>>>13,Q=C[5]|0,ee=Q&8191,J=Q>>>13,ue=C[6]|0,ge=ue&8191,be=ue>>>13,Ke=C[7]|0,Te=Ke&8191,je=Ke>>>13,Ze=C[8]|0,ze=Ze&8191,Ve=Ze>>>13,pt=C[9]|0,Ht=pt&8191,er=pt>>>13,En=D[0]|0,Kt=En&8191,Et=En>>>13,ri=D[1]|0,it=ri&8191,Rr=ri>>>13,Bm=D[2]|0,Cr=Bm&8191,Or=Bm>>>13,Nm=D[3]|0,kr=Nm&8191,qr=Nm>>>13,Dm=D[4]|0,Br=Dm&8191,Nr=Dm>>>13,Mm=D[5]|0,Dr=Mm&8191,Mr=Mm>>>13,Lm=D[6]|0,Lr=Lm&8191,Ur=Lm>>>13,Um=D[7]|0,Fr=Um&8191,Kr=Um>>>13,Fm=D[8]|0,jr=Fm&8191,Vr=Fm>>>13,Km=D[9]|0,zr=Km&8191,tr=Km>>>13;S.negative=b.negative^w.negative,S.length=19,M=Math.imul(X,Kt),_=Math.imul(X,Et),_=_+Math.imul(ne,Kt)|0,L=Math.imul(ne,Et);var zh=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(zh>>>26)|0,zh&=67108863,M=Math.imul(de,Kt),_=Math.imul(de,Et),_=_+Math.imul(pe,Kt)|0,L=Math.imul(pe,Et),M=M+Math.imul(X,it)|0,_=_+Math.imul(X,Rr)|0,_=_+Math.imul(ne,it)|0,L=L+Math.imul(ne,Rr)|0;var Ay=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ay>>>26)|0,Ay&=67108863,M=Math.imul(k,Kt),_=Math.imul(k,Et),_=_+Math.imul(K,Kt)|0,L=Math.imul(K,Et),M=M+Math.imul(de,it)|0,_=_+Math.imul(de,Rr)|0,_=_+Math.imul(pe,it)|0,L=L+Math.imul(pe,Rr)|0,M=M+Math.imul(X,Cr)|0,_=_+Math.imul(X,Or)|0,_=_+Math.imul(ne,Cr)|0,L=L+Math.imul(ne,Or)|0;var Iy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Iy>>>26)|0,Iy&=67108863,M=Math.imul(Z,Kt),_=Math.imul(Z,Et),_=_+Math.imul(I,Kt)|0,L=Math.imul(I,Et),M=M+Math.imul(k,it)|0,_=_+Math.imul(k,Rr)|0,_=_+Math.imul(K,it)|0,L=L+Math.imul(K,Rr)|0,M=M+Math.imul(de,Cr)|0,_=_+Math.imul(de,Or)|0,_=_+Math.imul(pe,Cr)|0,L=L+Math.imul(pe,Or)|0,M=M+Math.imul(X,kr)|0,_=_+Math.imul(X,qr)|0,_=_+Math.imul(ne,kr)|0,L=L+Math.imul(ne,qr)|0;var Ty=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ty>>>26)|0,Ty&=67108863,M=Math.imul(V,Kt),_=Math.imul(V,Et),_=_+Math.imul(N,Kt)|0,L=Math.imul(N,Et),M=M+Math.imul(Z,it)|0,_=_+Math.imul(Z,Rr)|0,_=_+Math.imul(I,it)|0,L=L+Math.imul(I,Rr)|0,M=M+Math.imul(k,Cr)|0,_=_+Math.imul(k,Or)|0,_=_+Math.imul(K,Cr)|0,L=L+Math.imul(K,Or)|0,M=M+Math.imul(de,kr)|0,_=_+Math.imul(de,qr)|0,_=_+Math.imul(pe,kr)|0,L=L+Math.imul(pe,qr)|0,M=M+Math.imul(X,Br)|0,_=_+Math.imul(X,Nr)|0,_=_+Math.imul(ne,Br)|0,L=L+Math.imul(ne,Nr)|0;var Ry=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ry>>>26)|0,Ry&=67108863,M=Math.imul(ee,Kt),_=Math.imul(ee,Et),_=_+Math.imul(J,Kt)|0,L=Math.imul(J,Et),M=M+Math.imul(V,it)|0,_=_+Math.imul(V,Rr)|0,_=_+Math.imul(N,it)|0,L=L+Math.imul(N,Rr)|0,M=M+Math.imul(Z,Cr)|0,_=_+Math.imul(Z,Or)|0,_=_+Math.imul(I,Cr)|0,L=L+Math.imul(I,Or)|0,M=M+Math.imul(k,kr)|0,_=_+Math.imul(k,qr)|0,_=_+Math.imul(K,kr)|0,L=L+Math.imul(K,qr)|0,M=M+Math.imul(de,Br)|0,_=_+Math.imul(de,Nr)|0,_=_+Math.imul(pe,Br)|0,L=L+Math.imul(pe,Nr)|0,M=M+Math.imul(X,Dr)|0,_=_+Math.imul(X,Mr)|0,_=_+Math.imul(ne,Dr)|0,L=L+Math.imul(ne,Mr)|0;var Py=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Py>>>26)|0,Py&=67108863,M=Math.imul(ge,Kt),_=Math.imul(ge,Et),_=_+Math.imul(be,Kt)|0,L=Math.imul(be,Et),M=M+Math.imul(ee,it)|0,_=_+Math.imul(ee,Rr)|0,_=_+Math.imul(J,it)|0,L=L+Math.imul(J,Rr)|0,M=M+Math.imul(V,Cr)|0,_=_+Math.imul(V,Or)|0,_=_+Math.imul(N,Cr)|0,L=L+Math.imul(N,Or)|0,M=M+Math.imul(Z,kr)|0,_=_+Math.imul(Z,qr)|0,_=_+Math.imul(I,kr)|0,L=L+Math.imul(I,qr)|0,M=M+Math.imul(k,Br)|0,_=_+Math.imul(k,Nr)|0,_=_+Math.imul(K,Br)|0,L=L+Math.imul(K,Nr)|0,M=M+Math.imul(de,Dr)|0,_=_+Math.imul(de,Mr)|0,_=_+Math.imul(pe,Dr)|0,L=L+Math.imul(pe,Mr)|0,M=M+Math.imul(X,Lr)|0,_=_+Math.imul(X,Ur)|0,_=_+Math.imul(ne,Lr)|0,L=L+Math.imul(ne,Ur)|0;var uo=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(uo>>>26)|0,uo&=67108863,M=Math.imul(Te,Kt),_=Math.imul(Te,Et),_=_+Math.imul(je,Kt)|0,L=Math.imul(je,Et),M=M+Math.imul(ge,it)|0,_=_+Math.imul(ge,Rr)|0,_=_+Math.imul(be,it)|0,L=L+Math.imul(be,Rr)|0,M=M+Math.imul(ee,Cr)|0,_=_+Math.imul(ee,Or)|0,_=_+Math.imul(J,Cr)|0,L=L+Math.imul(J,Or)|0,M=M+Math.imul(V,kr)|0,_=_+Math.imul(V,qr)|0,_=_+Math.imul(N,kr)|0,L=L+Math.imul(N,qr)|0,M=M+Math.imul(Z,Br)|0,_=_+Math.imul(Z,Nr)|0,_=_+Math.imul(I,Br)|0,L=L+Math.imul(I,Nr)|0,M=M+Math.imul(k,Dr)|0,_=_+Math.imul(k,Mr)|0,_=_+Math.imul(K,Dr)|0,L=L+Math.imul(K,Mr)|0,M=M+Math.imul(de,Lr)|0,_=_+Math.imul(de,Ur)|0,_=_+Math.imul(pe,Lr)|0,L=L+Math.imul(pe,Ur)|0,M=M+Math.imul(X,Fr)|0,_=_+Math.imul(X,Kr)|0,_=_+Math.imul(ne,Fr)|0,L=L+Math.imul(ne,Kr)|0;var Cy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Cy>>>26)|0,Cy&=67108863,M=Math.imul(ze,Kt),_=Math.imul(ze,Et),_=_+Math.imul(Ve,Kt)|0,L=Math.imul(Ve,Et),M=M+Math.imul(Te,it)|0,_=_+Math.imul(Te,Rr)|0,_=_+Math.imul(je,it)|0,L=L+Math.imul(je,Rr)|0,M=M+Math.imul(ge,Cr)|0,_=_+Math.imul(ge,Or)|0,_=_+Math.imul(be,Cr)|0,L=L+Math.imul(be,Or)|0,M=M+Math.imul(ee,kr)|0,_=_+Math.imul(ee,qr)|0,_=_+Math.imul(J,kr)|0,L=L+Math.imul(J,qr)|0,M=M+Math.imul(V,Br)|0,_=_+Math.imul(V,Nr)|0,_=_+Math.imul(N,Br)|0,L=L+Math.imul(N,Nr)|0,M=M+Math.imul(Z,Dr)|0,_=_+Math.imul(Z,Mr)|0,_=_+Math.imul(I,Dr)|0,L=L+Math.imul(I,Mr)|0,M=M+Math.imul(k,Lr)|0,_=_+Math.imul(k,Ur)|0,_=_+Math.imul(K,Lr)|0,L=L+Math.imul(K,Ur)|0,M=M+Math.imul(de,Fr)|0,_=_+Math.imul(de,Kr)|0,_=_+Math.imul(pe,Fr)|0,L=L+Math.imul(pe,Kr)|0,M=M+Math.imul(X,jr)|0,_=_+Math.imul(X,Vr)|0,_=_+Math.imul(ne,jr)|0,L=L+Math.imul(ne,Vr)|0;var Oy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Oy>>>26)|0,Oy&=67108863,M=Math.imul(Ht,Kt),_=Math.imul(Ht,Et),_=_+Math.imul(er,Kt)|0,L=Math.imul(er,Et),M=M+Math.imul(ze,it)|0,_=_+Math.imul(ze,Rr)|0,_=_+Math.imul(Ve,it)|0,L=L+Math.imul(Ve,Rr)|0,M=M+Math.imul(Te,Cr)|0,_=_+Math.imul(Te,Or)|0,_=_+Math.imul(je,Cr)|0,L=L+Math.imul(je,Or)|0,M=M+Math.imul(ge,kr)|0,_=_+Math.imul(ge,qr)|0,_=_+Math.imul(be,kr)|0,L=L+Math.imul(be,qr)|0,M=M+Math.imul(ee,Br)|0,_=_+Math.imul(ee,Nr)|0,_=_+Math.imul(J,Br)|0,L=L+Math.imul(J,Nr)|0,M=M+Math.imul(V,Dr)|0,_=_+Math.imul(V,Mr)|0,_=_+Math.imul(N,Dr)|0,L=L+Math.imul(N,Mr)|0,M=M+Math.imul(Z,Lr)|0,_=_+Math.imul(Z,Ur)|0,_=_+Math.imul(I,Lr)|0,L=L+Math.imul(I,Ur)|0,M=M+Math.imul(k,Fr)|0,_=_+Math.imul(k,Kr)|0,_=_+Math.imul(K,Fr)|0,L=L+Math.imul(K,Kr)|0,M=M+Math.imul(de,jr)|0,_=_+Math.imul(de,Vr)|0,_=_+Math.imul(pe,jr)|0,L=L+Math.imul(pe,Vr)|0,M=M+Math.imul(X,zr)|0,_=_+Math.imul(X,tr)|0,_=_+Math.imul(ne,zr)|0,L=L+Math.imul(ne,tr)|0;var ky=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(ky>>>26)|0,ky&=67108863,M=Math.imul(Ht,it),_=Math.imul(Ht,Rr),_=_+Math.imul(er,it)|0,L=Math.imul(er,Rr),M=M+Math.imul(ze,Cr)|0,_=_+Math.imul(ze,Or)|0,_=_+Math.imul(Ve,Cr)|0,L=L+Math.imul(Ve,Or)|0,M=M+Math.imul(Te,kr)|0,_=_+Math.imul(Te,qr)|0,_=_+Math.imul(je,kr)|0,L=L+Math.imul(je,qr)|0,M=M+Math.imul(ge,Br)|0,_=_+Math.imul(ge,Nr)|0,_=_+Math.imul(be,Br)|0,L=L+Math.imul(be,Nr)|0,M=M+Math.imul(ee,Dr)|0,_=_+Math.imul(ee,Mr)|0,_=_+Math.imul(J,Dr)|0,L=L+Math.imul(J,Mr)|0,M=M+Math.imul(V,Lr)|0,_=_+Math.imul(V,Ur)|0,_=_+Math.imul(N,Lr)|0,L=L+Math.imul(N,Ur)|0,M=M+Math.imul(Z,Fr)|0,_=_+Math.imul(Z,Kr)|0,_=_+Math.imul(I,Fr)|0,L=L+Math.imul(I,Kr)|0,M=M+Math.imul(k,jr)|0,_=_+Math.imul(k,Vr)|0,_=_+Math.imul(K,jr)|0,L=L+Math.imul(K,Vr)|0,M=M+Math.imul(de,zr)|0,_=_+Math.imul(de,tr)|0,_=_+Math.imul(pe,zr)|0,L=L+Math.imul(pe,tr)|0;var qy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(qy>>>26)|0,qy&=67108863,M=Math.imul(Ht,Cr),_=Math.imul(Ht,Or),_=_+Math.imul(er,Cr)|0,L=Math.imul(er,Or),M=M+Math.imul(ze,kr)|0,_=_+Math.imul(ze,qr)|0,_=_+Math.imul(Ve,kr)|0,L=L+Math.imul(Ve,qr)|0,M=M+Math.imul(Te,Br)|0,_=_+Math.imul(Te,Nr)|0,_=_+Math.imul(je,Br)|0,L=L+Math.imul(je,Nr)|0,M=M+Math.imul(ge,Dr)|0,_=_+Math.imul(ge,Mr)|0,_=_+Math.imul(be,Dr)|0,L=L+Math.imul(be,Mr)|0,M=M+Math.imul(ee,Lr)|0,_=_+Math.imul(ee,Ur)|0,_=_+Math.imul(J,Lr)|0,L=L+Math.imul(J,Ur)|0,M=M+Math.imul(V,Fr)|0,_=_+Math.imul(V,Kr)|0,_=_+Math.imul(N,Fr)|0,L=L+Math.imul(N,Kr)|0,M=M+Math.imul(Z,jr)|0,_=_+Math.imul(Z,Vr)|0,_=_+Math.imul(I,jr)|0,L=L+Math.imul(I,Vr)|0,M=M+Math.imul(k,zr)|0,_=_+Math.imul(k,tr)|0,_=_+Math.imul(K,zr)|0,L=L+Math.imul(K,tr)|0;var By=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(By>>>26)|0,By&=67108863,M=Math.imul(Ht,kr),_=Math.imul(Ht,qr),_=_+Math.imul(er,kr)|0,L=Math.imul(er,qr),M=M+Math.imul(ze,Br)|0,_=_+Math.imul(ze,Nr)|0,_=_+Math.imul(Ve,Br)|0,L=L+Math.imul(Ve,Nr)|0,M=M+Math.imul(Te,Dr)|0,_=_+Math.imul(Te,Mr)|0,_=_+Math.imul(je,Dr)|0,L=L+Math.imul(je,Mr)|0,M=M+Math.imul(ge,Lr)|0,_=_+Math.imul(ge,Ur)|0,_=_+Math.imul(be,Lr)|0,L=L+Math.imul(be,Ur)|0,M=M+Math.imul(ee,Fr)|0,_=_+Math.imul(ee,Kr)|0,_=_+Math.imul(J,Fr)|0,L=L+Math.imul(J,Kr)|0,M=M+Math.imul(V,jr)|0,_=_+Math.imul(V,Vr)|0,_=_+Math.imul(N,jr)|0,L=L+Math.imul(N,Vr)|0,M=M+Math.imul(Z,zr)|0,_=_+Math.imul(Z,tr)|0,_=_+Math.imul(I,zr)|0,L=L+Math.imul(I,tr)|0;var Ny=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ny>>>26)|0,Ny&=67108863,M=Math.imul(Ht,Br),_=Math.imul(Ht,Nr),_=_+Math.imul(er,Br)|0,L=Math.imul(er,Nr),M=M+Math.imul(ze,Dr)|0,_=_+Math.imul(ze,Mr)|0,_=_+Math.imul(Ve,Dr)|0,L=L+Math.imul(Ve,Mr)|0,M=M+Math.imul(Te,Lr)|0,_=_+Math.imul(Te,Ur)|0,_=_+Math.imul(je,Lr)|0,L=L+Math.imul(je,Ur)|0,M=M+Math.imul(ge,Fr)|0,_=_+Math.imul(ge,Kr)|0,_=_+Math.imul(be,Fr)|0,L=L+Math.imul(be,Kr)|0,M=M+Math.imul(ee,jr)|0,_=_+Math.imul(ee,Vr)|0,_=_+Math.imul(J,jr)|0,L=L+Math.imul(J,Vr)|0,M=M+Math.imul(V,zr)|0,_=_+Math.imul(V,tr)|0,_=_+Math.imul(N,zr)|0,L=L+Math.imul(N,tr)|0;var Dy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Dy>>>26)|0,Dy&=67108863,M=Math.imul(Ht,Dr),_=Math.imul(Ht,Mr),_=_+Math.imul(er,Dr)|0,L=Math.imul(er,Mr),M=M+Math.imul(ze,Lr)|0,_=_+Math.imul(ze,Ur)|0,_=_+Math.imul(Ve,Lr)|0,L=L+Math.imul(Ve,Ur)|0,M=M+Math.imul(Te,Fr)|0,_=_+Math.imul(Te,Kr)|0,_=_+Math.imul(je,Fr)|0,L=L+Math.imul(je,Kr)|0,M=M+Math.imul(ge,jr)|0,_=_+Math.imul(ge,Vr)|0,_=_+Math.imul(be,jr)|0,L=L+Math.imul(be,Vr)|0,M=M+Math.imul(ee,zr)|0,_=_+Math.imul(ee,tr)|0,_=_+Math.imul(J,zr)|0,L=L+Math.imul(J,tr)|0;var My=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(My>>>26)|0,My&=67108863,M=Math.imul(Ht,Lr),_=Math.imul(Ht,Ur),_=_+Math.imul(er,Lr)|0,L=Math.imul(er,Ur),M=M+Math.imul(ze,Fr)|0,_=_+Math.imul(ze,Kr)|0,_=_+Math.imul(Ve,Fr)|0,L=L+Math.imul(Ve,Kr)|0,M=M+Math.imul(Te,jr)|0,_=_+Math.imul(Te,Vr)|0,_=_+Math.imul(je,jr)|0,L=L+Math.imul(je,Vr)|0,M=M+Math.imul(ge,zr)|0,_=_+Math.imul(ge,tr)|0,_=_+Math.imul(be,zr)|0,L=L+Math.imul(be,tr)|0;var Ly=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ly>>>26)|0,Ly&=67108863,M=Math.imul(Ht,Fr),_=Math.imul(Ht,Kr),_=_+Math.imul(er,Fr)|0,L=Math.imul(er,Kr),M=M+Math.imul(ze,jr)|0,_=_+Math.imul(ze,Vr)|0,_=_+Math.imul(Ve,jr)|0,L=L+Math.imul(Ve,Vr)|0,M=M+Math.imul(Te,zr)|0,_=_+Math.imul(Te,tr)|0,_=_+Math.imul(je,zr)|0,L=L+Math.imul(je,tr)|0;var wi=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(wi>>>26)|0,wi&=67108863,M=Math.imul(Ht,jr),_=Math.imul(Ht,Vr),_=_+Math.imul(er,jr)|0,L=Math.imul(er,Vr),M=M+Math.imul(ze,zr)|0,_=_+Math.imul(ze,tr)|0,_=_+Math.imul(Ve,zr)|0,L=L+Math.imul(Ve,tr)|0;var Uy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Uy>>>26)|0,Uy&=67108863,M=Math.imul(Ht,zr),_=Math.imul(Ht,tr),_=_+Math.imul(er,zr)|0,L=Math.imul(er,tr);var Fy=(j+M|0)+((_&8191)<<13)|0;return j=(L+(_>>>13)|0)+(Fy>>>26)|0,Fy&=67108863,W[0]=zh,W[1]=Ay,W[2]=Iy,W[3]=Ty,W[4]=Ry,W[5]=Py,W[6]=uo,W[7]=Cy,W[8]=Oy,W[9]=ky,W[10]=qy,W[11]=By,W[12]=Ny,W[13]=Dy,W[14]=My,W[15]=Ly,W[16]=wi,W[17]=Uy,W[18]=Fy,j!==0&&(W[19]=j,S.length++),S};Math.imul||(g=y);function m(P,b,w){w.negative=b.negative^P.negative,w.length=P.length+b.length;for(var S=0,C=0,D=0;D<w.length-1;D++){var W=C;C=0;for(var j=S&67108863,M=Math.min(D,b.length-1),_=Math.max(0,D-P.length+1);_<=M;_++){var L=D-_,ce=P.words[L]|0,X=b.words[_]|0,ne=ce*X,oe=ne&67108863;W=W+(ne/67108864|0)|0,oe=oe+j|0,j=oe&67108863,W=W+(oe>>>26)|0,C+=W>>>26,W&=67108863}w.words[D]=j,S=W,W=C}return S!==0?w.words[D]=S:w.length--,w.strip()}function E(P,b,w){var S=new v;return S.mulp(P,b,w)}n.prototype.mulTo=function(b,w){var S,C=this.length+b.length;return this.length===10&&b.length===10?S=g(this,b,w):C<63?S=y(this,b,w):C<1024?S=m(this,b,w):S=E(this,b,w),S};function v(P,b){this.x=P,this.y=b}v.prototype.makeRBT=function(b){for(var w=new Array(b),S=n.prototype._countBits(b)-1,C=0;C<b;C++)w[C]=this.revBin(C,S,b);return w},v.prototype.revBin=function(b,w,S){if(b===0||b===S-1)return b;for(var C=0,D=0;D<w;D++)C|=(b&1)<<w-D-1,b>>=1;return C},v.prototype.permute=function(b,w,S,C,D,W){for(var j=0;j<W;j++)C[j]=w[b[j]],D[j]=S[b[j]]},v.prototype.transform=function(b,w,S,C,D,W){this.permute(W,b,w,S,C,D);for(var j=1;j<D;j<<=1)for(var M=j<<1,_=Math.cos(2*Math.PI/M),L=Math.sin(2*Math.PI/M),ce=0;ce<D;ce+=M)for(var X=_,ne=L,oe=0;oe<j;oe++){var de=S[ce+oe],pe=C[ce+oe],_e=S[ce+oe+j],k=C[ce+oe+j],K=X*_e-ne*k;k=X*k+ne*_e,_e=K,S[ce+oe]=de+_e,C[ce+oe]=pe+k,S[ce+oe+j]=de-_e,C[ce+oe+j]=pe-k,oe!==M&&(K=_*X-L*ne,ne=_*ne+L*X,X=K)}},v.prototype.guessLen13b=function(b,w){var S=Math.max(w,b)|1,C=S&1,D=0;for(S=S/2|0;S;S=S>>>1)D++;return 1<<D+1+C},v.prototype.conjugate=function(b,w,S){if(!(S<=1))for(var C=0;C<S/2;C++){var D=b[C];b[C]=b[S-C-1],b[S-C-1]=D,D=w[C],w[C]=-w[S-C-1],w[S-C-1]=-D}},v.prototype.normalize13b=function(b,w){for(var S=0,C=0;C<w/2;C++){var D=Math.round(b[2*C+1]/w)*8192+Math.round(b[2*C]/w)+S;b[C]=D&67108863,D<67108864?S=0:S=D/67108864|0}return b},v.prototype.convert13b=function(b,w,S,C){for(var D=0,W=0;W<w;W++)D=D+(b[W]|0),S[2*W]=D&8191,D=D>>>13,S[2*W+1]=D&8191,D=D>>>13;for(W=2*w;W<C;++W)S[W]=0;r(D===0),r((D&~8191)==0)},v.prototype.stub=function(b){for(var w=new Array(b),S=0;S<b;S++)w[S]=0;return w},v.prototype.mulp=function(b,w,S){var C=2*this.guessLen13b(b.length,w.length),D=this.makeRBT(C),W=this.stub(C),j=new Array(C),M=new Array(C),_=new Array(C),L=new Array(C),ce=new Array(C),X=new Array(C),ne=S.words;ne.length=C,this.convert13b(b.words,b.length,j,C),this.convert13b(w.words,w.length,L,C),this.transform(j,W,M,_,C,D),this.transform(L,W,ce,X,C,D);for(var oe=0;oe<C;oe++){var de=M[oe]*ce[oe]-_[oe]*X[oe];_[oe]=M[oe]*X[oe]+_[oe]*ce[oe],M[oe]=de}return this.conjugate(M,_,C),this.transform(M,_,ne,W,C,D),this.conjugate(ne,W,C),this.normalize13b(ne,C),S.negative=b.negative^w.negative,S.length=b.length+w.length,S.strip()},n.prototype.mul=function(b){var w=new n(null);return w.words=new Array(this.length+b.length),this.mulTo(b,w)},n.prototype.mulf=function(b){var w=new n(null);return w.words=new Array(this.length+b.length),E(this,b,w)},n.prototype.imul=function(b){return this.clone().mulTo(b,this)},n.prototype.imuln=function(b){r(typeof b=="number"),r(b<67108864);for(var w=0,S=0;S<this.length;S++){var C=(this.words[S]|0)*b,D=(C&67108863)+(w&67108863);w>>=26,w+=C/67108864|0,w+=D>>>26,this.words[S]=D&67108863}return w!==0&&(this.words[S]=w,this.length++),this},n.prototype.muln=function(b){return this.clone().imuln(b)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(b){var w=d(b);if(w.length===0)return new n(1);for(var S=this,C=0;C<w.length&&w[C]===0;C++,S=S.sqr());if(++C<w.length)for(var D=S.sqr();C<w.length;C++,D=D.sqr())w[C]!==0&&(S=S.mul(D));return S},n.prototype.iushln=function(b){r(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26,C=67108863>>>26-w<<26-w,D;if(w!==0){var W=0;for(D=0;D<this.length;D++){var j=this.words[D]&C,M=(this.words[D]|0)-j<<w;this.words[D]=M|W,W=j>>>26-w}W&&(this.words[D]=W,this.length++)}if(S!==0){for(D=this.length-1;D>=0;D--)this.words[D+S]=this.words[D];for(D=0;D<S;D++)this.words[D]=0;this.length+=S}return this.strip()},n.prototype.ishln=function(b){return r(this.negative===0),this.iushln(b)},n.prototype.iushrn=function(b,w,S){r(typeof b=="number"&&b>=0);var C;w?C=(w-w%26)/26:C=0;var D=b%26,W=Math.min((b-D)/26,this.length),j=67108863^67108863>>>D<<D,M=S;if(C-=W,C=Math.max(0,C),M){for(var _=0;_<W;_++)M.words[_]=this.words[_];M.length=W}if(W!==0)if(this.length>W)for(this.length-=W,_=0;_<this.length;_++)this.words[_]=this.words[_+W];else this.words[0]=0,this.length=1;var L=0;for(_=this.length-1;_>=0&&(L!==0||_>=C);_--){var ce=this.words[_]|0;this.words[_]=L<<26-D|ce>>>D,L=ce&j}return M&&L!==0&&(M.words[M.length++]=L),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(b,w,S){return r(this.negative===0),this.iushrn(b,w,S)},n.prototype.shln=function(b){return this.clone().ishln(b)},n.prototype.ushln=function(b){return this.clone().iushln(b)},n.prototype.shrn=function(b){return this.clone().ishrn(b)},n.prototype.ushrn=function(b){return this.clone().iushrn(b)},n.prototype.testn=function(b){r(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26,C=1<<w;if(this.length<=S)return!1;var D=this.words[S];return!!(D&C)},n.prototype.imaskn=function(b){r(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(w!==0&&S++,this.length=Math.min(S,this.length),w!==0){var C=67108863^67108863>>>w<<w;this.words[this.length-1]&=C}return this.strip()},n.prototype.maskn=function(b){return this.clone().imaskn(b)},n.prototype.iaddn=function(b){return r(typeof b=="number"),r(b<67108864),b<0?this.isubn(-b):this.negative!==0?this.length===1&&(this.words[0]|0)<b?(this.words[0]=b-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(b),this.negative=1,this):this._iaddn(b)},n.prototype._iaddn=function(b){this.words[0]+=b;for(var w=0;w<this.length&&this.words[w]>=67108864;w++)this.words[w]-=67108864,w===this.length-1?this.words[w+1]=1:this.words[w+1]++;return this.length=Math.max(this.length,w+1),this},n.prototype.isubn=function(b){if(r(typeof b=="number"),r(b<67108864),b<0)return this.iaddn(-b);if(this.negative!==0)return this.negative=0,this.iaddn(b),this.negative=1,this;if(this.words[0]-=b,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var w=0;w<this.length&&this.words[w]<0;w++)this.words[w]+=67108864,this.words[w+1]-=1;return this.strip()},n.prototype.addn=function(b){return this.clone().iaddn(b)},n.prototype.subn=function(b){return this.clone().isubn(b)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(b,w,S){var C=b.length+S,D;this._expand(C);var W,j=0;for(D=0;D<b.length;D++){W=(this.words[D+S]|0)+j;var M=(b.words[D]|0)*w;W-=M&67108863,j=(W>>26)-(M/67108864|0),this.words[D+S]=W&67108863}for(;D<this.length-S;D++)W=(this.words[D+S]|0)+j,j=W>>26,this.words[D+S]=W&67108863;if(j===0)return this.strip();for(r(j===-1),j=0,D=0;D<this.length;D++)W=-(this.words[D]|0)+j,j=W>>26,this.words[D]=W&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(b,w){var S=this.length-b.length,C=this.clone(),D=b,W=D.words[D.length-1]|0,j=this._countBits(W);S=26-j,S!==0&&(D=D.ushln(S),C.iushln(S),W=D.words[D.length-1]|0);var M=C.length-D.length,_;if(w!=="mod"){_=new n(null),_.length=M+1,_.words=new Array(_.length);for(var L=0;L<_.length;L++)_.words[L]=0}var ce=C.clone()._ishlnsubmul(D,1,M);ce.negative===0&&(C=ce,_&&(_.words[M]=1));for(var X=M-1;X>=0;X--){var ne=(C.words[D.length+X]|0)*67108864+(C.words[D.length+X-1]|0);for(ne=Math.min(ne/W|0,67108863),C._ishlnsubmul(D,ne,X);C.negative!==0;)ne--,C.negative=0,C._ishlnsubmul(D,1,X),C.isZero()||(C.negative^=1);_&&(_.words[X]=ne)}return _&&_.strip(),C.strip(),w!=="div"&&S!==0&&C.iushrn(S),{div:_||null,mod:C}},n.prototype.divmod=function(b,w,S){if(r(!b.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var C,D,W;return this.negative!==0&&b.negative===0?(W=this.neg().divmod(b,w),w!=="mod"&&(C=W.div.neg()),w!=="div"&&(D=W.mod.neg(),S&&D.negative!==0&&D.iadd(b)),{div:C,mod:D}):this.negative===0&&b.negative!==0?(W=this.divmod(b.neg(),w),w!=="mod"&&(C=W.div.neg()),{div:C,mod:W.mod}):(this.negative&b.negative)!=0?(W=this.neg().divmod(b.neg(),w),w!=="div"&&(D=W.mod.neg(),S&&D.negative!==0&&D.isub(b)),{div:W.div,mod:D}):b.length>this.length||this.cmp(b)<0?{div:new n(0),mod:this}:b.length===1?w==="div"?{div:this.divn(b.words[0]),mod:null}:w==="mod"?{div:null,mod:new n(this.modn(b.words[0]))}:{div:this.divn(b.words[0]),mod:new n(this.modn(b.words[0]))}:this._wordDiv(b,w)},n.prototype.div=function(b){return this.divmod(b,"div",!1).div},n.prototype.mod=function(b){return this.divmod(b,"mod",!1).mod},n.prototype.umod=function(b){return this.divmod(b,"mod",!0).mod},n.prototype.divRound=function(b){var w=this.divmod(b);if(w.mod.isZero())return w.div;var S=w.div.negative!==0?w.mod.isub(b):w.mod,C=b.ushrn(1),D=b.andln(1),W=S.cmp(C);return W<0||D===1&&W===0?w.div:w.div.negative!==0?w.div.isubn(1):w.div.iaddn(1)},n.prototype.modn=function(b){r(b<=67108863);for(var w=(1<<26)%b,S=0,C=this.length-1;C>=0;C--)S=(w*S+(this.words[C]|0))%b;return S},n.prototype.idivn=function(b){r(b<=67108863);for(var w=0,S=this.length-1;S>=0;S--){var C=(this.words[S]|0)+w*67108864;this.words[S]=C/b|0,w=C%b}return this.strip()},n.prototype.divn=function(b){return this.clone().idivn(b)},n.prototype.egcd=function(b){r(b.negative===0),r(!b.isZero());var w=this,S=b.clone();w.negative!==0?w=w.umod(b):w=w.clone();for(var C=new n(1),D=new n(0),W=new n(0),j=new n(1),M=0;w.isEven()&&S.isEven();)w.iushrn(1),S.iushrn(1),++M;for(var _=S.clone(),L=w.clone();!w.isZero();){for(var ce=0,X=1;(w.words[0]&X)==0&&ce<26;++ce,X<<=1);if(ce>0)for(w.iushrn(ce);ce-- >0;)(C.isOdd()||D.isOdd())&&(C.iadd(_),D.isub(L)),C.iushrn(1),D.iushrn(1);for(var ne=0,oe=1;(S.words[0]&oe)==0&&ne<26;++ne,oe<<=1);if(ne>0)for(S.iushrn(ne);ne-- >0;)(W.isOdd()||j.isOdd())&&(W.iadd(_),j.isub(L)),W.iushrn(1),j.iushrn(1);w.cmp(S)>=0?(w.isub(S),C.isub(W),D.isub(j)):(S.isub(w),W.isub(C),j.isub(D))}return{a:W,b:j,gcd:S.iushln(M)}},n.prototype._invmp=function(b){r(b.negative===0),r(!b.isZero());var w=this,S=b.clone();w.negative!==0?w=w.umod(b):w=w.clone();for(var C=new n(1),D=new n(0),W=S.clone();w.cmpn(1)>0&&S.cmpn(1)>0;){for(var j=0,M=1;(w.words[0]&M)==0&&j<26;++j,M<<=1);if(j>0)for(w.iushrn(j);j-- >0;)C.isOdd()&&C.iadd(W),C.iushrn(1);for(var _=0,L=1;(S.words[0]&L)==0&&_<26;++_,L<<=1);if(_>0)for(S.iushrn(_);_-- >0;)D.isOdd()&&D.iadd(W),D.iushrn(1);w.cmp(S)>=0?(w.isub(S),C.isub(D)):(S.isub(w),D.isub(C))}var ce;return w.cmpn(1)===0?ce=C:ce=D,ce.cmpn(0)<0&&ce.iadd(b),ce},n.prototype.gcd=function(b){if(this.isZero())return b.abs();if(b.isZero())return this.abs();var w=this.clone(),S=b.clone();w.negative=0,S.negative=0;for(var C=0;w.isEven()&&S.isEven();C++)w.iushrn(1),S.iushrn(1);do{for(;w.isEven();)w.iushrn(1);for(;S.isEven();)S.iushrn(1);var D=w.cmp(S);if(D<0){var W=w;w=S,S=W}else if(D===0||S.cmpn(1)===0)break;w.isub(S)}while(!0);return S.iushln(C)},n.prototype.invm=function(b){return this.egcd(b).a.umod(b)},n.prototype.isEven=function(){return(this.words[0]&1)==0},n.prototype.isOdd=function(){return(this.words[0]&1)==1},n.prototype.andln=function(b){return this.words[0]&b},n.prototype.bincn=function(b){r(typeof b=="number");var w=b%26,S=(b-w)/26,C=1<<w;if(this.length<=S)return this._expand(S+1),this.words[S]|=C,this;for(var D=C,W=S;D!==0&&W<this.length;W++){var j=this.words[W]|0;j+=D,D=j>>>26,j&=67108863,this.words[W]=j}return D!==0&&(this.words[W]=D,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(b){var w=b<0;if(this.negative!==0&&!w)return-1;if(this.negative===0&&w)return 1;this.strip();var S;if(this.length>1)S=1;else{w&&(b=-b),r(b<=67108863,"Number is too big");var C=this.words[0]|0;S=C===b?0:C<b?-1:1}return this.negative!==0?-S|0:S},n.prototype.cmp=function(b){if(this.negative!==0&&b.negative===0)return-1;if(this.negative===0&&b.negative!==0)return 1;var w=this.ucmp(b);return this.negative!==0?-w|0:w},n.prototype.ucmp=function(b){if(this.length>b.length)return 1;if(this.length<b.length)return-1;for(var w=0,S=this.length-1;S>=0;S--){var C=this.words[S]|0,D=b.words[S]|0;if(C!==D){C<D?w=-1:C>D&&(w=1);break}}return w},n.prototype.gtn=function(b){return this.cmpn(b)===1},n.prototype.gt=function(b){return this.cmp(b)===1},n.prototype.gten=function(b){return this.cmpn(b)>=0},n.prototype.gte=function(b){return this.cmp(b)>=0},n.prototype.ltn=function(b){return this.cmpn(b)===-1},n.prototype.lt=function(b){return this.cmp(b)===-1},n.prototype.lten=function(b){return this.cmpn(b)<=0},n.prototype.lte=function(b){return this.cmp(b)<=0},n.prototype.eqn=function(b){return this.cmpn(b)===0},n.prototype.eq=function(b){return this.cmp(b)===0},n.red=function(b){return new G(b)},n.prototype.toRed=function(b){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),b.convertTo(this)._forceRed(b)},n.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(b){return this.red=b,this},n.prototype.forceRed=function(b){return r(!this.red,"Already a number in reduction context"),this._forceRed(b)},n.prototype.redAdd=function(b){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,b)},n.prototype.redIAdd=function(b){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,b)},n.prototype.redSub=function(b){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,b)},n.prototype.redISub=function(b){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,b)},n.prototype.redShl=function(b){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,b)},n.prototype.redMul=function(b){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.mul(this,b)},n.prototype.redIMul=function(b){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.imul(this,b)},n.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(b){return r(this.red&&!b.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,b)};var A={k256:null,p224:null,p192:null,p25519:null};function R(P,b){this.name=P,this.p=new n(b,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}R.prototype._tmp=function(){var b=new n(null);return b.words=new Array(Math.ceil(this.n/13)),b},R.prototype.ireduce=function(b){var w=b,S;do this.split(w,this.tmp),w=this.imulK(w),w=w.iadd(this.tmp),S=w.bitLength();while(S>this.n);var C=S<this.n?-1:w.ucmp(this.p);return C===0?(w.words[0]=0,w.length=1):C>0?w.isub(this.p):w.strip!==void 0?w.strip():w._strip(),w},R.prototype.split=function(b,w){b.iushrn(this.n,0,w)},R.prototype.imulK=function(b){return b.imul(this.k)};function F(){R.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(F,R),F.prototype.split=function(b,w){for(var S=4194303,C=Math.min(b.length,9),D=0;D<C;D++)w.words[D]=b.words[D];if(w.length=C,b.length<=9){b.words[0]=0,b.length=1;return}var W=b.words[9];for(w.words[w.length++]=W&S,D=10;D<b.length;D++){var j=b.words[D]|0;b.words[D-10]=(j&S)<<4|W>>>22,W=j}W>>>=22,b.words[D-10]=W,W===0&&b.length>10?b.length-=10:b.length-=9},F.prototype.imulK=function(b){b.words[b.length]=0,b.words[b.length+1]=0,b.length+=2;for(var w=0,S=0;S<b.length;S++){var C=b.words[S]|0;w+=C*977,b.words[S]=w&67108863,w=C*64+(w/67108864|0)}return b.words[b.length-1]===0&&(b.length--,b.words[b.length-1]===0&&b.length--),b};function q(){R.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(q,R);function B(){R.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(B,R);function z(){R.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(z,R),z.prototype.imulK=function(b){for(var w=0,S=0;S<b.length;S++){var C=(b.words[S]|0)*19+w,D=C&67108863;C>>>=26,b.words[S]=D,w=C}return w!==0&&(b.words[b.length++]=w),b},n._prime=function(b){if(A[b])return A[b];var w;if(b==="k256")w=new F;else if(b==="p224")w=new q;else if(b==="p192")w=new B;else if(b==="p25519")w=new z;else throw new Error("Unknown prime "+b);return A[b]=w,w};function G(P){if(typeof P=="string"){var b=n._prime(P);this.m=b.p,this.prime=b}else r(P.gtn(1),"modulus must be greater than 1"),this.m=P,this.prime=null}G.prototype._verify1=function(b){r(b.negative===0,"red works only with positives"),r(b.red,"red works only with red numbers")},G.prototype._verify2=function(b,w){r((b.negative|w.negative)==0,"red works only with positives"),r(b.red&&b.red===w.red,"red works only with red numbers")},G.prototype.imod=function(b){return this.prime?this.prime.ireduce(b)._forceRed(this):b.umod(this.m)._forceRed(this)},G.prototype.neg=function(b){return b.isZero()?b.clone():this.m.sub(b)._forceRed(this)},G.prototype.add=function(b,w){this._verify2(b,w);var S=b.add(w);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},G.prototype.iadd=function(b,w){this._verify2(b,w);var S=b.iadd(w);return S.cmp(this.m)>=0&&S.isub(this.m),S},G.prototype.sub=function(b,w){this._verify2(b,w);var S=b.sub(w);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},G.prototype.isub=function(b,w){this._verify2(b,w);var S=b.isub(w);return S.cmpn(0)<0&&S.iadd(this.m),S},G.prototype.shl=function(b,w){return this._verify1(b),this.imod(b.ushln(w))},G.prototype.imul=function(b,w){return this._verify2(b,w),this.imod(b.imul(w))},G.prototype.mul=function(b,w){return this._verify2(b,w),this.imod(b.mul(w))},G.prototype.isqr=function(b){return this.imul(b,b.clone())},G.prototype.sqr=function(b){return this.mul(b,b)},G.prototype.sqrt=function(b){if(b.isZero())return b.clone();var w=this.m.andln(3);if(r(w%2==1),w===3){var S=this.m.add(new n(1)).iushrn(2);return this.pow(b,S)}for(var C=this.m.subn(1),D=0;!C.isZero()&&C.andln(1)===0;)D++,C.iushrn(1);r(!C.isZero());var W=new n(1).toRed(this),j=W.redNeg(),M=this.m.subn(1).iushrn(1),_=this.m.bitLength();for(_=new n(2*_*_).toRed(this);this.pow(_,M).cmp(j)!==0;)_.redIAdd(j);for(var L=this.pow(_,C),ce=this.pow(b,C.addn(1).iushrn(1)),X=this.pow(b,C),ne=D;X.cmp(W)!==0;){for(var oe=X,de=0;oe.cmp(W)!==0;de++)oe=oe.redSqr();r(de<ne);var pe=this.pow(L,new n(1).iushln(ne-de-1));ce=ce.redMul(pe),L=pe.redSqr(),X=X.redMul(L),ne=de}return ce},G.prototype.invm=function(b){var w=b._invmp(this.m);return w.negative!==0?(w.negative=0,this.imod(w).redNeg()):this.imod(w)},G.prototype.pow=function(b,w){if(w.isZero())return new n(1).toRed(this);if(w.cmpn(1)===0)return b.clone();var S=4,C=new Array(1<<S);C[0]=new n(1).toRed(this),C[1]=b;for(var D=2;D<C.length;D++)C[D]=this.mul(C[D-1],b);var W=C[0],j=0,M=0,_=w.bitLength()%26;for(_===0&&(_=26),D=w.length-1;D>=0;D--){for(var L=w.words[D],ce=_-1;ce>=0;ce--){var X=L>>ce&1;if(W!==C[0]&&(W=this.sqr(W)),X===0&&j===0){M=0;continue}j<<=1,j|=X,M++,!(M!==S&&(D!==0||ce!==0))&&(W=this.mul(W,C[j]),M=0,j=0)}_=26}return W},G.prototype.convertTo=function(b){var w=b.umod(this.m);return w===b?w.clone():w},G.prototype.convertFrom=function(b){var w=b.clone();return w.red=null,w},n.mont=function(b){return new Y(b)};function Y(P){G.call(this,P),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(Y,G),Y.prototype.convertTo=function(b){return this.imod(b.ushln(this.shift))},Y.prototype.convertFrom=function(b){var w=this.imod(b.mul(this.rinv));return w.red=null,w},Y.prototype.imul=function(b,w){if(b.isZero()||w.isZero())return b.words[0]=0,b.length=1,b;var S=b.imul(w),C=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),D=S.isub(C).iushrn(this.shift),W=D;return D.cmp(this.m)>=0?W=D.isub(this.m):D.cmpn(0)<0&&(W=D.iadd(this.m)),W._forceRed(this)},Y.prototype.mul=function(b,w){if(b.isZero()||w.isZero())return new n(0)._forceRed(this);var S=b.mul(w),C=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),D=S.isub(C).iushrn(this.shift),W=D;return D.cmp(this.m)>=0?W=D.isub(this.m):D.cmpn(0)<0&&(W=D.iadd(this.m)),W._forceRed(this)},Y.prototype.invm=function(b){var w=this.imod(b._invmp(this.m).mul(this.r2));return w._forceRed(this)}})(typeof Yx=="undefined"||Yx,q7)});var Mu=p((jAt,N7)=>{f();N7.exports=B7;function B7(t,e){if(!t)throw new Error(e||"Assertion failed")}B7.equal=function(e,r,i){if(e!=r)throw new Error(i||"Assertion failed: "+e+" != "+r)}});var Xx=p(L7=>{f();"use strict";var Wv=L7;function PPe(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t!="string"){for(var i=0;i<t.length;i++)r[i]=t[i]|0;return r}if(e==="hex"){t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!=0&&(t="0"+t);for(var i=0;i<t.length;i+=2)r.push(parseInt(t[i]+t[i+1],16))}else for(var i=0;i<t.length;i++){var n=t.charCodeAt(i),s=n>>8,o=n&255;s?r.push(s,o):r.push(o)}return r}Wv.toArray=PPe;function D7(t){return t.length===1?"0"+t:t}Wv.zero2=D7;function M7(t){for(var e="",r=0;r<t.length;r++)e+=D7(t[r].toString(16));return e}Wv.toHex=M7;Wv.encode=function(e,r){return r==="hex"?M7(e):e}});var ss=p(U7=>{f();"use strict";var wo=U7,CPe=Aa(),OPe=Mu(),Yv=Xx();wo.assert=OPe;wo.toArray=Yv.toArray;wo.zero2=Yv.zero2;wo.toHex=Yv.toHex;wo.encode=Yv.encode;function kPe(t,e,r){var i=new Array(Math.max(t.bitLength(),r)+1);i.fill(0);for(var n=1<<e+1,s=t.clone(),o=0;o<i.length;o++){var a,c=s.andln(n-1);s.isOdd()?(c>(n>>1)-1?a=(n>>1)-c:a=c,s.isubn(a)):a=0,i[o]=a,s.iushrn(1)}return i}wo.getNAF=kPe;function qPe(t,e){var r=[[],[]];t=t.clone(),e=e.clone();for(var i=0,n=0,s;t.cmpn(-i)>0||e.cmpn(-n)>0;){var o=t.andln(3)+i&3,a=e.andln(3)+n&3;o===3&&(o=-1),a===3&&(a=-1);var c;(o&1)==0?c=0:(s=t.andln(7)+i&7,(s===3||s===5)&&a===2?c=-o:c=o),r[0].push(c);var l;(a&1)==0?l=0:(s=e.andln(7)+n&7,(s===3||s===5)&&o===2?l=-a:l=a),r[1].push(l),2*i===c+1&&(i=1-i),2*n===l+1&&(n=1-n),t.iushrn(1),e.iushrn(1)}return r}wo.getJSF=qPe;function BPe(t,e,r){var i="_"+e;t.prototype[e]=function(){return this[i]!==void 0?this[i]:this[i]=r.call(this)}}wo.cachedProperty=BPe;function NPe(t){return typeof t=="string"?wo.toArray(t,"hex"):t}wo.parseBytes=NPe;function DPe(t){return new CPe(t,"hex","le")}wo.intFromLE=DPe});var eA=p((HAt,Jx)=>{f();var Qx;Jx.exports=function(e){return Qx||(Qx=new Lu(null)),Qx.generate(e)};function Lu(t){this.rand=t}Jx.exports.Rand=Lu;Lu.prototype.generate=function(e){return this._rand(e)};Lu.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var r=new Uint8Array(e),i=0;i<r.length;i++)r[i]=this.rand.getByte();return r};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?Lu.prototype._rand=function(e){var r=new Uint8Array(e);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?Lu.prototype._rand=function(e){var r=new Uint8Array(e);return self.msCrypto.getRandomValues(r),r}:typeof window=="object"&&(Lu.prototype._rand=function(){throw new Error("Not implemented yet")});else try{if(Zx=ud(),typeof Zx.randomBytes!="function")throw new Error("Not supported");Lu.prototype._rand=function(e){return Zx.randomBytes(e)}}catch(t){}var Zx});var gg=p(($At,F7)=>{f();"use strict";var pf=Aa(),yg=ss(),Xv=yg.getNAF,MPe=yg.getJSF,Qv=yg.assert;function Uu(t,e){this.type=t,this.p=new pf(e.p,16),this.red=e.prime?pf.red(e.prime):pf.mont(this.p),this.zero=new pf(0).toRed(this.red),this.one=new pf(1).toRed(this.red),this.two=new pf(2).toRed(this.red),this.n=e.n&&new pf(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}F7.exports=Uu;Uu.prototype.point=function(){throw new Error("Not implemented")};Uu.prototype.validate=function(){throw new Error("Not implemented")};Uu.prototype._fixedNafMul=function(e,r){Qv(e.precomputed);var i=e._getDoubles(),n=Xv(r,1,this._bitLength),s=(1<<i.step+1)-(i.step%2==0?2:1);s/=3;var o=[],a,c;for(a=0;a<n.length;a+=i.step){c=0;for(var l=a+i.step-1;l>=a;l--)c=(c<<1)+n[l];o.push(c)}for(var u=this.jpoint(null,null,null),h=this.jpoint(null,null,null),d=s;d>0;d--){for(a=0;a<o.length;a++)c=o[a],c===d?h=h.mixedAdd(i.points[a]):c===-d&&(h=h.mixedAdd(i.points[a].neg()));u=u.add(h)}return u.toP()};Uu.prototype._wnafMul=function(e,r){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,o=Xv(r,i,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var l=0;c>=0&&o[c]===0;c--)l++;if(c>=0&&l++,a=a.dblp(l),c<0)break;var u=o[c];Qv(u!==0),e.type==="affine"?u>0?a=a.mixedAdd(s[u-1>>1]):a=a.mixedAdd(s[-u-1>>1].neg()):u>0?a=a.add(s[u-1>>1]):a=a.add(s[-u-1>>1].neg())}return e.type==="affine"?a.toP():a};Uu.prototype._wnafMulAdd=function(e,r,i,n,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,l=0,u,h,d;for(u=0;u<n;u++){d=r[u];var y=d._getNAFPoints(e);o[u]=y.wnd,a[u]=y.points}for(u=n-1;u>=1;u-=2){var g=u-1,m=u;if(o[g]!==1||o[m]!==1){c[g]=Xv(i[g],o[g],this._bitLength),c[m]=Xv(i[m],o[m],this._bitLength),l=Math.max(c[g].length,l),l=Math.max(c[m].length,l);continue}var E=[r[g],null,null,r[m]];r[g].y.cmp(r[m].y)===0?(E[1]=r[g].add(r[m]),E[2]=r[g].toJ().mixedAdd(r[m].neg())):r[g].y.cmp(r[m].y.redNeg())===0?(E[1]=r[g].toJ().mixedAdd(r[m]),E[2]=r[g].add(r[m].neg())):(E[1]=r[g].toJ().mixedAdd(r[m]),E[2]=r[g].toJ().mixedAdd(r[m].neg()));var v=[-3,-1,-5,-7,0,7,5,1,3],A=MPe(i[g],i[m]);for(l=Math.max(A[0].length,l),c[g]=new Array(l),c[m]=new Array(l),h=0;h<l;h++){var R=A[0][h]|0,F=A[1][h]|0;c[g][h]=v[(R+1)*3+(F+1)],c[m][h]=0,a[g]=E}}var q=this.jpoint(null,null,null),B=this._wnafT4;for(u=l;u>=0;u--){for(var z=0;u>=0;){var G=!0;for(h=0;h<n;h++)B[h]=c[h][u]|0,B[h]!==0&&(G=!1);if(!G)break;z++,u--}if(u>=0&&z++,q=q.dblp(z),u<0)break;for(h=0;h<n;h++){var Y=B[h];Y!==0&&(Y>0?d=a[h][Y-1>>1]:Y<0&&(d=a[h][-Y-1>>1].neg()),d.type==="affine"?q=q.mixedAdd(d):q=q.add(d))}}for(u=0;u<n;u++)a[u]=null;return s?q:q.toP()};function Os(t,e){this.curve=t,this.type=e,this.precomputed=null}Uu.BasePoint=Os;Os.prototype.eq=function(){throw new Error("Not implemented")};Os.prototype.validate=function(){return this.curve.validate(this)};Uu.prototype.decodePoint=function(e,r){e=yg.toArray(e,r);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1==2*i){e[0]===6?Qv(e[e.length-1]%2==0):e[0]===7&&Qv(e[e.length-1]%2==1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};Os.prototype.encodeCompressed=function(e){return this.encode(e,!0)};Os.prototype._encode=function(e){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))};Os.prototype.encode=function(e,r){return yg.encode(this._encode(r),e)};Os.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this};Os.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1};Os.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<r;s+=e){for(var o=0;o<e;o++)n=n.dbl();i.push(n)}return{step:e,points:i}};Os.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)r[s]=r[s-1].add(n);return{wnd:e,points:r}};Os.prototype._getBeta=function(){return null};Os.prototype.dblp=function(e){for(var r=this,i=0;i<e;i++)r=r.dbl();return r}});var Xi=p((GAt,tA)=>{f();typeof Object.create=="function"?tA.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:tA.exports=function(e,r){if(r){e.super_=r;var i=function(){};i.prototype=r.prototype,e.prototype=new i,e.prototype.constructor=e}}});var j7=p((WAt,K7)=>{f();"use strict";var LPe=ss(),Gr=Aa(),rA=Xi(),wd=gg(),UPe=LPe.assert;function ks(t){wd.call(this,"short",t),this.a=new Gr(t.a,16).toRed(this.red),this.b=new Gr(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}rA(ks,wd);K7.exports=ks;ks.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(e.beta)r=new Gr(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);r=n[0].cmp(n[1])<0?n[0]:n[1],r=r.toRed(this.red)}if(e.lambda)i=new Gr(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?i=s[0]:(i=s[1],UPe(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new Gr(a.a,16),b:new Gr(a.b,16)}}):o=this._getEndoBasis(i),{beta:r,lambda:i,basis:o}}};ks.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:Gr.mont(e),i=new Gr(2).toRed(r).redInvm(),n=i.redNeg(),s=new Gr(3).toRed(r).redNeg().redSqrt().redMul(i),o=n.redAdd(s).fromRed(),a=n.redSub(s).fromRed();return[o,a]};ks.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new Gr(1),o=new Gr(0),a=new Gr(0),c=new Gr(1),l,u,h,d,y,g,m,E=0,v,A;i.cmpn(0)!==0;){var R=n.div(i);v=n.sub(R.mul(i)),A=a.sub(R.mul(s));var F=c.sub(R.mul(o));if(!h&&v.cmp(r)<0)l=m.neg(),u=s,h=v.neg(),d=A;else if(h&&++E==2)break;m=v,n=i,i=v,a=s,s=A,c=o,o=F}y=v.neg(),g=A;var q=h.sqr().add(d.sqr()),B=y.sqr().add(g.sqr());return B.cmp(q)>=0&&(y=l,g=u),h.negative&&(h=h.neg(),d=d.neg()),y.negative&&(y=y.neg(),g=g.neg()),[{a:h,b:d},{a:y,b:g}]};ks.prototype._endoSplit=function(e){var r=this.endo.basis,i=r[0],n=r[1],s=n.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),c=o.mul(n.a),l=s.mul(i.b),u=o.mul(n.b),h=e.sub(a).sub(c),d=l.add(u).neg();return{k1:h,k2:d}};ks.prototype.pointFromX=function(e,r){e=new Gr(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(r&&!s||!r&&s)&&(n=n.redNeg()),this.point(e,n)};ks.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,i=e.y,n=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};ks.prototype._endoWnafMulAdd=function(e,r,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(r[o]),c=e[o],l=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),l=l.neg(!0)),n[o*2]=c,n[o*2+1]=l,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var u=this._wnafMulAdd(1,n,s,o*2,i),h=0;h<o*2;h++)n[h]=null,s[h]=null;return u};function Ui(t,e,r,i){wd.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Gr(e,16),this.y=new Gr(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}rA(Ui,wd.BasePoint);ks.prototype.point=function(e,r,i){return new Ui(this,e,r,i)};ks.prototype.pointFromJSON=function(e,r){return Ui.fromJSON(this,e,r)};Ui.prototype._getBeta=function(){if(!!this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return r}};Ui.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Ui.fromJSON=function(e,r,i){typeof r=="string"&&(r=JSON.parse(r));var n=e.point(r[0],r[1],i);if(!r[2])return n;function s(a){return e.point(a[0],a[1],i)}var o=r[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(s))}},n};Ui.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Ui.prototype.isInfinity=function(){return this.inf};Ui.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};Ui.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(n),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};Ui.prototype.getX=function(){return this.x.fromRed()};Ui.prototype.getY=function(){return this.y.fromRed()};Ui.prototype.mul=function(e){return e=new Gr(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Ui.prototype.mulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};Ui.prototype.jmulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};Ui.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Ui.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return r};Ui.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Qi(t,e,r,i){wd.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Gr(0)):(this.x=new Gr(e,16),this.y=new Gr(r,16),this.z=new Gr(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}rA(Qi,wd.BasePoint);ks.prototype.jpoint=function(e,r,i){return new Qi(this,e,r,i)};Qi.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),i=this.x.redMul(r),n=this.y.redMul(r).redMul(e);return this.curve.point(i,n)};Qi.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Qi.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(r),s=e.x.redMul(i),o=this.y.redMul(r.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),c=n.redSub(s),l=o.redSub(a);if(c.cmpn(0)===0)return l.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=c.redSqr(),h=u.redMul(c),d=n.redMul(u),y=l.redSqr().redIAdd(h).redISub(d).redISub(d),g=l.redMul(d.redISub(y)).redISub(o.redMul(h)),m=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(y,g,m)};Qi.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),i=this.x,n=e.x.redMul(r),s=this.y,o=e.y.redMul(r).redMul(this.z),a=i.redSub(n),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=a.redSqr(),u=l.redMul(a),h=i.redMul(l),d=c.redSqr().redIAdd(u).redISub(h).redISub(h),y=c.redMul(h.redISub(d)).redISub(s.redMul(u)),g=this.z.redMul(a);return this.curve.jpoint(d,y,g)};Qi.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<e;r++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,l=c.redSqr().redSqr(),u=a.redAdd(a);for(r=0;r<e;r++){var h=o.redSqr(),d=u.redSqr(),y=d.redSqr(),g=h.redAdd(h).redIAdd(h).redIAdd(n.redMul(l)),m=o.redMul(d),E=g.redSqr().redISub(m.redAdd(m)),v=m.redISub(E),A=g.redMul(v);A=A.redIAdd(A).redISub(y);var R=u.redMul(c);r+1<e&&(l=l.redMul(y)),o=E,c=R,u=A}return this.curve.jpoint(o,u.redMul(s),c)};Qi.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Qi.prototype._zeroDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n),l=c.redSqr().redISub(a).redISub(a),u=o.redIAdd(o);u=u.redIAdd(u),u=u.redIAdd(u),e=l,r=c.redMul(a.redISub(l)).redISub(u),i=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),d=this.y.redSqr(),y=d.redSqr(),g=this.x.redAdd(d).redSqr().redISub(h).redISub(y);g=g.redIAdd(g);var m=h.redAdd(h).redIAdd(h),E=m.redSqr(),v=y.redIAdd(y);v=v.redIAdd(v),v=v.redIAdd(v),e=E.redISub(g).redISub(g),r=m.redMul(g.redISub(e)).redISub(v),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,r,i)};Qi.prototype._threeDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),l=c.redSqr().redISub(a).redISub(a);e=l;var u=o.redIAdd(o);u=u.redIAdd(u),u=u.redIAdd(u),r=c.redMul(a.redISub(l)).redISub(u),i=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),d=this.y.redSqr(),y=this.x.redMul(d),g=this.x.redSub(h).redMul(this.x.redAdd(h));g=g.redAdd(g).redIAdd(g);var m=y.redIAdd(y);m=m.redIAdd(m);var E=m.redAdd(m);e=g.redSqr().redISub(E),i=this.y.redAdd(this.z).redSqr().redISub(d).redISub(h);var v=d.redSqr();v=v.redIAdd(v),v=v.redIAdd(v),v=v.redIAdd(v),r=g.redMul(m.redISub(e)).redISub(v)}return this.curve.jpoint(e,r,i)};Qi.prototype._dbl=function(){var e=this.curve.a,r=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),o=r.redSqr(),a=i.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),l=r.redAdd(r);l=l.redIAdd(l);var u=l.redMul(a),h=c.redSqr().redISub(u.redAdd(u)),d=u.redISub(h),y=a.redSqr();y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var g=c.redMul(d).redISub(y),m=i.redAdd(i).redMul(n);return this.curve.jpoint(h,g,m)};Qi.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),n=r.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(e).redISub(n);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),l=n.redIAdd(n);l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var u=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(l),h=r.redMul(u);h=h.redIAdd(h),h=h.redIAdd(h);var d=this.x.redMul(c).redISub(h);d=d.redIAdd(d),d=d.redIAdd(d);var y=this.y.redMul(u.redMul(l.redISub(u)).redISub(a.redMul(c)));y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var g=this.z.redAdd(a).redSqr().redISub(i).redISub(c);return this.curve.jpoint(d,y,g)};Qi.prototype.mul=function(e,r){return e=new Gr(e,r),this.curve._wnafMul(this,e)};Qi.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var n=r.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};Qi.prototype.eqXToP=function(e){var r=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(r);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};Qi.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Qi.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var H7=p((YAt,z7)=>{f();"use strict";var _d=Aa(),V7=Xi(),Zv=gg(),FPe=ss();function Ed(t){Zv.call(this,"mont",t),this.a=new _d(t.a,16).toRed(this.red),this.b=new _d(t.b,16).toRed(this.red),this.i4=new _d(4).toRed(this.red).redInvm(),this.two=new _d(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}V7(Ed,Zv);z7.exports=Ed;Ed.prototype.validate=function(e){var r=e.normalize().x,i=r.redSqr(),n=i.redMul(r).redAdd(i.redMul(this.a)).redAdd(r),s=n.redSqrt();return s.redSqr().cmp(n)===0};function Fi(t,e,r){Zv.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new _d(e,16),this.z=new _d(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}V7(Fi,Zv.BasePoint);Ed.prototype.decodePoint=function(e,r){return this.point(FPe.toArray(e,r),1)};Ed.prototype.point=function(e,r){return new Fi(this,e,r)};Ed.prototype.pointFromJSON=function(e){return Fi.fromJSON(this,e)};Fi.prototype.precompute=function(){};Fi.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Fi.fromJSON=function(e,r){return new Fi(e,r[0],r[1]||e.one)};Fi.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Fi.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Fi.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=r.redSub(n),o=r.redMul(n),a=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)};Fi.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Fi.prototype.diffAdd=function(e,r){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),a=o.redMul(i),c=s.redMul(n),l=r.z.redMul(a.redAdd(c).redSqr()),u=r.x.redMul(a.redISub(c).redSqr());return this.curve.point(l,u)};Fi.prototype.mul=function(e){for(var r=e.clone(),i=this,n=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n};Fi.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Fi.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Fi.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};Fi.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Fi.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var W7=p((XAt,G7)=>{f();"use strict";var KPe=ss(),qc=Aa(),$7=Xi(),Jv=gg(),jPe=KPe.assert;function Ia(t){this.twisted=(t.a|0)!=1,this.mOneA=this.twisted&&(t.a|0)==-1,this.extended=this.mOneA,Jv.call(this,"edwards",t),this.a=new qc(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new qc(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new qc(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),jPe(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)==1}$7(Ia,Jv);G7.exports=Ia;Ia.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Ia.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Ia.prototype.jpoint=function(e,r,i,n){return this.point(e,r,i,n)};Ia.prototype.pointFromX=function(e,r){e=new qc(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),o=n.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(r&&!c||!r&&c)&&(a=a.redNeg()),this.point(e,a)};Ia.prototype.pointFromY=function(e,r){e=new qc(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),o=n.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,e)};Ia.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),i=e.y.redSqr(),n=r.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(i)));return n.cmp(s)===0};function ir(t,e,r,i,n){Jv.BasePoint.call(this,t,"projective"),e===null&&r===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new qc(e,16),this.y=new qc(r,16),this.z=i?new qc(i,16):this.curve.one,this.t=n&&new qc(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}$7(ir,Jv.BasePoint);Ia.prototype.pointFromJSON=function(e){return ir.fromJSON(this,e)};Ia.prototype.point=function(e,r,i,n){return new ir(this,e,r,i,n)};ir.fromJSON=function(e,r){return new ir(e,r[0],r[1],r[2])};ir.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};ir.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};ir.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),o=n.redAdd(r),a=o.redSub(i),c=n.redSub(r),l=s.redMul(a),u=o.redMul(c),h=s.redMul(c),d=a.redMul(o);return this.curve.point(l,u,d,h)};ir.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),i=this.y.redSqr(),n,s,o,a,c,l;if(this.curve.twisted){a=this.curve._mulA(r);var u=a.redAdd(i);this.zOne?(n=e.redSub(r).redSub(i).redMul(u.redSub(this.curve.two)),s=u.redMul(a.redSub(i)),o=u.redSqr().redSub(u).redSub(u)):(c=this.z.redSqr(),l=u.redSub(c).redISub(c),n=e.redSub(r).redISub(i).redMul(l),s=u.redMul(a.redSub(i)),o=u.redMul(l))}else a=r.redAdd(i),c=this.curve._mulC(this.z).redSqr(),l=a.redSub(c).redSub(c),n=this.curve._mulC(e.redISub(a)).redMul(l),s=this.curve._mulC(a).redMul(r.redISub(i)),o=a.redMul(l);return this.curve.point(n,s,o)};ir.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};ir.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=i.redSub(r),a=s.redSub(n),c=s.redAdd(n),l=i.redAdd(r),u=o.redMul(a),h=c.redMul(l),d=o.redMul(l),y=a.redMul(c);return this.curve.point(u,h,y,d)};ir.prototype._projAdd=function(e){var r=this.z.redMul(e.z),i=r.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(n).redMul(s),a=i.redSub(o),c=i.redAdd(o),l=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),u=r.redMul(a).redMul(l),h,d;return this.curve.twisted?(h=r.redMul(c).redMul(s.redSub(this.curve._mulA(n))),d=a.redMul(c)):(h=r.redMul(c).redMul(s.redSub(n)),d=this.curve._mulC(a).redMul(c)),this.curve.point(u,h,d)};ir.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};ir.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};ir.prototype.mulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!1)};ir.prototype.jmulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!0)};ir.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};ir.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};ir.prototype.getX=function(){return this.normalize(),this.x.fromRed()};ir.prototype.getY=function(){return this.normalize(),this.y.fromRed()};ir.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};ir.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),this.x.cmp(r)===0)return!0}};ir.prototype.toP=ir.prototype.normalize;ir.prototype.mixedAdd=ir.prototype.add});var iA=p(Y7=>{f();"use strict";var ew=Y7;ew.base=gg();ew.short=j7();ew.mont=H7();ew.edwards=W7()});var _o=p(Xt=>{f();"use strict";var VPe=Mu(),zPe=Xi();Xt.inherits=zPe;function HPe(t,e){return(t.charCodeAt(e)&64512)!=55296||e<0||e+1>=t.length?!1:(t.charCodeAt(e+1)&64512)==56320}function $Pe(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t=="string")if(e){if(e==="hex")for(t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!=0&&(t="0"+t),n=0;n<t.length;n+=2)r.push(parseInt(t[n]+t[n+1],16))}else for(var i=0,n=0;n<t.length;n++){var s=t.charCodeAt(n);s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):HPe(t,n)?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128)}else for(n=0;n<t.length;n++)r[n]=t[n]|0;return r}Xt.toArray=$Pe;function GPe(t){for(var e="",r=0;r<t.length;r++)e+=Q7(t[r].toString(16));return e}Xt.toHex=GPe;function X7(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(t&255)<<24;return e>>>0}Xt.htonl=X7;function WPe(t,e){for(var r="",i=0;i<t.length;i++){var n=t[i];e==="little"&&(n=X7(n)),r+=Z7(n.toString(16))}return r}Xt.toHex32=WPe;function Q7(t){return t.length===1?"0"+t:t}Xt.zero2=Q7;function Z7(t){return t.length===7?"0"+t:t.length===6?"00"+t:t.length===5?"000"+t:t.length===4?"0000"+t:t.length===3?"00000"+t:t.length===2?"000000"+t:t.length===1?"0000000"+t:t}Xt.zero8=Z7;function YPe(t,e,r,i){var n=r-e;VPe(n%4==0);for(var s=new Array(n/4),o=0,a=e;o<s.length;o++,a+=4){var c;i==="big"?c=t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3]:c=t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a],s[o]=c>>>0}return s}Xt.join32=YPe;function XPe(t,e){for(var r=new Array(t.length*4),i=0,n=0;i<t.length;i++,n+=4){var s=t[i];e==="big"?(r[n]=s>>>24,r[n+1]=s>>>16&255,r[n+2]=s>>>8&255,r[n+3]=s&255):(r[n+3]=s>>>24,r[n+2]=s>>>16&255,r[n+1]=s>>>8&255,r[n]=s&255)}return r}Xt.split32=XPe;function QPe(t,e){return t>>>e|t<<32-e}Xt.rotr32=QPe;function ZPe(t,e){return t<<e|t>>>32-e}Xt.rotl32=ZPe;function JPe(t,e){return t+e>>>0}Xt.sum32=JPe;function eCe(t,e,r){return t+e+r>>>0}Xt.sum32_3=eCe;function tCe(t,e,r,i){return t+e+r+i>>>0}Xt.sum32_4=tCe;function rCe(t,e,r,i,n){return t+e+r+i+n>>>0}Xt.sum32_5=rCe;function iCe(t,e,r,i){var n=t[e],s=t[e+1],o=i+s>>>0,a=(o<i?1:0)+r+n;t[e]=a>>>0,t[e+1]=o}Xt.sum64=iCe;function nCe(t,e,r,i){var n=e+i>>>0,s=(n<e?1:0)+t+r;return s>>>0}Xt.sum64_hi=nCe;function sCe(t,e,r,i){var n=e+i;return n>>>0}Xt.sum64_lo=sCe;function oCe(t,e,r,i,n,s,o,a){var c=0,l=e;l=l+i>>>0,c+=l<e?1:0,l=l+s>>>0,c+=l<s?1:0,l=l+a>>>0,c+=l<a?1:0;var u=t+r+n+o+c;return u>>>0}Xt.sum64_4_hi=oCe;function aCe(t,e,r,i,n,s,o,a){var c=e+i+s+a;return c>>>0}Xt.sum64_4_lo=aCe;function cCe(t,e,r,i,n,s,o,a,c,l){var u=0,h=e;h=h+i>>>0,u+=h<e?1:0,h=h+s>>>0,u+=h<s?1:0,h=h+a>>>0,u+=h<a?1:0,h=h+l>>>0,u+=h<l?1:0;var d=t+r+n+o+c+u;return d>>>0}Xt.sum64_5_hi=cCe;function uCe(t,e,r,i,n,s,o,a,c,l){var u=e+i+s+a+l;return u>>>0}Xt.sum64_5_lo=uCe;function lCe(t,e,r){var i=e<<32-r|t>>>r;return i>>>0}Xt.rotr64_hi=lCe;function fCe(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}Xt.rotr64_lo=fCe;function hCe(t,e,r){return t>>>r}Xt.shr64_hi=hCe;function dCe(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}Xt.shr64_lo=dCe});var Sd=p(eM=>{f();"use strict";var J7=_o(),pCe=Mu();function tw(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}eM.BlockHash=tw;tw.prototype.update=function(e,r){if(e=J7.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=J7.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this};tw.prototype.digest=function(e){return this.update(this._pad()),pCe(this.pending===null),this._digest(e)};tw.prototype._pad=function(){var e=this.pendingTotal,r=this._delta8,i=r-(e+this.padLength)%r,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=e>>>24&255,n[s++]=e>>>16&255,n[s++]=e>>>8&255,n[s++]=e&255}else for(n[s++]=e&255,n[s++]=e>>>8&255,n[s++]=e>>>16&255,n[s++]=e>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,o=8;o<this.padLength;o++)n[s++]=0;return n}});var nA=p(Bc=>{f();"use strict";var yCe=_o(),Ta=yCe.rotr32;function gCe(t,e,r,i){if(t===0)return tM(e,r,i);if(t===1||t===3)return iM(e,r,i);if(t===2)return rM(e,r,i)}Bc.ft_1=gCe;function tM(t,e,r){return t&e^~t&r}Bc.ch32=tM;function rM(t,e,r){return t&e^t&r^e&r}Bc.maj32=rM;function iM(t,e,r){return t^e^r}Bc.p32=iM;function bCe(t){return Ta(t,2)^Ta(t,13)^Ta(t,22)}Bc.s0_256=bCe;function mCe(t){return Ta(t,6)^Ta(t,11)^Ta(t,25)}Bc.s1_256=mCe;function vCe(t){return Ta(t,7)^Ta(t,18)^t>>>3}Bc.g0_256=vCe;function wCe(t){return Ta(t,17)^Ta(t,19)^t>>>10}Bc.g1_256=wCe});var oM=p((tIt,sM)=>{f();"use strict";var xd=_o(),_Ce=Sd(),ECe=nA(),sA=xd.rotl32,bg=xd.sum32,SCe=xd.sum32_5,xCe=ECe.ft_1,nM=_Ce.BlockHash,ACe=[1518500249,1859775393,2400959708,3395469782];function Ra(){if(!(this instanceof Ra))return new Ra;nM.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}xd.inherits(Ra,nM);sM.exports=Ra;Ra.blockSize=512;Ra.outSize=160;Ra.hmacStrength=80;Ra.padLength=64;Ra.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=sA(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],l=this.h[4];for(n=0;n<i.length;n++){var u=~~(n/20),h=SCe(sA(s,5),xCe(u,o,a,c),l,i[n],ACe[u]);l=c,c=a,a=sA(o,30),o=s,s=h}this.h[0]=bg(this.h[0],s),this.h[1]=bg(this.h[1],o),this.h[2]=bg(this.h[2],a),this.h[3]=bg(this.h[3],c),this.h[4]=bg(this.h[4],l)};Ra.prototype._digest=function(e){return e==="hex"?xd.toHex32(this.h,"big"):xd.split32(this.h,"big")}});var oA=p((rIt,cM)=>{f();"use strict";var Ad=_o(),ICe=Sd(),Id=nA(),TCe=Mu(),Eo=Ad.sum32,RCe=Ad.sum32_4,PCe=Ad.sum32_5,CCe=Id.ch32,OCe=Id.maj32,kCe=Id.s0_256,qCe=Id.s1_256,BCe=Id.g0_256,NCe=Id.g1_256,aM=ICe.BlockHash,DCe=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Pa(){if(!(this instanceof Pa))return new Pa;aM.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=DCe,this.W=new Array(64)}Ad.inherits(Pa,aM);cM.exports=Pa;Pa.blockSize=512;Pa.outSize=256;Pa.hmacStrength=192;Pa.padLength=64;Pa.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=RCe(NCe(i[n-2]),i[n-7],BCe(i[n-15]),i[n-16]);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],l=this.h[4],u=this.h[5],h=this.h[6],d=this.h[7];for(TCe(this.k.length===i.length),n=0;n<i.length;n++){var y=PCe(d,qCe(l),CCe(l,u,h),this.k[n],i[n]),g=Eo(kCe(s),OCe(s,o,a));d=h,h=u,u=l,l=Eo(c,y),c=a,a=o,o=s,s=Eo(y,g)}this.h[0]=Eo(this.h[0],s),this.h[1]=Eo(this.h[1],o),this.h[2]=Eo(this.h[2],a),this.h[3]=Eo(this.h[3],c),this.h[4]=Eo(this.h[4],l),this.h[5]=Eo(this.h[5],u),this.h[6]=Eo(this.h[6],h),this.h[7]=Eo(this.h[7],d)};Pa.prototype._digest=function(e){return e==="hex"?Ad.toHex32(this.h,"big"):Ad.split32(this.h,"big")}});var fM=p((iIt,lM)=>{f();"use strict";var aA=_o(),uM=oA();function Nc(){if(!(this instanceof Nc))return new Nc;uM.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}aA.inherits(Nc,uM);lM.exports=Nc;Nc.blockSize=512;Nc.outSize=224;Nc.hmacStrength=192;Nc.padLength=64;Nc.prototype._digest=function(e){return e==="hex"?aA.toHex32(this.h.slice(0,7),"big"):aA.split32(this.h.slice(0,7),"big")}});var lA=p((nIt,yM)=>{f();"use strict";var jn=_o(),MCe=Sd(),LCe=Mu(),Ca=jn.rotr64_hi,Oa=jn.rotr64_lo,hM=jn.shr64_hi,dM=jn.shr64_lo,Fu=jn.sum64,cA=jn.sum64_hi,uA=jn.sum64_lo,UCe=jn.sum64_4_hi,FCe=jn.sum64_4_lo,KCe=jn.sum64_5_hi,jCe=jn.sum64_5_lo,pM=MCe.BlockHash,VCe=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function So(){if(!(this instanceof So))return new So;pM.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=VCe,this.W=new Array(160)}jn.inherits(So,pM);yM.exports=So;So.blockSize=1024;So.outSize=512;So.hmacStrength=192;So.padLength=128;So.prototype._prepareBlock=function(e,r){for(var i=this.W,n=0;n<32;n++)i[n]=e[r+n];for(;n<i.length;n+=2){var s=eOe(i[n-4],i[n-3]),o=tOe(i[n-4],i[n-3]),a=i[n-14],c=i[n-13],l=ZCe(i[n-30],i[n-29]),u=JCe(i[n-30],i[n-29]),h=i[n-32],d=i[n-31];i[n]=UCe(s,o,a,c,l,u,h,d),i[n+1]=FCe(s,o,a,c,l,u,h,d)}};So.prototype._update=function(e,r){this._prepareBlock(e,r);var i=this.W,n=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],l=this.h[5],u=this.h[6],h=this.h[7],d=this.h[8],y=this.h[9],g=this.h[10],m=this.h[11],E=this.h[12],v=this.h[13],A=this.h[14],R=this.h[15];LCe(this.k.length===i.length);for(var F=0;F<i.length;F+=2){var q=A,B=R,z=XCe(d,y),G=QCe(d,y),Y=zCe(d,y,g,m,E,v),P=HCe(d,y,g,m,E,v),b=this.k[F],w=this.k[F+1],S=i[F],C=i[F+1],D=KCe(q,B,z,G,Y,P,b,w,S,C),W=jCe(q,B,z,G,Y,P,b,w,S,C);q=WCe(n,s),B=YCe(n,s),z=$Ce(n,s,o,a,c,l),G=GCe(n,s,o,a,c,l);var j=cA(q,B,z,G),M=uA(q,B,z,G);A=E,R=v,E=g,v=m,g=d,m=y,d=cA(u,h,D,W),y=uA(h,h,D,W),u=c,h=l,c=o,l=a,o=n,a=s,n=cA(D,W,j,M),s=uA(D,W,j,M)}Fu(this.h,0,n,s),Fu(this.h,2,o,a),Fu(this.h,4,c,l),Fu(this.h,6,u,h),Fu(this.h,8,d,y),Fu(this.h,10,g,m),Fu(this.h,12,E,v),Fu(this.h,14,A,R)};So.prototype._digest=function(e){return e==="hex"?jn.toHex32(this.h,"big"):jn.split32(this.h,"big")};function zCe(t,e,r,i,n){var s=t&r^~t&n;return s<0&&(s+=4294967296),s}function HCe(t,e,r,i,n,s){var o=e&i^~e&s;return o<0&&(o+=4294967296),o}function $Ce(t,e,r,i,n){var s=t&r^t&n^r&n;return s<0&&(s+=4294967296),s}function GCe(t,e,r,i,n,s){var o=e&i^e&s^i&s;return o<0&&(o+=4294967296),o}function WCe(t,e){var r=Ca(t,e,28),i=Ca(e,t,2),n=Ca(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function YCe(t,e){var r=Oa(t,e,28),i=Oa(e,t,2),n=Oa(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function XCe(t,e){var r=Ca(t,e,14),i=Ca(t,e,18),n=Ca(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function QCe(t,e){var r=Oa(t,e,14),i=Oa(t,e,18),n=Oa(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function ZCe(t,e){var r=Ca(t,e,1),i=Ca(t,e,8),n=hM(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function JCe(t,e){var r=Oa(t,e,1),i=Oa(t,e,8),n=dM(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function eOe(t,e){var r=Ca(t,e,19),i=Ca(e,t,29),n=hM(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}function tOe(t,e){var r=Oa(t,e,19),i=Oa(e,t,29),n=dM(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}});var mM=p((sIt,bM)=>{f();"use strict";var fA=_o(),gM=lA();function Dc(){if(!(this instanceof Dc))return new Dc;gM.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}fA.inherits(Dc,gM);bM.exports=Dc;Dc.blockSize=1024;Dc.outSize=384;Dc.hmacStrength=192;Dc.padLength=128;Dc.prototype._digest=function(e){return e==="hex"?fA.toHex32(this.h.slice(0,12),"big"):fA.split32(this.h.slice(0,12),"big")}});var vM=p(Td=>{f();"use strict";Td.sha1=oM();Td.sha224=fM();Td.sha256=oA();Td.sha384=mM();Td.sha512=lA()});var AM=p(xM=>{f();"use strict";var yf=_o(),rOe=Sd(),rw=yf.rotl32,wM=yf.sum32,mg=yf.sum32_3,_M=yf.sum32_4,EM=rOe.BlockHash;function ka(){if(!(this instanceof ka))return new ka;EM.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}yf.inherits(ka,EM);xM.ripemd160=ka;ka.blockSize=512;ka.outSize=160;ka.hmacStrength=192;ka.padLength=64;ka.prototype._update=function(e,r){for(var i=this.h[0],n=this.h[1],s=this.h[2],o=this.h[3],a=this.h[4],c=i,l=n,u=s,h=o,d=a,y=0;y<80;y++){var g=wM(rw(_M(i,SM(y,n,s,o),e[sOe[y]+r],iOe(y)),aOe[y]),a);i=a,a=o,o=rw(s,10),s=n,n=g,g=wM(rw(_M(c,SM(79-y,l,u,h),e[oOe[y]+r],nOe(y)),cOe[y]),d),c=d,d=h,h=rw(u,10),u=l,l=g}g=mg(this.h[1],s,h),this.h[1]=mg(this.h[2],o,d),this.h[2]=mg(this.h[3],a,c),this.h[3]=mg(this.h[4],i,l),this.h[4]=mg(this.h[0],n,u),this.h[0]=g};ka.prototype._digest=function(e){return e==="hex"?yf.toHex32(this.h,"little"):yf.split32(this.h,"little")};function SM(t,e,r,i){return t<=15?e^r^i:t<=31?e&r|~e&i:t<=47?(e|~r)^i:t<=63?e&i|r&~i:e^(r|~i)}function iOe(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function nOe(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var sOe=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],oOe=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],aOe=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],cOe=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]});var TM=p((cIt,IM)=>{f();"use strict";var uOe=_o(),lOe=Mu();function Rd(t,e,r){if(!(this instanceof Rd))return new Rd(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(uOe.toArray(e,r))}IM.exports=Rd;Rd.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),lOe(e.length<=this.blockSize);for(var r=e.length;r<this.blockSize;r++)e.push(0);for(r=0;r<e.length;r++)e[r]^=54;for(this.inner=new this.Hash().update(e),r=0;r<e.length;r++)e[r]^=106;this.outer=new this.Hash().update(e)};Rd.prototype.update=function(e,r){return this.inner.update(e,r),this};Rd.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}});var iw=p(RM=>{f();var Zi=RM;Zi.utils=_o();Zi.common=Sd();Zi.sha=vM();Zi.ripemd=AM();Zi.hmac=TM();Zi.sha1=Zi.sha.sha1;Zi.sha256=Zi.sha.sha256;Zi.sha224=Zi.sha.sha224;Zi.sha384=Zi.sha.sha384;Zi.sha512=Zi.sha.sha512;Zi.ripemd160=Zi.ripemd.ripemd160});var CM=p((lIt,PM)=>{f();PM.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var nw=p(qM=>{f();"use strict";var hA=qM,Ku=iw(),dA=iA(),fOe=ss(),OM=fOe.assert;function kM(t){t.type==="short"?this.curve=new dA.short(t):t.type==="edwards"?this.curve=new dA.edwards(t):this.curve=new dA.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,OM(this.g.validate(),"Invalid curve"),OM(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}hA.PresetCurve=kM;function ju(t,e){Object.defineProperty(hA,t,{configurable:!0,enumerable:!0,get:function(){var r=new kM(e);return Object.defineProperty(hA,t,{configurable:!0,enumerable:!0,value:r}),r}})}ju("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Ku.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});ju("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Ku.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});ju("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Ku.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});ju("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Ku.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});ju("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Ku.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});ju("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ku.sha256,gRed:!1,g:["9"]});ju("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ku.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var pA;try{pA=CM()}catch(t){pA=void 0}ju("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Ku.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",pA]})});var DM=p((hIt,NM)=>{f();"use strict";var hOe=iw(),gf=Xx(),BM=Mu();function Vu(t){if(!(this instanceof Vu))return new Vu(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=gf.toArray(t.entropy,t.entropyEnc||"hex"),r=gf.toArray(t.nonce,t.nonceEnc||"hex"),i=gf.toArray(t.pers,t.persEnc||"hex");BM(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,i)}NM.exports=Vu;Vu.prototype._init=function(e,r,i){var n=e.concat(r).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};Vu.prototype._hmac=function(){return new hOe.hmac(this.hash,this.K)};Vu.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),!!e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};Vu.prototype.reseed=function(e,r,i,n){typeof r!="string"&&(n=i,i=r,r=null),e=gf.toArray(e,r),i=gf.toArray(i,n),BM(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};Vu.prototype.generate=function(e,r,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(n=i,i=r,r=null),i&&(i=gf.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(i),this._reseed++,gf.encode(o,r)}});var LM=p((dIt,MM)=>{f();"use strict";var dOe=Aa(),pOe=ss(),yA=pOe.assert;function fn(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}MM.exports=fn;fn.fromPublic=function(e,r,i){return r instanceof fn?r:new fn(e,{pub:r,pubEnc:i})};fn.fromPrivate=function(e,r,i){return r instanceof fn?r:new fn(e,{priv:r,privEnc:i})};fn.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};fn.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub};fn.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};fn.prototype._importPrivate=function(e,r){this.priv=new dOe(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)};fn.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?yA(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&yA(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)};fn.prototype.derive=function(e){return e.validate()||yA(e.validate(),"public point not validated"),e.mul(this.priv).getX()};fn.prototype.sign=function(e,r,i){return this.ec.sign(e,this,r,i)};fn.prototype.verify=function(e,r){return this.ec.verify(e,r,this)};fn.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var KM=p((pIt,FM)=>{f();"use strict";var sw=Aa(),gA=ss(),yOe=gA.assert;function ow(t,e){if(t instanceof ow)return t;this._importDER(t,e)||(yOe(t.r&&t.s,"Signature without r or s"),this.r=new sw(t.r,16),this.s=new sw(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}FM.exports=ow;function gOe(){this.place=0}function bA(t,e){var r=t[e.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4)return!1;for(var n=0,s=0,o=e.place;s<i;s++,o++)n<<=8,n|=t[o],n>>>=0;return n<=127?!1:(e.place=o,n)}function UM(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}ow.prototype._importDER=function(e,r){e=gA.toArray(e,r);var i=new gOe;if(e[i.place++]!==48)return!1;var n=bA(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=bA(e,i);if(s===!1)return!1;var o=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var a=bA(e,i);if(a===!1||e.length!==a+i.place)return!1;var c=e.slice(i.place,a+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new sw(o),this.s=new sw(c),this.recoveryParam=null,!0};function mA(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}ow.prototype.toDER=function(e){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=UM(r),i=UM(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];mA(n,r.length),n=n.concat(r),n.push(2),mA(n,i.length);var s=n.concat(i),o=[48];return mA(o,s.length),o=o.concat(s),gA.encode(o,e)}});var HM=p((yIt,zM)=>{f();"use strict";var bf=Aa(),jM=DM(),bOe=ss(),vA=nw(),mOe=eA(),VM=bOe.assert,wA=LM(),aw=KM();function qs(t){if(!(this instanceof qs))return new qs(t);typeof t=="string"&&(VM(Object.prototype.hasOwnProperty.call(vA,t),"Unknown curve "+t),t=vA[t]),t instanceof vA.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}zM.exports=qs;qs.prototype.keyPair=function(e){return new wA(this,e)};qs.prototype.keyFromPrivate=function(e,r){return wA.fromPrivate(this,e,r)};qs.prototype.keyFromPublic=function(e,r){return wA.fromPublic(this,e,r)};qs.prototype.genKeyPair=function(e){e||(e={});for(var r=new jM({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||mOe(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new bf(2));;){var s=new bf(r.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};qs.prototype._truncateToN=function(e,r){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e};qs.prototype.sign=function(e,r,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),r=this.keyFromPrivate(r,i),e=this._truncateToN(new bf(e,16));for(var s=this.n.byteLength(),o=r.getPrivate().toArray("be",s),a=e.toArray("be",s),c=new jM({hash:this.hash,entropy:o,nonce:a,pers:n.pers,persEnc:n.persEnc||"utf8"}),l=this.n.sub(new bf(1)),u=0;;u++){var h=n.k?n.k(u):new bf(c.generate(this.n.byteLength()));if(h=this._truncateToN(h,!0),!(h.cmpn(1)<=0||h.cmp(l)>=0)){var d=this.g.mul(h);if(!d.isInfinity()){var y=d.getX(),g=y.umod(this.n);if(g.cmpn(0)!==0){var m=h.invm(this.n).mul(g.mul(r.getPrivate()).iadd(e));if(m=m.umod(this.n),m.cmpn(0)!==0){var E=(d.getY().isOdd()?1:0)|(y.cmp(g)!==0?2:0);return n.canonical&&m.cmp(this.nh)>0&&(m=this.n.sub(m),E^=1),new aw({r:g,s:m,recoveryParam:E})}}}}}};qs.prototype.verify=function(e,r,i,n){e=this._truncateToN(new bf(e,16)),i=this.keyFromPublic(i,n),r=new aw(r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),c=a.mul(e).umod(this.n),l=a.mul(s).umod(this.n),u;return this.curve._maxwellTrick?(u=this.g.jmulAdd(c,i.getPublic(),l),u.isInfinity()?!1:u.eqXToP(s)):(u=this.g.mulAdd(c,i.getPublic(),l),u.isInfinity()?!1:u.getX().umod(this.n).cmp(s)===0)};qs.prototype.recoverPubKey=function(t,e,r,i){VM((3&r)===r,"The recovery param is more than two bits"),e=new aw(e,i);var n=this.n,s=new bf(t),o=e.r,a=e.s,c=r&1,l=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");l?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var u=e.r.invm(n),h=n.sub(s).mul(u).umod(n),d=a.mul(u).umod(n);return this.g.mulAdd(h,o,d)};qs.prototype.getKeyRecoveryParam=function(t,e,r,i){if(e=new aw(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(t,e,n)}catch(o){continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")}});var YM=p((gIt,WM)=>{f();"use strict";var vg=ss(),$M=vg.assert,GM=vg.parseBytes,Pd=vg.cachedProperty;function Ki(t,e){this.eddsa=t,this._secret=GM(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=GM(e.pub)}Ki.fromPublic=function(e,r){return r instanceof Ki?r:new Ki(e,{pub:r})};Ki.fromSecret=function(e,r){return r instanceof Ki?r:new Ki(e,{secret:r})};Ki.prototype.secret=function(){return this._secret};Pd(Ki,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});Pd(Ki,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});Pd(Ki,"privBytes",function(){var e=this.eddsa,r=this.hash(),i=e.encodingLength-1,n=r.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n});Pd(Ki,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});Pd(Ki,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});Pd(Ki,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});Ki.prototype.sign=function(e){return $M(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};Ki.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)};Ki.prototype.getSecret=function(e){return $M(this._secret,"KeyPair is public only"),vg.encode(this.secret(),e)};Ki.prototype.getPublic=function(e){return vg.encode(this.pubBytes(),e)};WM.exports=Ki});var QM=p((bIt,XM)=>{f();"use strict";var vOe=Aa(),cw=ss(),wOe=cw.assert,uw=cw.cachedProperty,_Oe=cw.parseBytes;function mf(t,e){this.eddsa=t,typeof e!="object"&&(e=_Oe(e)),Array.isArray(e)&&(e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),wOe(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof vOe&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}uw(mf,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});uw(mf,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});uw(mf,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});uw(mf,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});mf.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};mf.prototype.toHex=function(){return cw.encode(this.toBytes(),"hex").toUpperCase()};XM.exports=mf});var rL=p((mIt,tL)=>{f();"use strict";var EOe=iw(),SOe=nw(),Cd=ss(),xOe=Cd.assert,ZM=Cd.parseBytes,JM=YM(),eL=QM();function Vn(t){if(xOe(t==="ed25519","only tested with ed25519 so far"),!(this instanceof Vn))return new Vn(t);t=SOe[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=EOe.sha512}tL.exports=Vn;Vn.prototype.sign=function(e,r){e=ZM(e);var i=this.keyFromSecret(r),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),o=this.encodePoint(s),a=this.hashInt(o,i.pubBytes(),e).mul(i.priv()),c=n.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})};Vn.prototype.verify=function(e,r,i){e=ZM(e),r=this.makeSignature(r);var n=this.keyFromPublic(i),s=this.hashInt(r.Rencoded(),n.pubBytes(),e),o=this.g.mul(r.S()),a=r.R().add(n.pub().mul(s));return a.eq(o)};Vn.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return Cd.intFromLE(e.digest()).umod(this.curve.n)};Vn.prototype.keyFromPublic=function(e){return JM.fromPublic(this,e)};Vn.prototype.keyFromSecret=function(e){return JM.fromSecret(this,e)};Vn.prototype.makeSignature=function(e){return e instanceof eL?e:new eL(this,e)};Vn.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r};Vn.prototype.decodePoint=function(e){e=Cd.parseBytes(e);var r=e.length-1,i=e.slice(0,r).concat(e[r]&~128),n=(e[r]&128)!=0,s=Cd.intFromLE(i);return this.curve.pointFromY(s,n)};Vn.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Vn.prototype.decodeInt=function(e){return Cd.intFromLE(e)};Vn.prototype.isPoint=function(e){return e instanceof this.pointClass}});var nL=p(iL=>{f();"use strict";var vf=iL;vf.version=O7().version;vf.utils=ss();vf.rand=eA();vf.curve=iA();vf.curves=nw();vf.ec=HM();vf.eddsa=rL()});var oL=p((wIt,sL)=>{f();var AOe=nL().ec,qa=new AOe("secp256k1"),St=qa.curve,Qt=St.n.constructor;function IOe(t,e){let r=new Qt(e);if(r.cmp(St.p)>=0)return null;r=r.toRed(St.red);let i=r.redSqr().redIMul(r).redIAdd(St.b).redSqrt();return t===3!==i.isOdd()&&(i=i.redNeg()),qa.keyPair({pub:{x:r,y:i}})}function TOe(t,e,r){let i=new Qt(e),n=new Qt(r);if(i.cmp(St.p)>=0||n.cmp(St.p)>=0||(i=i.toRed(St.red),n=n.toRed(St.red),(t===6||t===7)&&n.isOdd()!==(t===7)))return null;let s=i.redSqr().redIMul(i);return n.redSqr().redISub(s.redIAdd(St.b)).isZero()?qa.keyPair({pub:{x:i,y:n}}):null}function zu(t){let e=t[0];switch(e){case 2:case 3:return t.length!==33?null:IOe(e,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:TOe(e,t.subarray(1,33),t.subarray(33,65));default:return null}}function wf(t,e){let r=e.encode(null,t.length===33);for(let i=0;i<t.length;++i)t[i]=r[i]}sL.exports={contextRandomize(){return 0},privateKeyVerify(t){let e=new Qt(t);return e.cmp(St.n)<0&&!e.isZero()?0:1},privateKeyNegate(t){let e=new Qt(t),r=St.n.sub(e).umod(St.n).toArrayLike(Uint8Array,"be",32);return t.set(r),0},privateKeyTweakAdd(t,e){let r=new Qt(e);if(r.cmp(St.n)>=0||(r.iadd(new Qt(t)),r.cmp(St.n)>=0&&r.isub(St.n),r.isZero()))return 1;let i=r.toArrayLike(Uint8Array,"be",32);return t.set(i),0},privateKeyTweakMul(t,e){let r=new Qt(e);if(r.cmp(St.n)>=0||r.isZero())return 1;r.imul(new Qt(t)),r.cmp(St.n)>=0&&(r=r.umod(St.n));let i=r.toArrayLike(Uint8Array,"be",32);return t.set(i),0},publicKeyVerify(t){return zu(t)===null?1:0},publicKeyCreate(t,e){let r=new Qt(e);if(r.cmp(St.n)>=0||r.isZero())return 1;let i=qa.keyFromPrivate(e).getPublic();return wf(t,i),0},publicKeyConvert(t,e){let r=zu(e);if(r===null)return 1;let i=r.getPublic();return wf(t,i),0},publicKeyNegate(t,e){let r=zu(e);if(r===null)return 1;let i=r.getPublic();return i.y=i.y.redNeg(),wf(t,i),0},publicKeyCombine(t,e){let r=new Array(e.length);for(let n=0;n<e.length;++n)if(r[n]=zu(e[n]),r[n]===null)return 1;let i=r[0].getPublic();for(let n=1;n<r.length;++n)i=i.add(r[n].pub);return i.isInfinity()?2:(wf(t,i),0)},publicKeyTweakAdd(t,e,r){let i=zu(e);if(i===null)return 1;if(r=new Qt(r),r.cmp(St.n)>=0)return 2;let n=i.getPublic().add(St.g.mul(r));return n.isInfinity()?2:(wf(t,n),0)},publicKeyTweakMul(t,e,r){let i=zu(e);if(i===null)return 1;if(r=new Qt(r),r.cmp(St.n)>=0||r.isZero())return 2;let n=i.getPublic().mul(r);return wf(t,n),0},signatureNormalize(t){let e=new Qt(t.subarray(0,32)),r=new Qt(t.subarray(32,64));return e.cmp(St.n)>=0||r.cmp(St.n)>=0?1:(r.cmp(qa.nh)===1&&t.set(St.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(t,e){let r=e.subarray(0,32),i=e.subarray(32,64);if(new Qt(r).cmp(St.n)>=0||new Qt(i).cmp(St.n)>=0)return 1;let{output:n}=t,s=n.subarray(4,4+33);s[0]=0,s.set(r,1);let o=33,a=0;for(;o>1&&s[a]===0&&!(s[a+1]&128);--o,++a);if(s=s.subarray(a),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let c=n.subarray(6+33,6+33+33);c[0]=0,c.set(i,1);let l=33,u=0;for(;l>1&&c[u]===0&&!(c[u+1]&128);--l,++u);return c=c.subarray(u),c[0]&128||l>1&&c[0]===0&&!(c[1]&128)?1:(t.outputlen=6+o+l,n[0]=48,n[1]=t.outputlen-2,n[2]=2,n[3]=s.length,n.set(s,4),n[4+o]=2,n[5+o]=c.length,n.set(c,6+o),0)},signatureImport(t,e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return 1;let r=e[3];if(r===0||5+r>=e.length||e[4+r]!==2)return 1;let i=e[5+r];if(i===0||6+r+i!==e.length||e[4]&128||r>1&&e[4]===0&&!(e[5]&128)||e[r+6]&128||i>1&&e[r+6]===0&&!(e[r+7]&128))return 1;let n=e.subarray(4,4+r);if(n.length===33&&n[0]===0&&(n=n.subarray(1)),n.length>32)return 1;let s=e.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new Qt(n);o.cmp(St.n)>=0&&(o=new Qt(0));let a=new Qt(e.subarray(6+r));return a.cmp(St.n)>=0&&(a=new Qt(0)),t.set(o.toArrayLike(Uint8Array,"be",32),0),t.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(t,e,r,i,n){if(n){let a=n;n=c=>{let l=a(e,r,null,i,c);if(!(l instanceof Uint8Array&&l.length===32))throw new Error("This is the way");return new Qt(l)}}let s=new Qt(r);if(s.cmp(St.n)>=0||s.isZero())return 1;let o;try{o=qa.sign(e,r,{canonical:!0,k:n,pers:i})}catch(a){return 1}return t.signature.set(o.r.toArrayLike(Uint8Array,"be",32),0),t.signature.set(o.s.toArrayLike(Uint8Array,"be",32),32),t.recid=o.recoveryParam,0},ecdsaVerify(t,e,r){let i={r:t.subarray(0,32),s:t.subarray(32,64)},n=new Qt(i.r),s=new Qt(i.s);if(n.cmp(St.n)>=0||s.cmp(St.n)>=0)return 1;if(s.cmp(qa.nh)===1||n.isZero()||s.isZero())return 3;let o=zu(r);if(o===null)return 2;let a=o.getPublic();return qa.verify(e,i,a)?0:3},ecdsaRecover(t,e,r,i){let n={r:e.slice(0,32),s:e.slice(32,64)},s=new Qt(n.r),o=new Qt(n.s);if(s.cmp(St.n)>=0||o.cmp(St.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let a;try{a=qa.recoverPubKey(i,n,r)}catch(c){return 2}return wf(t,a),0},ecdh(t,e,r,i,n,s,o){let a=zu(e);if(a===null)return 1;let c=new Qt(r);if(c.cmp(St.n)>=0||c.isZero())return 2;let l=a.getPublic().mul(c);if(n===void 0){let u=l.encode(null,!0),h=qa.hash().update(u).digest();for(let d=0;d<32;++d)t[d]=h[d]}else{s||(s=new Uint8Array(32));let u=l.getX().toArray("be",32);for(let g=0;g<32;++g)s[g]=u[g];o||(o=new Uint8Array(32));let h=l.getY().toArray("be",32);for(let g=0;g<32;++g)o[g]=h[g];let d=n(s,o,i);if(!(d instanceof Uint8Array&&d.length===t.length))return 2;t.set(d)}return 0}}});var cL=p((_It,aL)=>{f();aL.exports=C7()(oL())});var fL=p((EIt,lL)=>{f();"use strict";var xo=cL(),{sha256:uL}=(ai(),$r);lL.exports=t=>{let e=32;function r(){let u;do u=t(32);while(!xo.privateKeyVerify(u));return u}async function i(u,h){let{digest:d}=await uL.digest(h),y=xo.ecdsaSign(d,u);return xo.signatureExport(y.signature)}async function n(u,h,d){let{digest:y}=await uL.digest(d);return h=xo.signatureImport(h),xo.ecdsaVerify(h,y,u)}function s(u){if(!xo.publicKeyVerify(u))throw new Error("Invalid public key");return xo.publicKeyConvert(u,!0)}function o(u){return xo.publicKeyConvert(u,!1)}function a(u){if(!xo.privateKeyVerify(u))throw new Error("Invalid private key")}function c(u){if(!xo.publicKeyVerify(u))throw new Error("Invalid public key")}function l(u){return a(u),xo.publicKeyCreate(u)}return{generateKey:r,privateKeyLength:e,hashAndSign:i,hashAndVerify:n,compressPublicKey:s,decompressPublicKey:o,validatePrivateKey:a,validatePublicKey:c,computePublicKey:l}}});var yL=p((SIt,pL)=>{f();"use strict";var{sha256:hL}=(ai(),$r),ROe=ae(),dL=yi(),POe=Je(),COe=jv();pL.exports=(t,e,r)=>{r=r||fL()(e);class i{constructor(l){r.validatePublicKey(l),this._key=l}verify(l,u){return r.hashAndVerify(this._key,u,l)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(l){return dL(this.bytes,l.bytes)}async hash(){let{bytes:l}=await hL.digest(this.bytes);return l}}class n{constructor(l,u){this._key=l,this._publicKey=u||r.computePublicKey(l),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(l){return r.hashAndSign(this._key,l)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(l){return dL(this.bytes,l.bytes)}async hash(){let{bytes:l}=await hL.digest(this.bytes);return l}async id(){let l=await this.public.hash();return POe(l,"base58btc")}async export(l,u="libp2p-key"){if(u==="libp2p-key")return COe.export(this.bytes,l);throw ROe(new Error(`export format '${u}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new n(c)}function o(c){return new i(c)}async function a(){let c=await r.generateKey();return new n(c)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var bL=p((xIt,gL)=>{f();"use strict";gL.exports={SHA1:20,SHA256:32,SHA512:64}});var _A=p(vL=>{f();"use strict";var mL=cg(),OOe=bL(),kOe={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},qOe=async(t,e)=>{let r=await mL.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};vL.create=async function(t,e){let r=kOe[t],i=await mL.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(n){return qOe(i,n)},length:OOe[t]}}});var xL=p((IIt,SL)=>{f();"use strict";var wL=ae(),_L=un(),BOe=ct(),NOe=_A(),EL={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};SL.exports=async(t,e,r)=>{let i=EL[t];if(!i){let A=Object.keys(EL).join(" / ");throw wL(new Error(`unknown cipher type '${t}'. Must be ${A}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw wL(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,o=20,a=BOe("key expansion"),c=2*(s+n+o),l=await NOe.create(e,r),u=await l.digest(a),h=[],d=0;for(;d<c;){let A=await l.digest(_L([u,a])),R=A.length;d+R>c&&(R=c-d),h.push(A),d+=R,u=await l.digest(u)}let y=c/2,g=_L(h),m=g.slice(0,y),E=g.slice(y,c),v=A=>({iv:A.slice(0,s),cipherKey:A.slice(s,s+n),macKey:A.slice(s+n)});return{k1:v(m),k2:v(E)}}});var IL=p((TIt,AL)=>{f();"use strict";var DOe=ae();AL.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw DOe(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var kL=p(OL=>{f();"use strict";var MOe=ae(),wg=cg(),{base64urlToBuffer:TL}=Kv(),LOe=IL(),EA=Je(),UOe=un(),FOe=yi(),RL={"P-256":256,"P-384":384,"P-521":521};OL.generateEphmeralKeyPair=async function(t){LOe(Object.keys(RL),t);let e=await wg.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(n,s)=>{let o;s?o=await wg.get().subtle.importKey("jwk",jOe(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let a=[await wg.get().subtle.importKey("jwk",CL(t,n),{name:"ECDH",namedCurve:t},!1,[]),o],c=await wg.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:a[0]},a[1],RL[t]);return new Uint8Array(c,c.byteOffset,c.byteLength)},i=await wg.get().subtle.exportKey("jwk",e.publicKey);return{key:KOe(i),genSharedKey:r}};var PL={"P-256":32,"P-384":48,"P-521":66};function KOe(t){let e=PL[t.crv];return UOe([Uint8Array.from([4]),TL(t.x,e),TL(t.y,e)],1+e*2)}function CL(t,e){let r=PL[t];if(FOe(!e.slice(0,1),Uint8Array.from([4])))throw MOe(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:EA(e.slice(1,r+1),"base64url"),y:EA(e.slice(1+r),"base64url"),ext:!0}}var jOe=(t,e)=>({...CL(t,e.public),d:EA(e.private,"base64url")})});var BL=p((PIt,qL)=>{f();"use strict";var VOe=kL();qL.exports=async t=>VOe.generateEphmeralKeyPair(t)});var fw=p((CIt,DL)=>{f();"use strict";var Ba=yv();Ac();Tx();var SA=lt(),_g=ae(),zOe=ct(),HOe=DD(),Bs={rsa:E7(),ed25519:R7(),secp256k1:yL()(Ba,fg())},lw={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function Od(t){let e=Bs[t.toLowerCase()];if(!e){let r=Object.keys(Bs).join(" / ");throw _g(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var $Oe=async(t,e)=>Od(t).generateKeyPair(e),GOe=async(t,e,r)=>{let i=Od(t);if(t.toLowerCase()!=="ed25519")throw _g(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,r)},WOe=t=>{let e=Ba.PublicKey.decode(t),r=e.Data;switch(e.Type){case Ba.KeyType.RSA:return Bs.rsa.unmarshalRsaPublicKey(r);case Ba.KeyType.Ed25519:return Bs.ed25519.unmarshalEd25519PublicKey(r);case Ba.KeyType.Secp256k1:if(Bs.secp256k1)return Bs.secp256k1.unmarshalSecp256k1PublicKey(r);throw _g(new Error(lw.message),lw.code);default:Od(e.Type)}},YOe=(t,e)=>(e=(e||"rsa").toLowerCase(),Od(e),t.bytes),NL=async t=>{let e=Ba.PrivateKey.decode(t),r=e.Data;switch(e.Type){case Ba.KeyType.RSA:return Bs.rsa.unmarshalRsaPrivateKey(r);case Ba.KeyType.Ed25519:return Bs.ed25519.unmarshalEd25519PrivateKey(r);case Ba.KeyType.Secp256k1:if(Bs.secp256k1)return Bs.secp256k1.unmarshalSecp256k1PrivateKey(r);throw _g(new Error(lw.message),lw.code);default:Od(e.Type)}},XOe=(t,e)=>(e=(e||"rsa").toLowerCase(),Od(e),t.bytes),QOe=async(t,e)=>{try{let n=await HOe.import(t,e);return NL(n)}catch(n){}let r=SA.pki.decryptRsaPrivateKey(t,e);if(r===null)throw _g(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=SA.asn1.toDer(SA.pki.privateKeyToAsn1(r));return i=zOe(i.getBytes(),"ascii"),Bs.rsa.unmarshalRsaPrivateKey(i)};DL.exports={supportedKeys:Bs,keysPBM:Ba,keyStretcher:xL(),generateEphemeralKeyPair:BL(),generateKeyPair:$Oe,generateKeyPairFromSeed:GOe,unmarshalPublicKey:WOe,marshalPublicKey:YOe,unmarshalPrivateKey:NL,marshalPrivateKey:XOe,import:QOe}});var hw=p((OIt,xA)=>{f();"use strict";function ZOe(t,{className:e,symbolName:r}){let i=Symbol.for(r),n={[e]:class extends t{constructor(...s){super(...s);Object.defineProperty(this,i,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return n[`is${e}`]=s=>!!(s&&s[i]),n}function JOe(t,{className:e,symbolName:r,withoutNew:i}){let n=Symbol.for(r),s={[e]:function(...o){if(i&&!(this instanceof s))return new s(...o);let a=t.call(this,...o)||this;return a&&!a[n]&&Object.defineProperty(a,n,{value:!0}),a}}[e];return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[n]),s}xA.exports=ZOe;xA.exports.proto=JOe});var UL=p((kIt,LL)=>{f();"use strict";var kd=Bi(),ML=kd.Reader,eke=kd.Writer,_i=kd.util,Eg=kd.roots["libp2p-peer-id"]||(kd.roots["libp2p-peer-id"]={});Eg.PeerIdProto=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.id=_i.newBuffer([]),t.prototype.pubKey=_i.newBuffer([]),t.prototype.privKey=_i.newBuffer([]),t.encode=function(r,i){return i||(i=eke.create()),i.uint32(10).bytes(r.id),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&i.uint32(18).bytes(r.pubKey),r.privKey!=null&&Object.hasOwnProperty.call(r,"privKey")&&i.uint32(26).bytes(r.privKey),i},t.decode=function(r,i){r instanceof ML||(r=ML.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Eg.PeerIdProto;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.id=r.bytes();break;case 2:s.pubKey=r.bytes();break;case 3:s.privKey=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw _i.ProtocolError("missing required 'id'",{instance:s});return s},t.fromObject=function(r){if(r instanceof Eg.PeerIdProto)return r;var i=new Eg.PeerIdProto;return r.id!=null&&(typeof r.id=="string"?_i.base64.decode(r.id,i.id=_i.newBuffer(_i.base64.length(r.id)),0):r.id.length&&(i.id=r.id)),r.pubKey!=null&&(typeof r.pubKey=="string"?_i.base64.decode(r.pubKey,i.pubKey=_i.newBuffer(_i.base64.length(r.pubKey)),0):r.pubKey.length&&(i.pubKey=r.pubKey)),r.privKey!=null&&(typeof r.privKey=="string"?_i.base64.decode(r.privKey,i.privKey=_i.newBuffer(_i.base64.length(r.privKey)),0):r.privKey.length&&(i.privKey=r.privKey)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.id="":(n.id=[],i.bytes!==Array&&(n.id=_i.newBuffer(n.id))),i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=_i.newBuffer(n.pubKey))),i.bytes===String?n.privKey="":(n.privKey=[],i.bytes!==Array&&(n.privKey=_i.newBuffer(n.privKey)))),r.id!=null&&r.hasOwnProperty("id")&&(n.id=i.bytes===String?_i.base64.encode(r.id,0,r.id.length):i.bytes===Array?Array.prototype.slice.call(r.id):r.id),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?_i.base64.encode(r.pubKey,0,r.pubKey.length):i.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.privKey!=null&&r.hasOwnProperty("privKey")&&(n.privKey=i.bytes===String?_i.base64.encode(r.privKey,0,r.privKey.length):i.bytes===Array?Array.prototype.slice.call(r.privKey):r.privKey),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,kd.util.toJSONOptions)},t}();LL.exports=Eg});var et=p((hn,GL)=>{f();"use strict";var{CID:AA}=(Ae(),Ce),tke=(an(),on),rke=(z6(),cv),ike=(si(),ni),nke=(Qy(),id),{base58btc:IA}=(si(),ni),{base32:ske}=(an(),on),{base16:FL}=(H6(),uv),Sg=(An(),xn),Na=fw(),oke=hw(),{PeerIdProto:KL}=UL(),_f=yi(),xg=ct(),ake=Je(),{identity:dw}=(Pc(),Ea),jL={...tke,...rke,...ike,...nke},cke=Object.keys(jL).reduce((t,e)=>t.or(jL[e]),ske.decoder),uke=112,VL=114,zL=class{constructor(e,r,i){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(r&&i&&!_f(r.public.bytes,i.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=IA.encode(this.id).substring(1),this._privKey=r,this._pubKey=i}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=Sg.decode(this.id);e.code===dw.code&&(this._pubKey=Na.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return Na.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return Na.marshalPrivateKey(this.privKey)}marshal(e){return KL.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let r=6;return e.length<r&&(r=e.length),"<peer.ID "+e.substr(0,r)+">"}toJSON(){return{id:this.toB58String(),privKey:$L(this.marshalPrivKey()),pubKey:$L(this.marshalPubKey())}}toHexString(){return FL.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=AA.createV1(VL,Sg.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return _f(this.id,e);if(e.id)return _f(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&_f(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(Sg.decode(this.id).code===dw.code)return!0}catch(e){}return!1}},Da=oke(zL,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});hn=GL.exports=Da;var Ag=t=>t.bytes.length<=42?Sg.create(dw.code,t.bytes).bytes:t.hash(),TA=async(t,e)=>{let r=await Ag(e);return new Da(r,t,e)};hn.create=async t=>{t=t||{},t.bits=t.bits||2048,t.keyType=t.keyType||"RSA";let e=await Na.generateKeyPair(t.keyType,t.bits);return TA(e,e.public)};hn.createFromHexString=t=>new Da(FL.decode("f"+t));hn.createFromBytes=t=>{try{let e=AA.decode(t);if(!HL(e))throw new Error("Supplied PeerID CID is invalid");return hn.createFromCID(e)}catch{if(Sg.decode(t).code!==dw.code)throw new Error("Supplied PeerID CID is invalid");return new Da(t)}};hn.createFromB58String=t=>hn.createFromBytes(IA.decode("z"+t));var HL=t=>t.code===VL||t.code===uke;hn.createFromCID=t=>{if(t=AA.asCID(t),!t||!HL(t))throw new Error("Supplied PeerID CID is invalid");return new Da(t.multihash.bytes)};hn.createFromPubKey=async t=>{let e=t;if(typeof e=="string"&&(e=xg(t,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let r=await Na.unmarshalPublicKey(e);return TA(void 0,r)};hn.createFromPrivKey=async t=>{if(typeof t=="string"&&(t=xg(t,"base64pad")),!(t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await Na.unmarshalPrivateKey(t);return TA(e,e.public)};hn.createFromJSON=async t=>{let e=IA.decode("z"+t.id),r=t.privKey&&xg(t.privKey,"base64pad"),i=t.pubKey&&xg(t.pubKey,"base64pad"),n=i&&await Na.unmarshalPublicKey(i);if(!r)return new Da(e,void 0,n);let s=await Na.unmarshalPrivateKey(r),o=await Ag(s.public),a;if(n&&(a=await Ag(n)),n&&!_f(o,a))throw new Error("Public and private key do not match");if(e&&!_f(o,e))throw new Error("Id and private key do not match");return new Da(e,s,n)};hn.createFromProtobuf=async t=>{typeof t=="string"&&(t=xg(t,"base16"));let{id:e,privKey:r,pubKey:i}=KL.decode(t);r=r?await Na.unmarshalPrivateKey(r):!1,i=i?await Na.unmarshalPublicKey(i):!1;let n,s;if(r&&(s=await Ag(r.public)),i&&(n=await Ag(i)),r){if(i&&!_f(s,n))throw new Error("Public and private key do not match");return new Da(s,r,r.public)}if(i)return new Da(n,void 0,i);if(e)return new Da(e);throw new Error("Protobuf did not contain any usable key material")};hn.parse=t=>((t.charAt(0)==="1"||t.charAt(0)==="Q")&&(t=`z${t}`),hn.createFromBytes(cke.decode(t)));hn.isPeerId=t=>Boolean(typeof t=="object"&&t._id&&t._idB58String);function $L(t){if(t)return ake(t,"base64pad")}});var XL=p((qIt,YL)=>{f();"use strict";cd();var pw=lt(),qd=Je(),WL=ct();YL.exports={createCipheriv:(t,e,r)=>{let i=pw.cipher.createCipher("AES-CTR",qd(e,"ascii"));return i.start({iv:qd(r,"ascii")}),{update:n=>(i.update(pw.util.createBuffer(qd(n,"ascii"))),WL(i.output.getBytes(),"ascii"))}},createDecipheriv:(t,e,r)=>{let i=pw.cipher.createDecipher("AES-CTR",qd(e,"ascii"));return i.start({iv:qd(r,"ascii")}),{update:n=>(i.update(pw.util.createBuffer(qd(n,"ascii"))),WL(i.output.getBytes(),"ascii"))}}}});var JL=p((BIt,ZL)=>{f();"use strict";var lke=ae(),QL={16:"aes-128-ctr",32:"aes-256-ctr"};ZL.exports=function(t){let e=QL[t.length];if(!e){let r=Object.entries(QL).map(([i,n])=>`${i} (${n})`).join(" / ");throw lke(new Error(`Invalid key length ${t.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return e}});var r9=p(t9=>{f();"use strict";var e9=XL(),fke=JL();t9.create=async function(t,e){let r=fke(t),i=e9.createCipheriv(r,t,e),n=e9.createDecipheriv(r,t,e);return{async encrypt(o){return i.update(o)},async decrypt(o){return n.update(o)}}}});var s9=p((DIt,n9)=>{f();"use strict";var hke=bx(),dke=Wt(),pke=ae(),i9={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function yke(t,e,r,i,n){let s=i9[n];if(!s){let a=Object.keys(i9).join(" / ");throw pke(new Error(`Hash '${n}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=hke(t,e,r,i,s);return dke.encode64(o)}n9.exports=yke});var Ma=p(Bd=>{f();"use strict";var gke=_A(),bke=r9(),mke=fw();Bd.aes=bke;Bd.hmac=gke;Bd.keys=mke;Bd.randomBytes=fg();Bd.pbkdf2=s9()});var PA=p((LIt,a9)=>{f();"use strict";var o9="[a-fA-F\\d:]",Hu=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${o9})|(?<=${o9})(?=\\s|$))`:"",Ao="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",gi="[a-fA-F\\d]{1,4}",yw=`
(?:
(?:${gi}:){7}(?:${gi}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${gi}:){6}(?:${Ao}|:${gi}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${gi}:){5}(?::${Ao}|(?::${gi}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${gi}:){4}(?:(?::${gi}){0,1}:${Ao}|(?::${gi}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${gi}:){3}(?:(?::${gi}){0,2}:${Ao}|(?::${gi}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${gi}:){2}(?:(?::${gi}){0,3}:${Ao}|(?::${gi}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${gi}:){1}(?:(?::${gi}){0,4}:${Ao}|(?::${gi}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${gi}){0,5}:${Ao}|(?::${gi}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),vke=new RegExp(`(?:^${Ao}$)|(?:^${yw}$)`),wke=new RegExp(`^${Ao}$`),_ke=new RegExp(`^${yw}$`),RA=t=>t&&t.exact?vke:new RegExp(`(?:${Hu(t)}${Ao}${Hu(t)})|(?:${Hu(t)}${yw}${Hu(t)})`,"g");RA.v4=t=>t&&t.exact?wke:new RegExp(`${Hu(t)}${Ao}${Hu(t)}`,"g");RA.v6=t=>t&&t.exact?_ke:new RegExp(`${Hu(t)}${yw}${Hu(t)}`,"g");a9.exports=RA});var u9=p((UIt,c9)=>{f();"use strict";var CA=PA(),Nd=t=>CA({exact:!0}).test(t);Nd.v4=t=>CA.v4({exact:!0}).test(t);Nd.v6=t=>CA.v6({exact:!0}).test(t);Nd.version=t=>Nd(t)?Nd.v4(t)?4:6:void 0;c9.exports=Nd});var p9=p((FIt,d9)=>{f();"use strict";var OA=u9(),l9=Je(),Eke=OA,kA=OA.v4,f9=OA.v6,h9=function(t,e,r){r=~~r;let i;if(kA(t))i=e||new Uint8Array(r+4),t.split(/\./g).map(function(n){i[r++]=parseInt(n,10)&255});else if(f9(t)){let n=t.split(":",8),s;for(s=0;s<n.length;s++){let o=kA(n[s]),a;o&&(a=h9(n[s]),n[s]=l9(a.slice(0,2),"base16")),a&&++s<8&&n.splice(s,0,l9(a.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(s=0;s<n.length&&n[s]!=="";s++);let o=[s,"1"];for(s=9-n.length;s>0;s--)o.push("0");n.splice.apply(n,o)}for(i=e||new Uint8Array(r+16),s=0;s<n.length;s++){let o=parseInt(n[s],16);i[r++]=o>>8&255,i[r++]=o&255}}if(!i)throw Error("Invalid ip address: "+t);return i},Ske=function(t,e,r){e=~~e,r=r||t.length-e;let i=[],n,s=new DataView(t.buffer);if(r===4){for(let o=0;o<r;o++)i.push(t[e+o]);n=i.join(".")}else if(r===16){for(let o=0;o<r;o+=2)i.push(s.getUint16(e+o).toString(16));n=i.join(":"),n=n.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),n=n.replace(/:{3,4}/,"::")}return n};d9.exports={isIP:Eke,isV4:kA,isV6:f9,toBytes:h9,toString:Ske}});var Ig=p((KIt,g9)=>{f();"use strict";function zn(t){if(typeof t=="number"){if(zn.codes[t])return zn.codes[t];throw new Error("no protocol with code: "+t)}else if(typeof t=="string"){if(zn.names[t])return zn.names[t];throw new Error("no protocol with name: "+t)}throw new Error("invalid protocol id type: "+t)}var Ns=-1;zn.lengthPrefixedVarSize=Ns;zn.V=Ns;zn.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,Ns,"ip6zone"],[53,Ns,"dns","resolvable"],[54,Ns,"dns4","resolvable"],[55,Ns,"dns6","resolvable"],[56,Ns,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,Ns,"unix",!1,"path"],[421,Ns,"ipfs"],[421,Ns,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,Ns,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,Ns,"memory"]];zn.names={};zn.codes={};zn.table.map(t=>{let e=y9.apply(null,t);return zn.codes[e.code]=e,zn.names[e.name]=e,null});zn.object=y9;function y9(t,e,r,i,n){return{code:t,size:e,name:r,resolvable:Boolean(i),path:Boolean(n)}}g9.exports=zn});var v9=p((jIt,m9)=>{f();m9.exports=qA;var b9=128,xke=127,Ake=~xke,Ike=Math.pow(2,31);function qA(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw qA.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var i=r;t>=Ike;)e[r++]=t&255|b9,t/=128;for(;t&Ake;)e[r++]=t&255|b9,t>>>=7;return e[r]=t|0,qA.bytes=r-i+1,e}});var E9=p((VIt,_9)=>{f();_9.exports=BA;var Tke=128,w9=127;function BA(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o||i>49)throw BA.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&w9)<<i:(s&w9)*Math.pow(2,i),i+=7}while(s>=Tke);return BA.bytes=n-e,r}});var x9=p((zIt,S9)=>{f();var Rke=Math.pow(2,7),Pke=Math.pow(2,14),Cke=Math.pow(2,21),Oke=Math.pow(2,28),kke=Math.pow(2,35),qke=Math.pow(2,42),Bke=Math.pow(2,49),Nke=Math.pow(2,56),Dke=Math.pow(2,63);S9.exports=function(t){return t<Rke?1:t<Pke?2:t<Cke?3:t<Oke?4:t<kke?5:t<qke?6:t<Bke?7:t<Nke?8:t<Dke?9:10}});var os=p((HIt,A9)=>{f();A9.exports={encode:v9(),decode:E9(),encodingLength:x9()}});var q9=p(($It,k9)=>{f();"use strict";var gw=p9(),I9=Ig(),{CID:Mke}=(Ae(),Ce),{base32:T9}=(an(),on),{base58btc:Lke}=(si(),ni),Uke=(An(),xn),Dd=os(),bw=Je(),R9=ct(),mw=un();k9.exports=Tg;function Tg(t,e){return e instanceof Uint8Array?Tg.toString(t,e):Tg.toBytes(t,e)}Tg.toString=function(e,r){switch(I9(e).code){case 4:case 41:return Fke(r);case 6:case 273:case 33:case 132:return C9(r).toString();case 53:case 54:case 55:case 56:case 400:case 777:return jke(r);case 421:return zke(r);case 444:return O9(r);case 445:return O9(r);default:return bw(r,"base16")}};Tg.toBytes=function(e,r){switch(I9(e).code){case 4:return P9(r);case 41:return P9(r);case 6:case 273:case 33:case 132:return NA(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 777:return Kke(r);case 421:return Vke(r);case 444:return Hke(r);case 445:return $ke(r);default:return R9(r,"base16")}};function P9(t){if(!gw.isIP(t))throw new Error("invalid ip address");return gw.toBytes(t)}function Fke(t){let e=gw.toString(t);if(!e||!gw.isIP(e))throw new Error("invalid ip address");return e}function NA(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function C9(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function Kke(t){let e=R9(t),r=Uint8Array.from(Dd.encode(e.length));return mw([r,e],r.length+e.length)}function jke(t){let e=Dd.decode(t);if(t=t.slice(Dd.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return bw(t)}function Vke(t){let e;t[0]==="Q"||t[0]==="1"?e=Uke.decode(Lke.decode(`z${t}`)).bytes:e=Mke.parse(t).multihash.bytes;let r=Uint8Array.from(Dd.encode(e.length));return mw([r,e],r.length+e.length)}function zke(t){let e=Dd.decode(t),r=t.slice(Dd.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return bw(r,"base58btc")}function Hke(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let r=T9.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=NA(i);return mw([r,n],r.length+n.length)}function $ke(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let r=T9.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=NA(i);return mw([r,n],r.length+n.length)}function O9(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),i=bw(e,"base32"),n=C9(r);return i+":"+n}});var H9=p((GIt,z9)=>{f();"use strict";var B9=q9(),DA=Ig(),Rg=os(),N9=un(),Gke=Je();z9.exports={stringToStringTuples:D9,stringTuplesToString:M9,tuplesToStringTuples:U9,stringTuplesToTuples:L9,bytesToTuples:MA,tuplesToBytes:F9,bytesToString:Wke,stringToBytes:j9,fromString:Yke,fromBytes:V9,validateBytes:LA,isValidBytes:Xke,cleanPath:vw,ParseError:UA,protoFromTuple:Pg,sizeForAddr:K9};function D9(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let i=0;i<r.length;i++){let n=r[i],s=DA(n);if(s.size===0){e.push([n]);continue}if(i++,i>=r.length)throw UA("invalid address: "+t);if(s.path){e.push([n,vw(r.slice(i).join("/"))]);break}e.push([n,r[i]])}return e}function M9(t){let e=[];return t.map(r=>{let i=Pg(r);return e.push(i.name),r.length>1&&e.push(r[1]),null}),vw(e.join("/"))}function L9(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=Pg(e);return e.length>1?[r.code,B9.toBytes(r.code,e[1])]:[r.code]})}function U9(t){return t.map(e=>{let r=Pg(e);return e[1]?[r.code,B9.toString(r.code,e[1])]:[r.code]})}function F9(t){return V9(N9(t.map(e=>{let r=Pg(e),i=Uint8Array.from(Rg.encode(r.code));return e.length>1&&(i=N9([i,e[1]])),i})))}function K9(t,e){return t.size>0?t.size/8:t.size===0?0:Rg.decode(e)+Rg.decode.bytes}function MA(t){let e=[],r=0;for(;r<t.length;){let i=Rg.decode(t,r),n=Rg.decode.bytes,s=DA(i),o=K9(s,t.slice(r+n));if(o===0){e.push([i]),r+=n;continue}let a=t.slice(r+n,r+n+o);if(r+=o+n,r>t.length)throw UA("Invalid address Uint8Array: "+Gke(t,"base16"));e.push([i,a])}return e}function Wke(t){let e=MA(t),r=U9(e);return M9(r)}function j9(t){t=vw(t);let e=D9(t),r=L9(e);return F9(r)}function Yke(t){return j9(t)}function V9(t){let e=LA(t);if(e)throw e;return Uint8Array.from(t)}function LA(t){try{MA(t)}catch(e){return e}}function Xke(t){return LA(t)===void 0}function vw(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function UA(t){return new Error("Error parsing address: "+t)}function Pg(t){return DA(t[0])}});var tt=p((WIt,W9)=>{f();"use strict";var Io=H9(),Md=Ig(),$9=os(),{CID:Qke}=(Ae(),Ce),{base58btc:Zke}=(si(),ni),Jke=ae(),eqe=Symbol.for("nodejs.util.inspect.custom"),ww=Je(),tqe=yi(),FA=new Map,G9=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Rn=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,G9,{value:!0}),e instanceof Uint8Array)this.bytes=Io.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Io.fromString(e)}else if(Rn.isMultiaddr(e))this.bytes=Io.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Io.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},r=this.toString().split("/");return e.family=r[1]==="ip4"?4:6,e.host=r[2],e.transport=r[3],e.port=parseInt(r[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},Md(e)))}protoCodes(){let e=[],r=this.bytes,i=0;for(;i<r.length;){let n=$9.decode(r,i),s=$9.decode.bytes,o=Md(n);i+=Io.sizeForAddr(o,r.slice(i+s))+s,e.push(n)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Io.bytesToTuples(this.bytes)}stringTuples(){let e=Io.bytesToTuples(this.bytes);return Io.tuplesToStringTuples(e)}encapsulate(e){return e=new Rn(e),new Rn(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),i=this.toString(),n=i.lastIndexOf(r);if(n<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new Rn(i.slice(0,n))}decapsulateCode(e){let r=this.tuples();for(let i=r.length-1;i>=0;i--)if(r[i][0]===e)return new Rn(Io.tuplesToBytes(r.slice(0,i)));return this}getPeerId(){try{let r=this.stringTuples().filter(i=>i[0]===Md.names.ipfs.code).pop();if(r&&r[1]){let i=r[1];return i[0]==="Q"||i[0]==="1"?ww(Zke.decode(`z${i}`),"base58btc"):ww(Qke.parse(i).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>!!Md(r[0]).path)[0][1],e||(e=null)}catch(r){e=null}return e}equals(e){return tqe(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(n=>n.resolvable);if(!e)return[this];let r=FA.get(e.name);if(!r)throw Jke(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this)).map(n=>new Rn(n))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),i=this.toString().split("/").slice(1);if(i.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(i[2]!=="tcp"&&i[2]!=="udp")throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:i[1],port:parseInt(i[3])}}isThinWaistAddress(e){let r=(e||this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(!e)throw new Error("requires node address object");if(!r)throw new Error("requires transport protocol");let i;switch(e.family){case 4:i="ip4";break;case 6:i="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new Rn("/"+[i,e.address,r,e.port].join("/"))}static isName(e){return Rn.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return e instanceof Rn||Boolean(e&&e[G9])}[eqe](){return"<Multiaddr "+ww(this.bytes,"base16")+" - "+Io.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+ww(this.bytes,"base16")+" - "+Io.bytesToString(this.bytes)+">"}};Rn.protocols=Md;Rn.resolvers=FA;function rqe(t){return new Rn(t)}W9.exports={Multiaddr:Rn,multiaddr:rqe,protocols:Md,resolvers:FA}});var Sf=p((YIt,nU)=>{f();"use strict";var{Multiaddr:KA}=tt(),Y9=Xe("dns4"),X9=Xe("dns6"),Q9=Xe("dnsaddr"),Ef=dn(Xe("dns"),Q9,Y9,X9),Cg=dn(Xe("ip4"),Xe("ip6")),Ld=dn(ht(Cg,Xe("tcp")),ht(Ef,Xe("tcp"))),jA=ht(Cg,Xe("udp")),Z9=ht(jA,Xe("utp")),J9=ht(jA,Xe("quic")),Ud=dn(ht(Ld,Xe("ws")),ht(Ef,Xe("ws"))),Fd=dn(ht(Ld,Xe("wss")),ht(Ef,Xe("wss"))),_w=dn(ht(Ld,Xe("http")),ht(Cg,Xe("http")),ht(Ef,Xe("http"))),Ew=dn(ht(Ld,Xe("https")),ht(Cg,Xe("https")),ht(Ef,Xe("https"))),VA=dn(ht(Ud,Xe("p2p-webrtc-star"),Xe("p2p")),ht(Fd,Xe("p2p-webrtc-star"),Xe("p2p")),ht(Ud,Xe("p2p-webrtc-star")),ht(Fd,Xe("p2p-webrtc-star"))),iqe=dn(ht(Ud,Xe("p2p-websocket-star"),Xe("p2p")),ht(Fd,Xe("p2p-websocket-star"),Xe("p2p")),ht(Ud,Xe("p2p-websocket-star")),ht(Fd,Xe("p2p-websocket-star"))),zA=dn(ht(_w,Xe("p2p-webrtc-direct"),Xe("p2p")),ht(Ew,Xe("p2p-webrtc-direct"),Xe("p2p")),ht(_w,Xe("p2p-webrtc-direct")),ht(Ew,Xe("p2p-webrtc-direct"))),Kd=dn(Ud,Fd,_w,Ew,VA,zA,Ld,Z9,J9,Ef),nqe=dn(ht(Kd,Xe("p2p-stardust"),Xe("p2p")),ht(Kd,Xe("p2p-stardust"))),$u=dn(ht(Kd,Xe("p2p")),VA,zA,Xe("p2p")),eU=dn(ht($u,Xe("p2p-circuit"),$u),ht($u,Xe("p2p-circuit")),ht(Xe("p2p-circuit"),$u),ht(Kd,Xe("p2p-circuit")),ht(Xe("p2p-circuit"),Kd),Xe("p2p-circuit")),tU=()=>dn(ht(eU,tU),eU),jd=tU(),rU=dn(ht(jd,$u,jd),ht($u,jd),ht(jd,$u),jd,$u);nU.exports={DNS:Ef,DNS4:Y9,DNS6:X9,DNSADDR:Q9,IP:Cg,TCP:Ld,UDP:jA,QUIC:J9,UTP:Z9,HTTP:_w,HTTPS:Ew,WebSockets:Ud,WebSocketsSecure:Fd,WebSocketStar:iqe,WebRTCStar:VA,WebRTCDirect:zA,Reliable:Kd,Stardust:nqe,Circuit:jd,P2P:rU,IPFS:rU};function iU(t){function e(r){if(!KA.isMultiaddr(r))try{r=new KA(r)}catch(n){return!1}let i=t(r.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return e}function ht(...t){function e(r){if(r.length<t.length)return null;let i=r;return t.some(n=>(i=typeof n=="function"?n().partialMatch(r):n.partialMatch(r),Array.isArray(i)&&(r=i),i===null)),i}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:iU(e),partialMatch:e}}function dn(...t){function e(i){let n=null;return t.some(s=>{let o=typeof s=="function"?s().partialMatch(i):s.partialMatch(i);return o?(n=o,!0):!1}),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:iU(e),partialMatch:e}}function Xe(t){let e=t;function r(n){let s;if(typeof n=="string"||n instanceof Uint8Array)try{s=new KA(n)}catch(a){return!1}else s=n;let o=s.protoNames();return o.length===1&&o[0]===e}function i(n){return n.length===0?null:n[0]===e?n.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:i}}});var zd=p((XIt,bU)=>{f();"use strict";var{base58btc:sqe}=(si(),ni),{base32:oqe}=(an(),on),aqe=(An(),xn),{Multiaddr:sU}=tt(),cqe=Sf(),{CID:HA}=(Ae(),Ce),{URL:uqe}=ev(),lqe=Je(),$A=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,Vd=/^\/(ip[fn]s)\/([^/?#]+)/,oU=1,aU=2,Og=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,cU=1,uU=2,fqe=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function hqe(t){let e=GA(t);try{aqe.decode(sqe.decode("z"+e))}catch{return!1}return!0}function dqe(t){try{oqe.decode(t)}catch{return!1}return!0}function kg(t){try{return typeof t=="string"?Boolean(HA.parse(t)):t instanceof Uint8Array?Boolean(HA.decode(t)):Boolean(HA.asCID(t))}catch(e){return!1}}function lU(t){if(!t)return!1;if(sU.isMultiaddr(t))return!0;try{return new sU(t),!0}catch(e){return!1}}function pqe(t){return lU(t)&&cqe.P2P.matches(t)}function qg(t,e,r=oU,i=aU){let n=GA(t);if(!n)return!1;let s=n.match(e);if(!s||s[r]!=="ipfs")return!1;let o=s[i];return o&&e===Og&&(o=o.toLowerCase()),kg(o)}function Sw(t,e,r=oU,i=aU){let n=GA(t);if(!n)return!1;let s=n.match(e);if(!s||s[r]!=="ipns")return!1;let o=s[i];if(o&&e===Og){if(o=o.toLowerCase(),kg(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:a}=new uqe(`http://${o}`);return fqe.test(a)}catch(a){return!1}}return!0}function fU(t){return typeof t=="string"}function GA(t){return t instanceof Uint8Array?lqe(t,"base58btc"):fU(t)?t:!1}var WA=t=>qg(t,Og,uU,cU),YA=t=>Sw(t,Og,uU,cU),hU=t=>WA(t)||YA(t),dU=t=>qg(t,$A)||WA(t),pU=t=>Sw(t,$A)||YA(t),yU=t=>dU(t)||pU(t)||hU(t),gU=t=>qg(t,Vd)||Sw(t,Vd);bU.exports={multihash:hqe,multiaddr:lU,peerMultiaddr:pqe,cid:kg,base32cid:t=>dqe(t)&&kg(t),ipfsSubdomain:WA,ipnsSubdomain:YA,subdomain:hU,subdomainGatewayPattern:Og,ipfsUrl:dU,ipnsUrl:pU,url:yU,pathGatewayPattern:$A,ipfsPath:t=>qg(t,Vd),ipnsPath:t=>Sw(t,Vd),path:gU,pathPattern:Vd,urlOrPath:t=>yU(t)||gU(t),cidPath:t=>fU(t)&&!kg(t)&&qg(`/ipfs/${t}`,Vd)}});var vU=p((QIt,mU)=>{f();var Hd=1e3,$d=Hd*60,Gd=$d*60,xf=Gd*24,yqe=xf*7,gqe=xf*365.25;mU.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return bqe(t);if(r==="number"&&isFinite(t))return e.long?vqe(t):mqe(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function bqe(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*gqe;case"weeks":case"week":case"w":return r*yqe;case"days":case"day":case"d":return r*xf;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Gd;case"minutes":case"minute":case"mins":case"min":case"m":return r*$d;case"seconds":case"second":case"secs":case"sec":case"s":return r*Hd;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function mqe(t){var e=Math.abs(t);return e>=xf?Math.round(t/xf)+"d":e>=Gd?Math.round(t/Gd)+"h":e>=$d?Math.round(t/$d)+"m":e>=Hd?Math.round(t/Hd)+"s":t+"ms"}function vqe(t){var e=Math.abs(t);return e>=xf?xw(t,e,xf,"day"):e>=Gd?xw(t,e,Gd,"hour"):e>=$d?xw(t,e,$d,"minute"):e>=Hd?xw(t,e,Hd,"second"):t+" ms"}function xw(t,e,r,i){var n=e>=r*1.5;return Math.round(t/r)+" "+i+(n?"s":"")}});var _U=p((ZIt,wU)=>{f();function wqe(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=n,r.enabled=o,r.humanize=vU(),r.destroy=l,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let h=0;for(let d=0;d<u.length;d++)h=(h<<5)-h+u.charCodeAt(d),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(u){let h,d=null,y,g;function m(...E){if(!m.enabled)return;let v=m,A=Number(new Date),R=A-(h||A);v.diff=R,v.prev=h,v.curr=A,h=A,E[0]=r.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let F=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(B,z)=>{if(B==="%%")return"%";F++;let G=r.formatters[z];if(typeof G=="function"){let Y=E[F];B=G.call(v,Y),E.splice(F,1),F--}return B}),r.formatArgs.call(v,E),(v.log||r.log).apply(v,E)}return m.namespace=u,m.useColors=r.useColors(),m.color=r.selectColor(u),m.extend=i,m.destroy=r.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(y!==r.namespaces&&(y=r.namespaces,g=r.enabled(u)),g),set:E=>{d=E}}),typeof r.init=="function"&&r.init(m),m}function i(u,h){let d=r(this.namespace+(typeof h=="undefined"?":":h)+u);return d.log=this.log,d}function n(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,d=(typeof u=="string"?u:"").split(/[\s,]+/),y=d.length;for(h=0;h<y;h++)!d[h]||(u=d[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.substr(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function s(){let u=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),u}function o(u){if(u[u.length-1]==="*")return!0;let h,d;for(h=0,d=r.skips.length;h<d;h++)if(r.skips[h].test(u))return!1;for(h=0,d=r.names.length;h<d;h++)if(r.names[h].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}wU.exports=wqe});var me=p((as,Aw)=>{f();as.formatArgs=Eqe;as.save=Sqe;as.load=xqe;as.useColors=_qe;as.storage=Aqe();as.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();as.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function _qe(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Eqe(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Aw.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(i=r))}),t.splice(i,0,e)}as.log=console.debug||console.log||(()=>{});function Sqe(t){try{t?as.storage.setItem("debug",t):as.storage.removeItem("debug")}catch(e){}}function xqe(){let t;try{t=as.storage.getItem("debug")}catch(e){}return!t&&typeof process!="undefined"&&"env"in process&&(t=process.env.DEBUG),t}function Aqe(){try{return localStorage}catch(t){}}Aw.exports=_U()(as);var{formatters:Iqe}=Aw.exports;Iqe.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var SU=p((JIt,EU)=>{f();"use strict";var Gu=Bi(),Wd=Gu.Reader,XA=Gu.Writer,Qe=Gu.util,ji=Gu.roots["ipfs-unixfs"]||(Gu.roots["ipfs-unixfs"]={});ji.Data=function(){function t(e){if(this.blocksizes=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=Qe.newBuffer([]),t.prototype.filesize=Qe.Long?Qe.Long.fromBits(0,0,!0):0,t.prototype.blocksizes=Qe.emptyArray,t.prototype.hashType=Qe.Long?Qe.Long.fromBits(0,0,!0):0,t.prototype.fanout=Qe.Long?Qe.Long.fromBits(0,0,!0):0,t.prototype.mode=0,t.prototype.mtime=null,t.encode=function(r,i){if(i||(i=XA.create()),i.uint32(8).int32(r.Type),r.Data!=null&&Object.hasOwnProperty.call(r,"Data")&&i.uint32(18).bytes(r.Data),r.filesize!=null&&Object.hasOwnProperty.call(r,"filesize")&&i.uint32(24).uint64(r.filesize),r.blocksizes!=null&&r.blocksizes.length)for(var n=0;n<r.blocksizes.length;++n)i.uint32(32).uint64(r.blocksizes[n]);return r.hashType!=null&&Object.hasOwnProperty.call(r,"hashType")&&i.uint32(40).uint64(r.hashType),r.fanout!=null&&Object.hasOwnProperty.call(r,"fanout")&&i.uint32(48).uint64(r.fanout),r.mode!=null&&Object.hasOwnProperty.call(r,"mode")&&i.uint32(56).uint32(r.mode),r.mtime!=null&&Object.hasOwnProperty.call(r,"mtime")&&ji.UnixTime.encode(r.mtime,i.uint32(66).fork()).ldelim(),i},t.decode=function(r,i){r instanceof Wd||(r=Wd.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new ji.Data;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;case 3:s.filesize=r.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(o&7)==2)for(var a=r.uint32()+r.pos;r.pos<a;)s.blocksizes.push(r.uint64());else s.blocksizes.push(r.uint64());break;case 5:s.hashType=r.uint64();break;case 6:s.fanout=r.uint64();break;case 7:s.mode=r.uint32();break;case 8:s.mtime=ji.UnixTime.decode(r,r.uint32());break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Qe.ProtocolError("missing required 'Type'",{instance:s});return s},t.fromObject=function(r){if(r instanceof ji.Data)return r;var i=new ji.Data;switch(r.Type){case"Raw":case 0:i.Type=0;break;case"Directory":case 1:i.Type=1;break;case"File":case 2:i.Type=2;break;case"Metadata":case 3:i.Type=3;break;case"Symlink":case 4:i.Type=4;break;case"HAMTShard":case 5:i.Type=5;break}if(r.Data!=null&&(typeof r.Data=="string"?Qe.base64.decode(r.Data,i.Data=Qe.newBuffer(Qe.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),r.filesize!=null&&(Qe.Long?(i.filesize=Qe.Long.fromValue(r.filesize)).unsigned=!0:typeof r.filesize=="string"?i.filesize=parseInt(r.filesize,10):typeof r.filesize=="number"?i.filesize=r.filesize:typeof r.filesize=="object"&&(i.filesize=new Qe.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0))),r.blocksizes){if(!Array.isArray(r.blocksizes))throw TypeError(".Data.blocksizes: array expected");i.blocksizes=[];for(var n=0;n<r.blocksizes.length;++n)Qe.Long?(i.blocksizes[n]=Qe.Long.fromValue(r.blocksizes[n])).unsigned=!0:typeof r.blocksizes[n]=="string"?i.blocksizes[n]=parseInt(r.blocksizes[n],10):typeof r.blocksizes[n]=="number"?i.blocksizes[n]=r.blocksizes[n]:typeof r.blocksizes[n]=="object"&&(i.blocksizes[n]=new Qe.LongBits(r.blocksizes[n].low>>>0,r.blocksizes[n].high>>>0).toNumber(!0))}if(r.hashType!=null&&(Qe.Long?(i.hashType=Qe.Long.fromValue(r.hashType)).unsigned=!0:typeof r.hashType=="string"?i.hashType=parseInt(r.hashType,10):typeof r.hashType=="number"?i.hashType=r.hashType:typeof r.hashType=="object"&&(i.hashType=new Qe.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0))),r.fanout!=null&&(Qe.Long?(i.fanout=Qe.Long.fromValue(r.fanout)).unsigned=!0:typeof r.fanout=="string"?i.fanout=parseInt(r.fanout,10):typeof r.fanout=="number"?i.fanout=r.fanout:typeof r.fanout=="object"&&(i.fanout=new Qe.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0))),r.mode!=null&&(i.mode=r.mode>>>0),r.mtime!=null){if(typeof r.mtime!="object")throw TypeError(".Data.mtime: object expected");i.mtime=ji.UnixTime.fromObject(r.mtime)}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocksizes=[]),i.defaults){if(n.Type=i.enums===String?"Raw":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=Qe.newBuffer(n.Data))),Qe.Long){var s=new Qe.Long(0,0,!0);n.filesize=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.filesize=i.longs===String?"0":0;if(Qe.Long){var s=new Qe.Long(0,0,!0);n.hashType=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.hashType=i.longs===String?"0":0;if(Qe.Long){var s=new Qe.Long(0,0,!0);n.fanout=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.fanout=i.longs===String?"0":0;n.mode=0,n.mtime=null}if(r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?ji.Data.DataType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?Qe.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),r.filesize!=null&&r.hasOwnProperty("filesize")&&(typeof r.filesize=="number"?n.filesize=i.longs===String?String(r.filesize):r.filesize:n.filesize=i.longs===String?Qe.Long.prototype.toString.call(r.filesize):i.longs===Number?new Qe.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0):r.filesize),r.blocksizes&&r.blocksizes.length){n.blocksizes=[];for(var o=0;o<r.blocksizes.length;++o)typeof r.blocksizes[o]=="number"?n.blocksizes[o]=i.longs===String?String(r.blocksizes[o]):r.blocksizes[o]:n.blocksizes[o]=i.longs===String?Qe.Long.prototype.toString.call(r.blocksizes[o]):i.longs===Number?new Qe.LongBits(r.blocksizes[o].low>>>0,r.blocksizes[o].high>>>0).toNumber(!0):r.blocksizes[o]}return r.hashType!=null&&r.hasOwnProperty("hashType")&&(typeof r.hashType=="number"?n.hashType=i.longs===String?String(r.hashType):r.hashType:n.hashType=i.longs===String?Qe.Long.prototype.toString.call(r.hashType):i.longs===Number?new Qe.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0):r.hashType),r.fanout!=null&&r.hasOwnProperty("fanout")&&(typeof r.fanout=="number"?n.fanout=i.longs===String?String(r.fanout):r.fanout:n.fanout=i.longs===String?Qe.Long.prototype.toString.call(r.fanout):i.longs===Number?new Qe.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0):r.fanout),r.mode!=null&&r.hasOwnProperty("mode")&&(n.mode=r.mode),r.mtime!=null&&r.hasOwnProperty("mtime")&&(n.mtime=ji.UnixTime.toObject(r.mtime,i)),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Gu.util.toJSONOptions)},t.DataType=function(){var e={},r=Object.create(e);return r[e[0]="Raw"]=0,r[e[1]="Directory"]=1,r[e[2]="File"]=2,r[e[3]="Metadata"]=3,r[e[4]="Symlink"]=4,r[e[5]="HAMTShard"]=5,r}(),t}();ji.UnixTime=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Seconds=Qe.Long?Qe.Long.fromBits(0,0,!1):0,t.prototype.FractionalNanoseconds=0,t.encode=function(r,i){return i||(i=XA.create()),i.uint32(8).int64(r.Seconds),r.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(r,"FractionalNanoseconds")&&i.uint32(21).fixed32(r.FractionalNanoseconds),i},t.decode=function(r,i){r instanceof Wd||(r=Wd.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new ji.UnixTime;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Seconds=r.int64();break;case 2:s.FractionalNanoseconds=r.fixed32();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Seconds"))throw Qe.ProtocolError("missing required 'Seconds'",{instance:s});return s},t.fromObject=function(r){if(r instanceof ji.UnixTime)return r;var i=new ji.UnixTime;return r.Seconds!=null&&(Qe.Long?(i.Seconds=Qe.Long.fromValue(r.Seconds)).unsigned=!1:typeof r.Seconds=="string"?i.Seconds=parseInt(r.Seconds,10):typeof r.Seconds=="number"?i.Seconds=r.Seconds:typeof r.Seconds=="object"&&(i.Seconds=new Qe.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber())),r.FractionalNanoseconds!=null&&(i.FractionalNanoseconds=r.FractionalNanoseconds>>>0),i},t.toObject=function(r,i){i||(i={});var n={};if(i.defaults){if(Qe.Long){var s=new Qe.Long(0,0,!1);n.Seconds=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.Seconds=i.longs===String?"0":0;n.FractionalNanoseconds=0}return r.Seconds!=null&&r.hasOwnProperty("Seconds")&&(typeof r.Seconds=="number"?n.Seconds=i.longs===String?String(r.Seconds):r.Seconds:n.Seconds=i.longs===String?Qe.Long.prototype.toString.call(r.Seconds):i.longs===Number?new Qe.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber():r.Seconds),r.FractionalNanoseconds!=null&&r.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=r.FractionalNanoseconds),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Gu.util.toJSONOptions)},t}();ji.Metadata=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.MimeType="",t.encode=function(r,i){return i||(i=XA.create()),r.MimeType!=null&&Object.hasOwnProperty.call(r,"MimeType")&&i.uint32(10).string(r.MimeType),i},t.decode=function(r,i){r instanceof Wd||(r=Wd.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new ji.Metadata;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.MimeType=r.string();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof ji.Metadata)return r;var i=new ji.Metadata;return r.MimeType!=null&&(i.MimeType=String(r.MimeType)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.MimeType=""),r.MimeType!=null&&r.hasOwnProperty("MimeType")&&(n.MimeType=r.MimeType),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Gu.util.toJSONOptions)},t}();EU.exports=ji});var Ei=p((e4t,TU)=>{f();"use strict";var{Data:Mc}=SU(),QA=ae(),xU=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],Tqe=["directory","hamt-sharded-directory"],AU=parseInt("0644",8),IU=parseInt("0755",8);function Iw(t){if(t!=null)return typeof t=="number"?t&4095:(t=t.toString(),t.substring(0,1)==="0"?parseInt(t,8)&4095:parseInt(t,10)&4095)}function ZA(t){if(t==null)return;let e;if(t.secs!=null&&(e={secs:t.secs,nsecs:t.nsecs}),t.Seconds!=null&&(e={secs:t.Seconds,nsecs:t.FractionalNanoseconds}),Array.isArray(t)&&(e={secs:t[0],nsecs:t[1]}),t instanceof Date){let r=t.getTime(),i=Math.floor(r/1e3);e={secs:i,nsecs:(r-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw QA(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}var Tw=class{static unmarshal(e){let r=Mc.decode(e),i=Mc.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new Tw({type:xU[i.Type],data:i.Data,blockSizes:i.blocksizes,mode:i.mode,mtime:i.mtime?{secs:i.mtime.Seconds,nsecs:i.mtime.FractionalNanoseconds}:void 0});return n._originalMode=i.mode||0,n}constructor(e={type:"file"}){let{type:r,data:i,blockSizes:n,hashType:s,fanout:o,mtime:a,mode:c}=e;if(r&&!xU.includes(r))throw QA(new Error("Type: "+r+" is not valid"),"ERR_INVALID_TYPE");this.type=r||"file",this.data=i,this.hashType=s,this.fanout=o,this.blockSizes=n||[],this._originalMode=0,this.mode=Iw(c),a&&(this.mtime=ZA(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?IU:AU;let r=Iw(e);r!==void 0&&(this._mode=r)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&Tqe.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(r=>{e+=r}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=Mc.DataType.Raw;break;case"directory":e=Mc.DataType.Directory;break;case"file":e=Mc.DataType.File;break;case"metadata":e=Mc.DataType.Metadata;break;case"symlink":e=Mc.DataType.Symlink;break;case"hamt-sharded-directory":e=Mc.DataType.HAMTShard;break;default:throw QA(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let r=this.data;(!this.data||!this.data.length)&&(r=void 0);let i;this.mode!=null&&(i=this._originalMode&4294963200|(Iw(this.mode)||0),i===AU&&!this.isDirectory()&&(i=void 0),i===IU&&this.isDirectory()&&(i=void 0));let n;if(this.mtime!=null){let o=ZA(this.mtime);o&&(n={Seconds:o.secs,FractionalNanoseconds:o.nsecs},n.FractionalNanoseconds===0&&delete n.FractionalNanoseconds)}let s={Type:e,Data:r,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:i,mtime:n};return Mc.encode(s).finish()}};TU.exports={UnixFS:Tw,parseMode:Iw,parseMtime:ZA}});function JA(t,e){let r=0;for(let i=0;;i+=7){if(i>=64)throw new Error("protobuf: varint overflow");if(e>=t.length)throw new Error("protobuf: unexpected end of data");let n=t[e++];if(r+=i<28?(n&127)<<i:(n&127)*2**i,n<128)break}return[r,e]}function Rw(t,e){let r;[r,e]=JA(t,e);let i=e+r;if(r<0||i<0)throw new Error("protobuf: invalid length");if(i>t.length)throw new Error("protobuf: unexpected end of data");return[t.subarray(e,i),i]}function RU(t,e){let r;return[r,e]=JA(t,e),[r&7,r>>3,e]}function Pqe(t){let e={},r=t.length,i=0;for(;i<r;){let n,s;if([n,s,i]=RU(t,i),s===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,i]=Rw(t,i)}else if(s===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,i]=Rw(t,i),e.Name=Rqe.decode(o)}else if(s===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(n!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Tsize`);[e.Tsize,i]=JA(t,i)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(i>r)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function PU(t){let e=t.length,r=0,i,n=!1,s;for(;r<e;){let a,c;if([a,c,r]=RU(t,r),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,r]=Rw(t,r),i&&(n=!0)}else if(c===2){if(n)throw new Error("protobuf: (PBNode) duplicate Links section");i||(i=[]);let l;[l,r]=Rw(t,r),i.push(Pqe(l))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(r>e)throw new Error("protobuf: (PBNode) unexpected end of data");let o={};return s&&(o.Data=s),o.Links=i||[],o}var Rqe,CU=Ge(()=>{f();Rqe=new TextDecoder});function Oqe(t,e){let r=e.length;if(typeof t.Tsize=="number"){if(t.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(t.Tsize))throw new Error("Tsize too large for encoding");r=Bg(e,r,t.Tsize)-1,e[r]=24}if(typeof t.Name=="string"){let i=OU.encode(t.Name);r-=i.length,e.set(i,r),r=Bg(e,r,i.length)-1,e[r]=18}return t.Hash&&(r-=t.Hash.length,e.set(t.Hash,r),r=Bg(e,r,t.Hash.length)-1,e[r]=10),e.length-r}function qU(t){let e=qqe(t),r=new Uint8Array(e),i=e;if(t.Data&&(i-=t.Data.length,r.set(t.Data,i),i=Bg(r,i,t.Data.length)-1,r[i]=10),t.Links)for(let n=t.Links.length-1;n>=0;n--){let s=Oqe(t.Links[n],r.subarray(0,i));i-=s,i=Bg(r,i,s)-1,r[i]=18}return r}function kqe(t){let e=0;if(t.Hash){let r=t.Hash.length;e+=1+r+Yd(r)}if(typeof t.Name=="string"){let r=OU.encode(t.Name).length;e+=1+r+Yd(r)}return typeof t.Tsize=="number"&&(e+=1+Yd(t.Tsize)),e}function qqe(t){let e=0;if(t.Data){let r=t.Data.length;e+=1+r+Yd(r)}if(t.Links)for(let r of t.Links){let i=kqe(r);e+=1+i+Yd(i)}return e}function Bg(t,e,r){e-=Yd(r);let i=e;for(;r>=Cqe;)t[e++]=r&127|128,r/=128;for(;r>=128;)t[e++]=r&127|128,r>>>=7;return t[e]=r,i}function Yd(t){return t%2==0&&t++,Math.floor((Bqe(t)+6)/7)}function Bqe(t){let e=0;return t>=kU&&(t=Math.floor(t/kU),e=32),t>=1<<16&&(t>>>=16,e+=16),t>=1<<8&&(t>>>=8,e+=8),e+Nqe[t]}var OU,kU,Cqe,Nqe,BU=Ge(()=>{f();OU=new TextEncoder,kU=2**32,Cqe=2**31;Nqe=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]});function NU(t,e){if(t===e)return 0;let r=t.Name?eI.encode(t.Name):[],i=e.Name?eI.encode(e.Name):[],n=r.length,s=i.length;for(let o=0,a=Math.min(n,s);o<a;++o)if(r[o]!==i[o]){n=r[o],s=i[o];break}return n<s?-1:s<n?1:0}function DU(t,e){return!Object.keys(t).some(r=>!e.includes(r))}function MU(t){if(typeof t.asCID=="object"){let r=rt.asCID(t);if(!r)throw new TypeError("Invalid DAG-PB form");return{Hash:r}}if(typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Hash){let r=rt.asCID(t.Hash);try{r||(typeof t.Hash=="string"?r=rt.parse(t.Hash):t.Hash instanceof Uint8Array&&(r=rt.decode(t.Hash)))}catch(i){throw new TypeError(`Invalid DAG-PB form: ${i.message}`)}r&&(e.Hash=r)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof t.Name=="string"&&(e.Name=t.Name),typeof t.Tsize=="number"&&(e.Tsize=t.Tsize),e}function tI(t){if((t instanceof Uint8Array||typeof t=="string")&&(t={Data:t}),typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Data!==void 0)if(typeof t.Data=="string")e.Data=eI.encode(t.Data);else if(t.Data instanceof Uint8Array)e.Data=t.Data;else throw new TypeError("Invalid DAG-PB form");if(t.Links!==void 0)if(Array.isArray(t.Links))e.Links=t.Links.map(MU),e.Links.sort(NU);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function rI(t){if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");if(!DU(t,Dqe))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(t.Data!==void 0&&!(t.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(t.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<t.Links.length;e++){let r=t.Links[e];if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!DU(r,Mqe))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash.asCID!==r.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(r.Name!==void 0&&typeof r.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(r.Tsize!==void 0&&(typeof r.Tsize!="number"||r.Tsize%1!=0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&NU(r,t.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function LU(t,e=[]){return tI({Data:t,Links:e})}function UU(t,e,r){return MU({Hash:r,Name:t,Tsize:e})}var Dqe,Mqe,eI,FU=Ge(()=>{f();Ae();Dqe=["Data","Links"],Mqe=["Hash","Name","Tsize"],eI=new TextEncoder});var xt={};Gt(xt,{code:()=>Uqe,createLink:()=>UU,createNode:()=>LU,decode:()=>Kqe,encode:()=>Fqe,name:()=>Lqe,prepare:()=>tI,validate:()=>rI});function Fqe(t){rI(t);let e={};return t.Links&&(e.Links=t.Links.map(r=>{let i={};return r.Hash&&(i.Hash=r.Hash.bytes),r.Name!==void 0&&(i.Name=r.Name),r.Tsize!==void 0&&(i.Tsize=r.Tsize),i})),t.Data&&(e.Data=t.Data),qU(e)}function Kqe(t){let e=PU(t),r={};return e.Data&&(r.Data=e.Data),e.Links&&(r.Links=e.Links.map(i=>{let n={};try{n.Hash=rt.decode(i.Hash)}catch(s){}if(!n.Hash)throw new Error("Invalid Hash field found in link, expected CID");return i.Name!==void 0&&(n.Name=i.Name),i.Tsize!==void 0&&(n.Tsize=i.Tsize),n})),r}var Lqe,Uqe,At=Ge(()=>{f();Ae();CU();BU();FU();Lqe="dag-pb",Uqe=112});function KU(t){if(t===null)return"null";if(t===void 0)return"undefined";if(t===!0||t===!1)return"boolean";let e=typeof t;if(jqe.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(t))return"Array";if(zqe(t))return"Buffer";let r=Hqe(t);return r||"Object"}function zqe(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}function Hqe(t){let e=Object.prototype.toString.call(t).slice(8,-1);if(Vqe.includes(e))return e}var jqe,Vqe,jU=Ge(()=>{f();jqe=["string","number","bigint","symbol"],Vqe=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"]});var he,Ue,cs=Ge(()=>{f();he=class{constructor(e,r,i){this.major=e,this.majorEncoded=e<<5,this.name=r,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};he.uint=new he(0,"uint",!0);he.negint=new he(1,"negint",!0);he.bytes=new he(2,"bytes",!0);he.string=new he(3,"string",!0);he.array=new he(4,"array",!1);he.map=new he(5,"map",!1);he.tag=new he(6,"tag",!1);he.float=new he(7,"float",!0);he.false=new he(7,"false",!0);he.true=new he(7,"true",!0);he.null=new he(7,"null",!0);he.undefined=new he(7,"undefined",!0);he.break=new he(7,"break",!0);Ue=class{constructor(e,r,i){this.type=e,this.value=r,this.encodedLength=i,this.encodedBytes=void 0}toString(){return`Token[${this.type}].${this.value}`}}});function Pw(t){return Xd&&globalThis.Buffer.isBuffer(t)}function iI(t){return t instanceof Uint8Array?Pw(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}function GU(t,e){if(Pw(t)&&Pw(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}function WU(t,e=1/0){let r,i=t.length,n=null,s=[];for(let o=0;o<i;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function YU(t,e,r){let i=[];for(;e<r;){let n=t[e],s=null,o=n>239?4:n>223?3:n>191?2:1;if(e+o<=r){let a,c,l,u;switch(o){case 1:n<128&&(s=n);break;case 2:a=t[e+1],(a&192)==128&&(u=(n&31)<<6|a&63,u>127&&(s=u));break;case 3:a=t[e+1],c=t[e+2],(a&192)==128&&(c&192)==128&&(u=(n&15)<<12|(a&63)<<6|c&63,u>2047&&(u<55296||u>57343)&&(s=u));break;case 4:a=t[e+1],c=t[e+2],l=t[e+3],(a&192)==128&&(c&192)==128&&(l&192)==128&&(u=(n&15)<<18|(a&63)<<12|(c&63)<<6|l&63,u>65535&&u<1114112&&(s=u))}}s===null?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),e+=o}return Wqe(i)}function Wqe(t){let e=t.length;if(e<=XU)return String.fromCharCode.apply(String,t);let r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=XU));return r}var Xd,$qe,Gqe,VU,zU,La,Cw,HU,$U,XU,Qd=Ge(()=>{f();Xd=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",$qe=new TextDecoder,Gqe=new TextEncoder;VU=Xd?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):YU(t,e,r):(t,e,r)=>r-e>64?$qe.decode(t.subarray(e,r)):YU(t,e,r),zU=Xd?t=>t.length>64?globalThis.Buffer.from(t):WU(t):t=>t.length>64?Gqe.encode(t):WU(t),La=t=>Uint8Array.from(t),Cw=Xd?(t,e,r)=>Pw(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),HU=Xd?(t,e)=>(t=t.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),iI(globalThis.Buffer.concat(t,e))):(t,e)=>{let r=new Uint8Array(e),i=0;for(let n of t)i+n.length>r.length&&(n=n.subarray(0,r.length-i)),r.set(n,i),i+=n.length;return r},$U=Xd?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);XU=4096});var Yqe,Ow,QU=Ge(()=>{f();Qd();Yqe=256,Ow=class{constructor(e=Yqe){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.chunks=[],this.cursor=0,this.maxCursor=-1,this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let r=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let n=r.length-(this.maxCursor-this.cursor)-1;r.set(e,n)}else{if(r){let n=r.length-(this.maxCursor-this.cursor)-1;n<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,n),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(r=$U(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let r;if(this.chunks.length===1){let i=this.chunks[0];e&&this.cursor>i.length/2?(r=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=Cw(i,0,this.cursor)}else r=HU(this.chunks,this.cursor);return e&&this.reset(),r}}});function Lc(t,e,r){if(t.length-e<r)throw new Error(`${st} not enough data for type`)}var st,nI,Ng,To=Ge(()=>{f();st="CBOR decode error:",nI="CBOR encode error:",Ng=[];Ng[23]=1;Ng[24]=2;Ng[25]=3;Ng[26]=5;Ng[27]=9});function us(t,e,r){Lc(t,e,1);let i=t[e];if(r.strict===!0&&i<Vi[0])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);return i}function ls(t,e,r){Lc(t,e,2);let i=t[e]<<8|t[e+1];if(r.strict===!0&&i<Vi[1])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);return i}function fs(t,e,r){Lc(t,e,4);let i=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(r.strict===!0&&i<Vi[2])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);return i}function hs(t,e,r){Lc(t,e,8);let i=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],n=t[e+4]*16777216+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],s=(BigInt(i)<<BigInt(32))+BigInt(n);if(r.strict===!0&&s<Vi[3])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(r.allowBigInt===!0)return s;throw new Error(`${st} integers outside of the safe integer range are not supported`)}function ZU(t,e,r,i){return new Ue(he.uint,us(t,e+1,i),2)}function JU(t,e,r,i){return new Ue(he.uint,ls(t,e+1,i),3)}function eF(t,e,r,i){return new Ue(he.uint,fs(t,e+1,i),5)}function tF(t,e,r,i){return new Ue(he.uint,hs(t,e+1,i),9)}function Ds(t,e){return Hn(t,0,e.value)}function Hn(t,e,r){if(r<Vi[0]){let i=Number(r);t.push([e|i])}else if(r<Vi[1]){let i=Number(r);t.push([e|24,i])}else if(r<Vi[2]){let i=Number(r);t.push([e|25,i>>>8,i&255])}else if(r<Vi[3]){let i=Number(r);t.push([e|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{let i=BigInt(r);if(i<Vi[4]){let n=[e|27,0,0,0,0,0,0,0],s=Number(i&BigInt(4294967295)),o=Number(i>>BigInt(32)&BigInt(4294967295));n[8]=s&255,s=s>>8,n[7]=s&255,s=s>>8,n[6]=s&255,s=s>>8,n[5]=s&255,n[4]=o&255,o=o>>8,n[3]=o&255,o=o>>8,n[2]=o&255,o=o>>8,n[1]=o&255,t.push(n)}else throw new Error(`${st} encountered BigInt larger than allowable range`)}}var Vi,Ua=Ge(()=>{f();cs();To();Vi=[24,256,65536,4294967296,BigInt("18446744073709551616")];Ds.encodedSize=function(e){return Hn.encodedSize(e.value)};Hn.encodedSize=function(e){return e<Vi[0]?1:e<Vi[1]?2:e<Vi[2]?3:e<Vi[3]?5:9};Ds.compareTokens=function(e,r){return e.value<r.value?-1:e.value>r.value?1:0}});function rF(t,e,r,i){return new Ue(he.negint,-1-us(t,e+1,i),2)}function iF(t,e,r,i){return new Ue(he.negint,-1-ls(t,e+1,i),3)}function nF(t,e,r,i){return new Ue(he.negint,-1-fs(t,e+1,i),5)}function oF(t,e,r,i){let n=hs(t,e+1,i);if(typeof n!="bigint"){let s=-1-n;if(s>=Number.MIN_SAFE_INTEGER)return new Ue(he.negint,s,9)}if(i.allowBigInt!==!0)throw new Error(`${st} integers outside of the safe integer range are not supported`);return new Ue(he.negint,sI-BigInt(n),9)}function kw(t,e){let r=e.value,i=typeof r=="bigint"?r*sI-sF:r*-1-1;Hn(t,e.type.majorEncoded,i)}var sI,sF,oI=Ge(()=>{f();cs();Ua();To();sI=BigInt(-1),sF=BigInt(1);kw.encodedSize=function(e){let r=e.value,i=typeof r=="bigint"?r*sI-sF:r*-1-1;return i<Vi[0]?1:i<Vi[1]?2:i<Vi[2]?3:i<Vi[3]?5:9};kw.compareTokens=function(e,r){return e.value<r.value?1:e.value>r.value?-1:0}});function Dg(t,e,r,i){Lc(t,e,r+i);let n=Cw(t,e+r,e+r+i);return new Ue(he.bytes,n,r+i)}function aF(t,e,r,i){return Dg(t,e,1,r)}function cF(t,e,r,i){return Dg(t,e,2,us(t,e+1,i))}function uF(t,e,r,i){return Dg(t,e,3,ls(t,e+1,i))}function lF(t,e,r,i){return Dg(t,e,5,fs(t,e+1,i))}function fF(t,e,r,i){let n=hs(t,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer bytes lengths not supported`);return Dg(t,e,9,n)}function qw(t){return t.encodedBytes===void 0&&(t.encodedBytes=t.type===he.string?zU(t.value):t.value),t.encodedBytes}function Zd(t,e){let r=qw(e);Hn(t,e.type.majorEncoded,r.length),t.push(r)}function Xqe(t,e){return t.length<e.length?-1:t.length>e.length?1:GU(t,e)}var Bw=Ge(()=>{f();cs();To();Ua();Qd();Zd.encodedSize=function(e){let r=qw(e);return Hn.encodedSize(r.length)+r.length};Zd.compareTokens=function(e,r){return Xqe(qw(e),qw(r))}});function Mg(t,e,r,i){let n=r+i;return Lc(t,e,n),new Ue(he.string,VU(t,e+r,e+n),n)}function hF(t,e,r,i){return Mg(t,e,1,r)}function dF(t,e,r,i){return Mg(t,e,2,us(t,e+1,i))}function pF(t,e,r,i){return Mg(t,e,3,ls(t,e+1,i))}function yF(t,e,r,i){return Mg(t,e,5,fs(t,e+1,i))}function gF(t,e,r,i){let n=hs(t,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer string lengths not supported`);return Mg(t,e,9,n)}var bF,aI=Ge(()=>{f();cs();To();Ua();Bw();Qd();bF=Zd});function Jd(t,e,r,i){return new Ue(he.array,i,r)}function mF(t,e,r,i){return Jd(t,e,1,r)}function vF(t,e,r,i){return Jd(t,e,2,us(t,e+1,i))}function wF(t,e,r,i){return Jd(t,e,3,ls(t,e+1,i))}function _F(t,e,r,i){return Jd(t,e,5,fs(t,e+1,i))}function EF(t,e,r,i){let n=hs(t,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer array lengths not supported`);return Jd(t,e,9,n)}function SF(t,e,r,i){if(i.allowIndefinite===!1)throw new Error(`${st} indefinite length items not allowed`);return Jd(t,e,1,1/0)}function cI(t,e){Hn(t,he.array.majorEncoded,e.value)}var uI=Ge(()=>{f();cs();Ua();To();cI.compareTokens=Ds.compareTokens});function ep(t,e,r,i){return new Ue(he.map,i,r)}function xF(t,e,r,i){return ep(t,e,1,r)}function AF(t,e,r,i){return ep(t,e,2,us(t,e+1,i))}function IF(t,e,r,i){return ep(t,e,3,ls(t,e+1,i))}function TF(t,e,r,i){return ep(t,e,5,fs(t,e+1,i))}function RF(t,e,r,i){let n=hs(t,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer map lengths not supported`);return ep(t,e,9,n)}function PF(t,e,r,i){if(i.allowIndefinite===!1)throw new Error(`${st} indefinite length items not allowed`);return ep(t,e,1,1/0)}function lI(t,e){Hn(t,he.map.majorEncoded,e.value)}var fI=Ge(()=>{f();cs();Ua();To();lI.compareTokens=Ds.compareTokens});function CF(t,e,r,i){return new Ue(he.tag,r,1)}function OF(t,e,r,i){return new Ue(he.tag,us(t,e+1,i),2)}function kF(t,e,r,i){return new Ue(he.tag,ls(t,e+1,i),3)}function qF(t,e,r,i){return new Ue(he.tag,fs(t,e+1,i),5)}function BF(t,e,r,i){return new Ue(he.tag,hs(t,e+1,i),9)}function hI(t,e){Hn(t,he.tag.majorEncoded,e.value)}var dI=Ge(()=>{f();cs();Ua();hI.compareTokens=Ds.compareTokens});function NF(t,e,r,i){if(i.allowUndefined===!1)throw new Error(`${st} undefined values are not supported`);return new Ue(he.undefined,void 0,1)}function DF(t,e,r,i){if(i.allowIndefinite===!1)throw new Error(`${st} indefinite length items not allowed`);return new Ue(he.break,void 0,1)}function pI(t,e,r){if(r){if(r.allowNaN===!1&&Number.isNaN(t))throw new Error(`${st} NaN values are not supported`);if(r.allowInfinity===!1&&(t===1/0||t===-1/0))throw new Error(`${st} Infinity values are not supported`)}return new Ue(he.float,t,e)}function MF(t,e,r,i){return pI(yI(t,e+1),3,i)}function LF(t,e,r,i){return pI(gI(t,e+1),5,i)}function UF(t,e,r,i){return pI(VF(t,e+1),9,i)}function Nw(t,e,r){let i=e.value;if(i===!1)t.push([he.float.majorEncoded|Qqe]);else if(i===!0)t.push([he.float.majorEncoded|Zqe]);else if(i===null)t.push([he.float.majorEncoded|Jqe]);else if(i===void 0)t.push([he.float.majorEncoded|eBe]);else{let n,s=!1;(!r||r.float64!==!0)&&(KF(i),n=yI(Ro,1),i===n||Number.isNaN(i)?(Ro[0]=249,t.push(Ro.slice(0,3)),s=!0):(jF(i),n=gI(Ro,1),i===n&&(Ro[0]=250,t.push(Ro.slice(0,5)),s=!0))),s||(tBe(i),n=VF(Ro,1),Ro[0]=251,t.push(Ro.slice(0,9)))}}function KF(t){if(t===1/0)Ms.setUint16(0,31744,!1);else if(t===-1/0)Ms.setUint16(0,64512,!1);else if(Number.isNaN(t))Ms.setUint16(0,32256,!1);else{Ms.setFloat32(0,t);let e=Ms.getUint32(0),r=(e&2139095040)>>23,i=e&8388607;if(r===255)Ms.setUint16(0,31744,!1);else if(r===0)Ms.setUint16(0,(t&2147483648)>>16|i>>13,!1);else{let n=r-127;n<-24?Ms.setUint16(0,0):n<-14?Ms.setUint16(0,(e&2147483648)>>16|1<<24+n,!1):Ms.setUint16(0,(e&2147483648)>>16|n+15<<10|i>>13,!1)}}}function yI(t,e){if(t.length-e<2)throw new Error(`${st} not enough data for float16`);let r=(t[e]<<8)+t[e+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let i=r>>10&31,n=r&1023,s;return i===0?s=n*2**-24:i!==31?s=(n+1024)*2**(i-25):s=n===0?1/0:NaN,r&32768?-s:s}function jF(t){Ms.setFloat32(0,t,!1)}function gI(t,e){if(t.length-e<4)throw new Error(`${st} not enough data for float32`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function tBe(t){Ms.setFloat64(0,t,!1)}function VF(t,e){if(t.length-e<8)throw new Error(`${st} not enough data for float64`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}var Qqe,Zqe,Jqe,eBe,FF,Ms,Ro,bI=Ge(()=>{f();cs();To();Ua();Qqe=20,Zqe=21,Jqe=22,eBe=23;Nw.encodedSize=function(e,r){let i=e.value;if(i===!1||i===!0||i===null||i===void 0)return 1;let n;if(!r||r.float64!==!0){if(KF(i),n=yI(Ro,1),i===n||Number.isNaN(i))return 3;if(jF(i),n=gI(Ro,1),i===n)return 5}return 9};FF=new ArrayBuffer(9),Ms=new DataView(FF,1),Ro=new Uint8Array(FF,0);Nw.compareTokens=Ds.compareTokens});function Dt(t,e,r){throw new Error(`${st} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function Dw(t){return()=>{throw new Error(`${st} ${t}`)}}function zF(t){switch(t.type){case he.false:return La([244]);case he.true:return La([245]);case he.null:return La([246]);case he.bytes:return t.value.length?void 0:La([64]);case he.string:return t.value===""?La([96]):void 0;case he.array:return t.value===0?La([128]):void 0;case he.map:return t.value===0?La([160]):void 0;case he.uint:return t.value<24?La([Number(t.value)]):void 0;case he.negint:if(t.value>=-24)return La([31-Number(t.value)])}}var qe,Po,mI=Ge(()=>{f();cs();Ua();oI();Bw();aI();uI();fI();dI();bI();To();Qd();qe=[];for(let t=0;t<=23;t++)qe[t]=Dt;qe[24]=ZU;qe[25]=JU;qe[26]=eF;qe[27]=tF;qe[28]=Dt;qe[29]=Dt;qe[30]=Dt;qe[31]=Dt;for(let t=32;t<=55;t++)qe[t]=Dt;qe[56]=rF;qe[57]=iF;qe[58]=nF;qe[59]=oF;qe[60]=Dt;qe[61]=Dt;qe[62]=Dt;qe[63]=Dt;for(let t=64;t<=87;t++)qe[t]=aF;qe[88]=cF;qe[89]=uF;qe[90]=lF;qe[91]=fF;qe[92]=Dt;qe[93]=Dt;qe[94]=Dt;qe[95]=Dw("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)qe[t]=hF;qe[120]=dF;qe[121]=pF;qe[122]=yF;qe[123]=gF;qe[124]=Dt;qe[125]=Dt;qe[126]=Dt;qe[127]=Dw("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)qe[t]=mF;qe[152]=vF;qe[153]=wF;qe[154]=_F;qe[155]=EF;qe[156]=Dt;qe[157]=Dt;qe[158]=Dt;qe[159]=SF;for(let t=160;t<=183;t++)qe[t]=xF;qe[184]=AF;qe[185]=IF;qe[186]=TF;qe[187]=RF;qe[188]=Dt;qe[189]=Dt;qe[190]=Dt;qe[191]=PF;for(let t=192;t<=215;t++)qe[t]=CF;qe[216]=OF;qe[217]=kF;qe[218]=qF;qe[219]=BF;qe[220]=Dt;qe[221]=Dt;qe[222]=Dt;qe[223]=Dt;for(let t=224;t<=243;t++)qe[t]=Dw("simple values are not supported");qe[244]=Dt;qe[245]=Dt;qe[246]=Dt;qe[247]=NF;qe[248]=Dw("simple values are not supported");qe[249]=MF;qe[250]=LF;qe[251]=UF;qe[252]=Dt;qe[253]=Dt;qe[254]=Dt;qe[255]=DF;Po=[];for(let t=0;t<24;t++)Po[t]=new Ue(he.uint,t,1);for(let t=-1;t>=-24;t--)Po[31-t]=new Ue(he.negint,t,1);Po[64]=new Ue(he.bytes,new Uint8Array(0),1);Po[96]=new Ue(he.string,"",1);Po[128]=new Ue(he.array,0,1);Po[160]=new Ue(he.map,0,1);Po[244]=new Ue(he.false,!1,1);Po[245]=new Ue(he.true,!0,1);Po[246]=new Ue(he.null,null,1)});function Mw(t,e={},r){let i=KU(t),n=e&&e.typeEncoders&&e.typeEncoders[i]||Yu[i];if(typeof n=="function"){let o=n(t,i,e,r);if(o!=null)return o}let s=Yu[i];if(!s)throw new Error(`${nI} unsupported type: ${i}`);return s(t,i,e,r)}function iBe(t,e){e.mapSorter&&t.sort(e.mapSorter)}function nBe(t,e){let r=Array.isArray(t[0])?t[0][0]:t[0],i=Array.isArray(e[0])?e[0][0]:e[0];if(r.type!==i.type)return r.type.compare(i.type);let n=r.type.major,s=Fa[n].compareTokens(r,i);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function $F(t,e,r,i){if(Array.isArray(e))for(let n of e)$F(t,n,r,i);else r[e.type.major](t,e,i)}function sBe(t,e,r){let i=Mw(t,r);if(!Array.isArray(i)&&r.quickEncodeToken){let n=r.quickEncodeToken(i);if(n)return n;let s=e[i.type.major];if(s.encodedSize){let o=s.encodedSize(i,r),a=new Ow(o);if(s(a,i,r),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return iI(a.chunks[0])}}return $F(HF,i,e,r),HF.toBytes(!0)}function Lw(t,e){return e=Object.assign({},rBe,e),sBe(t,Fa,e)}var rBe,Fa,HF,Lg,Wu,Yu,GF=Ge(()=>{f();jU();cs();QU();To();mI();Qd();Ua();oI();Bw();aI();uI();fI();dI();bI();rBe={float64:!1,mapSorter:nBe,quickEncodeToken:zF},Fa=[];Fa[he.uint.major]=Ds;Fa[he.negint.major]=kw;Fa[he.bytes.major]=Zd;Fa[he.string.major]=bF;Fa[he.array.major]=cI;Fa[he.map.major]=lI;Fa[he.tag.major]=hI;Fa[he.float.major]=Nw;HF=new Ow,Lg=class{constructor(e,r){this.obj=e,this.parent=r}includes(e){let r=this;do if(r.obj===e)return!0;while(r=r.parent);return!1}static createCheck(e,r){if(e&&e.includes(r))throw new Error(`${nI} object contains circular references`);return new Lg(r,e)}},Wu={null:new Ue(he.null,null),undefined:new Ue(he.undefined,void 0),true:new Ue(he.true,!0),false:new Ue(he.false,!1),emptyArray:new Ue(he.array,0),emptyMap:new Ue(he.map,0)},Yu={number(t,e,r,i){return!Number.isInteger(t)||!Number.isSafeInteger(t)?new Ue(he.float,t):t>=0?new Ue(he.uint,t):new Ue(he.negint,t)},bigint(t,e,r,i){return t>=BigInt(0)?new Ue(he.uint,t):new Ue(he.negint,t)},Uint8Array(t,e,r,i){return new Ue(he.bytes,t)},string(t,e,r,i){return new Ue(he.string,t)},boolean(t,e,r,i){return t?Wu.true:Wu.false},null(t,e,r,i){return Wu.null},undefined(t,e,r,i){return Wu.undefined},ArrayBuffer(t,e,r,i){return new Ue(he.bytes,new Uint8Array(t))},DataView(t,e,r,i){return new Ue(he.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength))},Array(t,e,r,i){if(!t.length)return r.addBreakTokens===!0?[Wu.emptyArray,new Ue(he.break)]:Wu.emptyArray;i=Lg.createCheck(i,t);let n=[],s=0;for(let o of t)n[s++]=Mw(o,r,i);return r.addBreakTokens?[new Ue(he.array,t.length),n,new Ue(he.break)]:[new Ue(he.array,t.length),n]},Object(t,e,r,i){let n=e!=="Object",s=n?t.keys():Object.keys(t),o=n?t.size:s.length;if(!o)return r.addBreakTokens===!0?[Wu.emptyMap,new Ue(he.break)]:Wu.emptyMap;i=Lg.createCheck(i,t);let a=[],c=0;for(let l of s)a[c++]=[Mw(l,r,i),Mw(n?t.get(l):t[l],r,i)];return iBe(a,r),r.addBreakTokens?[new Ue(he.map,o),a,new Ue(he.break)]:[new Ue(he.map,o),a]}};Yu.Map=Yu.Object;Yu.Buffer=Yu.Uint8Array;for(let t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Yu[`${t}Array`]=Yu.DataView});function aBe(t,e,r){let i=[];for(let n=0;n<t.value;n++){let s=Fg(e,r);if(s===Uw){if(t.value===1/0)break;throw new Error(`${st} got unexpected break to lengthed array`)}if(s===Ug)throw new Error(`${st} found array but not enough entries (got ${n}, expected ${t.value})`);i[n]=s}return i}function cBe(t,e,r){let i=r.useMaps===!0,n=i?void 0:{},s=i?new Map:void 0;for(let o=0;o<t.value;o++){let a=Fg(e,r);if(a===Uw){if(t.value===1/0)break;throw new Error(`${st} got unexpected break to lengthed map`)}if(a===Ug)throw new Error(`${st} found map but not enough entries (got ${o} [no key], expected ${t.value})`);if(i!==!0&&typeof a!="string")throw new Error(`${st} non-string keys not supported (got ${typeof a})`);let c=Fg(e,r);if(c===Ug)throw new Error(`${st} found map but not enough entries (got ${o} [no value], expected ${t.value})`);i?s.set(a,c):n[a]=c}return i?s:n}function Fg(t,e){if(t.done())return Ug;let r=t.next();if(r.type===he.break)return Uw;if(r.type.terminal)return r.value;if(r.type===he.array)return aBe(r,t,e);if(r.type===he.map)return cBe(r,t,e);if(r.type===he.tag){if(e.tags&&typeof e.tags[r.value]=="function"){let i=Fg(t,e);return e.tags[r.value](i)}throw new Error(`${st} tag not supported (${r.value})`)}throw new Error("unsupported")}function Fw(t,e){if(!(t instanceof Uint8Array))throw new Error(`${st} data to decode must be a Uint8Array`);e=Object.assign({},oBe,e);let r=e.tokenizer||new WF(t,e),i=Fg(r,e);if(i===Ug)throw new Error(`${st} did not find any content to decode`);if(i===Uw)throw new Error(`${st} got unexpected break`);if(!r.done())throw new Error(`${st} too many terminals, data makes no sense`);return i}var oBe,WF,Ug,Uw,YF=Ge(()=>{f();To();cs();mI();oBe={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},WF=class{constructor(e,r={}){this.pos=0,this.data=e,this.options=r}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],r=Po[e];if(r===void 0){let i=qe[e];if(!i)throw new Error(`${st} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let n=e&31;r=i(this.data,this.pos,n,this.options)}return this.pos+=r.encodedLength,r}},Ug=Symbol.for("DONE"),Uw=Symbol.for("BREAK")});var Kw={};Gt(Kw,{Token:()=>Ue,Type:()=>he,decode:()=>Fw,encode:()=>Lw});var Kg=Ge(()=>{f();GF();YF();cs()});var Af={};Gt(Af,{code:()=>yBe,decode:()=>wI,encode:()=>vI,name:()=>pBe});function uBe(t){if(t.asCID!==t)return null;let e=rt.asCID(t);if(!e)return null;let r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new Ue(he.tag,XF),new Ue(he.bytes,r)]}function lBe(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function fBe(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function dBe(t){if(t[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return rt.decode(t.subarray(1))}var XF,hBe,QF,pBe,yBe,vI,wI,Uc=Ge(()=>{f();Kg();Ae();XF=42;hBe={float64:!0,typeEncoders:{Object:uBe,undefined:lBe,number:fBe}};QF={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};QF.tags[XF]=dBe;pBe="dag-cbor",yBe=113,vI=t=>Lw(t,hBe),wI=t=>Fw(t,QF)});var JF=p((C5t,ZF)=>{f();"use strict";ZF.exports=()=>{}});var Qu=p(Xu=>{f();"use strict";var jg=class extends Error{constructor(e="not initialized"){super(e);this.name="NotInitializedError",this.code=jg.code}};jg.code="ERR_NOT_INITIALIZED";Xu.NotInitializedError=jg;var _I=class extends Error{constructor(e="cannot initialize an initializing node"){super(e);this.name="AlreadyInitializingError",this.code=tp.code}};_I.code="ERR_ALREADY_INITIALIZING";Xu.AlreadyInitializingError=_I;var tp=class extends Error{constructor(e="cannot re-initialize an initialized node"){super(e);this.name="AlreadyInitializedError",this.code=tp.code}};tp.code="ERR_ALREADY_INITIALIZED";Xu.AlreadyInitializedError=tp;var Vg=class extends Error{constructor(e="not started"){super(e);this.name="NotStartedError",this.code=Vg.code}};Vg.code="ERR_NOT_STARTED";Xu.NotStartedError=Vg;var zg=class extends Error{constructor(e="cannot start, already startin"){super(e);this.name="AlreadyStartingError",this.code=zg.code}};zg.code="ERR_ALREADY_STARTING";Xu.AlreadyStartingError=zg;var Hg=class extends Error{constructor(e="cannot start, already started"){super(e);this.name="AlreadyStartedError",this.code=Hg.code}};Hg.code="ERR_ALREADY_STARTED";Xu.AlreadyStartedError=Hg;var $g=class extends Error{constructor(e="not enabled"){super(e);this.name="NotEnabledError",this.code=$g.code}};$g.code="ERR_NOT_ENABLED";Xu.NotEnabledError=$g});var eK,tK=Ge(()=>{f();eK="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"});var Gg={};Gt(Gg,{customAlphabet:()=>gBe,customRandom:()=>iK,nanoid:()=>bBe,random:()=>rK,urlAlphabet:()=>eK});var rK,iK,gBe,bBe,Wg=Ge(()=>{f();tK();rK=t=>crypto.getRandomValues(new Uint8Array(t)),iK=(t,e,r)=>{let i=(2<<Math.log(t.length-1)/Math.LN2)-1,n=-~(1.6*i*e/t.length);return()=>{let s="";for(;;){let o=r(n),a=n;for(;a--;)if(s+=t[o[a]&i]||"",s.length===e)return s}}},gBe=(t,e)=>iK(t,e,rK),bBe=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let i=r[t]&63;i<36?e+=i.toString(36):i<62?e+=(i-26).toString(36).toUpperCase():i<63?e+="_":e+="-"}return e}});var EI=p((B5t,sK)=>{f();"use strict";var{nanoid:mBe}=(Wg(),Gg),vBe=Je(),wBe=ct(),Fc="/",nK=new TextEncoder().encode(Fc),jw=nK[0],Ls=class{constructor(e,r){if(typeof e=="string")this._buf=wBe(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==jw)throw new Error("Invalid key")}toString(e="utf8"){return vBe(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Ls(e.join(Fc))}static random(){return new Ls(mBe().replace(/-/g,""))}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=nK),this._buf[0]!==jw){let e=new Uint8Array(this._buf.byteLength+1);e.fill(jw,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===jw;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),i=e.list();for(let n=0;n<r.length;n++){if(i.length<n+1)return!1;let s=r[n],o=i[n];if(s<o)return!0;if(s>o)return!1}return r.length<i.length}reverse(){return Ls.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Fc).slice(1)}type(){return _Be(this.baseNamespace())}name(){return EBe(this.baseNamespace())}instance(e){return new Ls(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Fc)||(e+=Fc),e+=this.type(),new Ls(e)}parent(){let e=this.list();return e.length===1?new Ls(Fc):new Ls(e.slice(0,-1).join(Fc))}child(e){return this.toString()===Fc?e:e.toString()===Fc?this:new Ls(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Ls.withNamespaces([...this.namespaces(),...SBe(e.map(r=>r.namespaces()))])}};function _Be(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function EBe(t){let e=t.split(":");return e[e.length-1]}function SBe(t){return[].concat(...t)}sK.exports=Ls});var aK=p((N5t,oK)=>{f();"use strict";var{nanoid:xBe}=(Wg(),Gg),ABe=(t=e=>e)=>t(xBe());oK.exports=ABe});var rp=p((D5t,cK)=>{f();"use strict";var IBe=async t=>{let e=[];for await(let r of t)e.push(r);return e};cK.exports=IBe});var SI=p((M5t,uK)=>{f();"use strict";var TBe=aK(),RBe=rp(),PBe=(t,e)=>async function*(){yield*(await RBe(t)).sort(e)}(),CBe=(t,e)=>{let r=new RegExp("^"+e);return t.replace(r,"")};uK.exports={sortAll:PBe,tmpdir:TBe,replaceStartWith:CBe}});var Ka=p((L5t,lK)=>{f();"use strict";var OBe=async t=>{for await(let e of t);};lK.exports=OBe});var ja=p((U5t,fK)=>{f();"use strict";var kBe=async function*(t,e){for await(let r of t)await e(r)&&(yield r)};fK.exports=kBe});var ip=p((F5t,hK)=>{f();"use strict";var qBe=async function*(t,e){let r=0;if(!(e<1)){for await(let i of t)if(yield i,r++,r===e)return}};hK.exports=qBe});var xI=p((K5t,bK)=>{f();"use strict";var{sortAll:dK}=SI(),pK=Ka(),np=ja(),yK=ip(),gK=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,i){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:i,value:n}of e)await this.put(i,n,r),yield{key:i,value:n}}async*getMany(e,r={}){for await(let i of e)yield this.get(i,r)}async*deleteMany(e,r={}){for await(let i of e)await this.delete(i,r),yield i}batch(){let e=[],r=[];return{put(i,n){e.push({key:i,value:n})},delete(i){r.push(i)},commit:async i=>{await pK(this.putMany(e,i)),e=[],await pK(this.deleteMany(r,i)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let i=this._all(e,r);if(e.prefix!=null&&(i=np(i,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>np(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>dK(n,s),i)),e.offset!=null){let n=0;i=np(i,()=>n++>=e.offset)}return e.limit!=null&&(i=yK(i,e.limit)),i}queryKeys(e,r){let i=this._allKeys(e,r);if(e.prefix!=null&&(i=np(i,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>np(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>dK(n,s),i)),e.offset!=null){let n=0;i=np(i,()=>n++>=e.offset)}return e.limit!=null&&(i=yK(i,e.limit)),i}};bK.exports=gK});var AI=p((j5t,mK)=>{f();"use strict";var Yg=ae();function BBe(t){return t=t||new Error("Cannot open database"),Yg(t,"ERR_DB_OPEN_FAILED")}function NBe(t){return t=t||new Error("Delete failed"),Yg(t,"ERR_DB_DELETE_FAILED")}function DBe(t){return t=t||new Error("Write failed"),Yg(t,"ERR_DB_WRITE_FAILED")}function MBe(t){return t=t||new Error("Not Found"),Yg(t,"ERR_NOT_FOUND")}function LBe(t){return t=t||new Error("Aborted"),Yg(t,"ERR_ABORTED")}mK.exports={dbOpenFailedError:BBe,dbDeleteFailedError:NBe,dbWriteFailedError:DBe,notFoundError:MBe,abortedError:LBe}});var EK=p((V5t,_K)=>{f();"use strict";var vK=EI(),UBe=xI(),FBe=AI(),wK=class extends UBe{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,r){this.data[e.toString()]=r}async get(e){if(!await this.has(e))throw FBe.notFoundError();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,r])=>({key:new vK(e),value:r}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new vK(e))}};_K.exports=wK});var Ft=p((z5t,SK)=>{f();"use strict";var KBe=EI(),jBe=EK(),VBe=SI(),zBe=AI(),HBe=xI();SK.exports={Key:KBe,MemoryDatastore:jBe,utils:VBe,Errors:zBe,Adapter:HBe}});var AK=p((H5t,xK)=>{f();"use strict";xK.exports=function(){return Date.now()}});var TK=p(($5t,IK)=>{f();"use strict";var II=AK();function TI(t,e,r){var i=this;this._started=II(),this._rescheduled=0,this._scheduled=e,this._args=r,this._timer=setTimeout(n,e);function n(){i._rescheduled>0?(i._scheduled=i._rescheduled-(II()-i._started),i._timer=setTimeout(n,i._scheduled),i._rescheduled=0):t.apply(null,i._args)}}TI.prototype.reschedule=function(t){var e=II();return e+t-(this._started+this._scheduled)<0?!1:(this._started=e,this._rescheduled=t,!0)};TI.prototype.clear=function(){clearTimeout(this._timer)};function $Be(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");var t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new TI(arguments[0],arguments[1],t)}IK.exports=$Be});var PI=p((G5t,RI)=>{f();"use strict";var{AbortController:GBe}=typeof self!="undefined"?self:typeof window!="undefined"?window:Ql(),RK=TK(),Xg=class extends GBe{constructor(e){super();this._ms=e,this._timer=RK(()=>this.abort(),e),Object.setPrototypeOf(this,Xg.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=RK(()=>this.abort(),this._ms)}};RI.exports=Xg;RI.exports.TimeoutController=Xg});var Qg=p((W5t,CI)=>{f();"use strict";var WBe=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;CI.exports=dt;CI.exports.default=dt;dt.nanosecond=dt.ns=1/1e6;dt.\u00B5s=dt.\u03BCs=dt.us=dt.microsecond=1/1e3;dt.millisecond=dt.ms=dt[""]=1;dt.second=dt.sec=dt.s=dt.ms*1e3;dt.minute=dt.min=dt.m=dt.s*60;dt.hour=dt.hr=dt.h=dt.m*60;dt.day=dt.d=dt.h*24;dt.week=dt.wk=dt.w=dt.d*7;dt.month=dt.b=dt.d*(365.25/12);dt.year=dt.yr=dt.y=dt.d*365.25;function dt(t="",e="ms"){var r=null;return t=(t+"").replace(/(\d)[,_](\d)/g,"$1$2"),t.replace(WBe,function(i,n,s){s=PK(s),s&&(r=(r||0)+parseFloat(n,10)*s)}),r&&r/(PK(e)||1)}function PK(t){return dt[t]||dt[t.toLowerCase().replace(/s$/,"")]}});var OK=p(CK=>{f();"use strict";var Zg=class extends Error{constructor(e="request timed out"){super(e);this.name="TimeoutError",this.code=Zg.code}};Zg.code="ERR_TIMEOUT";CK.TimeoutError=Zg});var Oe=p((X5t,kK)=>{f();"use strict";var YBe=PI(),{anySignal:XBe}=Zl(),{default:QBe}=Qg(),{TimeoutError:OI}=OK();function ZBe(t,e){return(...r)=>{let i=r[e??r.length-1];if(!i||!i.timeout)return t(...r);let n=typeof i.timeout=="string"?QBe(i.timeout):i.timeout,s=new YBe(n);i.signal=XBe([i.signal,s.signal]);let o=t(...r),a=new Promise((u,h)=>{s.signal.addEventListener("abort",()=>{h(new OI)})}),c=Date.now(),l=()=>{if(s.signal.aborted)throw new OI;if(Date.now()-c>n)throw s.abort(),new OI};return o[Symbol.asyncIterator]?async function*(){let u=o[Symbol.asyncIterator]();try{for(;;){let{value:h,done:d}=await Promise.race([u.next(),a]);if(d)break;l(),yield h}}catch(h){throw l(),h}finally{s.clear(),u.return&&u.return()}}():(async()=>{try{let u=await Promise.race([o,a]);return l(),u}catch(u){throw l(),u}finally{s.clear()}})()}}kK.exports=ZBe});var Jg=p((Q5t,NK)=>{f();"use strict";var{CID:kI}=(Ae(),Ce),qK=ae(),BK="/ipfs/",JBe=t=>{if(t instanceof Uint8Array)try{t=kI.decode(t)}catch(n){throw qK(n,"ERR_INVALID_CID")}if(t instanceof kI)return{cid:t,path:void 0};t.startsWith(BK)&&(t=t.substring(BK.length));let e=t.split("/"),r,i;try{r=kI.parse(e.shift()||"")}catch(n){throw qK(n,"ERR_INVALID_CID")}return e.length&&(i=`/${e.join("/")}`),{cid:r,path:i}};NK.exports=JBe});var zi=p((Z5t,MK)=>{f();"use strict";var eNe=zd(),{CID:sp}=(Ae(),Ce),tNe=Ft().Key,qI=ae(),rNe=Oe(),iNe=Jg(),nNe=(At(),xt),sNe="ERR_BAD_PATH",oNe=t=>{if(t instanceof sp)return`/ipfs/${t}`;try{sp.parse(t),t=`/ipfs/${t}`}catch{}if(eNe.path(t))return t;throw qI(new Error(`invalid path: ${t}`),sNe)},aNe=t=>t instanceof Uint8Array?sp.decode(t).toString():t instanceof sp?t.toString():(t.indexOf("/ipfs/")===0&&(t=t.substring("/ipfs/".length)),t.charAt(t.length-1)==="/"&&(t=t.substring(0,t.length-1)),t),cNe=async function(t,e,r,i={}){let{cid:n,path:s}=iNe(r);s&&(i.path=s);let o=n,a=i.path||"";if(a.startsWith("/")&&(a=a.substring(1)),i.path)try{for await(let{value:c,remainderPath:l}of DK(n,i.path,e,t,{signal:i.signal})){if(!(c instanceof sp))break;a=l,o=c}}catch(c){throw c.message.startsWith("Object has no property")&&(c.message=`no link named "${a.split("/")[0]}" under ${o}`,c.code="ERR_NO_LINK"),c}return{cid:o,remainderPath:a||""}},uNe=t=>{if(t.type!=="file"&&t.type!=="directory"&&t.type!=="raw")throw new Error(`Unknown node type '${t.type}'`);let e={cid:t.cid,path:t.path,name:t.name,size:t.size,type:"file"};return t.type==="directory"&&(e.type="dir"),t.type==="file"&&(e.size=t.unixfs.fileSize()),(t.type==="file"||t.type==="directory")&&(e.mode=t.unixfs.mode,t.unixfs.mtime!==void 0&&(e.mtime=t.unixfs.mtime)),e},lNe=rNe(async(t,e)=>await t),DK=async function*(t,e,r,i,n){let s=async l=>{let u=await r.getCodec(l.code),h=await i.blocks.get(l,n);return u.decode(h)},o=e.split("/").filter(Boolean),a=await s(t),c=t;for(o.length||(yield{value:a,remainderPath:""});o.length;){let l=o.shift();if(!l)throw qI(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(t.code===nNe.code&&Array.isArray(a.Links)){let u=a.Links.find(h=>h.Name===l);if(u){yield{value:u.Hash,remainderPath:o.join("/")},a=await s(u.Hash),c=u.Hash;continue}}if(Object.prototype.hasOwnProperty.call(a,l))a=a[l],yield{value:a,remainderPath:o.join("/")};else throw qI(new Error(`no link named "${l}" under ${c}`),"ERR_NO_LINK");a instanceof sp&&(c=a,a=await s(a))}};MK.exports={normalizePath:oNe,normalizeCidPath:aNe,resolvePath:cNe,mapFile:uNe,withTimeout:lNe,resolve:DK,OFFLINE_ERROR:"This command must be run in online mode. Try running 'ipfs daemon' first.",MFS_ROOT_KEY:new tNe("/local/filesroot"),MFS_MAX_CHUNK_SIZE:262144,MFS_MAX_LINKS:174}});var Vw=p((J5t,LK)=>{f();"use strict";var{NotStartedError:fNe,AlreadyStartingError:hNe,AlreadyStartedError:dNe}=Qu(),{withTimeout:pNe}=zi(),Va=class{static create({start:e,stop:r}){return new Va(e,r)}static async start(e,r){let{state:i,activate:n}=e;switch(i.status){case"stopped":try{let s=n(r);e.state={status:"starting",ready:s};let o=await s;return e.state={status:"started",value:o},o}catch(s){throw e.state={status:"stopped"},s}case"starting":throw new hNe;case"started":throw new dNe;case"stopping":return await i.ready,await Va.start(e,r);default:return Va.panic(e)}}static async stop(e){let{state:r,deactivate:i}=e;switch(r.status){case"stopped":break;case"starting":{try{await r.ready}catch(n){}return await Va.stop(e)}case"stopping":return await r.ready;case"started":{i&&await i(r.value),e.state={status:"stopped"};break}default:Va.panic(r)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},r){switch(e.status){case"started":return e.value;case"starting":return await pNe(e.ready,r);default:throw new fNe}}static panic({state:e}){let r=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${r}, should never happen if you see this please report a bug`)}constructor(e,r){this.activate=e,this.deactivate=r,this.state={status:"stopped"}}async use(e){return await Va.use(this,e)}try(){return Va.try(this)}};LK.exports=Va});var FK=p((eTt,UK)=>{f();"use strict";var yNe=Vw();UK.exports=({network:t,preload:e,peerId:r,keychain:i,repo:n,ipns:s,mfsPreload:o,print:a,options:c})=>async()=>{let{libp2p:u}=await yNe.start(t,{peerId:r,repo:n,print:a,options:c});await Promise.all([s.startOnline({keychain:i,libp2p:u,peerId:r,repo:n}),e.start(),o.start()])}});var jK=p((tTt,KK)=>{f();"use strict";var gNe=Vw();KK.exports=({network:t,preload:e,ipns:r,repo:i,mfsPreload:n})=>async()=>{await Promise.all([e.stop(),r.stop(),n.stop(),gNe.stop(t),i.close()])}});var eb=p((rTt,VK)=>{f();VK.exports=function(t){if(!t)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,r=Object.create(null),i=Object.create(null);function n(s,o){r[s]=o,e++,e>=t&&(e=0,i=r,r=Object.create(null))}return{has:function(s){return r[s]!==void 0||i[s]!==void 0},remove:function(s){r[s]!==void 0&&(r[s]=void 0),i[s]!==void 0&&(i[s]=void 0)},get:function(s){var o=r[s];if(o!==void 0)return o;if((o=i[s])!==void 0)return n(s,o),o},set:function(s,o){r[s]!==void 0?r[s]=o:n(s,o)},clear:function(){r=Object.create(null),i=Object.create(null)}}}});var BI=p((iTt,HK)=>{f();"use strict";var bNe=eb(),zK=class{constructor(e){this.lru=bNe(e)}get(e){let r=this.lru.get(e);if(r){if(r.expire&&r.expire<Date.now()){this.lru.remove(e);return}return r.value}}set(e,r,i){this.lru.set(e,{value:r,expire:Date.now()+i})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};HK.exports=zK});var GK=p((nTt,NI)=>{f();"use strict";var mNe=Object.prototype.hasOwnProperty,Pn="~";function tb(){}Object.create&&(tb.prototype=Object.create(null),new tb().__proto__||(Pn=!1));function vNe(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function $K(t,e,r,i,n){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new vNe(r,i||t,n),o=Pn?Pn+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],s]:t._events[o].push(s):(t._events[o]=s,t._eventsCount++),t}function zw(t,e){--t._eventsCount==0?t._events=new tb:delete t._events[e]}function pn(){this._events=new tb,this._eventsCount=0}pn.prototype.eventNames=function(){var e=[],r,i;if(this._eventsCount===0)return e;for(i in r=this._events)mNe.call(r,i)&&e.push(Pn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};pn.prototype.listeners=function(e){var r=Pn?Pn+e:e,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};pn.prototype.listenerCount=function(e){var r=Pn?Pn+e:e,i=this._events[r];return i?i.fn?1:i.length:0};pn.prototype.emit=function(e,r,i,n,s,o){var a=Pn?Pn+e:e;if(!this._events[a])return!1;var c=this._events[a],l=arguments.length,u,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,i),!0;case 4:return c.fn.call(c.context,r,i,n),!0;case 5:return c.fn.call(c.context,r,i,n,s),!0;case 6:return c.fn.call(c.context,r,i,n,s,o),!0}for(h=1,u=new Array(l-1);h<l;h++)u[h-1]=arguments[h];c.fn.apply(c.context,u)}else{var d=c.length,y;for(h=0;h<d;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),l){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,r);break;case 3:c[h].fn.call(c[h].context,r,i);break;case 4:c[h].fn.call(c[h].context,r,i,n);break;default:if(!u)for(y=1,u=new Array(l-1);y<l;y++)u[y-1]=arguments[y];c[h].fn.apply(c[h].context,u)}}return!0};pn.prototype.on=function(e,r,i){return $K(this,e,r,i,!1)};pn.prototype.once=function(e,r,i){return $K(this,e,r,i,!0)};pn.prototype.removeListener=function(e,r,i,n){var s=Pn?Pn+e:e;if(!this._events[s])return this;if(!r)return zw(this,s),this;var o=this._events[s];if(o.fn)o.fn===r&&(!n||o.once)&&(!i||o.context===i)&&zw(this,s);else{for(var a=0,c=[],l=o.length;a<l;a++)(o[a].fn!==r||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:zw(this,s)}return this};pn.prototype.removeAllListeners=function(e){var r;return e?(r=Pn?Pn+e:e,this._events[r]&&zw(this,r)):(this._events=new tb,this._eventsCount=0),this};pn.prototype.off=pn.prototype.removeListener;pn.prototype.addListener=pn.prototype.on;pn.prefixed=Pn;pn.EventEmitter=pn;typeof NI!="undefined"&&(NI.exports=pn)});var YK=p((sTt,WK)=>{f();"use strict";WK.exports=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(i=>{i(e())}).then(()=>r),r=>new Promise(i=>{i(e())}).then(()=>{throw r})))});var QK=p((oTt,Hw)=>{f();"use strict";var wNe=YK(),DI=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},XK=(t,e,r)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(t);return}let s=setTimeout(()=>{if(typeof r=="function"){try{i(r())}catch(c){n(c)}return}let o=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,a=r instanceof Error?r:new DI(o);typeof t.cancel=="function"&&t.cancel(),n(a)},e);wNe(t.then(i,n),()=>{clearTimeout(s)})});Hw.exports=XK;Hw.exports.default=XK;Hw.exports.TimeoutError=DI});var ZK=p(MI=>{f();"use strict";Object.defineProperty(MI,"__esModule",{value:!0});function _Ne(t,e,r){let i=0,n=t.length;for(;n>0;){let s=n/2|0,o=i+s;r(t[o],e)<=0?(i=++o,n-=s+1):n=s}return i}MI.default=_Ne});var ej=p(LI=>{f();"use strict";Object.defineProperty(LI,"__esModule",{value:!0});var ENe=ZK(),JK=class{constructor(){this._queue=[]}enqueue(e,r){r=Object.assign({priority:0},r);let i={priority:r.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(i);return}let n=ENe.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this._queue.length}};LI.default=JK});var Kc=p(UI=>{f();"use strict";Object.defineProperty(UI,"__esModule",{value:!0});var SNe=GK(),tj=QK(),xNe=ej(),$w=()=>{},ANe=new tj.TimeoutError,rj=class extends SNe{constructor(e){var r,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=$w,this._resolveIdle=$w,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:xNe.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=$w,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=$w,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let r=this._intervalEnd-e;if(r<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},r)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let r=this._queue.dequeue();return r?(this.emit("active"),r(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,r={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&r.timeout===void 0?e():tj.default(Promise.resolve(e()),r.timeout===void 0?this._timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?this._throwOnTimeout:r.throwOnTimeout)&&n(ANe)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,r),this._tryToStartAnother(),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async i=>this.add(i,r)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let r=this._resolveEmpty;this._resolveEmpty=()=>{r(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let r=this._resolveIdle;this._resolveIdle=()=>{r(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};UI.default=rj});var sj=p((lTt,nj)=>{f();"use strict";var INe=BI(),{default:TNe}=Kc(),RNe=$y(),FI=new INe(1e3),PNe=60*1e3,CNe=new TNe({concurrency:4}),ij=t=>{if(t.Path)return t.Path;throw new Error(t.Message)};nj.exports=async(t,e)=>(async(i,n={})=>{let s=new URLSearchParams(n);s.set("arg",i);let o=s.toString();if(!n.nocache&&FI.has(o)){let c=FI.get(o);return ij(c)}let a=await CNe.add(async()=>{let c=await RNe.get("https://ipfs.io/api/v0/dns",{searchParams:s}),l=new URL(c.url).search.slice(1),u=await c.json();return FI.set(l,u,PNe),u});return ij(a)})(t,e)});var aj=p((fTt,oj)=>{f();"use strict";var ONe=sj(),kNe=Oe();function qNe(t){return t.endsWith(".eth")&&(t=t.replace(/.eth$/,".eth.link")),t}oj.exports=()=>kNe(async(e,r={recursive:!0})=>{if(typeof e!="string")throw new Error("Invalid arguments, domain must be a string");return e=qNe(e),ONe(e,r)})});var uj=p((hTt,cj)=>{f();"use strict";cj.exports=({network:t})=>()=>{let e=t.try();return e!=null&&Boolean(e.libp2p.isStarted())}});var hj=p((dTt,fj)=>{f();"use strict";var lj=zd(),{CID:KI}=(Ae(),Ce),BNe=et(),NNe=Oe(),{resolve:DNe}=zi();fj.exports=({repo:t,codecs:e,bases:r,name:i})=>{async function n(s,o={}){if(!lj.path(s))throw new Error("invalid argument "+s);if(lj.ipnsPath(s))for await(let E of i.resolve(s,o))s=E;let[,a,c,...l]=s.split("/"),u=o.cidBase?await r.getBase(o.cidBase):void 0,h=MNe(c);if(l.length===0){let E=u?u.encoder.encode(h):c;return`/${a}/${E}`}let d=KI.decode(h);s=l.join("/");let y=DNe(d,s,e,t,o),g=d,m=s;for await(let E of y)E.value instanceof KI&&(g=E.value,m=E.remainderPath);return`/ipfs/${g.toString(u&&u.encoder)}${m?"/"+m:""}`}return NNe(n)};function MNe(t){try{return BNe.parse(t).toBytes()}catch{return KI.parse(t).bytes}}});var $n=p((pTt,dj)=>{f();"use strict";var LNe=async t=>{let e;for await(let r of t)e=r;return e};dj.exports=LNe});var yj=p((yTt,pj)=>{f();"use strict";var UNe=$n(),{CID:FNe}=(Ae(),Ce);pj.exports=({addAll:t})=>(e,r={})=>{let i;return e instanceof FNe?i=t([{cid:e,...r}],r):i=t([{path:e.toString(),...r}],r),UNe(i)}});var op=p((gTt,gj)=>{f();"use strict";var rb=ae(),{CID:jI}=(Ae(),Ce);async function*KNe(t){if(t==null)throw rb(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT");if(t instanceof jI){yield Co({cid:t});return}if(t instanceof String||typeof t=="string"){yield Co({path:t});return}if(t.cid!=null||t.path!=null)return yield Co(t);if(Symbol.iterator in t){let e=t[Symbol.iterator](),r=e.next();if(r.done)return e;if(r.value instanceof jI||r.value instanceof String||typeof r.value=="string"){yield Co({cid:r.value});for(let i of e)yield Co({cid:i});return}if(r.value.cid!=null||r.value.path!=null){yield Co(r.value);for(let i of e)yield Co(i);return}throw rb(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in t){let e=t[Symbol.asyncIterator](),r=await e.next();if(r.done)return e;if(r.value instanceof jI||r.value instanceof String||typeof r.value=="string"){yield Co({cid:r.value});for await(let i of e)yield Co({cid:i});return}if(r.value.cid!=null||r.value.path!=null){yield Co(r.value);for await(let i of e)yield Co(i);return}throw rb(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}throw rb(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}function Co(t){let e=t.cid||`${t.path}`;if(!e)throw rb(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let r={path:e,recursive:t.recursive!==!1};return t.metadata!=null&&(r.metadata=t.metadata),r}gj.exports={normaliseInput:KNe}});var VI=p((bTt,bj)=>{f();bj.exports=jNe;function jNe(t,e,r){if(!t)return r;var i,n;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");for(;i.length;)if(n=i.shift(),!t||(t=t[n],t===void 0))return r;return t}});var zI=p((mTt,mj)=>{f();"use strict";var VNe=async t=>{let e=0;for await(let r of t)e++;return e};mj.exports=VNe});var xj=p((vTt,Sj)=>{f();"use strict";var{CID:vj}=(Ae(),Ce),wj=Ft().Key,zNe=me()("ipfs:repo:migrator:migration-8"),HNe=zI(),{base32:Gw}=(an(),on),$Ne=(Rs(),ns),GNe=(An(),xn);function _j(t){return t.child?_j(t.child):t}function WNe(t){try{let e=Gw.decode(`b${t.toString().toLowerCase().slice(1)}`),r=vj.decode(e).multihash.bytes,i=Gw.encode(r).slice(1).toUpperCase();return new wj(`/${i}`,!1)}catch(e){return t}}function YNe(t){try{let e=Gw.decode(`b${t.toString().toLowerCase().slice(1)}`),r=GNe.decode(e),i=Gw.encode(vj.createV1($Ne.code,r).bytes).slice(1);return new wj(`/${i.toUpperCase()}`,!1)}catch{return t}}async function Ej(t,e,r){let i=t.blocks;await i.open();let n=_j(i),s;s=await HNe(n.queryKeys({filters:[o=>r(o).toString()!==o.toString()]}));try{let o=0;for await(let a of n.query({})){let c=r(a.key);c.toString()!==a.key.toString()&&(o+=1,zNe(`Migrating Block from ${a.key} to ${c}`,await n.has(a.key)),await n.delete(a.key),await n.put(c,a.value),e(o/s*100,`Migrated Block from ${a.key} to ${c}`))}}finally{await i.close()}}Sj.exports={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(t,e=()=>{})=>Ej(t,e,WNe),revert:(t,e=()=>{})=>Ej(t,e,YNe)}});var Tj=p((_Tt,Ij)=>{f();"use strict";var ap=Bi(),Aj=ap.Reader,XNe=ap.Writer,wTt=ap.util,ib=ap.roots.default||(ap.roots.default={});ib.ipfs=function(){var t={};return t.pin=function(){var e={};return e.Set=function(){function r(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return r.prototype.version=0,r.prototype.fanout=0,r.prototype.seed=0,r.encode=function(n,s){return s||(s=XNe.create()),n.version!=null&&Object.hasOwnProperty.call(n,"version")&&s.uint32(8).uint32(n.version),n.fanout!=null&&Object.hasOwnProperty.call(n,"fanout")&&s.uint32(16).uint32(n.fanout),n.seed!=null&&Object.hasOwnProperty.call(n,"seed")&&s.uint32(29).fixed32(n.seed),s},r.decode=function(n,s){n instanceof Aj||(n=Aj.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new ib.ipfs.pin.Set;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.version=n.uint32();break;case 2:a.fanout=n.uint32();break;case 3:a.seed=n.fixed32();break;default:n.skipType(c&7);break}}return a},r.fromObject=function(n){if(n instanceof ib.ipfs.pin.Set)return n;var s=new ib.ipfs.pin.Set;return n.version!=null&&(s.version=n.version>>>0),n.fanout!=null&&(s.fanout=n.fanout>>>0),n.seed!=null&&(s.seed=n.seed>>>0),s},r.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(o.version=0,o.fanout=0,o.seed=0),n.version!=null&&n.hasOwnProperty("version")&&(o.version=n.version),n.fanout!=null&&n.hasOwnProperty("fanout")&&(o.fanout=n.fanout),n.seed!=null&&n.hasOwnProperty("seed")&&(o.seed=n.seed),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,ap.util.toJSONOptions)},r}(),e}(),t}();Ij.exports=ib});var Pj=p((ETt,Rj)=>{f();HI.BASE=2166136261;function HI(t){for(var e=HI.BASE,r=0,i=t.length;r<i;r++)e^=t.charCodeAt(r),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}Rj.exports=HI});var $I=p((STt,Oj)=>{f();"use strict";var{Key:Cj}=Ft(),{base32:QNe}=(an(),on),{CID:ZNe}=(Bu(),dd),JNe=new Cj("/local/pins"),eDe=256,tDe=8192,rDe=ZNe.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),iDe={direct:"direct",recursive:"recursive"};function nDe(t){return new Cj(`/${QNe.encode(t.multihash.bytes).toUpperCase().substring(1)}`)}Oj.exports={PIN_DS_KEY:JNe,DEFAULT_FANOUT:eDe,MAX_ITEMS:tDe,EMPTY_KEY:rDe,PinTypes:iDe,cidToKey:nDe}});var qj=p((xTt,kj)=>{f();"use strict";function sDe(t,e){for(let r=0;r<t.byteLength;r++){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0}kj.exports=sDe});var Uj=p((ATt,Lj)=>{f();"use strict";var{CID:Bj}=(Ae(),Ce),{ipfs:{pin:{Set:GI}}}=Tj(),oDe=Pj(),WI=os(),Ww=(At(),xt),{DEFAULT_FANOUT:YI,MAX_ITEMS:aDe,EMPTY_KEY:Nj}=$I(),XI=un(),cDe=qj(),uDe=Je(),lDe=ct(),{sha256:Dj}=(ai(),$r);function fDe(t){let e=t.Data;if(!e)throw new Error("No data present");let r=WI.decode(e),i=WI.decode.bytes;if(i<=0)throw new Error("Invalid Set header length");if(i+r>e.length)throw new Error("Impossibly large set header length");let n=e.slice(i,r+i),s=GI.toObject(GI.decode(n),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(s.version!==1)throw new Error(`Unsupported Set version: ${s.version}`);if(s.fanout>t.Links.length)throw new Error("Impossibly large fanout");return{header:s,data:e.slice(r+i)}}function hDe(t,e){let r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,t,!0);let n=lDe(e.toString()),s=XI([r,n],r.byteLength+n.byteLength);return oDe(uDe(s))}async function*Mj(t,e){let r=fDe(e),i=0;for(let n of e.Links){if(i<r.header.fanout){let s=n.Hash;if(!Nj.equals(s)){let o=await t.get(s),a=Ww.decode(o);yield*Mj(t,a)}}else yield n.Hash;i++}}async function*dDe(t,e,r){let i=e.Links.find(o=>o.Name===r);if(!i)throw new Error("No link found with name "+r);let n=await t.get(i.Hash),s=Ww.decode(n);yield*Mj(t,s)}function pDe(t,e){return r(e,0);async function r(i,n){let s=GI.encode({version:1,fanout:YI,seed:n}).finish(),o=WI.encode(s.length),a=XI([o,s]),c=[];for(let u=0;u<YI;u++)c.push({Name:"",Tsize:1,Hash:Nj});if(i.length<=aDe){let u=i.map(y=>({link:{Name:"",Tsize:1,Hash:y.key},data:y.data||new Uint8Array})).sort((y,g)=>cDe(y.link.Hash.bytes,g.link.Hash.bytes)),h=c.concat(u.map(y=>y.link));return{Data:XI([a,...u.map(y=>y.data)]),Links:h}}else{let u=i.reduce((d,y)=>{let g=hDe(n,y.key)%YI;return d[g]=g in d?d[g].concat([y]):[y],d},[]),h=0;for(let d of u){let y=await r(d,n+1);await l(y,h),h++}return{Data:a,Links:c}}async function l(u,h){let d=Ww.encode(u),y=await Dj.digest(d),g=Bj.createV0(y);await t.put(g,d);let m=u.Links.reduce((E,v)=>E+(v.Tsize||0),0)+d.length;c[h]={Name:"",Tsize:m,Hash:g}}}}async function yDe(t,e,r){let i=await pDe(t,r.map(c=>({key:c}))),n=Ww.encode(i),s=await Dj.digest(n),o=Bj.createV0(s);await t.put(o,n);let a=i.Links.reduce((c,l)=>c+l.Tsize,0)+n.length;return{Name:e,Tsize:a,Hash:o}}Lj.exports={loadSet:dDe,storeSet:yDe}});var Vj=p((ITt,jj)=>{f();"use strict";var{CID:QI}=(Ae(),Ce),nb=(At(),xt),ZI=(Kg(),Kw),cp=Uj(),{cidToKey:Fj,PIN_DS_KEY:Yw,PinTypes:up}=$I(),JI=zI(),{sha256:gDe}=(ai(),$r),bDe=(An(),xn),{base32:mDe}=(an(),on);async function vDe(t,e,r,i){if(!await e.has(Yw))return;let n=await e.get(Yw),s=QI.decode(n),o=await t.get(s),a=nb.decode(o),c=0,l;l=await JI(cp.loadSet(t,a,up.recursive))+await JI(cp.loadSet(t,a,up.direct));for await(let u of cp.loadSet(t,a,up.recursive)){c++;let h={depth:1/0};u.version!==0&&(h.version=u.version),u.code!==nb.code&&(h.codec=u.code),await r.put(Fj(u),ZI.encode(h)),i(c/l*100,`Migrated recursive pin ${u}`)}for await(let u of cp.loadSet(t,a,up.direct)){c++;let h={depth:0};u.version!==0&&(h.version=u.version),u.code!==nb.code&&(h.codec=u.code),await r.put(Fj(u),ZI.encode(h)),i(c/l*100,`Migrated direct pin ${u}`)}await t.delete(s),await e.delete(Yw)}async function wDe(t,e,r,i){let n=[],s=[],o=0,a=await JI(r.queryKeys({}));for await(let{key:d,value:y}of r.query({})){o++;let g=ZI.decode(y),m=QI.create(g.version||0,g.codec||nb.code,bDe.decode(mDe.decode("b"+d.toString().toLowerCase().split("/").pop())));g.depth===0?(i(o/a*100,`Reverted direct pin ${m}`),s.push(m)):(i(o/a*100,`Reverted recursive pin ${m}`),n.push(m))}i(100,"Updating pin root");let c={Links:[await cp.storeSet(t,up.direct,s),await cp.storeSet(t,up.recursive,n)]},l=nb.encode(c),u=await gDe.digest(l),h=QI.createV0(u);await t.put(h,l),await e.put(Yw,h.bytes)}async function Kj(t,e,r){let i=t.blocks,n=t.datastore,s=t.pins;await i.open(),await n.open(),await s.open();try{await r(i,n,s,e)}finally{await s.close(),await n.close(),await i.close()}}jj.exports={version:9,description:"Migrates pins to datastore",migrate:(t,e=()=>{})=>Kj(t,e,vDe),revert:(t,e=()=>{})=>Kj(t,e,wDe)}});var If=p((TTt,Wj)=>{f();"use strict";var{Key:zj,Errors:Hj}=Ft(),_De=new zj("/config"),EDe=new zj("/version");function e4(t){let e=t;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function $j(t,e,r){let i=await e(t);if(i)return i;let n=e4(r);return n?new Promise((s,o)=>{let a=n.store("readonly").get(t.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function Gj(t,e,r,i){if(await r(t))return e(t);let n=e4(i);if(!n)throw Hj.notFoundError();return new Promise((s,o)=>{let a=n.store("readonly").get(t.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(Hj.notFoundError())}})}function Xw(t){let e=t.get.bind(t),r=t.has.bind(t);return t.get=i=>Gj(i,e,r,t),t.has=i=>$j(i,r,t),t}function SDe(t){return{...t,root:Xw(t.root),datastore:Xw(t.datastore),pins:Xw(t.pins),keys:Xw(t.keys)}}Wj.exports={wrapBackends:SDe,hasWithFallback:$j,getWithFallback:Gj,findLevelJs:e4,CONFIG_KEY:_De,VERSION_KEY:EDe}});var eV=p((RTt,Jj)=>{f();"use strict";var{findLevelJs:Yj}=If(),xDe=ct(),ADe=Je();async function IDe(t,e,r=()=>{}){let i=Yj(e);if(!i){r(`${t} did not need an upgrade`);return}r(`Upgrading ${t}`),await Zj(i,(s,o)=>[{type:"del",key:s},{type:"put",key:xDe(s),value:o}])}async function TDe(t,e,r=()=>{}){let i=Yj(e);if(!i){r(`${t} did not need a downgrade`);return}r(`Downgrading ${t}`),await Zj(i,(s,o)=>[{type:"del",key:s},{type:"put",key:ADe(s),value:o}])}function Xj(t){return t.child?Xj(t.child):t}async function Qj(t,e,r){let i=Object.entries(t).map(([s,o])=>({key:s,backend:Xj(o)})).filter(({key:s,backend:o})=>o.constructor.name==="LevelDatastore").map(({key:s,backend:o})=>({name:s,store:o}));e(0,`Migrating ${i.length} dbs`);let n=0;for(let{name:s,store:o}of i){await o.open();try{await r(s,o,c=>{e(Math.round(n/i.length*100),c)})}finally{n++,o.close()}}e(100,`Migrated ${i.length} dbs`)}Jj.exports={version:10,description:"Migrates datastore-level keys to binary",migrate:(t,e=()=>{})=>Qj(t,e,IDe),revert:(t,e=()=>{})=>Qj(t,e,TDe)};function Zj(t,e){function r(i,n){let s=t.store("readwrite"),o=s.transaction,a=0,c;o.onabort=()=>n(c||o.error||new Error("aborted by user")),o.oncomplete=()=>n();function l(){var u=i[a++],h=u.key;try{var d=u.type==="del"?s.delete(h):s.put(u.value,h)}catch(y){c=y,o.abort();return}a<i.length&&(d.onsuccess=l)}l()}return new Promise((i,n)=>{let s=t.iterator(),o=c=>c;s._deserializeKey=s._deserializeValue=o,a();function a(){let c=(l,u,h)=>{if(l||u===void 0){let d=y=>{if(y){n(y);return}i()};s.end(d);return}r(e(u,h),a)};s.next(c)}})}});var rV=p((PTt,tV)=>{f();"use strict";var Tf={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};tV.exports=[Object.assign({version:1},Tf),Object.assign({version:2},Tf),Object.assign({version:3},Tf),Object.assign({version:4},Tf),Object.assign({version:5},Tf),Object.assign({version:6},Tf),Object.assign({version:7},Tf),xj(),Vj(),eV()]});var Qw=p((CTt,iV)=>{f();"use strict";var t4=class extends Error{constructor(e){super(e);this.name="NonReversibleMigrationError",this.code="ERR_NON_REVERSIBLE_MIGRATION",this.message=e}};t4.code="ERR_NON_REVERSIBLE_MIGRATION";var r4=class extends Error{constructor(e){super(e);this.name="NotInitializedRepoError",this.code="ERR_NOT_INITIALIZED_REPO",this.message=e}};r4.code="ERR_NOT_INITIALIZED_REPO";var i4=class extends Error{constructor(e){super(e);this.name="RequiredParameterError",this.code="ERR_REQUIRED_PARAMETER",this.message=e}};i4.code="ERR_REQUIRED_PARAMETER";var n4=class extends Error{constructor(e){super(e);this.name="InvalidValueError",this.code="ERR_INVALID_VALUE",this.message=e}};n4.code="ERR_INVALID_VALUE";var s4=class extends Error{constructor(e){super(e);this.name="MissingRepoOptionsError",this.code="ERR_MISSING_REPO_OPTIONS",this.message=e}};s4.code="ERR_MISSING_REPO_OPTIONS";iV.exports={NonReversibleMigrationError:t4,NotInitializedRepoError:r4,RequiredParameterError:i4,InvalidValueError:n4,MissingRepoOptionsError:s4}});var sV=p((OTt,nV)=>{f();"use strict";var o4=me()("ipfs:repo:migrator:repo:init"),{CONFIG_KEY:RDe,VERSION_KEY:PDe}=If(),{MissingRepoOptionsError:CDe}=Qw();async function ODe(t){if(!t)throw new CDe("Please pass repo options when trying to open a repo");let e=t.root;try{await e.open();let r=await e.has(PDe),i=await e.has(RDe);return!r||!i?(o4(`Version entry present: ${r}`),o4(`Config entry present: ${i}`),!1):!0}catch(r){return o4("While checking if repo is initialized error was thrown: "+r.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}nV.exports={isRepoInitialized:ODe}});var cV=p((kTt,aV)=>{f();"use strict";var kDe=sV(),{MissingRepoOptionsError:qDe,NotInitializedRepoError:BDe}=Qw(),{VERSION_KEY:oV}=If(),NDe=ct(),DDe=Je();async function MDe(t){if(!await kDe.isRepoInitialized(t))throw new BDe("Repo is not initialized!");let e=t.root;await e.open();try{return parseInt(DDe(await e.get(oV)))}finally{await e.close()}}async function LDe(t,e){if(!e)throw new qDe("Please pass repo options when trying to open a repo");let r=e.root;await r.open(),await r.put(oV,NDe(String(t))),await r.close()}aV.exports={getVersion:MDe,setVersion:LDe}});var dV=p((qTt,hV)=>{f();"use strict";var a4=rV(),Rf=cV(),ds=Qw(),{wrapBackends:uV}=If(),Oo=me()("ipfs:repo:migrator");function lV(t){return t=t||a4,!Array.isArray(t)||t.length===0?0:t[t.length-1].version}async function UDe(t,e,r,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||a4,!t)throw new ds.RequiredParameterError("Path argument is required!");if(!r)throw new ds.RequiredParameterError("repoOptions argument is required!");if(!i)throw new ds.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(i)||i<=0)throw new ds.InvalidValueError("Version has to be positive integer!");e=uV(e);let c=await Rf.getVersion(e);if(c===i){Oo("Nothing to migrate.");return}if(c>i)throw new ds.InvalidValueError(`Current repo's version (${c}) is higher then toVersion (${i}), you probably wanted to revert it?`);fV(a,c,i);let l;!o&&!n&&(l=await r.repoLock.lock(t));try{for(let u of a){if(i!==void 0&&u.version>i)break;if(!(u.version<=c)){Oo(`Migrating version ${u.version}`);try{if(!o){let h=()=>{};s&&(h=(d,y)=>s(u.version,d.toFixed(2),y)),await u.migrate(e,h)}}catch(h){let d=u.version-1;throw Oo(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${d}`),await Rf.setVersion(d,e),new Error(`During migration to version ${u.version} exception was raised: ${h.stack||h.message||h}`)}Oo(`Migrating to version ${u.version} finished`)}}o||await Rf.setVersion(i||lV(a),e),Oo("Repo successfully migrated",i!==void 0?`to version ${i}!`:"to latest version!")}finally{!o&&!n&&l&&await l.close()}}async function FDe(t,e,r,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||a4,!t)throw new ds.RequiredParameterError("Path argument is required!");if(!r)throw new ds.RequiredParameterError("repoOptions argument is required!");if(!i)throw new ds.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(i)||i<=0)throw new ds.InvalidValueError("Version has to be positive integer!");e=uV(e);let c=await Rf.getVersion(e);if(c===i){Oo("Nothing to revert.");return}if(c<i)throw new ds.InvalidValueError(`Current repo's version (${c}) is lower then toVersion (${i}), you probably wanted to migrate it?`);fV(a,i,c,!0);let l;!o&&!n&&(l=await r.repoLock.lock(t)),Oo(`Reverting from version ${c} to ${i}`);try{let u=a.slice().reverse();for(let h of u){if(h.version<=i)break;if(!(h.version>c)){Oo(`Reverting migration version ${h.version}`);try{if(!o){let d=()=>{};s&&(d=(y,g)=>s(h.version,y.toFixed(2),g)),await h.revert(e,d)}}catch(d){let y=h.version;throw Oo(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${y}`),await Rf.setVersion(y,e),d.message=`During reversion to version ${h.version} exception was raised: ${d.message}`,d}Oo(`Reverting to version ${h.version} finished`)}}o||await Rf.setVersion(i,e),Oo(`All migrations successfully reverted to version ${i}!`)}finally{!o&&!n&&l&&await l.close()}}function fV(t,e,r,i=!1){let n=0;for(let s of t){if(s.version>r)break;if(s.version>e){if(i&&!s.revert)throw new ds.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${s.version} is not reversible. Cancelling reversion.`);n++}}if(n!==r-e)throw new ds.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${r}`)}hV.exports={getCurrentRepoVersion:Rf.getVersion,getLatestMigrationVersion:lV,errors:ds,migrate:UDe,revert:FDe}});var gV=p((BTt,Zw)=>{f();"use strict";Zw.exports=zDe;Zw.exports.format=pV;Zw.exports.parse=yV;var KDe=/\B(?=(\d{3})+(?!\d))/g,jDe=/(?:\.0*|(\.[^0]+)0+)$/,Zu={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},VDe=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function zDe(t,e){return typeof t=="string"?yV(t):typeof t=="number"?pV(t,e):null}function pV(t,e){if(!Number.isFinite(t))return null;var r=Math.abs(t),i=e&&e.thousandsSeparator||"",n=e&&e.unitSeparator||"",s=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,o=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!Zu[a.toLowerCase()])&&(r>=Zu.pb?a="PB":r>=Zu.tb?a="TB":r>=Zu.gb?a="GB":r>=Zu.mb?a="MB":r>=Zu.kb?a="KB":a="B");var c=t/Zu[a.toLowerCase()],l=c.toFixed(s);return o||(l=l.replace(jDe,"$1")),i&&(l=l.replace(KDe,i)),l+n+a}function yV(t){if(typeof t=="number"&&!isNaN(t))return t;if(typeof t!="string")return null;var e=VDe.exec(t),r,i="b";return e?(r=parseFloat(e[1]),i=e[4].toLowerCase()):(r=parseInt(t,10),i="b"),Math.floor(Zu[i]*r)}});var mV=p((NTt,bV)=>{f();"use strict";bV.exports={repoVersion:10}});var wV=p((DTt,vV)=>{f();"use strict";var HDe=Ft().Key,$De=me(),GDe=$De("ipfs:repo:version"),WDe=Je(),YDe=ct(),{hasWithFallback:XDe,getWithFallback:QDe}=If(),c4=new HDe("version");vV.exports=t=>({async exists(){return XDe(c4,t.has.bind(t),t)},async get(){let e=await QDe(c4,t.get.bind(t),t.has.bind(t),t);return parseInt(WDe(e),10)},set(e){return t.put(c4,YDe(String(e)))},async check(e){let r=await this.get();return GDe("comparing version: %s and %s",r,e),r===e||(r===6&&e===7||e===6&&r===7)}})});var u4=p((MTt,EV)=>{f();EV.exports=ZDe;function ZDe(t,e,r){typeof e=="string"&&(e=e.split(".")),typeof e=="symbol"&&(e=[e]);var i=e.pop();if(!i)return!1;_V(i);for(var n;n=e.shift();)if(_V(n),typeof t[n]=="undefined"&&(t[n]={}),t=t[n],!t||typeof t!="object")return!1;return t[i]=r,!0}function _V(t){if(t==="__proto__"||t==="constructor"||t==="prototype")throw new Error("setting of prototype values not supported")}});var Jw=p(Pf=>{f();"use strict";var sb=class extends Error{constructor(e){super(e);this.name="LockExistsError",this.code=sb.code}};sb.code="ERR_LOCK_EXISTS";Pf.LockExistsError=sb;var ob=class extends Error{constructor(e){super(e);this.name="NotFoundError",this.code=ob.code}};ob.code="ERR_NOT_FOUND";Pf.NotFoundError=ob;var ab=class extends Error{constructor(e){super(e);this.name="InvalidRepoVersionError",this.code=ab.code}};ab.code="ERR_INVALID_REPO_VERSION";Pf.InvalidRepoVersionError=ab;Pf.ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED";Pf.ERR_REPO_ALREADY_OPEN="ERR_REPO_ALREADY_OPEN";Pf.ERR_REPO_ALREADY_CLOSED="ERR_REPO_ALREADY_CLOSED"});var AV=p((UTt,xV)=>{f();"use strict";var{Key:JDe}=Ft(),{default:e7e}=Kc(),t7e=VI(),r7e=u4(),l4=ae(),SV=Jw(),i7e=Je(),n7e=ct(),{hasWithFallback:s7e,getWithFallback:o7e}=If(),f4=new JDe("config");xV.exports=t=>{let e=new e7e({concurrency:1}),r={async getAll(s={}){let o=await o7e(f4,t.get.bind(t),t.has.bind(t),t,{signal:s.signal});return JSON.parse(i7e(o))},async get(s,o={}){if(s==null)throw new SV.NotFoundError(`Key ${s} does not exist in config`);let a=await this.getAll(o),c=t7e(a,s);if(c===void 0)throw new SV.NotFoundError(`Key ${s} does not exist in config`);return c},set(s,o,a={}){if(typeof s!="string"&&!(s instanceof String))throw l4(new Error("Invalid key type: "+typeof s),"ERR_INVALID_KEY");if(o===void 0||o instanceof Uint8Array)throw l4(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>i({key:s,value:o},a.signal))},replace(s,o={}){if(!s||s instanceof Uint8Array)throw l4(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>i({key:void 0,value:s},o.signal))},async exists(){return s7e(f4,t.has.bind(t),t)}};return r;async function i(s,o){if(o&&o.aborted)return;let a=s.key,c=s.value;if(a){let l=await r.getAll();return typeof l=="object"&&l!==null&&r7e(l,a,c),n(l)}return n(c)}function n(s){let o=n7e(JSON.stringify(s,null,2));return t.put(f4,o)}}});var TV=p((FTt,IV)=>{f();"use strict";IV.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var PV=p((KTt,RV)=>{f();"use strict";var h4=TV();RV.exports=(t,e={})=>{if(!h4(t)&&!Array.isArray(t))throw new TypeError("Expected a plain object or array");let{deep:r}=e,i=[],n=[],s=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let l=[];return i.push(a),n.push(l),l.push(...a.map(u=>Array.isArray(u)?s(u):h4(u)?o(u):u)),l},o=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let l={},u=Object.keys(a).sort(e.compare);i.push(a),n.push(l);for(let h of u){let d=a[h],y;r&&Array.isArray(d)?y=s(d):y=r&&h4(d)?o(d):d,Object.defineProperty(l,h,{...Object.getOwnPropertyDescriptor(a,h),value:y})}return l};return Array.isArray(t)?r?s(t):t.slice():o(t)}});var OV=p((jTt,CV)=>{f();"use strict";var a7e=Ft().Key,c7e=PV(),u7e=Je(),l7e=ct(),d4=new a7e("datastore_spec");CV.exports=t=>({exists(){return t.has(d4)},async get(){let e=await t.get(d4);return JSON.parse(u7e(e))},async set(e){return t.put(d4,l7e(JSON.stringify(c7e(e,{deep:!0}))))}})});var qV=p((VTt,kV)=>{f();"use strict";var f7e=Ft().Key,h7e=ct(),p4=new f7e("api");kV.exports=t=>({async get(){let e=await t.get(p4);return e&&e.toString()},set(e){return t.put(p4,h7e(e.toString()))},delete(){return t.delete(p4)}})});var NV=p((HTt,BV)=>{f();BV.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var y4=p((GTt,MV)=>{f();var DV=NV();MV.exports=class{constructor(e){this.hwm=e||16,this.head=new DV(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new DV(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var za=p((WTt,LV)=>{f();var g4=y4();LV.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new g4,i,n,s,o=()=>{if(!r.isEmpty()){if(t.writev){let m,E=[];for(;!r.isEmpty();){if(m=r.shift(),m.error)throw m.error;E.push(m.value)}return{done:m.done,value:E}}let g=r.shift();if(g.error)throw g.error;return g}return s?{done:!0}:new Promise((g,m)=>{n=E=>(n=null,E.error?m(E.error):t.writev&&!E.done?g({done:E.done,value:[E.value]}):g(E),i)})},a=g=>n?n(g):(r.push(g),i),c=g=>(r=new g4,n?n({error:g}):(r.push({error:g}),i)),l=g=>s?i:a({done:!1,value:g}),u=g=>s?i:(s=!0,g?c(g):a({done:!0})),h=()=>(r=new g4,u(),{done:!0}),d=g=>(u(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:h,throw:d,push:l,end:u},!e)return i;let y=i;return i={[Symbol.asyncIterator](){return this},next(){return y.next()},throw(g){return y.throw(g),e&&(e(g),e=null),{done:!0}},return(){return y.return(),e&&(e(),e=null),{done:!0}},push:l,end(g){return y.end(g),e&&(e(g),e=null),i}},i}});var FV=p((YTt,UV)=>{f();"use strict";var d7e=ja(),p7e=za(),y7e=Ka(),{CID:g7e}=(Ae(),Ce),b7e=ae(),{identity:m7e}=(Pc(),Ea);UV.exports=v7e;function v7e(t){return{open(){return t.open()},close(){return t.close()},query(e,r){return t.query(e,r)},queryKeys(e,r){return t.queryKeys(e,r)},async get(e,r){let i=Ju(e);return i.isIdentity?Promise.resolve(i.digest):t.get(e,r)},async*getMany(e,r){for await(let i of e)yield this.get(i,r)},async put(e,r,i){let{isIdentity:n}=Ju(e);n||await t.put(e,r,i)},async*putMany(e,r){let i=p7e();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{await y7e(t.putMany(async function*(){for await(let{key:s,value:o}of e)Ju(s).isIdentity||(yield{key:s,value:o}),i.push({key:s,value:o})}())),i.end()}catch(s){i.end(s)}}),yield*i},has(e,r){let{isIdentity:i}=Ju(e);return i?Promise.resolve(!0):t.has(e,r)},delete(e,r){let{isIdentity:i}=Ju(e);return i?Promise.resolve():t.delete(e,r)},deleteMany(e,r){return t.deleteMany(d7e(e,i=>!Ju(i).isIdentity),r)},batch(){let e=t.batch();return{put(r,i){let{isIdentity:n}=Ju(r);n||e.put(r,i)},delete(r){let{isIdentity:i}=Ju(r);i||e.delete(r)},commit:r=>e.commit(r)}}}}function Ju(t){let e=g7e.asCID(t);if(e==null)throw b7e(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==m7e.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}});var e_=p(b4=>{f();"use strict";var w7e=Jw(),_7e=me(),KV=_7e("ipfs:repo:lock:memory"),jV="repo.lock",cb={};b4.lock=async t=>{let e=t+"/"+jV;if(KV("locking %s",e),cb[e]===!0)throw new w7e.LockExistsError(`Lock already being held for file: ${e}`);return cb[e]=!0,{async close(){cb[e]&&delete cb[e]}}};b4.locked=async t=>{let e=t+"/"+jV;return KV(`checking lock: ${e}`),Boolean(cb[e])}});var zV=p((QTt,VV)=>{f();"use strict";VV.exports={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:e_()}});var $V=p((ZTt,HV)=>{f();"use strict";HV.exports={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}}});var lp=p((JTt,GV)=>{f();"use strict";var E7e=async t=>{for await(let e of t)return e};GV.exports=E7e});var r_={};Gt(r_,{Block:()=>ub,create:()=>I7e,createUnsafe:()=>WV,decode:()=>A7e,encode:()=>x7e});var t_,m4,v4,S7e,ub,x7e,A7e,WV,I7e,i_=Ge(()=>{f();Bu();t_=({enumerable:t=!0,configurable:e=!1}={})=>({enumerable:t,configurable:e,writable:!1}),m4=function*(t,e){if(t!=null&&!(t instanceof Uint8Array))for(let[r,i]of Object.entries(t)){let n=[...e,r];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=rt.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*m4(o,a))}else{let s=rt.asCID(i);s?yield[n.join("/"),s]:yield*m4(i,n)}}},v4=function*(t,e){if(t!=null)for(let[r,i]of Object.entries(t)){let n=[...e,r];if(yield n.join("/"),i!=null&&!(i instanceof Uint8Array)&&typeof i=="object"&&!rt.asCID(i))if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s];yield a.join("/"),typeof o=="object"&&!rt.asCID(o)&&(yield*v4(o,a))}else yield*v4(i,n)}},S7e=(t,e)=>{let r=t;for(let[i,n]of e.entries()){if(r=r[n],r==null)throw new Error(`Object has no property at ${e.slice(0,i+1).map(o=>`[${JSON.stringify(o)}]`).join("")}`);let s=rt.asCID(r);if(s)return{value:s,remaining:e.slice(i+1).join("/")}}return{value:r}},ub=class{constructor({cid:e,bytes:r,value:i}){if(!e||!r||typeof i=="undefined")throw new Error("Missing required argument");this.cid=e,this.bytes=r,this.value=i,this.asBlock=this,Object.defineProperties(this,{cid:t_(),bytes:t_(),value:t_(),asBlock:t_()})}links(){return m4(this.value,[])}tree(){return v4(this.value,[])}get(e="/"){return S7e(this.value,e.split("/").filter(Boolean))}},x7e=async({value:t,codec:e,hasher:r})=>{if(typeof t=="undefined")throw new Error('Missing required argument "value"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");let i=e.encode(t),n=await r.digest(i),s=rt.create(1,e.code,n);return new ub({value:t,bytes:i,cid:s})},A7e=async({bytes:t,codec:e,hasher:r})=>{if(!t)throw new Error('Missing required argument "bytes"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");let i=e.decode(t),n=await r.digest(t),s=rt.create(1,e.code,n);return new ub({value:i,bytes:t,cid:s})},WV=({bytes:t,cid:e,value:r,codec:i})=>{let n=r!==void 0?r:i&&i.decode(t);if(n===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new ub({cid:e,bytes:t,value:n})},I7e=async({bytes:t,cid:e,hasher:r,codec:i})=>{if(!t)throw new Error('Missing required argument "bytes"');if(!r)throw new Error('Missing required argument "hasher"');let n=i.decode(t),s=await r.digest(t);if(!tf.equals(e.multihash.bytes,s.bytes))throw new Error("CID hash does not match bytes");return WV({bytes:t,cid:e,value:n,codec:i})}});var w4=p((tRt,ZV)=>{f();"use strict";var{Key:T7e}=Ft(),{CID:YV}=(Bu(),dd),R7e=(Rs(),ns),P7e=ae(),{base32:XV}=(an(),on),C7e=(An(),xn);function O7e(t){let e=YV.asCID(t);if(e==null)throw P7e(new Error("Not a valid cid"),"ERR_INVALID_CID");let r=XV.encode(e.multihash.bytes);return new T7e("/"+r.slice(1).toUpperCase(),!1)}function k7e(t){return YV.createV1(R7e.code,QV(t))}function QV(t){return C7e.decode(XV.decode(`b${t.toString().toLowerCase().substring(1)}`))}ZV.exports={cidToKey:O7e,keyToCid:k7e,keyToMultihash:QV}});var _4=p((rRt,ez)=>{f();"use strict";var q7e=me()("ipfs:repo:utils:walk-dag"),B7e=(i_(),r_);async function*JV(t,e,r,i){try{let n=await e.get(t,i),s=await r(t.code),o=B7e.createUnsafe({bytes:n,cid:t,codec:s});for(let[,a]of o.links())yield a,yield*JV(a,e,r,i)}catch(n){throw q7e("Could not walk DAG for CID",t.toString(),n),n}}ez.exports=JV});var E4=p((iRt,oz)=>{f();"use strict";var{CID:tz}=(Ae(),Ce),N7e=ae(),D7e=me(),rz=lp(),M7e=(i_(),r_),el=(Kg(),Kw),n_=(At(),xt),{cidToKey:s_,keyToMultihash:iz}=w4(),nz=_4();function L7e(t){let e=`Invalid type '${t}', must be one of {direct, indirect, recursive, all}`;return N7e(new Error(e),"ERR_INVALID_PIN_TYPE")}var Us={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"},sz=class{constructor({pinstore:e,blockstore:r,loadCodec:i}){this.pinstore=e,this.blockstore=r,this.loadCodec=i,this.log=D7e("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,r={}){await this.blockstore.get(e,r);let i={depth:0};return e.version!==0&&(i.version=e.version),e.code!==n_.code&&(i.codec=e.code),r.metadata&&(i.metadata=r.metadata),this.pinstore.put(s_(e),el.encode(i))}unpin(e,r){return this.pinstore.delete(s_(e),r)}async pinRecursively(e,r={}){await this.fetchCompleteDag(e,r);let i={depth:1/0};e.version!==0&&(i.version=e.version),e.code!==n_.code&&(i.codec=e.code),r.metadata&&(i.metadata=r.metadata),await this.pinstore.put(s_(e),el.encode(i))}async*directKeys(e){for await(let r of this.pinstore.query({filters:[i=>el.decode(i.value).depth===0]})){let i=el.decode(r.value),n=i.version||0,s=i.codec!=null?i.codec:n_.code,o=iz(r.key);yield{cid:tz.create(n,s,o),metadata:i.metadata}}}async*recursiveKeys(e){for await(let r of this.pinstore.query({filters:[i=>el.decode(i.value).depth===1/0]})){let i=el.decode(r.value),n=i.version||0,s=i.codec!=null?i.codec:n_.code,o=iz(r.key);yield{cid:tz.create(n,s,o),metadata:i.metadata}}}async*indirectKeys(e){for await(let{cid:r}of this.recursiveKeys())for await(let i of nz(r,this.blockstore,this.loadCodec,e)){let n=[Us.recursive];(await this.isPinnedWithType(i,n)).pinned||(yield i)}}async isPinnedWithType(e,r,i){Array.isArray(r)||(r=[r]);let n=r.includes(Us.all),s=r.includes(Us.direct),o=r.includes(Us.recursive),a=r.includes(Us.indirect);if(o||s||n){let u=await rz(this.pinstore.query({prefix:s_(e).toString(),filters:[h=>{if(n)return!0;let d=el.decode(h.value);return r.includes(d.depth===0?Us.direct:Us.recursive)}],limit:1}));if(u){let h=el.decode(u.value);return{cid:e,pinned:!0,reason:h.depth===0?Us.direct:Us.recursive,metadata:h.metadata}}}let c=this;async function*l(u,h){for await(let{cid:d}of h)for await(let y of nz(d,c.blockstore,c.loadCodec))if(y.equals(u)){yield d;return}}if(n||a){let u=await rz(l(e,this.recursiveKeys()));if(u)return{cid:e,pinned:!0,reason:Us.indirect,parent:u}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,r){let i=new Set,n=async(s,o)=>{if(i.has(s.toString()))return;i.add(s.toString());let a=await this.blockstore.get(s,o),c=await this.loadCodec(s.code),l=M7e.createUnsafe({bytes:a,cid:s,codec:c});await Promise.all([...l.links()].map(([,u])=>n(u,o)))};await n(e,r)}static checkPinType(e){if(typeof e!="string"||!Object.keys(Us).includes(e))throw L7e(e);return!0}};oz.exports={PinManager:sz,PinTypes:Us}});var ko=p((nRt,az)=>{f();"use strict";var U7e=async function*(t,e){for await(let r of t)yield e(r)};az.exports=U7e});var lz=p((sRt,uz)=>{f();"use strict";var F7e=ko(),K7e=ae(),{PinTypes:j7e}=E4();uz.exports=V7e;function V7e(t,e){return{open(){return e.open()},close(){return e.close()},query(r,i){return e.query(r,i)},queryKeys(r,i){return e.queryKeys(r,i)},async get(r,i){return e.get(r,i)},async*getMany(r,i){yield*e.getMany(r,i)},async put(r,i,n){await e.put(r,i,n)},async*putMany(r,i){yield*e.putMany(r,i)},has(r,i){return e.has(r,i)},async delete(r,i){return await cz(r,t),e.delete(r,i)},deleteMany(r,i){return e.deleteMany(F7e(r,async n=>(await cz(n,t),n)),i)},batch(){return e.batch()}}}async function cz(t,e){let{pinned:r,reason:i}=await e.isPinnedWithType(t,j7e.all);if(r)throw K7e(new Error(`pinned: ${i}`),"ERR_BLOCK_PINNED")}});var vr=p((oRt,S4)=>{f();"use strict";var fp=typeof Reflect=="object"?Reflect:null,fz=fp&&typeof fp.apply=="function"?fp.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},o_;fp&&typeof fp.ownKeys=="function"?o_=fp.ownKeys:Object.getOwnPropertySymbols?o_=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:o_=function(e){return Object.getOwnPropertyNames(e)};function z7e(t){console&&console.warn&&console.warn(t)}var hz=Number.isNaN||function(e){return e!==e};function $t(){$t.init.call(this)}S4.exports=$t;S4.exports.once=W7e;$t.EventEmitter=$t;$t.prototype._events=void 0;$t.prototype._eventsCount=0;$t.prototype._maxListeners=void 0;var dz=10;function a_(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty($t,"defaultMaxListeners",{enumerable:!0,get:function(){return dz},set:function(t){if(typeof t!="number"||t<0||hz(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");dz=t}});$t.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};$t.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||hz(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function pz(t){return t._maxListeners===void 0?$t.defaultMaxListeners:t._maxListeners}$t.prototype.getMaxListeners=function(){return pz(this)};$t.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")fz(c,this,r);else for(var l=c.length,u=vz(c,l),i=0;i<l;++i)fz(u[i],this,r);return!0};function yz(t,e,r,i){var n,s,o;if(a_(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=pz(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,z7e(a)}return t}$t.prototype.addListener=function(e,r){return yz(this,e,r,!1)};$t.prototype.on=$t.prototype.addListener;$t.prototype.prependListener=function(e,r){return yz(this,e,r,!0)};function H7e(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function gz(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=H7e.bind(i);return n.listener=r,i.wrapFn=n,n}$t.prototype.once=function(e,r){return a_(r),this.on(e,gz(this,e,r)),this};$t.prototype.prependOnceListener=function(e,r){return a_(r),this.prependListener(e,gz(this,e,r)),this};$t.prototype.removeListener=function(e,r){var i,n,s,o,a;if(a_(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount==0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===r||i[o].listener===r){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():$7e(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};$t.prototype.off=$t.prototype.removeListener;$t.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function bz(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?G7e(n):vz(n,n.length)}$t.prototype.listeners=function(e){return bz(this,e,!0)};$t.prototype.rawListeners=function(e){return bz(this,e,!1)};$t.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):mz.call(t,e)};$t.prototype.listenerCount=mz;function mz(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}$t.prototype.eventNames=function(){return this._eventsCount>0?o_(this._events):[]};function vz(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function $7e(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function G7e(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function W7e(t,e){return new Promise(function(r,i){function n(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}wz(t,e,s,{once:!0}),e!=="error"&&Y7e(t,n,{once:!0})})}function Y7e(t,e,r){typeof t.on=="function"&&wz(t,"error",e,r)}function wz(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var x4=p((aRt,_z)=>{f();_z.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var Ez=p(()=>{f()});var kz=p((lRt,Oz)=>{f();var X7e=vr().EventEmitter,{nanoid:Q7e}=(Wg(),Gg),{WORKER_REQUEST_READ_LOCK:Sz,WORKER_RELEASE_READ_LOCK:xz,MASTER_GRANT_READ_LOCK:Az,WORKER_REQUEST_WRITE_LOCK:Iz,WORKER_RELEASE_WRITE_LOCK:Tz,MASTER_GRANT_WRITE_LOCK:Rz}=x4(),lb,Pz=(t,e,r,i,n)=>(s,o)=>{o&&o.type===r&&t.emit(e,o.name,()=>(s.send({type:n,name:o.name,identifier:o.identifier}),new Promise(a=>{let c=l=>{l&&l.type===i&&l.identifier===o.identifier&&(s.removeListener("message",c),a())};s.on("message",c)})))},Cz=(t,e,r,i)=>()=>{let n=Q7e();return process.send({type:e,identifier:n,name:t}),new Promise(s=>{let o=a=>{a&&a.type===r&&a.identifier===n&&(process.removeListener("message",o),s(()=>{process.send({type:i,identifier:n,name:t})}))};process.on("message",o)})};Oz.exports=t=>{try{if(lb=Ez(),!Object.keys(lb).length)return}catch(e){return}if(lb.isMaster||t.singleProcess){let e=new X7e;return lb.on("message",Pz(e,"requestReadLock",Sz,xz,Az)),lb.on("message",Pz(e,"requestWriteLock",Iz,Tz,Rz)),e}return{isWorker:!0,readLock:e=>Cz(e,Sz,Az,xz),writeLock:e=>Cz(e,Iz,Rz,Tz)}}});var A4=p((fRt,qz)=>{f();var tl={},hp=t=>{t.addEventListener("message",e=>{hp.dispatchEvent("message",t,e)}),t.port&&t.port.addEventListener("message",e=>{hp.dispatchEvent("message",t,e)})};hp.addEventListener=(t,e)=>{tl[t]||(tl[t]=[]),tl[t].push(e)};hp.removeEventListener=(t,e)=>{!tl[t]||(tl[t]=tl[t].filter(r=>r===e))};hp.dispatchEvent=function(){let t=Array.prototype.slice.call(arguments),e=t.shift();!tl[e]||tl[e].forEach(r=>r.apply(null,t))};qz.exports=hp});var zz=p((hRt,Vz)=>{f();var Z7e=vr().EventEmitter,{nanoid:J7e}=(Wg(),Gg),{WORKER_REQUEST_READ_LOCK:Bz,WORKER_RELEASE_READ_LOCK:Nz,MASTER_GRANT_READ_LOCK:Dz,WORKER_REQUEST_WRITE_LOCK:Mz,WORKER_RELEASE_WRITE_LOCK:Lz,MASTER_GRANT_WRITE_LOCK:Uz}=x4(),Fz=A4(),Kz=(t,e,r,i,n)=>(s,o)=>{if(!o||!o.data||o.data.type!==r)return;let a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};t.emit(e,a.name,()=>(s.postMessage({type:n,name:a.name,identifier:a.identifier}),new Promise(c=>{let l=u=>{if(!u||!u.data)return;let h={type:u.data.type,name:u.data.name,identifier:u.data.identifier};h&&h.type===i&&h.identifier===a.identifier&&(s.removeEventListener("message",l),c())};s.addEventListener("message",l)})))},jz=(t,e,r,i)=>()=>{let n=J7e();return globalThis.postMessage({type:e,identifier:n,name:t}),new Promise(s=>{let o=a=>{if(!a||!a.data)return;let c={type:a.data.type,identifier:a.data.identifier};c&&c.type===r&&c.identifier===n&&(globalThis.removeEventListener("message",o),s(()=>{globalThis.postMessage({type:i,identifier:n,name:t})}))};globalThis.addEventListener("message",o)})},eMe={singleProcess:!1};Vz.exports=t=>{if(t=Object.assign({},eMe,t),!!globalThis.document||t.singleProcess){let r=new Z7e;return Fz.addEventListener("message",Kz(r,"requestReadLock",Bz,Nz,Dz)),Fz.addEventListener("message",Kz(r,"requestWriteLock",Mz,Lz,Uz)),r}return{isWorker:!0,readLock:r=>jz(r,Bz,Dz,Nz),writeLock:r=>jz(r,Mz,Uz,Lz)}}});var Hz=p((pRt,I4)=>{f();"use strict";var c_,dRt=I4.exports.timeout=function(t,e){var r=new c_,i;return Promise.race([t,new Promise(function(n,s){i=setTimeout(function(){s(r)},e)})]).then(function(n){return clearTimeout(i),n},function(n){throw clearTimeout(i),n})};c_=I4.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};c_.prototype=Object.create(Error.prototype);c_.prototype.name="TimeoutError"});var P4=p((yRt,R4)=>{f();var tMe=kz(),rMe=zz(),{default:$z}=Kc(),{timeout:iMe}=Hz(),nMe=A4(),Cf={},rl;function T4(t,e){let r,i=new Promise(n=>{r=n});return t.add(()=>iMe((()=>new Promise(n=>{r(()=>{n()})}))(),e.timeout)),i}var sMe=(t,e)=>{if(rl.isWorker)return{readLock:rl.readLock(t,e),writeLock:rl.writeLock(t,e)};let r=new $z({concurrency:1}),i=null;return{readLock:()=>{if(i)return T4(i,e);i=new $z({concurrency:e.concurrency,autoStart:!1});let n=i,s=T4(i,e);return r.add(()=>(n.start(),n.onIdle().then(()=>{i===n&&(i=null)}))),s},writeLock:()=>(i=null,T4(r,e))}},oMe={concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};R4.exports=(t,e)=>(e||(e={}),typeof t=="object"&&(e=t,t="lock"),t||(t="lock"),e=Object.assign({},oMe,e),rl||(rl=tMe(e)||rMe(e),rl.isWorker||(rl.on("requestReadLock",(r,i)=>{!Cf[r]||Cf[r].readLock().then(n=>i().finally(()=>n()))}),rl.on("requestWriteLock",async(r,i)=>{!Cf[r]||Cf[r].writeLock().then(n=>i().finally(()=>n()))}))),Cf[t]||(Cf[t]=sMe(t,e)),Cf[t]);R4.exports.Worker=function(t,e){e=e||globalThis.Worker;let r;try{r=new e(t)}catch(i){i.message.includes("not a constructor")&&(r=e(t))}if(!r)throw new Error("Could not create Worker from",e);return nMe(r),r}});var u_=p((gRt,Gz)=>{f();"use strict";async function*aMe(t,e=1){let r=[];e<1&&(e=1);for await(let i of t)for(r.push(i);r.length>=e;)yield r.slice(0,e),r=r.slice(e);for(;r.length;)yield r.slice(0,e),r=r.slice(e)}Gz.exports=aMe});var l_=p((bRt,Wz)=>{f();"use strict";var cMe=u_();async function*uMe(t,e=1){for await(let r of cMe(t,e)){let i=r.map(n=>n().then(s=>({ok:!0,value:s}),s=>({ok:!1,err:s})));for(let n=0;n<i.length;n++){let s=await i[n];if(s.ok)yield s.value;else throw s.err}}}Wz.exports=uMe});var Pr=p((mRt,dp)=>{f();var Yz=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},C4=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),f_=t=>t&&typeof t.sink=="function"&&C4(t.source),lMe=t=>e=>(t.sink(e),t.source),Xz=(...t)=>{if(f_(t[0])){let e=t[0];t[0]=()=>e.source}else if(C4(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&f_(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)f_(t[e])&&(t[e]=lMe(t[e]));return Yz(...t)};dp.exports=Xz;dp.exports.pipe=Xz;dp.exports.rawPipe=Yz;dp.exports.isIterable=C4;dp.exports.isDuplex=f_});var pp=p((vRt,Qz)=>{f();"use strict";var fMe=za(),hMe=async function*(...t){let e=fMe();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let i of r)e.push(i)})),e.end()}catch(r){e.end(r)}},0),yield*e};Qz.exports=hMe});var tH=p((wRt,eH)=>{f();"use strict";var{CID:dMe}=(Ae(),Ce),fb=me()("ipfs:repo:gc"),{Errors:pMe}=Ft(),yMe=pMe.notFoundError().code,gMe=l_(),{pipe:bMe}=Pr(),Zz=pp(),O4=ko(),mMe=ja(),{Key:vMe}=Ft(),{base32:Jz}=(an(),on),wMe=_4(),_Me=256,EMe=new vMe("/local/filesroot");eH.exports=({gcLock:t,pins:e,blockstore:r,root:i,loadCodec:n})=>{async function*s(){let o=Date.now();fb("Creating set of marked blocks");let a=await t.writeLock();try{let c=await SMe({pins:e,blockstore:r,root:i,loadCodec:n}),l=r.queryKeys({});yield*xMe({blockstore:r},c,l),fb(`Complete (${Date.now()-o}ms)`)}finally{a()}}return s};async function SMe({pins:t,blockstore:e,loadCodec:r,root:i}){let n=async function*(){let a;try{a=await i.get(EMe)}catch(l){if(l.code===yMe){fb("No blocks in MFS");return}throw l}let c=dMe.decode(a);yield c,yield*wMe(c,e,r)}(),s=Zz(O4(t.recursiveKeys(),({cid:a})=>a),t.indirectKeys(),O4(t.directKeys(),({cid:a})=>a),n),o=new Set;for await(let a of Zz(s,n))o.add(Jz.encode(a.multihash.bytes));return o}async function*xMe({blockstore:t},e,r){let i=0,n=0;yield*bMe(gMe(O4(r,async o=>async function(){i++;try{let c=Jz.encode(o.multihash.bytes);if(e.has(c))return null;try{await t.delete(o),n++}catch(l){return{err:new Error(`Could not delete block with CID ${o}: ${l.message}`)}}return{cid:o}}catch(c){let l=`Could delete block with CID ${o}`;return fb(l,c),{err:new Error(l+`: ${c.message}`)}}}),_Me),o=>mMe(o,Boolean)),fb(`Marked set has ${e.size} unique blocks. Blockstore has ${i} blocks. Deleted ${n} blocks.`)}});var Of=p((_Rt,aH)=>{f();"use strict";var rH=VI(),AMe=me(),yp=ae(),iH=dV(),IMe=gV(),TMe=wr(),h_=mV(),RMe=wV(),PMe=AV(),CMe=OV(),OMe=qV(),kMe=FV(),qMe=zV(),nH=$V(),jc=Jw(),{PinManager:BMe,PinTypes:NMe}=E4(),DMe=lz(),MMe=P4(),LMe=tH(),UMe=e_(),FMe=e_(),Gn=AMe("ipfs:repo"),KMe=Number.MAX_SAFE_INTEGER,jMe="repoAutoMigrate",sH=class{constructor(e,r,i,n){if(typeof e!="string")throw new Error("missing repo path");if(typeof r!="function")throw new Error("missing codec loader");this.options=TMe(qMe,n),this.closed=!0,this.path=e,this.root=i.root,this.datastore=i.datastore,this.keys=i.keys;let s=i.blocks,o=i.pins;this.pins=new BMe({pinstore:o,blockstore:s,loadCodec:r});let a=DMe(this.pins,s);this.blocks=kMe(a),this.version=RMe(this.root),this.config=PMe(this.root),this.spec=CMe(this.root),this.apiAddr=OMe(this.root),this.gcLock=MMe(e,{singleProcess:this.options.repoOwner!==!1}),this.gc=LMe({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:r})}async init(e){Gn("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(zMe(e)),await this.spec.set(HMe(e)),await this.version.set(h_.repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(e){return!1}}async open(){if(!this.closed)throw yp(new Error("repo is already open"),jc.ERR_REPO_ALREADY_OPEN);Gn("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),Gn("acquired repo.lock"),!await this.version.check(h_.repoVersion))if(await this._isAutoMigrationEnabled())await this._migrate(h_.repoVersion,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new jc.InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");Gn("creating datastore"),await this.datastore.open(),Gn("creating blocks"),this.blocks.open(),Gn("creating keystore"),await this.keys.open(),Gn("creating pins"),await this.pins.pinstore.open(),this.closed=!1,Gn("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(r){Gn("error removing lock",r)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw yp(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){Gn("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(r){throw r.code==="ERR_NOT_FOUND"?yp(new Error("repo is not initialized yet"),jc.ERR_REPO_NOT_INITIALIZED,{path:this.path}):r}if(!e)throw yp(new Error("repo is not initialized yet"),jc.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw yp(new Error("repo is already closed"),jc.ERR_REPO_ALREADY_CLOSED);Gn("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==jc.ERR_REPO_NOT_INITIALIZED&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),Gn("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,r,i,n,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),oH(this.datastore),oH(this.keys)]),o=r.size+n+s;return{repoPath:this.path,storageMax:e,version:i,numObjects:r.count,repoSize:o}}throw yp(new Error("repo is not initialized yet"),jc.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(jMe)}catch(r){if(r.code===jc.NotFoundError.code)e=!0;else throw r}return e}async _migrate(e,r){return await this.version.get()>e?(Gn(`reverting to version ${e}`),iH.revert(this.path,r,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(Gn(`migrating to version ${e}`),iH.migrate(this.path,r,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt(IMe(e))}catch(e){return BigInt(KMe)}}async _blockStat(){let e=BigInt(0),r=BigInt(0);if(this.blocks)for await(let{key:i,value:n}of this.blocks.query({}))e+=BigInt(1),r+=BigInt(n.byteLength),r+=BigInt(i.bytes.byteLength);return{count:e,size:r}}};async function oH(t){let e=BigInt(0);for await(let r of t.query({}))e+=BigInt(r.value.byteLength),e+=BigInt(r.key.uint8Array().byteLength);return e}function VMe(t,e,r,i){return new sH(t,e,r,i)}aH.exports={createRepo:VMe,repoVersion:h_.repoVersion,errors:jc,utils:{blockstore:w4()},locks:{memory:UMe,fs:FMe},PinTypes:NMe};function zMe(t){return t.Datastore=Object.assign({},nH,rH(t,"datastore")),t}function HMe(t){let e={...nH.Spec,...rH(t,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(r=>({mountpoint:r.mountpoint,type:r.child.type,path:r.child.path,shardFunc:r.child.shardFunc}))}}});var lH=p((ERt,uH)=>{f();"use strict";var{resolvePath:$Me}=zi(),GMe=Oe(),{normaliseInput:WMe}=op(),{PinTypes:cH}=Of();uH.exports=({repo:t,codecs:e})=>{async function*r(i,n={}){let s=async function*(){for await(let{path:c,recursive:l,metadata:u}of WMe(i)){let{cid:h}=await $Me(t,e,c),{reason:d}=await t.pins.isPinnedWithType(h,[cH.recursive,cH.direct]);if(d==="recursive"&&!l)throw new Error(`${h} already pinned recursively`);l?await t.pins.pinRecursively(h,{metadata:u}):await t.pins.pinDirectly(h,{metadata:u}),yield h}};if(!Boolean(n.lock)){yield*s();return}let a=await t.gcLock.readLock();try{yield*s()}finally{a()}}return GMe(r)}});var dH=p((SRt,hH)=>{f();"use strict";var{PinTypes:Wn}=Of(),{normaliseInput:YMe}=op(),{resolvePath:XMe}=zi(),QMe=Oe(),fH=ae();function hb(t,e,r){let i={type:t,cid:e};return r&&(i.metadata=r),i}hH.exports=({repo:t,codecs:e})=>{async function*r(i={}){let n=Wn.all;if(i.type&&(n=i.type,!Object.keys(Wn).includes(n)))throw fH(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(i.paths){let s=!1;for await(let{path:o}of YMe(i.paths)){let{cid:a}=await XMe(t,e,o),{reason:c,pinned:l,parent:u,metadata:h}=await t.pins.isPinnedWithType(a,n);if(!l)throw fH(new Error(`path '${o}' is not pinned`),"ERR_NOT_PINNED");switch(c){case Wn.direct:case Wn.recursive:s=!0,yield hb(c,a,h);break;default:s=!0,yield hb(`${Wn.indirect} through ${u}`,a,h)}}if(!s)throw new Error("No match found");return}if(n===Wn.recursive||n===Wn.all)for await(let{cid:s,metadata:o}of t.pins.recursiveKeys())yield hb(Wn.recursive,s,o);if(n===Wn.indirect||n===Wn.all)for await(let s of t.pins.indirectKeys(i))yield hb(Wn.indirect,s);if(n===Wn.direct||n===Wn.all)for await(let{cid:s,metadata:o}of t.pins.directKeys())yield hb(Wn.direct,s,o)}return QMe(r)}});var yH=p((xRt,pH)=>{f();"use strict";var ZMe=$n();pH.exports=({rmAll:t})=>(e,r={})=>ZMe(t([{path:e,...r}],r))});var bH=p((ARt,gH)=>{f();"use strict";var{normaliseInput:JMe}=op(),{resolvePath:eLe}=zi(),tLe=Oe(),{PinTypes:k4}=Of();gH.exports=({repo:t,codecs:e})=>{async function*r(i,n={}){let s=await t.gcLock.readLock();try{for await(let{path:o,recursive:a}of JMe(i)){let{cid:c}=await eLe(t,e,o),{pinned:l,reason:u}=await t.pins.isPinnedWithType(c,k4.all);if(!l)throw new Error(`${c} is not pinned`);switch(u){case k4.recursive:if(!a)throw new Error(`${c} is pinned recursively`);await t.pins.unpin(c),yield c;break;case k4.direct:await t.pins.unpin(c),yield c;break;default:throw new Error(`${c} is pinned indirectly under ${u}`)}}}finally{s()}}return tLe(r)}});var wH=p((IRt,vH)=>{f();"use strict";var rLe=yj(),iLe=lH(),nLe=dH(),sLe=yH(),oLe=bH(),mH=class{constructor({codecs:e,repo:r}){let i=iLe({codecs:e,repo:r});this.addAll=i,this.add=rLe({addAll:i});let n=oLe({codecs:e,repo:r});this.rmAll=n,this.rm=sLe({rmAll:n}),this.ls=nLe({codecs:e,repo:r}),this.remote={add:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:async function*(s,o={}){return Promise.reject(new Error("Not implemented"))},rm:(s,o={})=>Promise.reject(new Error("Not implemented")),rmAll:(s,o={})=>Promise.reject(new Error("Not implemented")),service:{add:(s,o)=>Promise.reject(new Error("Not implemented")),rm:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:(s={})=>Promise.reject(new Error("Not implemented"))}}}};vH.exports=mH});var _H=p((RRt,q4)=>{f();var TRt=function(){typeof q4!="undefined"&&(q4.exports=v);var t=24*3600,e=3200,r=(365*400+97)*e/400,i=t*r,n=i*1e3,s=1e3*1e4*1e4*t,o=16777216,a=65536*65536,c=1e3*1e3,l=1e3*1e3*1e3,u="000000000",h=Math.trunc||M,d=v.prototype;v.fromDate=Y,v.fromInt64BE=W(0,1,2,3,0,4),v.fromInt64LE=W(3,2,1,0,4,0),v.fromString=G,v.fromTimeT=P,d.year=0,d.time=0,d.nano=0,d.addNano=B,d.getNano=z,d.getTimeT=w,d.getYear=A,d.toDate=F,d.toJSON=S,d.toString=C,d.writeInt64BE=D(0,1,2,3,0,4),d.writeInt64LE=D(3,2,1,0,4,0);var y="%Y-%m-%dT%H:%M:%S.%NZ",g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],E={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return v;function v(X,ne,oe){var de=this;if(!(de instanceof v))return new v(X,ne,oe);de.time=+X||0,de.nano=+ne||0,de.year=+oe||0,R(de)}function A(){var X=this.toDate().getUTCFullYear();return X+this.year}function R(X){var ne=X.year,oe=X.time,de=X.nano,pe,_e;if(de<0||c<=de){var k=Math.floor(de/c);de-=k*c,oe+=k,pe=1}var K=ne%e;if(oe<-s||s<oe||K){_e=h(oe/n),_e&&(ne+=_e*e,oe-=_e*n);var $=q(oe);$.setUTCFullYear(K+$.getUTCFullYear()),ne-=K,oe=+$,_e=h(ne/e);var Z=oe+_e*n;_e&&-s<=Z&&Z<=s&&(ne-=_e*e,oe=Z),pe=1}return pe&&(X.year=ne,X.time=oe,X.nano=de),X}function F(){var X=R(this);return q(X.time)}function q(X){var ne=new Date(0);return ne.setTime(X),ne}function B(X){return this.nano+=+X||0,this}function z(){var X=R(this);return(X.time%1e3*c+ +X.nano+l)%l}function G(X){var ne,oe=new v;X+="";var de=X.replace(/^\s*[+\-]?\d+/,function(pe){var _e=+pe,k=1970+(_e-1970)%400;return oe.year=_e-k,k}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(pe,_e,k){return _e<0&&(k*=-1),ne=(+_e*60+ +k)*6e4,""}).replace(/\.\d+$/,function(pe){return oe.nano=+(pe+u).substr(1,9),""}).split(/\D+/);if(de.length>1?de[1]--:de[1]=0,oe.time=ne=Date.UTC.apply(Date,de)-(ne||0),isNaN(ne))throw new TypeError("Invalid Date");return R(oe)}function Y(X){return new v(+X)}function P(X){return b(X,0)}function b(X,ne){ne|=0,ne*=a,X=+X||0;var oe=h(ne/i)+h(X/i),de=ne%i+X%i,pe=h(de/i);return pe&&(oe+=pe,de-=pe*i),new v(de*1e3,0,oe*e)}function w(){var X=R(this),ne=Math.floor(X.time/1e3),oe=X.year;return oe&&(ne+=oe*r*t/e),ne}function S(){return this.toString().replace(/0{1,6}Z$/,"Z")}function C(X){var ne=this,oe=ne.toDate(),de={H:Z,L:V,M:I,N,S:U,Y:_e,a:Q,b:ee,d:K,e:$,m:k};return pe(X||y);function pe(J){return J.replace(/%./g,function(ue){var ge=ue[1],be=E[ge],Ke=de[ge];return be?pe(be):Ke?Ke():ue})}function _e(){var J=ne.getYear();return J>999999?"+"+J:J>9999?"+"+ce(J,6):J>=0?ce(J,4):J>=-999999?"-"+ce(-J,6):J}function k(){return L(oe.getUTCMonth()+1)}function K(){return L(oe.getUTCDate())}function $(){return _(oe.getUTCDate())}function Z(){return L(oe.getUTCHours())}function I(){return L(oe.getUTCMinutes())}function U(){return L(oe.getUTCSeconds())}function V(){return ce(oe.getUTCMilliseconds(),3)}function N(){return ce(ne.getNano(),9)}function Q(){return m[oe.getUTCDay()]}function ee(){return g[oe.getUTCMonth()]}}function D(X,ne,oe,de,pe,_e){return k;function k($,Z){var I=R(this);$||($=new Array(8)),j($,Z|=0);var U=Math.floor(I.time/1e3),V=I.year*(r*t/e),N=h(V/a)+h(U/a),Q=V%a+U%a,ee=Math.floor(Q/a);return ee&&(N+=ee,Q-=ee*a),K($,Z+pe,N),K($,Z+_e,Q),$}function K($,Z,I){$[Z+X]=I>>24&255,$[Z+ne]=I>>16&255,$[Z+oe]=I>>8&255,$[Z+de]=I&255}}function W(X,ne,oe,de,pe,_e){return k;function k($,Z){j($,Z|=0);var I=K($,Z+pe),U=K($,Z+_e);return b(U,I)}function K($,Z){return $[Z+X]*o+($[Z+ne]<<16|$[Z+oe]<<8|$[Z+de])}}function j(X,ne){var oe=X&&X.length;if(oe==null)throw new TypeError("Invalid Buffer");if(oe<ne+8)throw new RangeError("Out of range")}function M(X){var ne=X-X%1;return ne===0&&(X<0||X===0&&1/X!=1/0)?-0:ne}function _(X){return(X>9?"":" ")+(X|0)}function L(X){return(X>9?"":"0")+(X|0)}function ce(X,ne){return(u+(X|0)).substr(-ne)}}()});var kH=p((PRt,OH)=>{f();OH.exports=nr;var Fs=null;try{Fs=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function nr(t,e,r){this.low=t|0,this.high=e|0,this.unsigned=!!r}nr.prototype.__isLong__;Object.defineProperty(nr.prototype,"__isLong__",{value:!0});function Yn(t){return(t&&t.__isLong__)===!0}nr.isLong=Yn;var EH={},SH={};function kf(t,e){var r,i,n;return e?(t>>>=0,(n=0<=t&&t<256)&&(i=SH[t],i)?i:(r=sr(t,(t|0)<0?-1:0,!0),n&&(SH[t]=r),r)):(t|=0,(n=-128<=t&&t<128)&&(i=EH[t],i)?i:(r=sr(t,t<0?-1:0,!1),n&&(EH[t]=r),r))}nr.fromInt=kf;function Ks(t,e){if(isNaN(t))return e?qf:js;if(e){if(t<0)return qf;if(t>=AH)return CH}else{if(t<=-IH)return Xn;if(t+1>=IH)return PH}return t<0?Ks(-t,e).neg():sr(t%gp|0,t/gp|0,e)}nr.fromNumber=Ks;function sr(t,e,r){return new nr(t,e,r)}nr.fromBits=sr;var d_=Math.pow;function B4(t,e,r){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return js;if(typeof e=="number"?(r=e,e=!1):e=!!e,r=r||10,r<2||36<r)throw RangeError("radix");var i;if((i=t.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return B4(t.substring(1),e,r).neg();for(var n=Ks(d_(r,8)),s=js,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+a),r);if(a<8){var l=Ks(d_(r,a));s=s.mul(l).add(Ks(c))}else s=s.mul(n),s=s.add(Ks(c))}return s.unsigned=e,s}nr.fromString=B4;function qo(t,e){return typeof t=="number"?Ks(t,e):typeof t=="string"?B4(t,e):sr(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}nr.fromValue=qo;var xH=1<<16,aLe=1<<24,gp=xH*xH,AH=gp*gp,IH=AH/2,TH=kf(aLe),js=kf(0);nr.ZERO=js;var qf=kf(0,!0);nr.UZERO=qf;var bp=kf(1);nr.ONE=bp;var RH=kf(1,!0);nr.UONE=RH;var N4=kf(-1);nr.NEG_ONE=N4;var PH=sr(4294967295|0,2147483647|0,!1);nr.MAX_VALUE=PH;var CH=sr(4294967295|0,4294967295|0,!0);nr.MAX_UNSIGNED_VALUE=CH;var Xn=sr(0,2147483648|0,!1);nr.MIN_VALUE=Xn;var Re=nr.prototype;Re.toInt=function(){return this.unsigned?this.low>>>0:this.low};Re.toNumber=function(){return this.unsigned?(this.high>>>0)*gp+(this.low>>>0):this.high*gp+(this.low>>>0)};Re.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Xn)){var r=Ks(e),i=this.div(r),n=i.mul(r).sub(this);return i.toString(e)+n.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=Ks(d_(e,6),this.unsigned),o=this,a="";;){var c=o.div(s),l=o.sub(c.mul(s)).toInt()>>>0,u=l.toString(e);if(o=c,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};Re.getHighBits=function(){return this.high};Re.getHighBitsUnsigned=function(){return this.high>>>0};Re.getLowBits=function(){return this.low};Re.getLowBitsUnsigned=function(){return this.low>>>0};Re.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Xn)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,r=31;r>0&&(e&1<<r)==0;r--);return this.high!=0?r+33:r+1};Re.isZero=function(){return this.high===0&&this.low===0};Re.eqz=Re.isZero;Re.isNegative=function(){return!this.unsigned&&this.high<0};Re.isPositive=function(){return this.unsigned||this.high>=0};Re.isOdd=function(){return(this.low&1)==1};Re.isEven=function(){return(this.low&1)==0};Re.equals=function(e){return Yn(e)||(e=qo(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};Re.eq=Re.equals;Re.notEquals=function(e){return!this.eq(e)};Re.neq=Re.notEquals;Re.ne=Re.notEquals;Re.lessThan=function(e){return this.comp(e)<0};Re.lt=Re.lessThan;Re.lessThanOrEqual=function(e){return this.comp(e)<=0};Re.lte=Re.lessThanOrEqual;Re.le=Re.lessThanOrEqual;Re.greaterThan=function(e){return this.comp(e)>0};Re.gt=Re.greaterThan;Re.greaterThanOrEqual=function(e){return this.comp(e)>=0};Re.gte=Re.greaterThanOrEqual;Re.ge=Re.greaterThanOrEqual;Re.compare=function(e){if(Yn(e)||(e=qo(e)),this.eq(e))return 0;var r=this.isNegative(),i=e.isNegative();return r&&!i?-1:!r&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Re.comp=Re.compare;Re.negate=function(){return!this.unsigned&&this.eq(Xn)?Xn:this.not().add(bp)};Re.neg=Re.negate;Re.add=function(e){Yn(e)||(e=qo(e));var r=this.high>>>16,i=this.high&65535,n=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,l=e.low&65535,u=0,h=0,d=0,y=0;return y+=s+l,d+=y>>>16,y&=65535,d+=n+c,h+=d>>>16,d&=65535,h+=i+a,u+=h>>>16,h&=65535,u+=r+o,u&=65535,sr(d<<16|y,u<<16|h,this.unsigned)};Re.subtract=function(e){return Yn(e)||(e=qo(e)),this.add(e.neg())};Re.sub=Re.subtract;Re.multiply=function(e){if(this.isZero())return js;if(Yn(e)||(e=qo(e)),Fs){var r=Fs.mul(this.low,this.high,e.low,e.high);return sr(r,Fs.get_high(),this.unsigned)}if(e.isZero())return js;if(this.eq(Xn))return e.isOdd()?Xn:js;if(e.eq(Xn))return this.isOdd()?Xn:js;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TH)&&e.lt(TH))return Ks(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,n=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,l=e.low>>>16,u=e.low&65535,h=0,d=0,y=0,g=0;return g+=o*u,y+=g>>>16,g&=65535,y+=s*u,d+=y>>>16,y&=65535,y+=o*l,d+=y>>>16,y&=65535,d+=n*u,h+=d>>>16,d&=65535,d+=s*l,h+=d>>>16,d&=65535,d+=o*c,h+=d>>>16,d&=65535,h+=i*u+n*l+s*c+o*a,h&=65535,sr(y<<16|g,h<<16|d,this.unsigned)};Re.mul=Re.multiply;Re.divide=function(e){if(Yn(e)||(e=qo(e)),e.isZero())throw Error("division by zero");if(Fs){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var r=(this.unsigned?Fs.div_u:Fs.div_s)(this.low,this.high,e.low,e.high);return sr(r,Fs.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?qf:js;var i,n,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return qf;if(e.gt(this.shru(1)))return RH;s=qf}else{if(this.eq(Xn)){if(e.eq(bp)||e.eq(N4))return Xn;if(e.eq(Xn))return bp;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(js)?e.isNegative()?bp:N4:(n=this.sub(e.mul(i)),s=i.add(n.div(e)),s)}else if(e.eq(Xn))return this.unsigned?qf:js;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=js}for(n=this;n.gte(e);){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),c=a<=48?1:d_(2,a-48),l=Ks(i),u=l.mul(e);u.isNegative()||u.gt(n);)i-=c,l=Ks(i,this.unsigned),u=l.mul(e);l.isZero()&&(l=bp),s=s.add(l),n=n.sub(u)}return s};Re.div=Re.divide;Re.modulo=function(e){if(Yn(e)||(e=qo(e)),Fs){var r=(this.unsigned?Fs.rem_u:Fs.rem_s)(this.low,this.high,e.low,e.high);return sr(r,Fs.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Re.mod=Re.modulo;Re.rem=Re.modulo;Re.not=function(){return sr(~this.low,~this.high,this.unsigned)};Re.and=function(e){return Yn(e)||(e=qo(e)),sr(this.low&e.low,this.high&e.high,this.unsigned)};Re.or=function(e){return Yn(e)||(e=qo(e)),sr(this.low|e.low,this.high|e.high,this.unsigned)};Re.xor=function(e){return Yn(e)||(e=qo(e)),sr(this.low^e.low,this.high^e.high,this.unsigned)};Re.shiftLeft=function(e){return Yn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?sr(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):sr(0,this.low<<e-32,this.unsigned)};Re.shl=Re.shiftLeft;Re.shiftRight=function(e){return Yn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?sr(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):sr(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Re.shr=Re.shiftRight;Re.shiftRightUnsigned=function(e){if(Yn(e)&&(e=e.toInt()),e&=63,e===0)return this;var r=this.high;if(e<32){var i=this.low;return sr(i>>>e|r<<32-e,r>>>e,this.unsigned)}else return e===32?sr(r,0,this.unsigned):sr(r>>>e-32,0,this.unsigned)};Re.shru=Re.shiftRightUnsigned;Re.shr_u=Re.shiftRightUnsigned;Re.toSigned=function(){return this.unsigned?sr(this.low,this.high,!1):this};Re.toUnsigned=function(){return this.unsigned?this:sr(this.low,this.high,!0)};Re.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Re.toBytesLE=function(){var e=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Re.toBytesBE=function(){var e=this.high,r=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,r>>>24,r>>>16&255,r>>>8&255,r&255]};nr.fromBytes=function(e,r,i){return i?nr.fromBytesLE(e,r):nr.fromBytesBE(e,r)};nr.fromBytesLE=function(e,r){return new nr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,r)};nr.fromBytesBE=function(e,r){return new nr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],r)}});var NH=p((CRt,BH)=>{f();"use strict";var mp=Bi(),qH=mp.Reader,cLe=mp.Writer,We=mp.util,vp=mp.roots["ipfs-ipns"]||(mp.roots["ipfs-ipns"]={});vp.IpnsEntry=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.value=We.newBuffer([]),t.prototype.signature=We.newBuffer([]),t.prototype.validityType=0,t.prototype.validity=We.newBuffer([]),t.prototype.sequence=We.Long?We.Long.fromBits(0,0,!0):0,t.prototype.ttl=We.Long?We.Long.fromBits(0,0,!0):0,t.prototype.pubKey=We.newBuffer([]),t.prototype.signatureV2=We.newBuffer([]),t.prototype.data=We.newBuffer([]),t.encode=function(r,i){return i||(i=cLe.create()),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&i.uint32(10).bytes(r.value),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&i.uint32(18).bytes(r.signature),r.validityType!=null&&Object.hasOwnProperty.call(r,"validityType")&&i.uint32(24).int32(r.validityType),r.validity!=null&&Object.hasOwnProperty.call(r,"validity")&&i.uint32(34).bytes(r.validity),r.sequence!=null&&Object.hasOwnProperty.call(r,"sequence")&&i.uint32(40).uint64(r.sequence),r.ttl!=null&&Object.hasOwnProperty.call(r,"ttl")&&i.uint32(48).uint64(r.ttl),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&i.uint32(58).bytes(r.pubKey),r.signatureV2!=null&&Object.hasOwnProperty.call(r,"signatureV2")&&i.uint32(66).bytes(r.signatureV2),r.data!=null&&Object.hasOwnProperty.call(r,"data")&&i.uint32(74).bytes(r.data),i},t.decode=function(r,i){r instanceof qH||(r=qH.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new vp.IpnsEntry;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.value=r.bytes();break;case 2:s.signature=r.bytes();break;case 3:s.validityType=r.int32();break;case 4:s.validity=r.bytes();break;case 5:s.sequence=r.uint64();break;case 6:s.ttl=r.uint64();break;case 7:s.pubKey=r.bytes();break;case 8:s.signatureV2=r.bytes();break;case 9:s.data=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof vp.IpnsEntry)return r;var i=new vp.IpnsEntry;switch(r.value!=null&&(typeof r.value=="string"?We.base64.decode(r.value,i.value=We.newBuffer(We.base64.length(r.value)),0):r.value.length&&(i.value=r.value)),r.signature!=null&&(typeof r.signature=="string"?We.base64.decode(r.signature,i.signature=We.newBuffer(We.base64.length(r.signature)),0):r.signature.length&&(i.signature=r.signature)),r.validityType){case"EOL":case 0:i.validityType=0;break}return r.validity!=null&&(typeof r.validity=="string"?We.base64.decode(r.validity,i.validity=We.newBuffer(We.base64.length(r.validity)),0):r.validity.length&&(i.validity=r.validity)),r.sequence!=null&&(We.Long?(i.sequence=We.Long.fromValue(r.sequence)).unsigned=!0:typeof r.sequence=="string"?i.sequence=parseInt(r.sequence,10):typeof r.sequence=="number"?i.sequence=r.sequence:typeof r.sequence=="object"&&(i.sequence=new We.LongBits(r.sequence.low>>>0,r.sequence.high>>>0).toNumber(!0))),r.ttl!=null&&(We.Long?(i.ttl=We.Long.fromValue(r.ttl)).unsigned=!0:typeof r.ttl=="string"?i.ttl=parseInt(r.ttl,10):typeof r.ttl=="number"?i.ttl=r.ttl:typeof r.ttl=="object"&&(i.ttl=new We.LongBits(r.ttl.low>>>0,r.ttl.high>>>0).toNumber(!0))),r.pubKey!=null&&(typeof r.pubKey=="string"?We.base64.decode(r.pubKey,i.pubKey=We.newBuffer(We.base64.length(r.pubKey)),0):r.pubKey.length&&(i.pubKey=r.pubKey)),r.signatureV2!=null&&(typeof r.signatureV2=="string"?We.base64.decode(r.signatureV2,i.signatureV2=We.newBuffer(We.base64.length(r.signatureV2)),0):r.signatureV2.length&&(i.signatureV2=r.signatureV2)),r.data!=null&&(typeof r.data=="string"?We.base64.decode(r.data,i.data=We.newBuffer(We.base64.length(r.data)),0):r.data.length&&(i.data=r.data)),i},t.toObject=function(r,i){i||(i={});var n={};if(i.defaults){if(i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=We.newBuffer(n.value))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=We.newBuffer(n.signature))),n.validityType=i.enums===String?"EOL":0,i.bytes===String?n.validity="":(n.validity=[],i.bytes!==Array&&(n.validity=We.newBuffer(n.validity))),We.Long){var s=new We.Long(0,0,!0);n.sequence=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.sequence=i.longs===String?"0":0;if(We.Long){var s=new We.Long(0,0,!0);n.ttl=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.ttl=i.longs===String?"0":0;i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=We.newBuffer(n.pubKey))),i.bytes===String?n.signatureV2="":(n.signatureV2=[],i.bytes!==Array&&(n.signatureV2=We.newBuffer(n.signatureV2))),i.bytes===String?n.data="":(n.data=[],i.bytes!==Array&&(n.data=We.newBuffer(n.data)))}return r.value!=null&&r.hasOwnProperty("value")&&(n.value=i.bytes===String?We.base64.encode(r.value,0,r.value.length):i.bytes===Array?Array.prototype.slice.call(r.value):r.value),r.signature!=null&&r.hasOwnProperty("signature")&&(n.signature=i.bytes===String?We.base64.encode(r.signature,0,r.signature.length):i.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),r.validityType!=null&&r.hasOwnProperty("validityType")&&(n.validityType=i.enums===String?vp.IpnsEntry.ValidityType[r.validityType]:r.validityType),r.validity!=null&&r.hasOwnProperty("validity")&&(n.validity=i.bytes===String?We.base64.encode(r.validity,0,r.validity.length):i.bytes===Array?Array.prototype.slice.call(r.validity):r.validity),r.sequence!=null&&r.hasOwnProperty("sequence")&&(typeof r.sequence=="number"?n.sequence=i.longs===String?String(r.sequence):r.sequence:n.sequence=i.longs===String?We.Long.prototype.toString.call(r.sequence):i.longs===Number?new We.LongBits(r.sequence.low>>>0,r.sequence.high>>>0).toNumber(!0):r.sequence),r.ttl!=null&&r.hasOwnProperty("ttl")&&(typeof r.ttl=="number"?n.ttl=i.longs===String?String(r.ttl):r.ttl:n.ttl=i.longs===String?We.Long.prototype.toString.call(r.ttl):i.longs===Number?new We.LongBits(r.ttl.low>>>0,r.ttl.high>>>0).toNumber(!0):r.ttl),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?We.base64.encode(r.pubKey,0,r.pubKey.length):i.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.signatureV2!=null&&r.hasOwnProperty("signatureV2")&&(n.signatureV2=i.bytes===String?We.base64.encode(r.signatureV2,0,r.signatureV2.length):i.bytes===Array?Array.prototype.slice.call(r.signatureV2):r.signatureV2),r.data!=null&&r.hasOwnProperty("data")&&(n.data=i.bytes===String?We.base64.encode(r.data,0,r.data.length):i.bytes===Array?Array.prototype.slice.call(r.data):r.data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,mp.util.toJSONOptions)},t.ValidityType=function(){var e={},r=Object.create(e);return r[e[0]="EOL"]=0,r}(),t}();BH.exports=vp});var DH=p((ORt,D4)=>{f();"use strict";D4.exports.toRFC3339=t=>{let e=t.getUTCFullYear(),r=String(t.getUTCMonth()+1).padStart(2,"0"),i=String(t.getUTCDate()).padStart(2,"0"),n=String(t.getUTCHours()).padStart(2,"0"),s=String(t.getUTCMinutes()).padStart(2,"0"),o=String(t.getUTCSeconds()).padStart(2,"0"),c=t.getUTCMilliseconds()*1e3*1e3;return`${e}-${r}-${i}T${n}:${s}:${o}.${c}Z`};D4.exports.parseRFC3339=t=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(t).trim().match(e);if(!r)throw new Error("Invalid format");let i=parseInt(r[1],10),n=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),l=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,l))}});var MH=p(Ha=>{f();"use strict";Ha.ERR_IPNS_EXPIRED_RECORD="ERR_IPNS_EXPIRED_RECORD";Ha.ERR_UNRECOGNIZED_VALIDITY="ERR_UNRECOGNIZED_VALIDITY";Ha.ERR_SIGNATURE_CREATION="ERR_SIGNATURE_CREATION";Ha.ERR_SIGNATURE_VERIFICATION="ERR_SIGNATURE_VERIFICATION";Ha.ERR_UNRECOGNIZED_FORMAT="ERR_UNRECOGNIZED_FORMAT";Ha.ERR_PEER_ID_FROM_PUBLIC_KEY="ERR_PEER_ID_FROM_PUBLIC_KEY";Ha.ERR_PUBLIC_KEY_FROM_ID="ERR_PUBLIC_KEY_FROM_ID";Ha.ERR_UNDEFINED_PARAMETER="ERR_UNDEFINED_PARAMETER";Ha.ERR_INVALID_RECORD_DATA="ERR_INVALID_RECORD_DATA"});var Sp=p((qRt,XH)=>{f();"use strict";var LH=_H(),{Key:db}=Ft(),M4=Ma(),UH=et(),uLe=(An(),xn),{identity:lLe}=(Pc(),Ea),yn=ae(),{base32upper:fLe}=(an(),on),wp=ct(),hLe=Je(),_p=un(),FH=yi(),KH=(Kg(),Kw),jH=kH(),VH=me(),ps=Object.assign(VH("jsipns"),{error:VH("jsipns:error")}),{IpnsEntry:Ep}=NH(),{parseRFC3339:dLe}=DH(),Ji=MH(),pLe=lLe.code,zH="/ipns/",yLe=wp("/ipns/"),gLe=(t,e,r,i)=>{let n=new LH(Date.now()+Number(i)),s=Ep.ValidityType.EOL,[o,a]=i.toString().split("."),c=BigInt(o)*100000n+BigInt(a||0);return HH(t,e,r,s,n,c)},bLe=(t,e,r,i)=>{let n=LH.fromString(i),s=Ep.ValidityType.EOL,o=n.toDate().getTime()-Date.now(),a=BigInt(o)*100000n+BigInt(n.getNano());return HH(t,e,r,s,n,a)},HH=async(t,e,r,i,n,s)=>{r=BigInt(r);let o=wp(n.toString()),a=await SLe(t,e,i,o),c=mLe(e,o,i,r,s),l=YH(c),u=await t.sign(l),h={value:e,signature:a,validityType:i,validity:o,sequence:r,ttl:s,signatureV2:u,data:c};return ps(`ipns entry for ${e} created`),h},mLe=(t,e,r,i,n)=>{let s={Value:t,Validity:e,ValidityType:r,Sequence:i,TTL:n};return KH.encode(s)},$H=async(t,e)=>{let{value:r,validityType:i,validity:n}=e,s,o;e.signatureV2&&e.data?(o=e.signatureV2,s=YH(e.data),vLe(e)):(o=e.signature,s=WH(r,i,n));let a;try{a=await t.verify(s,o)}catch(c){a=!1}if(!a)throw ps.error("record signature verification failed"),yn(new Error("record signature verification failed"),Ji.ERR_SIGNATURE_VERIFICATION);if(i===Ep.ValidityType.EOL){let c;try{c=dLe(hLe(n))}catch(l){throw ps.error("unrecognized validity format (not an rfc3339 format)"),yn(new Error("unrecognized validity format (not an rfc3339 format)"),Ji.ERR_UNRECOGNIZED_FORMAT)}if(c.getTime()<Date.now())throw ps.error("record has expired"),yn(new Error("record has expired"),Ji.ERR_IPNS_EXPIRED_RECORD)}else if(i)throw ps.error("unrecognized validity type"),yn(new Error("unrecognized validity type"),Ji.ERR_UNRECOGNIZED_VALIDITY);ps(`ipns entry for ${r} is valid`)},vLe=t=>{if(!t.data)throw yn(new Error("Record data is missing"),Ji.ERR_INVALID_RECORD_DATA);let e=KH.decode(t.data);if(Number.isInteger(e.Sequence)&&(e.Sequence=BigInt(e.Sequence)),Number.isInteger(e.TTL)&&(e.TTL=BigInt(e.TTL)),!FH(e.Value,t.value))throw yn(new Error('Field "value" did not match between protobuf and CBOR'),Ji.ERR_SIGNATURE_VERIFICATION);if(!FH(e.Validity,t.validity))throw yn(new Error('Field "validity" did not match between protobuf and CBOR'),Ji.ERR_SIGNATURE_VERIFICATION);if(e.ValidityType!==t.validityType)throw yn(new Error('Field "validityType" did not match between protobuf and CBOR'),Ji.ERR_SIGNATURE_VERIFICATION);if(e.Sequence!==t.sequence)throw yn(new Error('Field "sequence" did not match between protobuf and CBOR'),Ji.ERR_SIGNATURE_VERIFICATION);if(e.TTL!==t.ttl)throw yn(new Error('Field "ttl" did not match between protobuf and CBOR'),Ji.ERR_SIGNATURE_VERIFICATION)},wLe=async(t,e)=>{if(!t||!t.bytes||!e){let n=new Error("one or more of the provided parameters are not defined");throw ps.error(n),yn(n,Ji.ERR_UNDEFINED_PARAMETER)}let r;try{r=await UH.createFromPubKey(t.bytes)}catch(n){throw yn(n,Ji.ERR_PEER_ID_FROM_PUBLIC_KEY)}let i;try{i=ALe(r)}catch(n){throw ps.error(n),yn(n,Ji.ERR_PUBLIC_KEY_FROM_ID)}if(i)return null;try{e.pubKey=M4.keys.marshalPublicKey(t)}catch(n){throw ps.error(n),n}return e},GH=(t,e)=>{if(!e||!t){let r=new Error("one or more of the provided parameters are not defined");throw ps.error(r),yn(r,Ji.ERR_UNDEFINED_PARAMETER)}if(e.pubKey){let r;try{r=M4.keys.unmarshalPublicKey(e.pubKey)}catch(i){throw ps.error(i),i}return r}if(t.pubKey)return t.pubKey;throw Object.assign(new Error("no public key is available"),{code:Ji.ERR_UNDEFINED_PARAMETER})},L4=t=>fLe.encode(t).slice(1),_Le=t=>new db(`/ipns/${L4(t)}`),ELe=t=>{let e=wp("/pk/"),r=wp("/ipns/");return{routingPubKey:new db(_p([e,t]),!1),pkKey:new db(L4(_p([e,t]))),routingKey:new db(_p([r,t]),!1),ipnsKey:new db(L4(_p([r,t])))}},SLe=(t,e,r,i)=>{try{let n=WH(e,r,i);return t.sign(n)}catch(n){throw ps.error("record signature creation failed"),yn(new Error("record signature creation failed: "+n.message),Ji.ERR_SIGNATURE_CREATION)}},xLe=t=>{if(t.toString()==="0")return"EOL";let e=new Error(`unrecognized validity type ${t.toString()}`);throw ps.error(e),yn(e,Ji.ERR_UNRECOGNIZED_VALIDITY)},WH=(t,e,r)=>{let i=wp(xLe(e));return _p([t,r,i])},YH=t=>{let e=wp("ipns-signature:");return _p([e,t])},ALe=t=>{let e=uLe.decode(t.id);return e.code!==pLe?null:M4.keys.unmarshalPublicKey(e.digest)},ILe=t=>Ep.encode({...t,sequence:jH.fromString(t.sequence.toString()),ttl:t.ttl==null?void 0:jH.fromString(t.ttl.toString())}).finish(),p_=t=>{let e=Ep.decode(t),r=Ep.toObject(e,{defaults:!1,arrays:!0,objects:!1});return{value:r.value,signature:r.signature,validityType:r.validityType,validity:r.validity,sequence:Object.hasOwnProperty.call(r,"sequence")?BigInt(`${r.sequence}`):0n,pubKey:r.pubKey,ttl:Object.hasOwnProperty.call(r,"ttl")?BigInt(`${r.ttl}`):void 0}},TLe={validate:async(t,e)=>{let r=p_(t),i=e.slice(yLe.length),n=UH.createFromBytes(i),s=GH(n,r);await $H(s,r)},select:(t,e)=>{let r=p_(t),i=p_(e);return r.sequence>i.sequence?0:1}};XH.exports={create:gLe,createWithExpiration:bLe,validate:$H,embedPublicKey:wLe,extractPublicKey:GH,getLocalKey:_Le,getIdKeys:ELe,marshal:ILe,unmarshal:p_,validator:TLe,namespace:zH,namespaceLength:zH.length}});var i$=p((t$,r$)=>{f();"use strict";var y_=et(),{Key:QH,Errors:RLe}=Ft(),Cn=ae(),ZH=me(),Si=Object.assign(ZH("ipfs:ipns:publisher"),{error:ZH("ipfs:ipns:publisher:error")}),pb=Je(),PLe=yi(),Vc=Sp(),JH=RLe.notFoundError().code,e$=60*60*1e3,U4=class{constructor(e,r){this._routing=e,this._datastore=r}async publishWithEOL(e,r,i){if(!e||!e.bytes)throw Cn(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");let n=await y_.createFromPrivKey(e.bytes),s=await this._updateOrCreateRecord(e,r,i,n);return this._putRecordToRouting(s,n)}publish(e,r){return this.publishWithEOL(e,r,e$)}async _putRecordToRouting(e,r){if(!y_.isPeerId(r)){let o="peerId received is not valid";throw Si.error(o),Cn(new Error(o),"ERR_INVALID_PEER_ID")}let i=r._pubKey,n=await Vc.embedPublicKey(i,e),s=Vc.getIdKeys(r.toBytes());return await this._publishEntry(s.routingKey,n||e),await this._publishPublicKey(s.routingPubKey,i),n||e}async _publishEntry(e,r){if(!(e instanceof QH)){let n="datastore key does not have a valid format";throw Si.error(n),Cn(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let i;try{i=Vc.marshal(r)}catch(n){throw Si.error(n),n}try{let n=await this._routing.put(e.uint8Array(),i);return Si(`ipns record for ${pb(e.uint8Array(),"base64")} was stored in the routing`),n}catch(n){let s=`ipns record for ${pb(e.uint8Array(),"base64")} could not be stored in the routing`;throw Si.error(s),Si.error(n),Cn(new Error(s),"ERR_PUTTING_TO_ROUTING")}}async _publishPublicKey(e,r){if(!(e instanceof QH)){let i="datastore key does not have a valid format";throw Si.error(i),Cn(new Error(i),"ERR_INVALID_DATASTORE_KEY")}if(!r||!r.bytes){let i="one or more of the provided parameters are not defined";throw Si.error(i),Cn(new Error(i),"ERR_UNDEFINED_PARAMETER")}try{let i=await this._routing.put(e.uint8Array(),r.bytes);return Si(`public key for ${pb(e.uint8Array(),"base64")} was stored in the routing`),i}catch(i){let n=`public key for ${pb(e.uint8Array(),"base64")} could not be stored in the routing`;throw Si.error(n),Si.error(i),Cn(new Error(n),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,r={}){if(!y_.isPeerId(e)){let n="peerId received is not valid";throw Si.error(n),Cn(new Error(n),"ERR_INVALID_PEER_ID")}let i=r.checkRouting!==!1;try{let n=await this._datastore.get(Vc.getLocalKey(e.id));return this._unmarshalData(n)}catch(n){if(n.code!==JH){let s=`unexpected error getting the ipns record ${e.id} from datastore`;throw Si.error(s),Cn(new Error(s),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!i)throw Cn(n,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let s=Vc.getIdKeys(e.toBytes()),o=await this._routing.get(s.routingKey.uint8Array());return this._unmarshalData(o)}catch(s){throw Si.error(s),s}}}_unmarshalData(e){try{return Vc.unmarshal(e)}catch(r){throw Cn(r,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,r,i,n){if(!y_.isPeerId(n)){let l="peerId received is not valid";throw Si.error(l),Cn(new Error(l),"ERR_INVALID_PEER_ID")}let s={checkRouting:!0},o;try{o=await this._getPublished(n,s)}catch(l){if(l.code!==JH){let u=`unexpected error when determining the last published IPNS record for ${n.id} ${l.stack}`;throw Si.error(u),Cn(new Error(u),"ERR_DETERMINING_PUBLISHED_RECORD")}}let a=0n;o&&o.sequence!==void 0&&(a=PLe(o.value,r)?BigInt(o.sequence):BigInt(o.sequence)+1n);let c;try{c=await Vc.create(e,r,a,i)}catch(l){let u=`ipns record for ${r} could not be created`;throw Si.error(l),Cn(new Error(u),"ERR_CREATING_IPNS_RECORD")}try{let l=Vc.marshal(c);return await this._datastore.put(Vc.getLocalKey(n.id),l),Si(`ipns record for ${pb(r,"base32")} was stored in the datastore`),c}catch(l){let u=`ipns record for ${r} could not be stored in the datastore`;throw Si.error(u),Cn(new Error(u),"ERR_STORING_IN_DATASTORE")}}};U4.defaultRecordLifetime=e$;t$=r$.exports=U4});var h$=p((l$,f$)=>{f();"use strict";var n$=Sp(),CLe=Ma(),s$=et(),Bf=ae(),o$=me(),g_=Object.assign(o$("ipfs:ipns:republisher"),{error:o$("ipfs:ipns:republisher:error")}),a$=60*1e3,c$=60*a$,OLe=4*c$,kLe=24*c$,u$=class{constructor(e,r,i,n,s={pass:""}){this._publisher=e,this._datastore=r,this._peerId=i,this._keychain=n,this._options=s,this._republishHandle=null}async start(){if(this._republishHandle)throw Bf(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:s=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(s)}catch(o){g_.error(o)}},s())},cancel:async()=>{e._timeoutId!=null&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{privKey:r}=this._peerId,{pass:i}=this._options,n=!0;e._task=()=>this._republishEntries(r,i),e.runPeriodically(()=>n?(n=!1,this._options.initialBroadcastInterval||a$):this._options.broadcastInterval||OLe),this._republishHandle=e}async stop(){let e=this._republishHandle;if(!e)throw Bf(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,r){try{await this._republishEntry(e)}catch(i){let n="cannot republish entry for the node's private key";g_.error(n);return}if(r)try{let i=await this._keychain.listKeys();for(let n of i){if(n.name==="self")continue;let s=await this._keychain.exportKey(n.name,r),o=await CLe.keys.import(s,r);await this._republishEntry(o)}}catch(i){g_.error(i)}}async _republishEntry(e){if(!e||!e.bytes)throw Bf(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");try{let r=await s$.createFromPrivKey(e.bytes),i=await this._getPreviousValue(r);await this._publisher.publishWithEOL(e,i,kLe)}catch(r){if(r.code==="ERR_NO_ENTRY_FOUND")return;throw r}}async _getPreviousValue(e){if(!s$.isPeerId(e))throw Bf(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let r=await this._datastore.get(n$.getLocalKey(e.id));if(!(r instanceof Uint8Array))throw Bf(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return n$.unmarshal(r).value}catch(i){throw g_.error(i),Bf(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(r){throw r&&r.notFound?Bf(new Error(`no previous entry for record with id: ${e.id}`),"ERR_NO_ENTRY_FOUND"):r}}};l$=f$.exports=u$});var m$=p((g$,b$)=>{f();"use strict";var b_=Sp(),qLe=et(),xp=ae(),d$=me(),m_=Object.assign(d$("ipfs:ipns:resolver"),{error:d$("ipfs:ipns:resolver:error")}),BLe=Je(),{Errors:NLe}=Ft(),DLe=NLe.notFoundError().code,p$=32,y$=class{constructor(e){this._routing=e}async resolve(e,r={}){if(typeof e!="string")throw xp(new Error("invalid name"),"ERR_INVALID_NAME");let i=r.recursive&&r.recursive.toString()==="true",n=e.split("/");if(n.length!==3||n[0]!=="")throw xp(new Error("invalid name"),"ERR_INVALID_NAME");let s=n[2],o=1/0;i&&(o=p$);let a=await this.resolver(s,o);return m_(`${e} was locally resolved correctly`),a}async resolver(e,r){if(r===0){let s=`could not resolve name (recursion limit of ${p$} exceeded)`;throw m_.error(s),xp(new Error(s),"ERR_RESOLVE_RECURSION_LIMIT")}let i=await this._resolveName(e),n=i.split("/");return n[1]==="ipfs"||!r?i:this.resolver(n[2],r-1)}async _resolveName(e){let r=qLe.parse(e),{routingKey:i}=b_.getIdKeys(r.toBytes()),n;try{n=await this._routing.get(i.uint8Array())}catch(o){throw m_.error("could not get record from routing",o),o.code===DLe?xp(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):xp(new Error(`unexpected error getting the ipns record ${r.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s;try{s=b_.unmarshal(n)}catch(o){throw m_.error("could not unmarshal record",o),xp(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_RECORD_RECEIVED")}return this._validateRecord(r,s)}async _validateRecord(e,r){let i=await b_.extractPublicKey(e,r);return await b_.validate(i,r),BLe(r.value)}};g$=b$.exports=y$});var x$=p((BRt,S$)=>{f();"use strict";var{createFromPrivKey:MLe}=et(),LLe=ae(),v$=me(),yb=Object.assign(v$("ipfs:ipns"),{error:v$("ipfs:ipns:error")}),F4=i$(),ULe=h$(),FLe=m$(),KLe=BI(),w$=60*1e3,_$=Je(),E$=class{constructor(e,r,i,n,s){this.publisher=new F4(e,r),this.republisher=new ULe(this.publisher,r,i,n,s),this.resolver=new FLe(e),this.cache=new KLe(1e3),this.routing=e}async publish(e,r,i=F4.defaultRecordLifetime){try{let n=await MLe(e.bytes);await this.publisher.publishWithEOL(e,r,i),yb(`IPNS value ${_$(r,"base32")} was published correctly`);let s=n.toB58String(),o=parseFloat(i),a=o<w$?o:w$;return this.cache.set(s,r,a),yb(`IPNS value ${_$(r,"base32")} was cached correctly`),{name:s,value:r}}catch(n){throw yb.error(n),n}}async resolve(e,r={}){if(typeof e!="string")throw LLe(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!r.nocache&&!r.recursive){let i=e.split("/")[2],n=this.cache.get(i);if(n)return n}try{let i=await this.resolver.resolve(e,r);return yb(`IPNS record from ${e} was resolved correctly`),i}catch(i){throw yb.error(i),i}}async initializeKeyspace(e,r){return this.publish(e,r,F4.defaultRecordLifetime)}};S$.exports=E$});var gb=p((NRt,I$)=>{f();"use strict";var{Adapter:jLe}=Ft(),Nf=ko(),{pipe:K4}=Pr(),A$=class extends jLe{constructor(e,r){super();this.child=e,this.transform=r}open(){return this.child.open()}put(e,r,i){return this.child.put(this.transform.convert(e),r,i)}get(e,r){return this.child.get(this.transform.convert(e),r)}has(e,r){return this.child.has(this.transform.convert(e),r)}delete(e,r){return this.child.delete(this.transform.convert(e),r)}async*putMany(e,r={}){let i=this.transform,n=this.child;yield*K4(e,async function*(s){yield*Nf(s,({key:o,value:a})=>({key:i.convert(o),value:a}))},async function*(s){yield*n.putMany(s,r)},async function*(s){yield*Nf(s,({key:o,value:a})=>({key:i.invert(o),value:a}))})}async*getMany(e,r={}){let i=this.transform,n=this.child;yield*K4(e,async function*(s){yield*Nf(s,o=>i.convert(o))},async function*(s){yield*n.getMany(s,r)})}async*deleteMany(e,r={}){let i=this.transform,n=this.child;yield*K4(e,async function*(s){yield*Nf(s,o=>i.convert(o))},async function*(s){yield*n.deleteMany(s,r)},async function*(s){yield*Nf(s,o=>i.invert(o))})}batch(){let e=this.child.batch();return{put:(r,i)=>{e.put(this.transform.convert(r),i)},delete:r=>{e.delete(this.transform.convert(r))},commit:r=>e.commit(r)}}query(e,r){return Nf(this.child.query(e,r),({key:i,value:n})=>({key:this.transform.invert(i),value:n}))}queryKeys(e,r){return Nf(this.child.queryKeys(e,r),i=>this.transform.invert(i))}close(){return this.child.close()}};I$.exports=A$});var R$=p((DRt,T$)=>{f();"use strict";T$.exports=`This is a repository of IPLD objects. Each IPLD object is in a single file,
named <base32 encoding of cid>.data. Where <base32 encoding of cid> is the
"base32" encoding of the CID (as specified in
https://github.com/multiformats/multibase) without the 'B' prefix.
All the object files are placed in a tree of directories, based on a
function of the CID. This is a form of sharding similar to
the objects directory in git repositories. Previously, we used
prefixes, we now use the next-to-last two charters.
    func NextToLast(base32cid string) {
      nextToLastLen := 2
      offset := len(base32cid) - nextToLastLen - 1
      return str[offset : offset+nextToLastLen]
    }
For example, an object with a base58 CIDv1 of
    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f
has a base32 CIDv1 of
    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA
and will be placed at
    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data
with 'SC' being the last-to-next two characters and the 'B' at the
beginning of the CIDv1 string is the multibase prefix that is not
stored in the filename.
`});var H4=p((MRt,k$)=>{f();"use strict";var{Key:P$}=Ft(),VLe=R$(),v_="/repo/flatfs/shard/",C$="SHARDING",zLe="_README",w_=class{constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${v_}v1/${this.name}/${this.param}`}},j4=class extends w_{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}},V4=class extends w_{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){let r=this._padding+e;return r.slice(r.length-this.param)}},z4=class extends w_{constructor(e){super(e);this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){let r=this._padding+e,i=r.length-this.param-1;return r.slice(i,i+this.param)}};function O$(t){if(t=t.trim(),t.length===0)throw new Error("empty shard string");if(!t.startsWith(v_))throw new Error(`invalid or no path prefix: ${t}`);let e=t.slice(v_.length).split("/"),r=e[0];if(r!=="v1")throw new Error(`expect 'v1' version, got '${r}'`);let i=e[1];if(!e[2])throw new Error("missing param");let n=parseInt(e[2],10);switch(i){case"prefix":return new j4(n);case"suffix":return new V4(n);case"next-to-last":return new z4(n);default:throw new Error(`unkown sharding function: ${i}`)}}var HLe=async(t,e)=>{let r=new P$(t).child(new P$(C$)),n=await(typeof e.getRaw=="function"?e.getRaw.bind(e):e.get.bind(e))(r);return O$(new TextDecoder().decode(n||"").trim())};k$.exports={readme:VLe,parseShardFun:O$,readShardFun:HLe,Prefix:j4,Suffix:V4,NextToLast:z4,README_FN:zLe,SHARDING_FN:C$,PREFIX:v_}});var B$=p((LRt,q$)=>{f();"use strict";var{Adapter:$Le,Key:__,Errors:GLe}=Ft(),bb=H4(),WLe=gb(),Ap=new __(bb.SHARDING_FN),mb=new __(bb.README_FN),Df=class extends $Le{constructor(e,r){super();this.child=new WLe(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=r}async open(){await this.child.open(),this.shard=await Df.create(this.child,this.shard)}_convertKey(e){let r=e.toString();return r===Ap.toString()||r===mb.toString()?e:new __(this.shard.fun(r)).child(e)}_invertKey(e){let r=e.toString();return r===Ap.toString()||r===mb.toString()?e:__.withNamespaces(e.list().slice(1))}static async createOrOpen(e,r){try{await Df.create(e,r)}catch(i){if(i&&i.message!=="datastore exists")throw i}return Df.open(e)}static async open(e){let r=await bb.readShardFun("/",e);return new Df(e,r)}static async create(e,r){let i=await e.has(Ap);if(!i&&!r)throw GLe.dbOpenFailedError(Error("Shard is required when datastore doesn't have a shard key already."));if(!i){let a=typeof e.putRaw=="function"?e.putRaw.bind(e):e.put.bind(e);return await Promise.all([a(Ap,new TextEncoder().encode(r.toString()+`
`)),a(mb,new TextEncoder().encode(bb.readme))]),r}let n=await bb.readShardFun("/",e),s=(n||"").toString(),o=r.toString();if(s!==o)throw new Error(`specified fun ${o} does not match repo shard fun ${s}`);return n}put(e,r,i){return this.child.put(e,r,i)}get(e,r){return this.child.get(e,r)}has(e,r){return this.child.has(e,r)}delete(e,r){return this.child.delete(e,r)}async*putMany(e,r={}){yield*this.child.putMany(e,r)}async*getMany(e,r={}){yield*this.child.getMany(e,r)}async*deleteMany(e,r={}){yield*this.child.deleteMany(e,r)}batch(){return this.child.batch()}query(e,r){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.key.toString()!==Ap.toString(),s=>s.key.toString()!==mb.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s.key).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>({key:c,value:l})=>o({key:this._invertKey(c),value:l}));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s({key:this._invertKey(a.key),value:a.value},{key:this._invertKey(c.key),value:c.value}))),this.child.query(i,r)}queryKeys(e,r){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.toString()!==Ap.toString(),s=>s.toString()!==mb.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>c=>o(this._invertKey(c)));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s(this._invertKey(a),this._invertKey(c)))),this.child.queryKeys(i,r)}close(){return this.child.close()}};q$.exports=Df});var K$=p((URt,F$)=>{f();"use strict";var{Adapter:YLe,Key:XLe,Errors:$4,utils:{sortAll:N$,replaceStartWith:G4}}=Ft(),E_=ja(),D$=ip(),M$=pp(),L$=gb(),U$=class extends YLe{constructor(e){super();this.mounts=e.slice()}async open(){await Promise.all(this.mounts.map(e=>e.datastore.open()))}_lookup(e){for(let r of this.mounts)if(r.prefix.toString()===e.toString()||r.prefix.isAncestorOf(e)){let i=G4(e.toString(),r.prefix.toString());return{datastore:r.datastore,mountpoint:r.prefix,rest:new XLe(i)}}}put(e,r,i){let n=this._lookup(e);if(n==null)throw $4.dbWriteFailedError(new Error("No datastore mounted for this key"));return n.datastore.put(n.rest,r,i)}get(e,r){let i=this._lookup(e);if(i==null)throw $4.notFoundError(new Error("No datastore mounted for this key"));return i.datastore.get(i.rest,r)}has(e,r){let i=this._lookup(e);return i==null?Promise.resolve(!1):i.datastore.has(i.rest,r)}delete(e,r){let i=this._lookup(e);if(i==null)throw $4.dbDeleteFailedError(new Error("No datastore mounted for this key"));return i.datastore.delete(i.rest,r)}async close(){await Promise.all(this.mounts.map(e=>e.datastore.close()))}batch(){let e={},r=i=>{let n=this._lookup(i);if(n==null)throw new Error("No datastore mounted for this key");let s=n.mountpoint.toString();return e[s]==null&&(e[s]=n.datastore.batch()),{batch:e[s],rest:n.rest}};return{put:(i,n)=>{let s=r(i);s.batch.put(s.rest,n)},delete:i=>{let n=r(i);n.batch.delete(n.rest)},commit:async i=>{await Promise.all(Object.keys(e).map(n=>e[n].commit(i)))}}}query(e,r){let i=this.mounts.map(s=>{let o=new L$(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=G4(e.prefix,s.prefix.toString())),o.query({prefix:a,filters:e.filters},r)}),n=M$(...i);if(e.filters&&e.filters.forEach(s=>{n=E_(n,s)}),e.orders&&e.orders.forEach(s=>{n=N$(n,s)}),e.offset!=null){let s=0;n=E_(n,()=>s++>=e.offset)}return e.limit!=null&&(n=D$(n,e.limit)),n}queryKeys(e,r){let i=this.mounts.map(s=>{let o=new L$(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=G4(e.prefix,s.prefix.toString())),o.queryKeys({prefix:a,filters:e.filters},r)}),n=M$(...i);if(e.filters&&e.filters.forEach(s=>{n=E_(n,s)}),e.orders&&e.orders.forEach(s=>{n=N$(n,s)}),e.offset!=null){let s=0;n=E_(n,()=>s++>=e.offset)}return e.limit!=null&&(n=D$(n,e.limit)),n}};F$.exports=U$});var $$=p((FRt,H$)=>{f();"use strict";var{Adapter:QLe,Errors:S_}=Ft(),ZLe=me()("datastore:core:tiered"),j$=za(),V$=Ka(),z$=class extends QLe{constructor(e){super();this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch(e){throw S_.dbOpenFailedError()}}async put(e,r){try{await Promise.all(this.stores.map(i=>i.put(e,r)))}catch(i){throw S_.dbWriteFailedError()}}async get(e,r){for(let i of this.stores)try{let n=await i.get(e,r);if(n)return n}catch(n){ZLe(n)}throw S_.notFoundError()}async has(e,r){for(let i of this.stores)if(await i.has(e,r))return!0;return!1}async delete(e,r){try{await Promise.all(this.stores.map(i=>i.delete(e,r)))}catch(i){throw S_.dbDeleteFailedError()}}async*putMany(e,r={}){let i,n=this.stores.map(s=>{let o=j$();return V$(s.putMany(o,r)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async*deleteMany(e,r={}){let i,n=this.stores.map(s=>{let o=j$();return V$(s.deleteMany(o,r)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){let e=this.stores.map(r=>r.batch());return{put:(r,i)=>{e.forEach(n=>n.put(r,i))},delete:r=>{e.forEach(i=>i.delete(r))},commit:async r=>{for(let i of e)await i.commit(r)}}}query(e,r){return this.stores[this.stores.length-1].query(e,r)}queryKeys(e,r){return this.stores[this.stores.length-1].queryKeys(e,r)}};H$.exports=z$});var Y$=p((KRt,W$)=>{f();"use strict";var W4=Ft().Key,JLe=gb(),G$=class extends JLe{constructor(e,r){super(e,{convert(i){return r.child(i)},invert(i){if(r.toString()==="/")return i;if(!r.isAncestorOf(i))throw new Error(`Expected prefix: (${r.toString()}) in key: ${i.toString()}`);return new W4(i.toString().slice(r.toString().length),!1)}});this.prefix=r}query(e,r){return e.prefix&&this.prefix.toString()!=="/"?super.query(Object.assign({},e,{prefix:this.prefix.child(new W4(e.prefix)).toString()})):super.query(e,r)}queryKeys(e,r){return e.prefix&&this.prefix.toString()!=="/"?super.queryKeys(Object.assign({},e,{prefix:this.prefix.child(new W4(e.prefix)).toString()})):super.queryKeys(e,r)}};W$.exports=G$});var Q$=p((jRt,X$)=>{f();"use strict";var e9e=gb(),t9e=B$(),r9e=K$(),i9e=$$(),n9e=Y$(),s9e=H4();X$.exports={KeytransformDatastore:e9e,ShardingDatastore:t9e,MountDatastore:r9e,TieredDatastore:i9e,NamespaceDatastore:n9e,shard:s9e}});var vb=p((Y4,X4)=>{f();(function(t,e){typeof Y4=="object"&&typeof X4!="undefined"?X4.exports=function(r,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)r=r?r[i[s]]:o;return r===o?n:r}:typeof define=="function"&&define.amd?define(function(){return function(r,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)r=r?r[i[s]]:o;return r===o?n:r}}):t.dlv=function(r,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)r=r?r[i[s]]:o;return r===o?n:r}})(Y4)});var tG=p((VRt,eG)=>{f();"use strict";var o9e=ae(),Z$=Je(),J$=ct(),x_="/record/";function a9e(t){return Z$(t,"base32")}function c9e(t){(typeof t=="string"||t instanceof String)&&(t=J$(t.toString()));let e=Z$(t,"base64url");return`${x_}${e}`}function u9e(t){if(t.substring(0,x_.length)!==x_)throw o9e(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let e=t.substring(x_.length);return J$(e,"base64url")}eG.exports={encodeBase32:a9e,keyToTopic:c9e,topicToKey:u9e}});var aG=p((sG,oG)=>{f();"use strict";var{Key:Q4,Adapter:l9e}=Ft(),{encodeBase32:rG,keyToTopic:A_,topicToKey:f9e}=tG(),h9e=yi(),Vs=ae(),iG=me(),gn=Object.assign(iG("datastore-pubsub:publisher"),{error:iG("datastore-pubsub:publisher:error")}),nG=class extends l9e{constructor(e,r,i,n,s){super();if(!n)throw Vs(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof n.validate!="function")throw Vs(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof n.select!="function")throw Vs(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&typeof s!="function")throw Vs(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=r,this._peerId=i,this._validator=n,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this)}async put(e,r){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw gn.error(n),Vs(new Error(n),"ERR_INVALID_DATASTORE_KEY")}if(!(r instanceof Uint8Array)){let n="received value is not a Uint8Array";throw gn.error(n),Vs(new Error(n),"ERR_INVALID_VALUE_RECEIVED")}let i=A_(e);gn(`publish value for topic ${i}`),await this._pubsub.publish(i,r)}async get(e){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw gn.error(n),Vs(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let r=A_(e),i=await this._pubsub.getTopics();if(i&&Array.isArray(i)&&i.indexOf(r)>-1)return this._getLocal(e);try{this._pubsub.on(r,this._onMessage),await this._pubsub.subscribe(r)}catch(n){let s=`cannot subscribe topic ${r}`;throw gn.error(s),Vs(new Error(s),"ERR_SUBSCRIBING_TOPIC")}return gn(`subscribed values for key ${r}`),this._getLocal(e)}unsubscribe(e){let r=A_(e);return this._pubsub.removeListener(r,this._onMessage),this._pubsub.unsubscribe(r)}async _getLocal(e){let r=new Q4("/"+rG(e),!1),i;try{i=await this._datastore.get(r)}catch(n){if(n.code!=="ERR_NOT_FOUND"){let o=`unexpected error getting the ipns record for ${r.toString()}`;throw gn.error(o),Vs(new Error(o),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s=`local record requested was not found for ${r.toString()}`;throw gn.error(s),Vs(new Error(s),"ERR_NOT_FOUND")}if(!(i instanceof Uint8Array)){let n="found record that we couldn't convert to a value";throw gn.error(n),Vs(new Error(n),"ERR_INVALID_RECORD_RECEIVED")}return i}async _onMessage(e){let{data:r,from:i,topicIDs:n}=e,s;try{s=f9e(n[0])}catch(o){gn.error(o);return}if(gn(`message received for topic ${n[0]}`),i===this._peerId.toB58String()){gn("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let o;try{o=await this._handleSubscriptionKeyFn(s)}catch(a){gn.error("message discarded by the subscriptionKeyFn");return}s=o}try{await this._storeIfSubscriptionIsBetter(s,r)}catch(o){gn.error(o)}}async _storeIfSubscriptionIsBetter(e,r){let i=!1;try{i=await this._isBetter(e,r)}catch(n){if(n.code!=="ERR_NOT_VALID_RECORD")throw n}i&&await this._storeRecord(e,r)}async _validateRecord(e,r){return this._validator.validate(e,r)}async _selectRecord(e,r){return await this._validator.select(e,r)===0}async _isBetter(e,r){try{await this._validateRecord(r,e)}catch(s){let o="record received through pubsub is not valid";throw gn.error(o),Vs(new Error(o),"ERR_NOT_VALID_RECORD")}let i=new Q4(e),n;try{n=await this._getLocal(i.uint8Array())}catch(s){return!0}return h9e(n,r)?!1:this._selectRecord(e,[n,r])}async _storeRecord(e,r){let i=new Q4("/"+rG(e),!1);await this._datastore.put(i,r),gn(`record for ${A_(e)} was stored in the datastore`)}};sG=oG.exports=nG});var J4=p((zRt,pG)=>{f();"use strict";var il=Sp(),{base58btc:cG}=(si(),ni),d9e=aG(),uG=Je(),lG=ct(),fG=ae(),hG=me(),Z4=Object.assign(hG("ipfs:ipns:pubsub"),{error:hG("ipfs:ipns:pubsub:error")}),dG=class{constructor(e,r,i){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new d9e(e,r,i,il.validator,this._handleSubscriptionKey)}put(e,r){return this._pubsubDs.put(e,r)}async get(e){let r,i;try{r=await this._pubsubDs.get(e)}catch(s){i=s}let n=e.slice(0,il.namespaceLength);if(uG(n)===il.namespace){let s=cG.encode(e).substring(1),o=cG.encode(e.slice(il.namespaceLength)).substring(1);this._subscriptions[s]=o,Z4(`subscribed to pubsub topic ${s}, id ${o}`)}if(i)throw i;return r}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=uG(e,"base58btc"));let r=this._subscriptions[e];if(!r)throw fG(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");let i;try{i=il.getIdKeys(lG(r,"base58btc"))}catch(n){throw Z4.error(n),n}return i.routingKey.uint8Array()}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(r=>`${il.namespace}${r}`)}async cancel(e){if(typeof e!="string")throw fG(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(il.namespace)&&(e=e.substring(il.namespaceLength));let r=Object.keys(this._subscriptions).find(n=>this._subscriptions[n]===e);if(!r)return{canceled:!1};let i=lG(r);return this._pubsubDs.unsubscribe(i),delete this._subscriptions[r],Z4(`unsubscribed pubsub ${r}: ${e}`),{canceled:!0}}};pG.exports=dG});var bG=p((HRt,gG)=>{f();"use strict";var Ip=Bi(),yG=Ip.Reader,p9e=Ip.Writer,zs=Ip.util,wb=Ip.roots["libp2p-record"]||(Ip.roots["libp2p-record"]={});wb.Record=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.key=zs.newBuffer([]),t.prototype.value=zs.newBuffer([]),t.prototype.timeReceived="",t.encode=function(r,i){return i||(i=p9e.create()),r.key!=null&&Object.hasOwnProperty.call(r,"key")&&i.uint32(10).bytes(r.key),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&i.uint32(18).bytes(r.value),r.timeReceived!=null&&Object.hasOwnProperty.call(r,"timeReceived")&&i.uint32(42).string(r.timeReceived),i},t.decode=function(r,i){r instanceof yG||(r=yG.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new wb.Record;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.key=r.bytes();break;case 2:s.value=r.bytes();break;case 5:s.timeReceived=r.string();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof wb.Record)return r;var i=new wb.Record;return r.key!=null&&(typeof r.key=="string"?zs.base64.decode(r.key,i.key=zs.newBuffer(zs.base64.length(r.key)),0):r.key.length&&(i.key=r.key)),r.value!=null&&(typeof r.value=="string"?zs.base64.decode(r.value,i.value=zs.newBuffer(zs.base64.length(r.value)),0):r.value.length&&(i.value=r.value)),r.timeReceived!=null&&(i.timeReceived=String(r.timeReceived)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.key="":(n.key=[],i.bytes!==Array&&(n.key=zs.newBuffer(n.key))),i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=zs.newBuffer(n.value))),n.timeReceived=""),r.key!=null&&r.hasOwnProperty("key")&&(n.key=i.bytes===String?zs.base64.encode(r.key,0,r.key.length):i.bytes===Array?Array.prototype.slice.call(r.key):r.key),r.value!=null&&r.hasOwnProperty("value")&&(n.value=i.bytes===String?zs.base64.encode(r.value,0,r.value.length):i.bytes===Array?Array.prototype.slice.call(r.value):r.value),r.timeReceived!=null&&r.hasOwnProperty("timeReceived")&&(n.timeReceived=r.timeReceived),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ip.util.toJSONOptions)},t}();gG.exports=wb});var mG=p(($Rt,e5)=>{f();"use strict";e5.exports.toRFC3339=t=>{let e=t.getUTCFullYear(),r=String(t.getUTCMonth()+1).padStart(2,"0"),i=String(t.getUTCDate()).padStart(2,"0"),n=String(t.getUTCHours()).padStart(2,"0"),s=String(t.getUTCMinutes()).padStart(2,"0"),o=String(t.getUTCSeconds()).padStart(2,"0"),c=t.getUTCMilliseconds()*1e3*1e3;return`${e}-${r}-${i}T${n}:${s}:${o}.${c}Z`};e5.exports.parseRFC3339=t=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(t).trim().match(e);if(!r)throw new Error("Invalid format");let i=parseInt(r[1],10),n=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),l=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,l))}});var _G=p((GRt,wG)=>{f();"use strict";var{Record:t5}=bG(),vG=mG(),_b=class{constructor(e,r,i){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(r instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=r,this.timeReceived=i}serialize(){return t5.encode(this.prepareSerialize()).finish()}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&vG.toRFC3339(this.timeReceived)}}static deserialize(e){let r=t5.decode(e);return _b.fromDeserialized(t5.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}))}static fromDeserialized(e){let r;return e.timeReceived&&(r=vG.parseRFC3339(e.timeReceived)),new _b(e.key,e.value,r)}};wG.exports=_b});var SG=p((WRt,EG)=>{f();"use strict";var{sha256:y9e}=(ai(),$r),I_=ae(),g9e=Je(),b9e=yi(),m9e=async(t,e)=>{if(!(t instanceof Uint8Array))throw I_(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(t.byteLength<5)throw I_(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(g9e(t.subarray(0,4))!=="/pk/")throw I_(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let i=t.slice(4),n=await y9e.digest(e);if(!b9e(i,n.bytes))throw I_(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")};EG.exports={func:m9e,sign:!1}});var AG=p((YRt,xG)=>{f();"use strict";xG.exports={pk:SG()}});var TG=p((XRt,IG)=>{f();"use strict";var v9e=ae(),w9e=Je(),_9e=(t,e)=>{let r=e.key,n=w9e(r).split("/");if(n.length<3)return;let s=t[n[1].toString()];if(!s){let o="Invalid record keytype";throw v9e(new Error(o),"ERR_INVALID_RECORD_KEY_TYPE")}return s.func(r,e.value)};IG.exports={verifyRecord:_9e,validators:AG()}});var PG=p((QRt,RG)=>{f();"use strict";var E9e=(t,e)=>0;RG.exports=E9e});var OG=p((ZRt,CG)=>{f();"use strict";CG.exports={pk:PG()}});var qG=p((JRt,kG)=>{f();"use strict";var r5=ae(),S9e=Je(),x9e=(t,e,r)=>{if(r.length===0){let o="No records given";throw r5(new Error(o),"ERR_NO_RECORDS_RECEIVED")}let n=S9e(e).split("/");if(n.length<3){let o="Record key does not have a selector function";throw r5(new Error(o),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let s=t[n[1].toString()];if(!s){let o=`Unrecognized key prefix: ${n[1]}`;throw r5(new Error(o),"ERR_UNRECOGNIZED_KEY_PREFIX")}return s(e,r)};kG.exports={bestRecord:x9e,selectors:OG()}});var Mf=p((e8t,BG)=>{f();"use strict";BG.exports={Record:_G(),validator:TG(),selection:qG()}});var i5=p((t8t,DG)=>{f();"use strict";var NG=Sp(),A9e=Je();DG.exports={encodeBase32:t=>A9e(t,"base32upper"),validator:{func:(t,e)=>NG.validator.validate(e,t)},selector:(t,e)=>NG.validator.select(e[0],e[1])}});var s5=p((FG,KG)=>{f();"use strict";var{Key:I9e}=Ft(),{Record:MG}=Mf(),{encodeBase32:T9e}=i5(),Eb=ae(),LG=me(),n5=Object.assign(LG("ipfs:ipns:offline-datastore"),{error:LG("ipfs:ipns:offline-datastore:error")}),UG=class{constructor(e){this._repo=e,this.stores=[]}async put(e,r){if(!(e instanceof Uint8Array))throw Eb(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(r instanceof Uint8Array))throw Eb(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let i;try{i=this._routingKey(e)}catch(s){throw n5.error(s),Eb(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let n=new MG(e,r);return this._repo.datastore.put(i,n.serialize())}async get(e){if(!(e instanceof Uint8Array))throw Eb(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let r;try{r=this._routingKey(e)}catch(s){throw n5.error(s),Eb(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let i=await this._repo.datastore.get(r),n;try{n=MG.deserialize(i)}catch(s){throw n5.error(s),s}return n.value}_routingKey(e){return new I9e("/"+T9e(e),!1)}};FG=KG.exports=UG});var VG=p((r8t,jG)=>{f();"use strict";var{TieredDatastore:R9e}=Q$(),o5=vb(),P9e=J4(),C9e=s5();jG.exports=({libp2p:t,repo:e,peerId:r,options:i})=>{let n=[],s;if(o5(i,"EXPERIMENTAL.ipnsPubsub",!1)){let o=t.pubsub,a=e.datastore;s=new P9e(o,a,r),n.push(s)}if(o5(i,"offline")||!o5(i,"libp2p.config.dht.enabled",!1)){let o=new C9e(e);n.push(o)}else n.push(t._dht);return new R9e(n)}});var WG=p((i8t,GG)=>{f();"use strict";var zG=x$(),O9e=VG(),k9e=s5(),{NotInitializedError:q9e,AlreadyInitializedError:HG}=Qu(),B9e=me()("ipfs:components:ipns"),$G=class{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){let e=this.online||this.offline;if(e)return e;throw new q9e}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:r,keychain:i}){if(this.offline!=null)throw new HG;B9e("initializing IPNS keyspace");let n=new k9e(e),s=new zG(n,e.datastore,r,i,this.options);this.offline=s}async startOnline({libp2p:e,repo:r,peerId:i,keychain:n}){if(this.online!=null)throw new HG;let s=O9e({libp2p:e,repo:r,peerId:i,options:this.options}),o=new zG(s,r.datastore,i,n,this.options);await o.republisher.start(),this.online=o}async stop(){let e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,r,i){return this.getIPNS().publish(e,r,i)}resolve(e,r){return this.getIPNS().resolve(e,r)}initializeKeyspace(e,r){return this.getIPNS().initializeKeyspace(e,r)}};GG.exports=$G});var XG=p(YG=>{f();"use strict";var N9e=zd(),D9e=Jg(),M9e=Ka(),{resolve:L9e}=zi();YG.resolvePath=async({ipns:t,repo:e,codecs:r},i,n)=>{if(N9e.ipnsPath(i))return t.resolve(i);let{cid:s,path:o}=D9e(i);await M9e(L9e(s,o||"",r,e,n))}});var eW=p((s8t,JG)=>{f();"use strict";var QG=me(),{default:U9e}=Qg(),F9e=Ma(),ZG=ae(),K9e=ct(),j9e=Je(),a5=Object.assign(QG("ipfs:name:publish"),{error:QG("ipfs:name:publish:error")}),{OFFLINE_ERROR:V9e,normalizePath:z9e}=zi(),H9e=Oe(),{resolvePath:$9e}=XG();JG.exports=({ipns:t,repo:e,codecs:r,peerId:i,isOnline:n,keychain:s})=>{let o=async c=>{if(c==="self")return i.privKey;try{let l=await s.exportKey(c,"temp");return await F9e.keys.import(l,"temp")}catch(l){throw a5.error(l),ZG(l,"ERR_CANNOT_GET_KEY")}};async function a(c,l={}){let u=l.resolve!==!1,h=l.lifetime||"24h",d=l.key||"self";if(!n())throw ZG(new Error(V9e),"OFFLINE_ERROR");try{c=z9e(c)}catch(v){throw a5.error(v),v}let y=0;try{y=U9e(h)||0,y=parseFloat(y.toFixed(6))}catch(v){throw a5.error(v),v}let g=await Promise.all([o(d),u?$9e({ipns:t,repo:e,codecs:r},c):Promise.resolve()]),m=K9e(c),E=await t.publish(g[0],m,y);return{name:E.name,value:j9e(E.value)}}return H9e(a)}});var rW=p((o8t,tW)=>{f();"use strict";var G9e=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;tW.exports=function(e,r){if(r==null&&(r=!1),e.length<2||e.length>255)return!1;var i=e[e.length-1];if(r){if(i!==".")return!1}else if(i===".")return!1;return G9e.test(e)}});var oW=p((a8t,sW)=>{f();"use strict";var iW=me(),c5=ae(),W9e=wr().bind({ignoreUndefined:!0}),{CID:Y9e}=(Ae(),Ce),X9e=et(),Q9e=rW(),Z9e=Je(),J9e=Object.assign(iW("ipfs:name:resolve"),{error:iW("ipfs:name:resolve:error")}),{OFFLINE_ERROR:eUe}=zi(),tUe=Oe(),nW=(t,e)=>e.length>0?t+"/"+e.join("/"):t;sW.exports=({dns:t,ipns:e,peerId:r,isOnline:i,options:{offline:n}})=>{async function*s(o,a={}){if(a=W9e({nocache:!1,recursive:!0},a),n&&a&&a.nocache)throw c5(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");o||(o=r.toB58String()),o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[c,l,...u]=o.slice(1).split("/");try{l.substring(0,1)==="1"?X9e.parse(l):Y9e.parse(l)}catch(d){if(Q9e(l)){yield nW(await t(l,a),u);return}throw J9e.error(d),c5(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}if(!i()&&!n)throw c5(new Error(eUe),"OFFLINE_ERROR");let h=await e.resolve(`/${c}/${l}`,a);yield nW(h instanceof Uint8Array?Z9e(h):h,u)}return tUe(s)}});var T_=p(uW=>{f();"use strict";var aW=J4(),cW=ae();uW.getPubsubRouting=(t,e)=>{if(!t||!(e&&e.ipnsPubsub))throw cW(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(t.routing instanceof aW)return t.routing;let r=(t.routing.stores||[]).find(i=>i instanceof aW);if(!r)throw cW(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return r}});var fW=p((u8t,lW)=>{f();"use strict";var{getPubsubRouting:rUe}=T_(),iUe=Oe();lW.exports=({ipns:t,options:e})=>{let r=e.EXPERIMENTAL;async function i(n,s={}){return rUe(t,r).cancel(n,s)}return iUe(i)}});var dW=p((l8t,hW)=>{f();"use strict";var{getPubsubRouting:nUe}=T_(),sUe=Oe();hW.exports=({ipns:t,options:e})=>{let r=e.EXPERIMENTAL;async function i(n={}){try{return{enabled:Boolean(nUe(t,r))}}catch(s){return{enabled:!1}}}return sUe(i)}});var yW=p((f8t,pW)=>{f();"use strict";var{getPubsubRouting:oUe}=T_(),aUe=Oe();pW.exports=({ipns:t,options:e})=>{let r=e.EXPERIMENTAL;async function i(n={}){return oUe(t,r).getSubscriptions(n)}return aUe(i)}});var mW=p((h8t,bW)=>{f();"use strict";var cUe=fW(),uUe=dW(),lUe=yW(),gW=class{constructor({ipns:e,options:r}){this.cancel=cUe({ipns:e,options:r}),this.state=uUe({ipns:e,options:r}),this.subs=lUe({ipns:e,options:r})}};bW.exports=gW});var _W=p((d8t,wW)=>{f();"use strict";var fUe=eW(),hUe=oW(),dUe=mW(),vW=class{constructor({dns:e,ipns:r,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a,options:c}){this.publish=fUe({ipns:r,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a}),this.resolve=hUe({dns:e,ipns:r,peerId:s,isOnline:o,options:c}),this.pubsub=new dUe({ipns:r,options:c})}};wW.exports=vW});var xW=p((p8t,l5)=>{f();"use strict";var pUe=(At(),xt),{Errors:yUe}=Ft(),gUe=yUe.notFoundError().code,bUe=Oe(),EW=Jg(),{CID:SW}=(Ae(),Ce),R_={default:"<dst>",edges:"<src> -> <dst>"};l5.exports=function({repo:t,codecs:e,resolve:r,preload:i}){async function*n(s,o={}){if(o.maxDepth===0)return;if(o.edges&&o.format&&o.format!==R_.default)throw new Error("Cannot set edges to true and also specify format");o.format=o.edges?R_.edges:o.format,typeof o.maxDepth!="number"&&(o.maxDepth=o.recursive?1/0:1);let c=(Array.isArray(s)?s:[s]).map(l=>mUe(i,l,o));for(let l of c)yield*vUe(r,t,e,l,o)}return bUe(n)};l5.exports.Format=R_;function mUe(t,e,r){let{cid:i,path:n}=EW(e);return r.preload!==!1&&t(i),`/ipfs/${i}${n||""}`}async function*vUe(t,e,r,i,n){let s=await t(i),{cid:o}=EW(s),a=n.maxDepth!=null?n.maxDepth:1/0,c=n.unique||!1;for await(let l of _Ue(e,r,o,a,c))!l.parent||l.isDuplicate||(yield{ref:wUe(l.parent.cid,l.node.cid,l.node.name,n.format)})}function wUe(t,e,r="",i=R_.default){let n=i.replace(/<src>/g,t.toString());return n=n.replace(/<dst>/g,e.toString()),n=n.replace(/<linkname>/g,r),n}async function*_Ue(t,e,r,i,n){let s=new Set;async function*o(a,c){let l=c+1;if(!(l>i))try{for await(let u of EUe(t,e,a.cid))yield{parent:a,node:u,isDuplicate:n&&s.has(u.cid.toString())},n&&s.add(u.cid.toString()),yield*o(u,l)}catch(u){throw u.code===gUe&&(u.message=`Could not find object with CID: ${a.cid}`),u}}yield*o({cid:r},0)}async function*EUe(t,e,r,i=[]){let n=await t.blocks.get(r),o=(await e.getCodec(r.code)).decode(n),a=r.code===pUe.code;for(let[c,l]of u5(o,i)){if(a){let u=c.match(/^Links\/(\d+)\/Hash$/);if(u){let h=Number(u[1]);if(h<o.Links.length){yield{name:o.Links[h].Name,cid:l};continue}}}yield{name:c,cid:l}}}var u5=function*(t,e){if(t!=null&&!(t instanceof Uint8Array)){for(let[r,i]of Object.entries(t)){let n=[...e,r];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=SW.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*u5(o,a))}else{let s=SW.asCID(i);s?yield[n.join("/"),s]:yield*u5(i,n)}}return[]}}});var IW=p((y8t,AW)=>{f();"use strict";var SUe=Oe();AW.exports=function({repo:t}){async function*e(r={}){for await(let i of t.blocks.queryKeys({},{signal:r.signal}))yield{ref:i.toString()}}return SUe(e)}});var RW=p((g8t,TW)=>{f();"use strict";var xUe=Oe();TW.exports=({network:t})=>{async function e(r={}){let{bitswap:i}=await t.use(r),n=i.getWantlist();return Array.from(n).map(s=>s[1].cid)}return xUe(e)}});var CW=p((b8t,PW)=>{f();"use strict";var AUe=et(),IUe=Oe();PW.exports=({network:t})=>{async function e(r,i={}){let{bitswap:n}=await t.use(i),s=n.wantlistForPeer(AUe.createFromB58String(r));return Array.from(s).map(o=>o[1].cid)}return IUe(e)}});var kW=p((m8t,OW)=>{f();"use strict";var TUe=Oe();OW.exports=({network:t})=>{async function e(r,i={}){let{bitswap:n}=await t.use(i);return Array.isArray(r)||(r=[r]),n.unwant(r)}return TUe(e)}});var f5=p((v8t,qW)=>{f();"use strict";var RUe=Oe();qW.exports=({network:t})=>{async function e(r={}){let i=(await t.use(r)).bitswap,n=i.stat().snapshot;return{provideBufLen:parseInt(n.providesBufferLength.toString()),blocksReceived:BigInt(n.blocksReceived.toString()),wantlist:Array.from(i.getWantlist()).map(s=>s[1].cid),peers:i.peers().map(s=>s.toB58String()),dupBlksReceived:BigInt(n.dupBlksReceived.toString()),dupDataReceived:BigInt(n.dupDataReceived.toString()),dataReceived:BigInt(n.dataReceived.toString()),blocksSent:BigInt(n.blocksSent.toString()),dataSent:BigInt(n.dataSent.toString())}}return RUe(e)}});var DW=p((w8t,NW)=>{f();"use strict";var PUe=RW(),CUe=CW(),OUe=kW(),kUe=f5(),BW=class{constructor({network:e}){this.wantlist=PUe({network:e}),this.wantlistForPeer=CUe({network:e}),this.unwant=OUe({network:e}),this.stat=kUe({network:e})}};NW.exports=BW});var h5=p(MW=>{f();"use strict";var qUe=Sf().IPFS.matches;MW.isValidMultiaddr=t=>{try{return qUe(t)}catch(e){return!1}}});var UW=p((E8t,LW)=>{f();"use strict";var{isValidMultiaddr:BUe}=h5(),NUe=Oe();LW.exports=({repo:t})=>{async function e(r,i={}){if(!BUe(r))throw new Error(`${r} is not a valid Multiaddr`);let n=await t.config.getAll(i),s=n.Bootstrap||[];return s.push(r.toString()),n.Bootstrap=Array.from(new Set(s)).sort((o,a)=>o.localeCompare(a)),await t.config.replace(n),{Peers:[r]}}return NUe(e)}});var KW=p((S8t,FW)=>{f();"use strict";var DUe=Oe(),{Multiaddr:MUe}=tt();FW.exports=({repo:t})=>{async function e(r={}){let i=await t.config.getAll(r),n=i.Bootstrap||[];return i.Bootstrap=[],await t.config.replace(i),{Peers:n.map(s=>new MUe(s))}}return DUe(e)}});var VW=p((x8t,jW)=>{f();"use strict";var LUe=Oe(),{Multiaddr:UUe}=tt();jW.exports=({repo:t})=>{async function e(r={}){return{Peers:(await t.config.get("Bootstrap",r)||[]).map(n=>new UUe(n))}}return LUe(e)}});var P_=p((A8t,zW)=>{f();"use strict";zW.exports=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:200,HighWater:500},DisableNatPortMap:!0},Routing:{Type:"none"}})});var GW=p((I8t,$W)=>{f();"use strict";var HW=P_(),FUe=Oe(),{Multiaddr:KUe}=tt();$W.exports=({repo:t})=>{async function e(r={}){let i=await t.config.getAll(r);return i.Bootstrap=HW().Bootstrap,await t.config.replace(i),{Peers:HW().Bootstrap.map(n=>new KUe(n))}}return FUe(e)}});var YW=p((T8t,WW)=>{f();"use strict";var{isValidMultiaddr:jUe}=h5(),VUe=Oe();WW.exports=({repo:t})=>{async function e(r,i={}){if(!jUe(r))throw new Error(`${r} is not a valid Multiaddr`);let n=await t.config.getAll(i);return n.Bootstrap=(n.Bootstrap||[]).filter(s=>s.toString()!==r.toString()),await t.config.replace(n),{Peers:[r]}}return VUe(e)}});var ZW=p((R8t,QW)=>{f();"use strict";var zUe=UW(),HUe=KW(),$Ue=VW(),GUe=GW(),WUe=YW(),XW=class{constructor({repo:e}){this.add=zUe({repo:e}),this.list=$Ue({repo:e}),this.rm=WUe({repo:e}),this.clear=HUe({repo:e}),this.reset=GUe({repo:e})}};QW.exports=XW});var eY=p((P8t,JW)=>{f();"use strict";var YUe=Oe();JW.exports=({preload:t,repo:e})=>{async function r(i,n={}){return n.preload!==!1&&t(i),e.blocks.get(i,n)}return YUe(r)}});var rY=p((C8t,tY)=>{f();"use strict";var{CID:XUe}=(Ae(),Ce),QUe=Oe();tY.exports=({codecs:t,hashers:e,repo:r,preload:i})=>{async function n(s,o={}){let a=o.pin?await r.gcLock.readLock():null;try{let c=o.version!=null?o.version:0,l=o.format||(c===0?"dag-pb":"raw"),h=await(await e.getHasher(o.mhtype||"sha2-256")).digest(s),d=await t.getCodec(l),y=XUe.create(c,d.code,h);return await r.blocks.put(y,s,{signal:o.signal}),o.preload!==!1&&i(y),o.pin===!0&&await r.pins.pinRecursively(y,{signal:o.signal}),y}finally{a&&a()}}return QUe(n)}});var Tp=p((C_,iY)=>{f();(function(t,e){typeof C_=="object"&&typeof iY!="undefined"?e(C_):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis!="undefined"?globalThis:t||self,e(t.streamingIterables={}))})(C_,function(t){"use strict";async function*e(I,U){let V=[];for await(let N of U)V.push(N),V.length===I&&(yield V,V=[]);V.length>0&&(yield V)}function*r(I,U){let V=[];for(let N of U)V.push(N),V.length===I&&(yield V,V=[]);V.length>0&&(yield V)}function i(I,U){return U===void 0?V=>i(I,V):U[Symbol.asyncIterator]?e(I,U):r(I,U)}function n(I){if(typeof I.next=="function")return I;if(typeof I[Symbol.iterator]=="function")return I[Symbol.iterator]();if(typeof I[Symbol.asyncIterator]=="function")return I[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function s(){let I,U;return{promise:new Promise((N,Q)=>{U=N,I=Q}),reject:I,resolve:U}}function o(I,U){let V=n(U),N=[],Q=[],ee=!1,J=!1;function ue(){for(;Q.length>0&&N.length>0;){let Te=Q.shift(),{error:je,value:Ze}=N.shift();je?Te.reject(je):Te.resolve({done:!1,value:Ze})}for(;Q.length>0&&J;){let{resolve:Te}=Q.shift();Te({done:!0,value:void 0})}}async function ge(){if(!J&&!ee&&!(N.length>=I)){ee=!0;try{let{done:Te,value:je}=await V.next();Te?J=!0:N.push({value:je})}catch(Te){J=!0,N.push({error:Te})}ue(),ee=!1,ge()}}async function be(){if(N.length>0){let{error:je,value:Ze}=N.shift();if(je)throw je;return ge(),{done:!1,value:Ze}}if(J)return{done:!0,value:void 0};let Te=s();return Q.push(Te),ge(),Te.promise}let Ke={next:be,[Symbol.asyncIterator]:()=>Ke};return Ke}function*a(I,U){let V=[],N;try{for(let Q of U)V.push(Q),!(V.length<=I)&&(yield V.shift())}catch(Q){N=Q}for(let Q of V)yield Q;if(N)throw N}function c(I,U){return U===void 0?V=>c(I,V):I===0?U:U[Symbol.asyncIterator]?o(I,U):a(I,U)}async function l(I){let U=[];for await(let V of I)U.push(V);return U}function u(I){return I[Symbol.asyncIterator]?l(I):Array.from(I)}async function*h(I){for await(let U of I)yield*U}function*d(I){for(let U of I)yield*U}function y(...I){return I.find(V=>V[Symbol.asyncIterator]!==void 0)?h(I):d(I)}async function g(I){for await(let U of I);}function m(I){if(I[Symbol.asyncIterator])return g(I);for(let U of I);}async function*E(I,U){for await(let V of U)await I(V)&&(yield V)}function v(I,U){return U===void 0?V=>E(I,V):E(I,U)}async function*A(I){for await(let U of I)U&&typeof U!="string"&&(U[Symbol.iterator]||U[Symbol.asyncIterator])?yield*A(U):yield U}async function*R(I,U){for await(let V of U)yield await I(V)}function F(I,U){return U===void 0?V=>R(I,V):R(I,U)}function q(I,U){return U===void 0?V=>q(I,V):v(V=>V!=null,A(F(I,U)))}function B(I,U,V){let N=n(V),Q=[],ee=[],J=!1,ue=!1,ge=0,be=null;function Ke(){for(;ee.length>0&&Q.length>0;){let{resolve:Ve}=ee.shift(),pt=Q.shift();Ve({done:!1,value:pt})}for(;ee.length>0&&ge===0&&J;){let{resolve:Ve,reject:pt}=ee.shift();be?(pt(be),be=null):Ve({done:!0,value:void 0})}}async function Te(){if(J){Ke();return}if(!ue&&!(ge+Q.length>=I)){ue=!0,ge++;try{let{done:Ve,value:pt}=await N.next();Ve?(J=!0,ge--,Ke()):je(pt)}catch(Ve){J=!0,ge--,be=Ve,Ke()}ue=!1,Te()}}async function je(Ve){try{let pt=await U(Ve);if(pt&&pt[Symbol.asyncIterator])for await(let Ht of pt)Q.push(Ht);else Q.push(pt)}catch(pt){J=!0,be=pt}ge--,Ke(),Te()}async function Ze(){if(Q.length===0){let pt=s();return ee.push(pt),Te(),pt.promise}let Ve=Q.shift();return Te(),{done:!1,value:Ve}}let ze={next:Ze,[Symbol.asyncIterator]:()=>ze};return ze}function z(I,U,V){return U===void 0?(N,Q)=>Q?z(I,N,Q):z(I,N):V===void 0?N=>z(I,U,N):v(N=>N!=null,A(B(I,U,V)))}async function G(I){return new Promise(U=>{I.once("readable",()=>{U()})})}async function*Y(I){for(;;){let U=I.read();if(U!==null){yield U;continue}if(I._readableState.ended)break;await G(I)}}function P(I){return typeof I[Symbol.asyncIterator]=="function"?I:Y(I)}async function*b(...I){let U=new Set(I.map(n));for(;U.size>0;)for(let V of U){let N=await V.next();N.done?U.delete(V):yield N.value}}function w(I,...U){let V=I();for(let N of U)V=N(V);return V}async function*S(I,U,V){let N=null,Q=ge=>({value:U(ge)}),ee=async function*(ge){for await(let be of ge){if(N)return;yield be}},J=w(()=>V,c(1),ee,F(Q),c(I-1)),ue=n(J);for(;;){let{value:ge,done:be}=await ue.next();if(be)break;try{let Ke=await ge.value;N||(yield Ke)}catch(Ke){N=Ke}}if(N)throw N}function C(I,U,V){return U===void 0?(N,Q)=>C(I,N,Q):V===void 0?N=>C(I,U,N):I===1?F(U,V):S(I,U,V)}function D(I,U,V){return U===void 0?(N,Q)=>Q?D(I,N,Q):D(I,N):V===void 0?N=>D(I,U,N):v(N=>N!=null,A(C(I,U,V)))}async function*W(...I){let U=I.map(n),V=new Set,N=new Map,Q=null,ee=null,J=null,ue=Te=>{Q=Te,ee&&ee(Te)},ge=Te=>{J&&J(Te)},be=()=>new Promise((Te,je)=>{if(Q&&je(Q),N.size>0)return Te();J=Te,ee=je}),Ke=Te=>{let je=Promise.resolve(Te.next()).then(async({done:Ze,value:ze})=>{Ze||N.set(Te,ze),V.delete(je)});V.add(je),je.then(ge,ue)};for(let Te of U)Ke(Te);for(;;){if(V.size===0&&N.size===0)return;await be();for(let[Te,je]of N)N.delete(Te),yield je,Ke(Te)}}async function j(I,U,V){let N=U;for await(let Q of V)N=await I(N,Q);return N}function M(I,U,V){return U===void 0?(N,Q)=>Q?j(I,N,Q):M(I,N):V===void 0?N=>M(I,U,N):j(I,U,V)}async function*_(I,U){let V=0;for await(let N of U)if(yield await N,V++,V>=I)break}function*L(I,U){let V=0;for(let N of U)if(yield N,V++,V>=I)break}function ce(I,U){return U===void 0?V=>ce(I,V):U[Symbol.asyncIterator]?_(I,U):L(I,U)}async function*X(I,U){for await(let V of U)await I(V),yield V}function ne(I,U){return U===void 0?V=>X(I,V):X(I,U)}function oe(I,U){let V=I[0]+U[0],N=I[1]+U[1];if(N>=1e9){let Q=N%1e9;V+=(N-Q)/1e9,N=Q}return[V,N]}async function*de(I,U){let V=U[Symbol.asyncIterator](),N=[0,0];for(;;){let Q=process.hrtime(),{value:ee,done:J}=await V.next(),ue=process.hrtime(Q);if(N=oe(N,ue),I.progress&&I.progress(ue,N),J)return I.total&&I.total(N),ee;yield ee}}function*pe(I,U){let V=U[Symbol.iterator](),N=[0,0];for(;;){let Q=process.hrtime(),{value:ee,done:J}=V.next(),ue=process.hrtime(Q);if(N=oe(N,ue),I.progress&&I.progress(ue,N),J)return I.total&&I.total(N),ee;yield ee}}function _e(I={},U){return U===void 0?V=>_e(I,V):U[Symbol.asyncIterator]!==void 0?de(I,U):pe(I,U)}function k(I,U,V){let N=n(V),Q=[],ee=[],J=!1,ue=!1,ge=0,be=null;function Ke(){for(;ee.length>0&&Q.length>0;){let{resolve:Ve}=ee.shift(),pt=Q.shift();Ve({done:!1,value:pt})}for(;ee.length>0&&ge===0&&J;){let{resolve:Ve,reject:pt}=ee.shift();be?(pt(be),be=null):Ve({done:!0,value:void 0})}}async function Te(){if(J){Ke();return}if(!ue&&!(ge+Q.length>=I)){ue=!0,ge++;try{let{done:Ve,value:pt}=await N.next();Ve?(J=!0,ge--,Ke()):je(pt)}catch(Ve){J=!0,ge--,be=Ve,Ke()}ue=!1,Te()}}async function je(Ve){try{let pt=await U(Ve);Q.push(pt)}catch(pt){J=!0,be=pt}ge--,Ke(),Te()}async function Ze(){if(Q.length===0){let pt=s();return ee.push(pt),Te(),pt.promise}let Ve=Q.shift();return Te(),{done:!1,value:Ve}}let ze={next:Ze,[Symbol.asyncIterator]:()=>ze};return ze}function K(I,U,V){return U===void 0?(N,Q)=>Q?K(I,N,Q):K(I,N):V===void 0?N=>K(I,U,N):k(I,U,V)}async function $(I,U){let V=null,N=null,Q=null,ee=be=>{V=be,N&&N(be)},J=()=>{Q&&Q()},ue=()=>{I.removeListener("error",ee),I.removeListener("drain",J)};I.once("error",ee);let ge=()=>new Promise((be,Ke)=>{if(V)return Ke(V);I.once("drain",J),Q=be,N=Ke});for await(let be of U)if(I.write(be)===!1&&await ge(),V)break;if(ue(),V)throw V}function Z(I,U){return U===void 0?V=>$(I,V):$(I,U)}t.batch=i,t.buffer=c,t.collect=u,t.concat=y,t.consume=m,t.filter=v,t.flatMap=q,t.flatTransform=z,t.flatten=A,t.fromStream=P,t.getIterator=n,t.map=F,t.merge=b,t.parallelFlatMap=D,t.parallelMap=C,t.parallelMerge=W,t.pipeline=w,t.reduce=M,t.take=ce,t.tap=ne,t.time=_e,t.transform=K,t.writeToStream=Z,Object.defineProperty(t,"__esModule",{value:!0})})});var p5=p(nY=>{f();"use strict";var{CID:d5}=(Ae(),Ce),ZUe=ae();nY.cleanCid=t=>{if(t instanceof d5)return t;if(typeof t=="string")return d5.parse(t);if(t instanceof Uint8Array)return d5.decode(t);throw ZUe(new Error("Invalid CID"),"ERR_INVALID_CID")}});var oY=p((k8t,sY)=>{f();"use strict";var JUe=ae(),{parallelMap:eFe,filter:tFe}=Tp(),{pipe:rFe}=Pr(),{cleanCid:iFe}=p5(),nFe=Oe(),sFe=8;sY.exports=({repo:t})=>{async function*e(r,i={}){Array.isArray(r)||(r=[r]);let n=await t.gcLock.writeLock();try{yield*rFe(r,eFe(sFe,async s=>{s=iFe(s);let o={cid:s};try{if(!await t.blocks.has(s))throw JUe(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await t.blocks.delete(s)}catch(a){i.force||(a.message=`cannot remove ${s}: ${a.message}`,o.error=a)}return o}),tFe(()=>!i.quiet))}finally{n()}}return nFe(e)}});var cY=p((q8t,aY)=>{f();"use strict";var{cleanCid:oFe}=p5(),aFe=Oe();aY.exports=({repo:t,preload:e})=>{async function r(i,n={}){i=oFe(i),n.preload!==!1&&e(i);let s=await t.blocks.get(i);return{cid:i,size:s.length}}return aFe(r)}});var fY=p((B8t,lY)=>{f();"use strict";var cFe=eY(),uFe=rY(),lFe=oY(),fFe=cY(),uY=class{constructor({codecs:e,hashers:r,preload:i,repo:n}){this.get=cFe({preload:i,repo:n}),this.put=uFe({codecs:e,hashers:r,preload:i,repo:n}),this.rm=lFe({repo:n}),this.stat=fFe({preload:i,repo:n})}};lY.exports=uY});var dY=p((N8t,hY)=>{f();"use strict";var hFe=$n();hY.exports=({addAll:t})=>{async function e(r,i={}){let n=await hFe(t(r,i));if(n==null)throw Error("Failed to add a file, if you see this please report a bug");return n}return e}});var pY=p((Sb,O_)=>{f();(function(t,e){"use strict";var r={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(y){if(!Array.isArray(y)&&!ArrayBuffer.isView(y))return!1;for(var g=0;g<y.length;g++)if(!Number.isInteger(y[g])||y[g]<0||y[g]>255)return!1;return!0}function n(y,g){return(y&65535)*g+(((y>>>16)*g&65535)<<16)}function s(y,g){return y<<g|y>>>32-g}function o(y){return y^=y>>>16,y=n(y,2246822507),y^=y>>>13,y=n(y,3266489909),y^=y>>>16,y}function a(y,g){y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var m=[0,0,0,0];return m[3]+=y[3]+g[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=y[2]+g[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=y[1]+g[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=y[0]+g[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function c(y,g){y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var m=[0,0,0,0];return m[3]+=y[3]*g[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=y[2]*g[3],m[1]+=m[2]>>>16,m[2]&=65535,m[2]+=y[3]*g[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=y[1]*g[3],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=y[2]*g[2],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=y[3]*g[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=y[0]*g[3]+y[1]*g[2]+y[2]*g[1]+y[3]*g[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function l(y,g){return g%=64,g===32?[y[1],y[0]]:g<32?[y[0]<<g|y[1]>>>32-g,y[1]<<g|y[0]>>>32-g]:(g-=32,[y[1]<<g|y[0]>>>32-g,y[0]<<g|y[1]>>>32-g])}function u(y,g){return g%=64,g===0?y:g<32?[y[0]<<g|y[1]>>>32-g,y[1]<<g]:[y[1]<<g-32,0]}function h(y,g){return[y[0]^g[0],y[1]^g[1]]}function d(y){return y=h(y,[0,y[0]>>>1]),y=c(y,[4283543511,3981806797]),y=h(y,[0,y[0]>>>1]),y=c(y,[3301882366,444984403]),y=h(y,[0,y[0]>>>1]),y}r.x86.hash32=function(y,g){if(r.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%4,E=y.length-m,v=g,A=0,R=3432918353,F=461845907,q=0;q<E;q=q+4)A=y[q]|y[q+1]<<8|y[q+2]<<16|y[q+3]<<24,A=n(A,R),A=s(A,15),A=n(A,F),v^=A,v=s(v,13),v=n(v,5)+3864292196;switch(A=0,m){case 3:A^=y[q+2]<<16;case 2:A^=y[q+1]<<8;case 1:A^=y[q],A=n(A,R),A=s(A,15),A=n(A,F),v^=A}return v^=y.length,v=o(v),v>>>0},r.x86.hash128=function(y,g){if(r.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%16,E=y.length-m,v=g,A=g,R=g,F=g,q=0,B=0,z=0,G=0,Y=597399067,P=2869860233,b=951274213,w=2716044179,S=0;S<E;S=S+16)q=y[S]|y[S+1]<<8|y[S+2]<<16|y[S+3]<<24,B=y[S+4]|y[S+5]<<8|y[S+6]<<16|y[S+7]<<24,z=y[S+8]|y[S+9]<<8|y[S+10]<<16|y[S+11]<<24,G=y[S+12]|y[S+13]<<8|y[S+14]<<16|y[S+15]<<24,q=n(q,Y),q=s(q,15),q=n(q,P),v^=q,v=s(v,19),v+=A,v=n(v,5)+1444728091,B=n(B,P),B=s(B,16),B=n(B,b),A^=B,A=s(A,17),A+=R,A=n(A,5)+197830471,z=n(z,b),z=s(z,17),z=n(z,w),R^=z,R=s(R,15),R+=F,R=n(R,5)+2530024501,G=n(G,w),G=s(G,18),G=n(G,Y),F^=G,F=s(F,13),F+=v,F=n(F,5)+850148119;switch(q=0,B=0,z=0,G=0,m){case 15:G^=y[S+14]<<16;case 14:G^=y[S+13]<<8;case 13:G^=y[S+12],G=n(G,w),G=s(G,18),G=n(G,Y),F^=G;case 12:z^=y[S+11]<<24;case 11:z^=y[S+10]<<16;case 10:z^=y[S+9]<<8;case 9:z^=y[S+8],z=n(z,b),z=s(z,17),z=n(z,w),R^=z;case 8:B^=y[S+7]<<24;case 7:B^=y[S+6]<<16;case 6:B^=y[S+5]<<8;case 5:B^=y[S+4],B=n(B,P),B=s(B,16),B=n(B,b),A^=B;case 4:q^=y[S+3]<<24;case 3:q^=y[S+2]<<16;case 2:q^=y[S+1]<<8;case 1:q^=y[S],q=n(q,Y),q=s(q,15),q=n(q,P),v^=q}return v^=y.length,A^=y.length,R^=y.length,F^=y.length,v+=A,v+=R,v+=F,A+=v,R+=v,F+=v,v=o(v),A=o(A),R=o(R),F=o(F),v+=A,v+=R,v+=F,A+=v,R+=v,F+=v,("00000000"+(v>>>0).toString(16)).slice(-8)+("00000000"+(A>>>0).toString(16)).slice(-8)+("00000000"+(R>>>0).toString(16)).slice(-8)+("00000000"+(F>>>0).toString(16)).slice(-8)},r.x64.hash128=function(y,g){if(r.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%16,E=y.length-m,v=[0,g],A=[0,g],R=[0,0],F=[0,0],q=[2277735313,289559509],B=[1291169091,658871167],z=0;z<E;z=z+16)R=[y[z+4]|y[z+5]<<8|y[z+6]<<16|y[z+7]<<24,y[z]|y[z+1]<<8|y[z+2]<<16|y[z+3]<<24],F=[y[z+12]|y[z+13]<<8|y[z+14]<<16|y[z+15]<<24,y[z+8]|y[z+9]<<8|y[z+10]<<16|y[z+11]<<24],R=c(R,q),R=l(R,31),R=c(R,B),v=h(v,R),v=l(v,27),v=a(v,A),v=a(c(v,[0,5]),[0,1390208809]),F=c(F,B),F=l(F,33),F=c(F,q),A=h(A,F),A=l(A,31),A=a(A,v),A=a(c(A,[0,5]),[0,944331445]);switch(R=[0,0],F=[0,0],m){case 15:F=h(F,u([0,y[z+14]],48));case 14:F=h(F,u([0,y[z+13]],40));case 13:F=h(F,u([0,y[z+12]],32));case 12:F=h(F,u([0,y[z+11]],24));case 11:F=h(F,u([0,y[z+10]],16));case 10:F=h(F,u([0,y[z+9]],8));case 9:F=h(F,[0,y[z+8]]),F=c(F,B),F=l(F,33),F=c(F,q),A=h(A,F);case 8:R=h(R,u([0,y[z+7]],56));case 7:R=h(R,u([0,y[z+6]],48));case 6:R=h(R,u([0,y[z+5]],40));case 5:R=h(R,u([0,y[z+4]],32));case 4:R=h(R,u([0,y[z+3]],24));case 3:R=h(R,u([0,y[z+2]],16));case 2:R=h(R,u([0,y[z+1]],8));case 1:R=h(R,[0,y[z]]),R=c(R,q),R=l(R,31),R=c(R,B),v=h(v,R)}return v=h(v,[0,y.length]),A=h(A,[0,y.length]),v=a(v,A),A=a(A,v),v=d(v),A=d(A),v=a(v,A),A=a(A,v),("00000000"+(v[0]>>>0).toString(16)).slice(-8)+("00000000"+(v[1]>>>0).toString(16)).slice(-8)+("00000000"+(A[0]>>>0).toString(16)).slice(-8)+("00000000"+(A[1]>>>0).toString(16)).slice(-8)},typeof Sb!="undefined"?(typeof O_!="undefined"&&O_.exports&&(Sb=O_.exports=r),Sb.murmurHash3=r):typeof define=="function"&&define.amd?define([],function(){return r}):(r._murmurHash3=t.murmurHash3,r.noConflict=function(){return t.murmurHash3=r._murmurHash3,r._murmurHash3=e,r.noConflict=e,r},t.murmurHash3=r)})(Sb)});var y5=p((D8t,yY)=>{f();yY.exports=pY()});var k_=p((M8t,gY)=>{f();"use strict";var dFe=wr().bind({ignoreUndefined:!0}),{sha256:pFe}=(ai(),$r),yFe=y5(),gFe=ct();async function bFe(t){return gFe(yFe.x64.hash128(t),"base16").slice(0,8).reverse()}var mFe={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:pFe,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:17437180132763652,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:bFe,hamtHashCode:34,hamtBucketBits:8};gY.exports=function(t={}){return dFe(mFe,t)}});var Lf=p((L8t,vY)=>{f();"use strict";var{CID:vFe}=(Ae(),Ce),bY=(At(),xt),{sha256:mY}=(ai(),$r),wFe=async(t,e,r)=>{r.codec||(r.codec=bY),r.hasher||(r.hasher=mY),r.cidVersion===void 0&&(r.cidVersion=1),r.codec===bY&&r.hasher!==mY&&(r.cidVersion=1);let i=await r.hasher.digest(t),n=vFe.create(r.cidVersion,r.codec.code,i);return r.onlyHash||await e.put(n,t,{signal:r.signal}),n};vY.exports=wFe});var _Y=p((U8t,wY)=>{f();"use strict";var{UnixFS:_Fe}=Ei(),EFe=Lf(),{encode:SFe,prepare:xFe}=(At(),xt),AFe=async(t,e,r)=>{let i=new _Fe({type:"directory",mtime:t.mtime,mode:t.mode}),n=SFe(xFe({Data:i.marshal()})),s=await EFe(n,e,r),o=t.path;return{cid:s,path:o,unixfs:i,size:n.length}};wY.exports=AFe});var SY=p((F8t,EY)=>{f();"use strict";var IFe=rp();EY.exports=async function(t,e){return e(await IFe(t))}});var IY=p((K8t,AY)=>{f();"use strict";var TFe=u_();function RFe(t,e,r){return xY(t,e,r)}async function xY(t,e,r){let i=[];for await(let n of TFe(t,r.maxChildrenPerNode))i.push(await e(n));return i.length>1?xY(i,e,r):i[0]}AY.exports=RFe});var PY=p((j8t,RY)=>{f();"use strict";var PFe=u_();RY.exports=async function(e,r,i){let n=new TY(i.layerRepeat),s=0,o=1,a=n;for await(let c of PFe(e,i.maxChildrenPerNode))a.isFull()&&(a!==n&&n.addChild(await a.reduce(r)),s&&s%i.layerRepeat==0&&o++,a=new g5(o,i.layerRepeat,s),s++),a.append(c);return a&&a!==n&&n.addChild(await a.reduce(r)),n.reduce(r)};var g5=class{constructor(e,r,i=0){this.maxDepth=e,this.layerRepeat=r,this.currentDepth=1,this.iteration=i,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let e=this._findParent(this.node,this.currentDepth);return e?(this._addNextNodeToParent(e),!1):!0}_addNextNodeToParent(e){this.parent=e;let r={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(r),this.currentDepth=r.depth,this.node=r}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,r){let i=[];return e.children.length&&(i=await Promise.all(e.children.filter(n=>n.data).map(n=>this._reduce(n,r)))),r((e.data||[]).concat(i))}_findParent(e,r){let i=e.parent;if(!(!i||i.depth===0))return i.children.length===i.maxChildren||!i.maxChildren?this._findParent(i,r):i}},TY=class extends g5{constructor(e){super(0,e);this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}});var kY=p((V8t,OY)=>{f();"use strict";var{UnixFS:CFe}=Ei(),OFe=Lf(),CY=(At(),xt),kFe=(Rs(),ns);async function*qFe(t,e,r){for await(let i of t.content)yield async()=>{r.progress(i.length,t.path);let n,s={codec:CY,cidVersion:r.cidVersion,hasher:r.hasher,onlyHash:r.onlyHash};return r.rawLeaves?(s.codec=kFe,s.cidVersion=1):(n=new CFe({type:r.leafType,data:i,mtime:t.mtime,mode:t.mode}),i=CY.encode({Data:n.marshal(),Links:[]})),{cid:await OFe(i,e,s),unixfs:n,size:i.length}}}OY.exports=qFe});var LY=p((z8t,MY)=>{f();"use strict";var BFe=ae(),{UnixFS:qY}=Ei(),BY=Lf(),{encode:NY,prepare:DY}=(At(),xt),NFe=l_(),b5=(Rs(),ns),DFe=(At(),xt),MFe={flat:SY(),balanced:IY(),trickle:PY()};async function*LFe(t,e,r){let i=-1,n,s;typeof r.bufferImporter=="function"?s=r.bufferImporter:s=kY();for await(let o of NFe(s(t,e,r),r.blockWriteConcurrency)){if(i++,i===0){n=o;continue}else i===1&&n&&(yield n,n=null);yield o}n&&(n.single=!0,yield n)}var UFe=(t,e,r)=>{async function i(n){if(n.length===1&&n[0].single&&r.reduceSingleLeafToSelf){let u=n[0];if(u.cid.code===b5.code&&(t.mtime!==void 0||t.mode!==void 0)){let h=await e.get(u.cid);u.unixfs=new qY({type:"file",mtime:t.mtime,mode:t.mode,data:h}),h=NY(DY({Data:u.unixfs.marshal()})),u.cid=await BY(h,e,{...r,codec:DFe,hasher:r.hasher,cidVersion:r.cidVersion}),u.size=h.length}return{cid:u.cid,path:t.path,unixfs:u.unixfs,size:u.size}}let s=new qY({type:"file",mtime:t.mtime,mode:t.mode}),o=n.filter(u=>u.cid.code===b5.code&&u.size||u.unixfs&&!u.unixfs.data&&u.unixfs.fileSize()?!0:Boolean(u.unixfs&&u.unixfs.data&&u.unixfs.data.length)).map(u=>u.cid.code===b5.code?(s.addBlockSize(u.size),{Name:"",Tsize:u.size,Hash:u.cid}):(!u.unixfs||!u.unixfs.data?s.addBlockSize(u.unixfs&&u.unixfs.fileSize()||0):s.addBlockSize(u.unixfs.data.length),{Name:"",Tsize:u.size,Hash:u.cid})),a={Data:s.marshal(),Links:o},c=NY(DY(a));return{cid:await BY(c,e,r),path:t.path,unixfs:s,size:c.length+a.Links.reduce((u,h)=>u+h.Tsize,0)}}return i};function FFe(t,e,r){let i=MFe[r.strategy];if(!i)throw BFe(new Error(`Unknown importer build strategy name: ${r.strategy}`),"ERR_BAD_STRATEGY");return i(LFe(t,e,r),UFe(t,e,r),r)}MY.exports=FFe});var m5=p((H8t,FY)=>{f();"use strict";var{Buffer:Bo}=ft(),UY=Symbol.for("BufferList");function or(t){if(!(this instanceof or))return new or(t);or._init.call(this,t)}or._init=function(e){Object.defineProperty(this,UY,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};or.prototype._new=function(e){return new or(e)};or.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};or.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};or.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};or.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};or.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Bo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,l=s&&r||0,u=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Bo.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,l),l+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-u)return s?this._bufs[o[0]].copy(e,r,u,u+c):this._bufs[o[0]].slice(u,u+c);s||(e=Bo.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-u;if(c>d)this._bufs[h].copy(e,l,u),l+=d;else{this._bufs[h].copy(e,l,u,u+c),l+=d;break}c-=d,u&&(u=0)}return e.length>l?e.slice(0,l):e};or.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};or.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};or.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};or.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};or.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Bo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Bo.from(e));return this};or.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};or.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Bo.from([t]):typeof t=="string"?t=Bo.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Bo.from(t.buffer,t.byteOffset,t.byteLength):Bo.isBuffer(t)||(t=Bo.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,t))return c;s++}s=0}return-1};or.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?or.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:or.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();or.prototype._isBufferList=function(e){return e instanceof or||or.isBufferList(e)};or.isBufferList=function(e){return e!=null&&e[UY]};FY.exports=or});var VY=p(($8t,jY)=>{f();var KY=class{constructor(e,r=12,i=8*1024,n=32*1024,s=64,o){this.bits=r,this.min=i,this.max=n,this.asModule=e,this.rabin=new e.Rabin(r,i,n,s,o),this.polynomial=o}fingerprint(e){let{__retain:r,__release:i,__allocArray:n,__getInt32Array:s,Int32Array_ID:o,Uint8Array_ID:a}=this.asModule,c=new Int32Array(Math.ceil(e.length/this.min)),l=r(n(o,c)),u=r(n(a,e)),h=this.rabin.fingerprint(u,l),d=s(h);i(u),i(l);let y=d.indexOf(0);return y>=0?d.subarray(0,y):d}};jY.exports=KY});var rX=p(Ib=>{f();"use strict";var v5=-8,q_=-4,KFe=0,zY=1,HY=1<<0,B_=1<<1,G8t=1<<2,W8t=1<<3,$Y=5,Y8t=1<<$Y,GY=1<<10,WY=1<<11,X8t=1<<12,jFe=1<<13,YY=14,Q8t=1<<YY,Z8t=1<<19,J8t=1<<20,ePt=1<<21,tPt=1<<22,VFe=0,w5=4,zFe=8,HFe=12,XY=12,$Fe=16,GFe=typeof BigUint64Array!="undefined",xb=Symbol(),Ab=1024;function QY(t,e){let r=new Uint32Array(t),i=new Uint16Array(t);var n=r[e+q_>>>2]>>>1,s=e>>>1;if(n<=Ab)return String.fromCharCode.apply(String,i.subarray(s,s+n));let o=[];do{let a=i[s+Ab-1],c=a>=55296&&a<56320?Ab-1:Ab;o.push(String.fromCharCode.apply(String,i.subarray(s,s+=c))),n-=c}while(n>Ab);return o.join("")+String.fromCharCode.apply(String,i.subarray(s,s+n))}function _5(t){let e={};function r(n,s){return n?QY(n.buffer,s):"<yet unknown>"}let i=t.env=t.env||{};return i.abort=i.abort||function(s,o,a,c){let l=e.memory||i.memory;throw Error("abort: "+r(l,s)+" at "+r(l,o)+":"+a+":"+c)},i.trace=i.trace||function(s,o){let a=e.memory||i.memory;console.log("trace: "+r(a,s)+(o?" ":"")+Array.prototype.slice.call(arguments,2,2+o).join(", "))},t.Math=t.Math||Math,t.Date=t.Date||Date,e}function E5(t,e){let r=e.exports,i=r.memory,n=r.table,s=r.__alloc,o=r.__retain,a=r.__rtti_base||~0;function c(B){let z=new Uint32Array(i.buffer),G=z[a>>>2];if((B>>>=0)>=G)throw Error("invalid id: "+B);return z[(a+4>>>2)+B*2]}function l(B){let z=new Uint32Array(i.buffer),G=z[a>>>2];if((B>>>=0)>=G)throw Error("invalid id: "+B);return z[(a+4>>>2)+B*2+1]}function u(B){return 31-Math.clz32(B>>>$Y&31)}function h(B){return 31-Math.clz32(B>>>YY&31)}function d(B){let z=B.length,G=s(z<<1,zY),Y=new Uint16Array(i.buffer);for(var P=0,b=G>>>1;P<z;++P)Y[b+P]=B.charCodeAt(P);return G}t.__allocString=d;function y(B){let z=i.buffer;if(new Uint32Array(z)[B+v5>>>2]!==zY)throw Error("not a string: "+B);return QY(z,B)}t.__getString=y;function g(B,z,G){let Y=i.buffer;if(G)switch(B){case 2:return new Float32Array(Y);case 3:return new Float64Array(Y)}else switch(B){case 0:return new(z?Int8Array:Uint8Array)(Y);case 1:return new(z?Int16Array:Uint16Array)(Y);case 2:return new(z?Int32Array:Uint32Array)(Y);case 3:return new(z?BigInt64Array:BigUint64Array)(Y)}throw Error("unsupported align: "+B)}function m(B,z){let G=c(B);if(!(G&(HY|B_)))throw Error("not an array: "+B+" @ "+G);let Y=u(G),P=z.length,b=s(P<<Y,KFe),w=s(G&B_?$Fe:HFe,B),S=new Uint32Array(i.buffer);S[w+VFe>>>2]=o(b),S[w+w5>>>2]=b,S[w+zFe>>>2]=P<<Y,G&B_&&(S[w+XY>>>2]=P);let C=g(Y,G&GY,G&WY);if(G&jFe)for(let D=0;D<P;++D)C[(b>>>Y)+D]=o(z[D]);else C.set(z,b>>>Y);return w}t.__allocArray=m;function E(B){let z=new Uint32Array(i.buffer),G=z[B+v5>>>2],Y=c(G);if(!(Y&HY))throw Error("not an array: "+G);let P=u(Y);var b=z[B+w5>>>2];let w=Y&B_?z[B+XY>>>2]:z[b+q_>>>2]>>>P;return g(P,Y&GY,Y&WY).subarray(b>>>=P,b+w)}t.__getArrayView=E;function v(B){let z=E(B),G=z.length,Y=new Array(G);for(let P=0;P<G;P++)Y[P]=z[P];return Y}t.__getArray=v;function A(B){let z=i.buffer,G=new Uint32Array(z)[B+q_>>>2];return z.slice(B,B+G)}t.__getArrayBuffer=A;function R(B,z,G){return new B(F(B,z,G))}function F(B,z,G){let Y=i.buffer,P=new Uint32Array(Y),b=P[G+w5>>>2];return new B(Y,b,P[b+q_>>>2]>>>z)}t.__getInt8Array=R.bind(null,Int8Array,0),t.__getInt8ArrayView=F.bind(null,Int8Array,0),t.__getUint8Array=R.bind(null,Uint8Array,0),t.__getUint8ArrayView=F.bind(null,Uint8Array,0),t.__getUint8ClampedArray=R.bind(null,Uint8ClampedArray,0),t.__getUint8ClampedArrayView=F.bind(null,Uint8ClampedArray,0),t.__getInt16Array=R.bind(null,Int16Array,1),t.__getInt16ArrayView=F.bind(null,Int16Array,1),t.__getUint16Array=R.bind(null,Uint16Array,1),t.__getUint16ArrayView=F.bind(null,Uint16Array,1),t.__getInt32Array=R.bind(null,Int32Array,2),t.__getInt32ArrayView=F.bind(null,Int32Array,2),t.__getUint32Array=R.bind(null,Uint32Array,2),t.__getUint32ArrayView=F.bind(null,Uint32Array,2),GFe&&(t.__getInt64Array=R.bind(null,BigInt64Array,3),t.__getInt64ArrayView=F.bind(null,BigInt64Array,3),t.__getUint64Array=R.bind(null,BigUint64Array,3),t.__getUint64ArrayView=F.bind(null,BigUint64Array,3)),t.__getFloat32Array=R.bind(null,Float32Array,2),t.__getFloat32ArrayView=F.bind(null,Float32Array,2),t.__getFloat64Array=R.bind(null,Float64Array,3),t.__getFloat64ArrayView=F.bind(null,Float64Array,3);function q(B,z){let G=new Uint32Array(i.buffer);var Y=G[B+v5>>>2];if(Y<=G[a>>>2])do if(Y==z)return!0;while(Y=l(Y));return!1}return t.__instanceof=q,t.memory=t.memory||i,t.table=t.table||n,tX(r,t)}function ZY(t){return typeof Response!="undefined"&&t instanceof Response}async function JY(t,e){return ZY(t=await t)?eX(t,e):E5(_5(e||(e={})),await WebAssembly.instantiate(t instanceof WebAssembly.Module?t:await WebAssembly.compile(t),e))}Ib.instantiate=JY;function WFe(t,e){return E5(_5(e||(e={})),new WebAssembly.Instance(t instanceof WebAssembly.Module?t:new WebAssembly.Module(t),e))}Ib.instantiateSync=WFe;async function eX(t,e){return WebAssembly.instantiateStreaming?E5(_5(e||(e={})),(await WebAssembly.instantiateStreaming(t,e)).instance):JY(ZY(t=await t)?t.arrayBuffer():t,e)}Ib.instantiateStreaming=eX;function tX(t,e){var r=e?Object.create(e):{},i=t.__argumentsLength?function(n){t.__argumentsLength.value=n}:t.__setArgumentsLength||t.__setargc||function(){};for(let n in t){if(!Object.prototype.hasOwnProperty.call(t,n))continue;let s=t[n],o=n.split("."),a=r;for(;o.length>1;){let u=o.shift();Object.prototype.hasOwnProperty.call(a,u)||(a[u]={}),a=a[u]}let c=o[0],l=c.indexOf("#");if(l>=0){let u=c.substring(0,l),h=a[u];if(typeof h=="undefined"||!h.prototype){let d=function(...y){return d.wrap(d.prototype.constructor(0,...y))};d.prototype={valueOf:function(){return this[xb]}},d.wrap=function(y){return Object.create(d.prototype,{[xb]:{value:y,writable:!1}})},h&&Object.getOwnPropertyNames(h).forEach(y=>Object.defineProperty(d,y,Object.getOwnPropertyDescriptor(h,y))),a[u]=d}if(c=c.substring(l+1),a=a[u].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(a,c=c.substring(4))){let d=t[n.replace("set:","get:")],y=t[n.replace("get:","set:")];Object.defineProperty(a,c,{get:function(){return d(this[xb])},set:function(g){y(this[xb],g)},enumerable:!0})}}else c==="constructor"?(a[c]=(...d)=>(i(d.length),s(...d))).original=s:(a[c]=function(...d){return i(d.length),s(this[xb],...d)}).original=s}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(a,c=c.substring(4))||Object.defineProperty(a,c,{get:t[n.replace("set:","get:")],set:t[n.replace("get:","set:")],enumerable:!0}):typeof s=="function"&&s!==i?(a[c]=(...u)=>(i(u.length),s(...u))).original=s:a[c]=s}return r}Ib.demangle=tX});var nX=p((iPt,iX)=>{f();var{instantiate:YFe}=rX();S5.supported=typeof WebAssembly!="undefined";function S5(t={}){if(!S5.supported)return null;var e=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return YFe(new Response(new Blob([e],{type:"application/wasm"})),t)}iX.exports=S5});var aX=p((nPt,oX)=>{f();var sX=VY(),XFe=nX(),QFe=async(t,e,r,i,n)=>{let s=await XFe();return new sX(s,t,e,r,i,n)};oX.exports={Rabin:sX,create:QFe}});var lX=p((sPt,uX)=>{f();"use strict";var ZFe=m5(),{create:JFe}=aX(),cX=ae();uX.exports=async function*(e,r){let i,n,s;if(r.minChunkSize&&r.maxChunkSize&&r.avgChunkSize)s=r.avgChunkSize,i=r.minChunkSize,n=r.maxChunkSize;else if(r.avgChunkSize)s=r.avgChunkSize,i=s/3,n=s+s/2;else throw cX(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(i<16)throw cX(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");n<i&&(n=i),s<i&&(s=i);let o=Math.floor(Math.log2(s));for await(let a of eKe(e,{min:i,max:n,bits:o,window:r.window,polynomial:r.polynomial}))yield a};async function*eKe(t,e){let r=await JFe(e.bits,e.min,e.max,e.window),i=new ZFe;for await(let n of t){i.append(n);let s=r.fingerprint(n);for(let o=0;o<s.length;o++){let a=s[o],c=i.slice(0,a);i.consume(a),yield c}}i.length&&(yield i.slice(0))}});var hX=p((oPt,fX)=>{f();"use strict";var x5=m5();fX.exports=async function*(e,r){let i=new x5,n=0,s=!1,o=r.maxChunkSize;for await(let a of e)for(i.append(a),n+=a.length;n>=o;)if(yield i.slice(0,o),s=!0,o===i.length)i=new x5,n=0;else{let c=new x5;c.append(i.shallowSlice(o)),i=c,n-=o}(!s||n)&&(yield i.slice(0,n))}});var yX=p((aPt,pX)=>{f();"use strict";var dX=ae(),tKe=ct();async function*rKe(t){for await(let e of t){if(e.length===void 0)throw dX(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield tKe(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw dX(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}pX.exports=rKe});var mX=p((cPt,bX)=>{f();"use strict";var iKe=_Y(),nKe=LY(),gX=ae();function sKe(t){return Symbol.iterator in t}function oKe(t){return Symbol.asyncIterator in t}function aKe(t){try{if(t instanceof Uint8Array)return async function*(){yield t}();if(sKe(t))return async function*(){yield*t}();if(oKe(t))return t}catch{throw gX(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw gX(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*cKe(t,e,r){for await(let i of t)if(i.path&&(i.path.substring(0,2)==="./"&&(r.wrapWithDirectory=!0),i.path=i.path.split("/").filter(n=>n&&n!==".").join("/")),i.content){let n;typeof r.chunker=="function"?n=r.chunker:r.chunker==="rabin"?n=lX():n=hX();let s;typeof r.chunkValidator=="function"?s=r.chunkValidator:s=yX();let o={path:i.path,mtime:i.mtime,mode:i.mode,content:n(s(aKe(i.content),r),r)};yield()=>nKe(o,e,r)}else if(i.path){let n={path:i.path,mtime:i.mtime,mode:i.mode};yield()=>iKe(n,e,r)}else throw new Error("Import candidate must have content or path or both")}bX.exports=cKe});var N_=p((uPt,wX)=>{f();"use strict";var vX=class{constructor(e,r){this.options=r||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,r){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}};wX.exports=vX});var A5=p((lPt,SX)=>{f();"use strict";var{encode:uKe,prepare:lKe}=(At(),xt),{UnixFS:fKe}=Ei(),_X=N_(),hKe=Lf(),EX=class extends _X{constructor(e,r){super(e,r);this._children={}}async put(e,r){this.cid=void 0,this.size=void 0,this._children[e]=r}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){let e=Object.keys(this._children);for(let r=0;r<e.length;r++){let i=e[r];yield{key:i,child:this._children[i]}}}async*flush(e){let r=Object.keys(this._children),i=[];for(let l=0;l<r.length;l++){let u=this._children[r[l]];if(u instanceof _X)for await(let h of u.flush(e))u=h,yield u;u.size!=null&&u.cid&&i.push({Name:r[l],Tsize:u.size,Hash:u.cid})}let n=new fKe({type:"directory",mtime:this.mtime,mode:this.mode}),s={Data:n.marshal(),Links:i},o=uKe(lKe(s)),a=await hKe(o,e,this.options),c=o.length+s.Links.reduce((l,u)=>l+(u.Tsize==null?0:u.Tsize),0);this.cid=a,this.size=c,yield{cid:a,unixfs:n,path:this.path,size:c}}};SX.exports=EX});var IX=p((hPt,AX)=>{f();"use strict";var D_=7;AX.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,r){let i=this._internalPositionFor(e,!1);if(r===void 0)i!==-1&&(this._unsetInternalPos(i),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;i===-1?(i=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(i,e,r,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();let r=this._internalPositionFor(e,!0);if(r!==-1)return this._data[r][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){let e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let r=0;for(;r<this.length;)e(this.get(r),r,this),r++}map(e){let r=0,i=new Array(this.length);for(;r<this.length;)i[r]=e(this.get(r),r,this),r++;return i}reduce(e,r){let i=0,n=r;for(;i<this.length;){let s=this.get(i);n=e(n,s,i),i++}return n}find(e){let r=0,i,n;for(;r<this.length&&!i;)n=this.get(r),i=e(n),r++;return i?n:void 0}_internalPositionFor(e,r){let i=this._bytePosFor(e,r);if(i>=this._bitArrays.length)return-1;let n=this._bitArrays[i],s=e-i*D_;if(!((n&1<<s)>0))return-1;let a=this._bitArrays.slice(0,i).reduce(dKe,0),c=~(4294967295<<s+1),l=xX(n&c);return a+l-1}_bytePosFor(e,r){let i=Math.floor(e/D_),n=i+1;for(;!r&&this._bitArrays.length<n;)this._bitArrays.push(0);return i}_setBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]|=1<<e-r*D_}_unsetBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]&=~(1<<e-r*D_)}_setInternalPos(e,r,i,n){let s=this._data,o=[r,i];if(n)this._sortData(),s[e]=o;else{if(s.length)if(s[s.length-1][0]>=r)s.push(o);else if(s[0][0]<=r)s.unshift(o);else{let a=Math.round(s.length/2);this._data=s.slice(0,a).concat(o).concat(s.slice(a))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(pKe),this._changedData=!1}bitField(){let e=[],r=8,i=0,n=0,s,o=this._bitArrays.slice();for(;o.length||i;){i===0&&(s=o.shift(),i=7);let c=Math.min(i,r),l=~(255<<c);n|=(s&l)<<8-r,s=s>>>c,i-=c,r-=c,(!r||!i&&!o.length)&&(e.push(n),n=0,r=8)}for(var a=e.length-1;a>0&&e[a]===0;a--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(yKe)}};function dKe(t,e){return t+xX(e)}function xX(t){let e=t;return e=e-(e>>1&1431655765),e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}function pKe(t,e){return t[0]-e[0]}function yKe(t){return t[1]}});var PX=p((dPt,RX)=>{f();"use strict";var gKe=IX(),bKe=ct(),No=class{constructor(e,r,i=0){this._options=e,this._popCount=0,this._parent=r,this._posAtParent=i,this._children=new gKe,this.key=null}async put(e,r){let i=await this._findNewBucketAndPos(e);await i.bucket._putAt(i,e,r)}async get(e){let r=await this._findChild(e);if(r)return r.value}async del(e){let r=await this._findPlace(e),i=r.bucket._at(r.pos);i&&i.key===e&&r.bucket._delAt(r.pos)}leafCount(){return this._children.compactArray().reduce((r,i)=>i instanceof No?r+i.leafCount():r+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let e=this._children.compactArray();for(let r of e)r instanceof No?yield*r.eachLeafSeries():yield r;return[]}serialize(e,r){let i=[];return r(this._children.reduce((n,s,o)=>(s&&(s instanceof No?n.push(s.serialize(e,r)):n.push(e(s,o))),n),i))}asyncTransform(e,r){return TX(this,e,r)}toJSON(){return this.serialize(vKe,wKe)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){let r=await this._findPlace(e),i=r.bucket._at(r.pos);if(!(i instanceof No)&&i&&i.key===e)return i}async _findPlace(e){let r=this._options.hash(typeof e=="string"?bKe(e):e),i=await r.take(this._options.bits),n=this._children.get(i);return n instanceof No?n._findPlace(r):{bucket:this,pos:i,hash:r,existingChild:n}}async _findNewBucketAndPos(e){let r=await this._findPlace(e);if(r.existingChild&&r.existingChild.key!==e){let i=new No(this._options,r.bucket,r.pos);r.bucket._putObjectAt(r.pos,i);let n=await i._findPlace(r.existingChild.hash);return n.bucket._putAt(n,r.existingChild.key,r.existingChild.value),i._findNewBucketAndPos(r.hash)}return r}_putAt(e,r,i){this._putObjectAt(e.pos,{key:r,value:i,hash:e.hash})}_putObjectAt(e,r){this._children.get(e)||this._popCount++,this._children.set(e,r)}_delAt(e){if(e===-1)throw new Error("Invalid position");this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){let e=this._children.find(mKe);if(e&&!(e instanceof No)){let r=e.hash;r.untake(this._options.bits);let i={pos:this._posAtParent,hash:r,bucket:this._parent};this._parent._putAt(i,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}};function mKe(t){return Boolean(t)}function vKe(t,e){return t.key}function wKe(t){return t}async function TX(t,e,r){let i=[];for(let n of t._children.compactArray())if(n instanceof No)await TX(n,e,r);else{let s=await e(n);i.push({bitField:t._children.bitField(),children:s})}return r(i)}RX.exports=No});var OX=p((yPt,CX)=>{f();"use strict";var _Ke=[255,254,252,248,240,224,192,128],EKe=[1,3,7,15,31,63,127,255];CX.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(e){let r=e,i=0;for(;r&&this._haveBits();){let n=this._value[this._currentBytePos],s=this._currentBitPos+1,o=Math.min(s,r),a=SKe(n,s-o,o);i=(i<<o)+a,r-=o,this._currentBitPos-=o,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return i}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function SKe(t,e,r){let i=xKe(e,r);return(t&i)>>>e}function xKe(t,e){return _Ke[t]&EKe[Math.min(e+t-1,7)]}});var kX=p((gPt,I5)=>{f();"use strict";var AKe=OX(),IKe=un();function TKe(t){function e(r){return r instanceof M_?r:new M_(r,t)}return e}var M_=class{constructor(e,r){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=r,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let r=e;for(;this._availableBits<r;)await this._produceMoreBits();let i=0;for(;r>0;){let n=this._buffers[this._currentBufferIndex],s=Math.min(n.availableBits(),r),o=n.take(s);i=(i<<s)+o,r-=s,this._availableBits-=s,n.availableBits()===0&&this._currentBufferIndex++}return i}untake(e){let r=e;for(;r>0;){let i=this._buffers[this._currentBufferIndex],n=Math.min(i.totalBits()-i.availableBits(),r);i.untake(n),r-=n,this._availableBits+=n,this._currentBufferIndex>0&&i.totalBits()===i.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let e=this._depth?IKe([this._value,Uint8Array.from([this._depth])]):this._value,r=await this._hashFn(e),i=new AKe(r);this._buffers.push(i),this._availableBits+=i.availableBits()}};I5.exports=TKe;I5.exports.InfiniteHash=M_});var L_=p((bPt,BX)=>{f();"use strict";var qX=PX(),RKe=kX();function PKe(t){if(!t||!t.hashFn)throw new Error("please define an options.hashFn");let e={bits:t.bits||8,hash:RKe(t.hashFn)};return new qX(e)}BX.exports={createHAMT:PKe,Bucket:qX}});var U_=p((mPt,MX)=>{f();"use strict";var{encode:CKe,prepare:OKe}=(At(),xt),{UnixFS:kKe}=Ei(),qKe=N_(),BKe=Lf(),{createHAMT:NKe,Bucket:DKe}=L_(),NX=class extends qKe{constructor(e,r){super(e,r);this._bucket=NKe({hashFn:r.hamtHashFn,bits:r.hamtBucketBits})}async put(e,r){await this._bucket.put(e,r)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:r}of this._bucket.eachLeafSeries())yield{key:e,child:r}}async*flush(e){for await(let r of DX(this._bucket,e,this,this.options))yield{...r,path:this.path}}};MX.exports=NX;async function*DX(t,e,r,i){let n=t._children,s=[],o=0;for(let y=0;y<n.length;y++){let g=n.get(y);if(!g)continue;let m=y.toString(16).toUpperCase().padStart(2,"0");if(g instanceof DKe){let E;for await(let v of await DX(g,e,null,i))E=v;if(!E)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:m,Tsize:E.size,Hash:E.cid}),o+=E.size}else if(typeof g.value.flush=="function"){let E=g.value,v;for await(let R of E.flush(e))v=R,yield v;let A=m+g.key;s.push({Name:A,Tsize:v.size,Hash:v.cid}),o+=v.size}else{let E=g.value;if(!E.cid)continue;let v=m+g.key,A=E.size;s.push({Name:v,Tsize:A,Hash:E.cid}),o+=A}}let a=Uint8Array.from(n.bitField().reverse()),c=new kKe({type:"hamt-sharded-directory",data:a,fanout:t.tableSize(),hashType:i.hamtHashCode,mtime:r&&r.mtime,mode:r&&r.mode}),l={Data:c.marshal(),Links:s},u=CKe(OKe(l)),h=await BKe(u,e,i),d=u.length+o;yield{cid:h,unixfs:c,size:d}}});var UX=p((vPt,LX)=>{f();"use strict";var MKe=U_(),LKe=A5();LX.exports=async function t(e,r,i,n){let s=r;r instanceof LKe&&r.directChildrenCount()>=i&&(s=await UKe(r,n));let o=s.parent;if(o){if(s!==r){if(e&&(e.parent=s),!s.parentKey)throw new Error("No parent key found");await o.put(s.parentKey,s)}return t(s,o,i,n)}return s};async function UKe(t,e){let r=new MKe({root:t.root,dir:!0,parent:t.parent,parentKey:t.parentKey,path:t.path,dirty:t.dirty,flat:!1,mtime:t.mtime,mode:t.mode},e);for await(let{key:i,child:n}of t.eachChildSeries())await r.put(i,n);return r}});var KX=p((wPt,FX)=>{f();"use strict";var FKe=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);FX.exports=FKe});var $X=p((_Pt,HX)=>{f();"use strict";var jX=A5(),KKe=UX(),VX=N_(),jKe=KX();async function VKe(t,e,r){let i=jKe(t.path||""),n=i.length-1,s=e,o="";for(let a=0;a<i.length;a++){let c=i[a];o+=`${o?"/":""}${c}`;let l=a===n;if(s.dirty=!0,s.cid=void 0,s.size=void 0,l)await s.put(c,t),e=await KKe(null,s,r.shardSplitThreshold,r);else{let u=await s.get(c);(!u||!(u instanceof VX))&&(u=new jX({root:!1,dir:!0,parent:s,parentKey:c,path:o,dirty:!0,flat:!0,mtime:u&&u.unixfs&&u.unixfs.mtime,mode:u&&u.unixfs&&u.unixfs.mode},r)),await s.put(c,u),s=u}}return e}async function*zX(t,e){if(!(t instanceof VX)){t&&t.unixfs&&t.unixfs.isDirectory()&&(yield t);return}yield*t.flush(e)}async function*zKe(t,e,r){let i=new jX({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r);for await(let n of t)!n||(i=await VKe(n,i,r),(!n.unixfs||!n.unixfs.isDirectory())&&(yield n));if(r.wrapWithDirectory)yield*zX(i,e);else for await(let n of i.eachChildSeries())!n||(yield*zX(n.child,e))}HX.exports=zKe});var F_=p((EPt,GX)=>{f();"use strict";var HKe=l_(),$Ke=k_();async function*GKe(t,e,r={}){let i=$Ke(r),n;typeof r.dagBuilder=="function"?n=r.dagBuilder:n=mX();let s;typeof r.treeBuilder=="function"?s=r.treeBuilder:s=$X();let o;Symbol.asyncIterator in t||Symbol.iterator in t?o=t:o=[t];for await(let a of s(HKe(n(o,e,i),i.fileImportConcurrency),e,i))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}GX.exports={importer:GKe}});var Tb=p((SPt,WX)=>{f();"use strict";async function*WKe(t,e={}){let r=t.getReader();try{for(;;){let i=await r.read();if(i.done)return;yield i.value}}finally{e.preventCancel!==!0&&r.cancel(),r.releaseLock()}}WX.exports=WKe});var QX=p((xPt,XX)=>{f();"use strict";var YX=Tb();function YKe(t){return typeof t.stream=="function"?YX(t.stream()):YX(new Response(t).body)}XX.exports=YKe});var Rb=p((APt,ZX)=>{f();"use strict";function XKe(t){let[e,r]=t[Symbol.asyncIterator]?[t[Symbol.asyncIterator](),Symbol.asyncIterator]:[t[Symbol.iterator](),Symbol.iterator],i=[];return{peek:()=>e.next(),push:n=>{i.push(n)},next:()=>i.length?{done:!1,value:i.shift()}:e.next(),[r](){return this}}}ZX.exports=XKe});var K_=p((IPt,JX)=>{f();"use strict";function QKe(t){return ArrayBuffer.isView(t)||t instanceof ArrayBuffer}function ZKe(t){return t.constructor&&(t.constructor.name==="Blob"||t.constructor.name==="File")&&typeof t.stream=="function"}function JKe(t){return typeof t=="object"&&(t.path||t.content)}var eje=t=>t&&typeof t.getReader=="function";JX.exports={isBytes:QKe,isBlob:ZKe,isFileObject:JKe,isReadableStream:eje}});var rQ=p((TPt,tQ)=>{f();"use strict";var tje=ae(),rje=ct(),ije=Tb(),nje=QX(),sje=Rb(),oje=rp(),aje=ko(),{isBytes:eQ,isReadableStream:cje,isBlob:uje}=K_();async function*lje(t){if(eQ(t)){yield T5(t);return}if(typeof t=="string"||t instanceof String){yield T5(t.toString());return}if(uje(t)){yield*nje(t);return}if(cje(t)&&(t=ije(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let e=sje(t),{value:r,done:i}=await e.peek();if(i){yield*[];return}if(e.push(r),Number.isInteger(r)){yield Uint8Array.from(await oje(e));return}if(eQ(r)||typeof r=="string"||r instanceof String){yield*aje(e,T5);return}}throw tje(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT")}function T5(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new Uint8Array(t):Array.isArray(t)?Uint8Array.from(t):rje(t.toString())}tQ.exports=lje});var R5=p((RPt,cQ)=>{f();"use strict";var fje=ae(),hje=Tb(),dje=Rb(),iQ=ko(),{isBytes:nQ,isBlob:sQ,isReadableStream:oQ,isFileObject:aQ}=K_(),{parseMtime:pje,parseMode:yje}=Ei();cQ.exports=async function*(e,r){if(e!=null){if(typeof e=="string"||e instanceof String){yield Rp(e.toString(),r);return}if(nQ(e)||sQ(e)){yield Rp(e,r);return}if(oQ(e)&&(e=hje(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let i=dje(e),{value:n,done:s}=await i.peek();if(s){yield*[];return}if(i.push(n),Number.isInteger(n)||nQ(n)){yield Rp(i,r);return}if(aQ(n)||sQ(n)||typeof n=="string"||n instanceof String){yield*iQ(i,o=>Rp(o,r));return}if(n[Symbol.iterator]||n[Symbol.asyncIterator]||oQ(n)){yield*iQ(i,o=>Rp(o,r));return}}if(aQ(e)){yield Rp(e,r);return}throw fje(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}};async function Rp(t,e){let{path:r,mode:i,mtime:n,content:s}=t,o={path:r||"",mode:yje(i),mtime:pje(n)};return s?o.content=await e(s):r||(o.content=await e(t)),o}});var lQ=p((PPt,uQ)=>{f();"use strict";var gje=rQ(),bje=R5();function mje(t){return bje(t,gje)}uQ.exports={normaliseInput:mje}});var dQ=p((CPt,hQ)=>{f();"use strict";var vje=t=>{if(t)if(t.startsWith("size-")){let e=t.split("-")[1],r=parseInt(e);if(isNaN(r))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:r}}else{if(t.startsWith("rabin"))return{chunker:"rabin",...fQ(t)};throw new Error(`Unrecognized chunker option: ${t}`)}else return{chunker:"fixed"}},fQ=t=>{let e={},r=t.split("-");switch(r.length){case 1:e.avgChunkSize=262144;break;case 2:e.avgChunkSize=Pb(r[1],"avg");break;case 4:e.minChunkSize=Pb(r[1],"min"),e.avgChunkSize=Pb(r[2],"avg"),e.maxChunkSize=Pb(r[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return e},Pb=(t,e)=>{let r=parseInt(t);if(isNaN(r))throw new Error(`Chunker parameter ${e} must be an integer`);return r};hQ.exports={parseChunkSize:Pb,parseRabinString:fQ,parseChunkerString:vje}});var yQ=p((OPt,pQ)=>{f();"use strict";var{importer:wje}=F_(),{normaliseInput:_je}=lQ(),{parseChunkerString:Eje}=dQ(),{pipe:Sje}=Pr(),xje=Oe(),Aje=wr().bind({ignoreUndefined:!0});pQ.exports=({repo:t,preload:e,options:r})=>{let i=r&&r.sharding;async function*n(s,o={}){let a=Aje({shardSplitThreshold:i?1e3:1/0,strategy:"balanced"},o,{...Eje(o.chunker)});a.hashAlg&&a.hashAlg!=="sha2-256"&&a.cidVersion!==1&&(a.cidVersion=1),a.trickle&&(a.strategy="trickle"),a.strategy==="trickle"&&(a.leafType="raw",a.reduceSingleLeafToSelf=!1),a.cidVersion>0&&a.rawLeaves===void 0&&(a.rawLeaves=!0),a.hashAlg!==void 0&&a.rawLeaves===void 0&&(a.rawLeaves=!0),delete a.trickle;let c={};if(a.progress){let h=a.progress;a.progress=(d,y)=>{c[y]||(c[y]=0),c[y]+=d,h(c[y],y)}}let l=Sje(_je(s),h=>wje(h,t.blocks,{...a,pin:!1}),Ije(a),Tje(e,a),Rje(t,a)),u=await t.gcLock.readLock();try{for await(let h of l)delete c[h.path],yield h}finally{u()}}return xje(n)};function Ije(t){async function*e(r){for await(let i of r){let n=i.cid;t.cidVersion===1&&(n=n.toV1());let s=i.path?i.path:n.toString();t.wrapWithDirectory&&!i.path&&(s=""),yield{path:s,cid:n,size:i.size,mode:i.unixfs&&i.unixfs.mode,mtime:i.unixfs&&i.unixfs.mtime}}}return e}function Tje(t,e){async function*r(i){for await(let n of i)(!n.path||e.wrapWithDirectory?n.path==="":!n.path.includes("/"))&&!e.onlyHash&&e.preload!==!1&&t(n.cid),yield n}return r}function Rje(t,e){async function*r(i){for await(let n of i){let s=!(n.path&&n.path.includes("/"));(e.pin==null?!0:e.pin)&&s&&!e.onlyHash&&await t.pins.pinRecursively(n.cid),yield n}}return r}});var vQ=p((kPt,mQ)=>{f();"use strict";var{Bucket:Pje,createHAMT:Cje}=L_(),{decode:Oje}=(At(),xt),kje=y5(),qje=ct(),Bje=async function(t){return qje(kje.x64.hash128(t),"base16").slice(0,8).reverse()},Nje=(t,e,r)=>Promise.all(t.map(i=>{if(i.Name==null)throw new Error("Unexpected Link without a Name");if(i.Name.length===2){let n=parseInt(i.Name,16);return e._putObjectAt(n,new Pje({hash:r._options.hash,bits:r._options.bits},e,n))}return r.put(i.Name.substring(2),!0)})),gQ=t=>t.toString(16).toUpperCase().padStart(2,"0").substring(0,2),Dje=t=>{let e=t.bucket,r=[];for(;e._parent;)r.push(e),e=e._parent;return r.push(e),r.reverse()},bQ=async(t,e,r,i,n)=>{if(!i){let u=Cje({hashFn:Bje});i={rootBucket:u,hamtDepth:1,lastBucket:u}}await Nje(t.Links,i.lastBucket,i.rootBucket);let s=await i.rootBucket._findNewBucketAndPos(e),o=gQ(s.pos),a=Dje(s);a.length>i.hamtDepth&&(i.lastBucket=a[i.hamtDepth],o=gQ(i.lastBucket._posAtParent));let c=t.Links.find(u=>{if(u.Name==null)return!1;let h=u.Name.substring(0,2),d=u.Name.substring(2);return!(h!==o||d&&d!==e)});if(!c)return null;if(c.Name!=null&&c.Name.substring(2)===e)return c.Hash;i.hamtDepth++;let l=await r.get(c.Hash,n);return t=Oje(l),bQ(t,e,r,i,n)};mQ.exports=bQ});var j_=p((qPt,wQ)=>{f();"use strict";wQ.exports=function(e,r,i,n){let s=e.length,o=r+s;return i>=o||n<r?new Uint8Array(0):(n>=r&&n<o&&(e=e.slice(0,n-r)),i>=r&&i<o&&(e=e.slice(i-r)),e)}});var V_=p((BPt,_Q)=>{f();"use strict";var P5=ae(),Mje=(t,e,r)=>{if(e||(e=0),e<0)throw P5(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(e>t)throw P5(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!r&&r!==0&&(r=t-e),r<0)throw P5(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return e+r>t&&(r=t-e),{offset:e,length:r}};_Q.exports=Mje});var C5=p((NPt,TQ)=>{f();"use strict";var EQ=j_(),Lje=V_(),{UnixFS:Uje}=Ei(),SQ=ae(),xQ=(At(),xt),AQ=(Uc(),Af),Fje=(Rs(),ns);async function*IQ(t,e,r,i,n=0,s){if(e instanceof Uint8Array){let c=EQ(e,n,r,i);return c.length&&(yield c),n+=c.length,n}if(e.Data==null)throw SQ(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let o;try{o=Uje.unmarshal(e.Data)}catch(c){throw SQ(c,"ERR_NOT_UNIXFS")}if(o.data&&o.data.length){let c=EQ(o.data,n,r,i);c.length&&(yield c),n+=o.data.length}let a=n;for(let c=0;c<e.Links.length;c++){let l=e.Links[c],u=n+o.blockSizes[c];if(r>=a&&r<u||i>a&&i<=u||r<a&&i>u){let h=await t.get(l.Hash,{signal:s.signal}),d;switch(l.Hash.code){case xQ.code:d=await xQ.decode(h);break;case Fje.code:d=h;break;case AQ.code:d=await AQ.decode(h);break;default:throw Error(`Unsupported codec: ${l.Hash.code}`)}for await(let y of IQ(t,d,r,i,n,s))n+=y.length,yield y}n=u,a=u+1}}var Kje=(t,e,r,i,n,s,o)=>{function a(c={}){let l=r.fileSize();if(l===void 0)throw new Error("File was a directory");let{offset:u,length:h}=Lje(l,c.offset,c.length),d=u,y=u+h;return IQ(o,e,d,y,0,c)}return a};TQ.exports=Kje});var PQ=p((DPt,RQ)=>{f();"use strict";var jje=(t,e,r,i,n,s,o)=>{async function*a(c={}){let l=c.offset||0,u=c.length||e.Links.length,h=e.Links.slice(l,u);for(let d of h){let y=await n(d.Hash,d.Name||"",`${i}/${d.Name||""}`,[],s+1,o,c);y.entry&&(yield y.entry)}}return a};RQ.exports=jje});var kQ=p((MPt,OQ)=>{f();"use strict";var{decode:Vje}=(At(),xt),zje=(t,e,r,i,n,s,o)=>{function a(c={}){return CQ(e,i,n,s,o,c)}return a};async function*CQ(t,e,r,i,n,s){let o=t.Links;for(let a of o){let c=a.Name!=null?a.Name.substring(2):null;if(c)yield(await r(a.Hash,c,`${e}/${c}`,[],i+1,n,s)).entry;else{let l=await n.get(a.Hash);t=Vje(l);for await(let u of CQ(t,e,r,i,n,s))yield u}}}OQ.exports=zje});var BQ=p((LPt,qQ)=>{f();"use strict";var O5=ae(),{UnixFS:Hje}=Ei(),$je=vQ(),{decode:Gje}=(At(),xt),Wje=(t,e)=>{let r=t.Links.find(i=>i.Name===e);return r&&r.Hash},Yje={raw:C5(),file:C5(),directory:PQ(),"hamt-sharded-directory":kQ(),metadata:(t,e,r,i,n,s,o)=>()=>[],symlink:(t,e,r,i,n,s,o)=>()=>[]},Xje=async(t,e,r,i,n,s,o,a)=>{let c=await o.get(t,a),l=Gje(c),u,h;if(e||(e=t.toString()),l.Data==null)throw O5(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{u=Hje.unmarshal(l.Data)}catch(d){throw O5(d,"ERR_NOT_UNIXFS")}if(r||(r=e),i.length){let d;if(u&&u.type==="hamt-sharded-directory"?d=await $je(l,i[0],o):d=Wje(l,i[0]),!d)throw O5(new Error("file does not exist"),"ERR_NOT_FOUND");let y=i.shift(),g=`${r}/${y}`;h={cid:d,toResolve:i,name:y||"",path:g}}return{entry:{type:u.isDirectory()?"directory":"file",name:e,path:r,cid:t,content:Yje[u.type](t,l,u,r,n,s,o),unixfs:u,depth:s,node:l,size:u.fileSize()},next:h}};qQ.exports=Xje});var DQ=p((UPt,NQ)=>{f();"use strict";var Qje=ae(),Zje=j_(),Jje=V_(),eVe=t=>{async function*e(r={}){let{offset:i,length:n}=Jje(t.length,r.offset,r.length);yield Zje(t,0,i,i+n)}return e},tVe=async(t,e,r,i,n,s,o,a)=>{if(i.length)throw Qje(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let c=await o.get(t,a);return{entry:{type:"raw",name:e,path:r,cid:t,content:eVe(c),depth:s,size:c.length,node:c}}};NQ.exports=tVe});var LQ=p((FPt,MQ)=>{f();"use strict";var{CID:rVe}=(Ae(),Ce),iVe=ae(),nVe=(Uc(),Af),sVe=async(t,e,r,i,n,s,o,a)=>{let c=await o.get(t),l=nVe.decode(c),u=l,h=r;for(;i.length;){let d=i[0];if(d in u){i.shift(),h=`${h}/${d}`;let y=rVe.asCID(u[d]);if(y)return{entry:{type:"object",name:e,path:r,cid:t,node:c,depth:s,size:c.length,content:async function*(){yield l}},next:{cid:y,name:d,path:h,toResolve:i}};u=u[d]}else throw iVe(new Error(`No property named ${d} found in cbor node ${t}`),"ERR_NO_PROP")}return{entry:{type:"object",name:e,path:r,cid:t,node:c,depth:s,size:c.length,content:async function*(){yield l}}}};MQ.exports=sVe});var FQ=p((KPt,UQ)=>{f();"use strict";var oVe=ae(),aVe=j_(),cVe=V_(),uVe=(An(),xn),lVe=t=>{async function*e(r={}){let{offset:i,length:n}=cVe(t.length,r.offset,r.length);yield aVe(t,0,i,i+n)}return e},fVe=async(t,e,r,i,n,s,o,a)=>{if(i.length)throw oVe(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let c=await uVe.decode(t.multihash.bytes);return{entry:{type:"identity",name:e,path:r,cid:t,content:lVe(c.digest),depth:s,size:c.digest.length,node:c.digest}}};UQ.exports=fVe});var VQ=p((jPt,jQ)=>{f();"use strict";var hVe=ae(),dVe=(At(),xt),pVe=(Uc(),Af),yVe=(Rs(),ns),{identity:gVe}=(Pc(),Ea),bVe={[dVe.code]:BQ(),[yVe.code]:DQ(),[pVe.code]:LQ(),[gVe.code]:FQ()};function KQ(t,e,r,i,n,s,o){let a=bVe[t.code];if(!a)throw hVe(new Error(`No resolver for code ${t.code}`),"ERR_NO_RESOLVER");return a(t,e,r,i,KQ,n,s,o)}jQ.exports=KQ});var Do=p((VPt,$Q)=>{f();"use strict";var k5=ae(),{CID:q5}=(Ae(),Ce),mVe=VQ(),vVe=$n(),wVe=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),_Ve=t=>{if(t instanceof Uint8Array)return{cid:q5.decode(t),toResolve:[]};let e=q5.asCID(t);if(e)return{cid:e,toResolve:[]};if(typeof t=="string"){t.indexOf("/ipfs/")===0&&(t=t.substring(6));let r=wVe(t);return{cid:q5.parse(r[0]),toResolve:r.slice(1)}}throw k5(new Error(`Unknown path type ${t}`),"ERR_BAD_PATH")};async function*zQ(t,e,r={}){let{cid:i,toResolve:n}=_Ve(t),s=i.toString(),o=s,a=n.length;for(;;){let c=await mVe(i,s,o,n,a,e,r);if(!c.entry&&!c.next)throw k5(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;n=c.next.toResolve,i=c.next.cid,s=c.next.name,o=c.next.path}}async function HQ(t,e,r={}){let i=await vVe(zQ(t,e,r));if(!i)throw k5(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");return i}async function*EVe(t,e,r={}){let i=await HQ(t,e,r);if(!i)return;if(yield i,i.type==="directory")for await(let s of n(i,r))yield s;async function*n(s,o){for await(let a of s.content(o))yield a,!(a instanceof Uint8Array)&&a.type==="directory"&&(yield*n(a,o))}}$Q.exports={exporter:HQ,walkPath:zQ,recursive:EVe}});var WQ=p((zPt,GQ)=>{f();"use strict";var{exporter:SVe}=Do(),{normalizeCidPath:xVe}=zi(),AVe=Oe(),{CID:IVe}=(Ae(),Ce);GQ.exports=function({repo:t,preload:e}){async function*r(i,n={}){if(i=xVe(i),n.preload!==!1){let o=i.split("/");e(IVe.parse(o[0]))}let s=await SVe(i,t.blocks,n);if(s.type==="directory")throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(n)}return AVe(r)}});var nl=p((HPt,YQ)=>{f();"use strict";var TVe=()=>{let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t};YQ.exports=TVe});var z_=p(($Pt,QQ)=>{f();"use strict";var{Buffer:Mo}=ft(),XQ=Symbol.for("BufferList");function ar(t){if(!(this instanceof ar))return new ar(t);ar._init.call(this,t)}ar._init=function(e){Object.defineProperty(this,XQ,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};ar.prototype._new=function(e){return new ar(e)};ar.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};ar.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};ar.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};ar.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};ar.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Mo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,l=s&&r||0,u=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Mo.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,l),l+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-u)return s?this._bufs[o[0]].copy(e,r,u,u+c):this._bufs[o[0]].slice(u,u+c);s||(e=Mo.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-u;if(c>d)this._bufs[h].copy(e,l,u),l+=d;else{this._bufs[h].copy(e,l,u,u+c),l+=d;break}c-=d,u&&(u=0)}return e.length>l?e.slice(0,l):e};ar.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};ar.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};ar.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};ar.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};ar.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Mo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Mo.from(e));return this};ar.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};ar.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Mo.from([t]):typeof t=="string"?t=Mo.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Mo.from(t.buffer,t.byteOffset,t.byteLength):Mo.isBuffer(t)||(t=Mo.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,t))return c;s++}s=0}return-1};ar.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?ar.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:ar.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();ar.prototype._isBufferList=function(e){return e instanceof ar||ar.isBufferList(e)};ar.isBufferList=function(e){return e!=null&&e[XQ]};QQ.exports=ar});var eZ=p($_=>{f();var{Buffer:B5}=ft(),Pp=z_(),RVe="0".charCodeAt(0),PVe=B5.from("ustar\0","binary"),CVe=B5.from("ustar ","binary"),OVe=B5.from(" \0","binary"),H_=257,ZQ=263,kVe=function(t,e,r){return typeof t!="number"?r:(t=~~t,t>=e?e:t>=0||(t+=e,t>=0)?t:0)},qVe=function(t){switch(t){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null},JQ=function(t,e,r,i){for(;r<i;r++)if(t.get(r)===e)return r;return i},BVe=function(t){let e=8*32;for(let r=0;r<148;r++)e+=t.get(r);for(let r=156;r<512;r++)e+=t.get(r);return e};function NVe(t){let e;if(t.get(0)===128)e=!0;else if(t.get(0)===255)e=!1;else return null;let r=!1,i=[];for(let o=t.length-1;o>0;o--){let a=t.get(o);e?i.push(a):r&&a===0?i.push(0):r?(r=!1,i.push(256-a)):i.push(255-a)}let n=0,s=i.length;for(let o=0;o<s;o++)n+=i[o]*Math.pow(256,o);return e?n:-1*n}var sl=function(t,e,r){if(t=t.shallowSlice(e,e+r),e=0,t.get(e)&128)return NVe(t);{for(;e<t.length&&t.get(e)===32;)e++;let i=kVe(JQ(t,32,e,t.length),t.length,t.length);for(;e<i&&t.get(e)===0;)e++;return i===e?0:parseInt(t.shallowSlice(e,i).toString(),8)}},Cp=function(t,e,r,i){return t.shallowSlice(e,JQ(t,0,e,e+r)).toString(i)};$_.decodeLongPath=function(t,e){return t=Pp.isBufferList(t)?t:new Pp(t),Cp(t,0,t.length,e)};$_.decodePax=function(t){t=Pp.isBufferList(t)?t:new Pp(t);let e={};for(;t.length;){let r=0;for(;r<t.length&&t.get(r)!==32;)r++;let i=parseInt(t.shallowSlice(0,r).toString(),10);if(!i)return e;let n=t.shallowSlice(r+1,i-1).toString(),s=n.indexOf("=");if(s===-1)return e;e[n.slice(0,s)]=n.slice(s+1),t=t.shallowSlice(i)}return e};$_.decode=function(t,e){t=Pp.isBufferList(t)?t:new Pp(t);let r=t.get(156)===0?0:t.get(156)-RVe,i=Cp(t,0,100,e),n=sl(t,100,8),s=sl(t,108,8),o=sl(t,116,8),a=sl(t,124,12),c=sl(t,136,12),l=qVe(r),u=t.get(157)===0?null:Cp(t,157,100,e),h=Cp(t,265,32),d=Cp(t,297,32),y=sl(t,329,8),g=sl(t,337,8),m=BVe(t);if(m===8*32)return null;if(m!==sl(t,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(PVe.compare(t.slice(H_,H_+6))===0)t.get(345)&&(i=Cp(t,345,155,e)+"/"+i);else if(!(CVe.compare(t.slice(H_,H_+6))===0&&OVe.compare(t.slice(ZQ,ZQ+2))===0))throw new Error("Invalid tar header: unknown format.");return r===0&&i&&i[i.length-1]==="/"&&(r=5),{name:i,mode:n,uid:s,gid:o,size:a,mtime:new Date(1e3*c),type:l,linkname:u,uname:h,gname:d,devmajor:y,devminor:g}}});var iZ=p((WPt,rZ)=>{f();"use strict";var{Buffer:Lo}=ft(),tZ=Symbol.for("BufferList");function cr(t){if(!(this instanceof cr))return new cr(t);cr._init.call(this,t)}cr._init=function(e){Object.defineProperty(this,tZ,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};cr.prototype._new=function(e){return new cr(e)};cr.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};cr.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};cr.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};cr.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};cr.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Lo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,l=s&&r||0,u=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Lo.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,l),l+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-u)return s?this._bufs[o[0]].copy(e,r,u,u+c):this._bufs[o[0]].slice(u,u+c);s||(e=Lo.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-u;if(c>d)this._bufs[h].copy(e,l,u),l+=d;else{this._bufs[h].copy(e,l,u,u+c),l+=d;break}c-=d,u&&(u=0)}return e.length>l?e.slice(0,l):e};cr.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};cr.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};cr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};cr.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};cr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Lo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Lo.from(e));return this};cr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};cr.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Lo.from([t]):typeof t=="string"?t=Lo.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Lo.from(t.buffer,t.byteOffset,t.byteLength):Lo.isBuffer(t)||(t=Lo.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,t))return c;s++}s=0}return-1};cr.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?cr.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:cr.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();cr.prototype._isBufferList=function(e){return e instanceof cr||cr.isBufferList(e)};cr.isBufferList=function(e){return e!=null&&e[tZ]};rZ.exports=cr});var G_=p((YPt,nZ)=>{f();var N5=iZ();nZ.exports=t=>{let e=async function*(){let r=yield,i=new N5;for await(let n of t){if(!r){r=yield i.append(n),i=new N5;continue}for(i.append(n);i.length>=r;){let s=i.shallowSlice(0,r);if(i.consume(r),r=yield s,!r){i.length&&(r=yield i,i=new N5);break}}}if(r)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:i})}();return e.next(),e}});var oZ=p((XPt,sZ)=>{f();var D5=z_(),DVe=G_();sZ.exports=function(e){let r=DVe(e),i,n={[Symbol.asyncIterator]:()=>n,async next(s){if(i){let o;if(s==null||i.length===s)o=i,i=null;else if(i.length>s)o=i.shallowSlice(0,s),i=i.shallowSlice(s);else if(i.length<s){let{value:a,done:c}=await r.next(s-i.length);if(c)throw Object.assign(new Error(`stream ended before ${s-i.length} bytes became available`),{code:"ERR_UNDER_READ"});o=new D5([i,a]),i=null}return{value:o}}return r.next(s)},async nextLte(s){let{done:o,value:a}=await n.next();return o?{done:o}:a.length<=s?{value:a}:(a=D5.isBufferList(a)?a:new D5(a),i?i.append(a.shallowSlice(s)):i=a.shallowSlice(s),{value:a.shallowSlice(0,s)})},return(){return r.return()}};return n}});var cZ=p((QPt,aZ)=>{f();var MVe=nl(),Cb=eZ(),LVe=oZ();function UVe(t){return t&=511,t&&512-t}async function Ob(t,e){let r=UVe(e);r&&await t.next(r)}aZ.exports=t=>(t=t||{},t.highWaterMark=t.highWaterMark||1024*16,e=>async function*(){let r=LVe(e),i,n,s,o;try{for(;;){let a;try{let{done:y,value:g}=await r.next(512);if(y)return;a=g}catch(y){if(y.code==="ERR_UNDER_READ")return;throw y}let c=Cb.decode(a,t.filenameEncoding);if(!c)continue;if(c.type==="gnu-long-path"){let{done:y,value:g}=await r.next(c.size);if(y)return;i=Cb.decodeLongPath(g,t.filenameEncoding),await Ob(r,c.size);continue}if(c.type==="gnu-long-link-path"){let{done:y,value:g}=await r.next(c.size);if(y)return;n=Cb.decodeLongPath(g,t.filenameEncoding),await Ob(r,c.size);continue}if(c.type==="pax-global-header"){let{done:y,value:g}=await r.next(c.size);if(y)return;s=Cb.decodePax(g,t.filenameEncoding),await Ob(r,c.size);continue}if(c.type==="pax-header"){let{done:y,value:g}=await r.next(c.size);if(y)return;o=Cb.decodePax(g,t.filenameEncoding),s&&(o={...s,...o}),await Ob(r,c.size);continue}if(i&&(c.name=i,i=null),n&&(c.linkname=n,n=null),o&&(o.path&&(c.name=o.path),o.linkpath&&(c.linkname=o.linkpath),o.size&&(c.size=parseInt(o.size,10)),c.pax=o,o=null),!c.size||c.type==="directory"){yield{header:c,body:async function*(){}()};continue}let l=c.size,u=MVe(),h=await r.nextLte(Math.min(l,t.highWaterMark));l-=h.value.length,l||u.resolve();let d=async function*(){try{for(yield h.value;l;){let{done:y,value:g}=await r.nextLte(l);if(y){l=0;return}l-=g.length,yield g}}finally{u.resolve()}}();if(yield{header:c,body:d},await u.promise,l)for await(let y of d);await Ob(r,c.size)}}finally{await r.return()}}())});var lZ=p((ZPt,uZ)=>{f();"use strict";uZ.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:8,RTLD_LOCAL:4,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGINFO:29,SIGSYS:12,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,UV_FS_O_FILEMAP:0,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_DSYNC:4194304,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488303,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}});var dZ=p((JPt,hZ)=>{f();"use strict";var{Buffer:Uo}=ft(),fZ=Symbol.for("BufferList");function ur(t){if(!(this instanceof ur))return new ur(t);ur._init.call(this,t)}ur._init=function(e){Object.defineProperty(this,fZ,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};ur.prototype._new=function(e){return new ur(e)};ur.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};ur.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};ur.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};ur.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};ur.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Uo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,l=s&&r||0,u=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Uo.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,l),l+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-u)return s?this._bufs[o[0]].copy(e,r,u,u+c):this._bufs[o[0]].slice(u,u+c);s||(e=Uo.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-u;if(c>d)this._bufs[h].copy(e,l,u),l+=d;else{this._bufs[h].copy(e,l,u,u+c),l+=d;break}c-=d,u&&(u=0)}return e.length>l?e.slice(0,l):e};ur.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};ur.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};ur.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};ur.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};ur.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Uo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Uo.from(e));return this};ur.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};ur.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Uo.from([t]):typeof t=="string"?t=Uo.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Uo.from(t.buffer,t.byteOffset,t.byteLength):Uo.isBuffer(t)||(t=Uo.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,t))return c;s++}s=0}return-1};ur.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?ur.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:ur.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();ur.prototype._isBufferList=function(e){return e instanceof ur||ur.isBufferList(e)};ur.isBufferList=function(e){return e!=null&&e[fZ]};hZ.exports=ur});var yZ=p((eCt,pZ)=>{f();var FVe=dZ(),M5={string:()=>"",buffer:()=>FVe()};pZ.exports=async(t,e)=>{if(e=e||{},e.type&&!M5[e.type])throw new Error(`invalid type "${e.type}"`);let r,i;for await(let n of t)r||(i=e.type||(typeof n=="string"?"string":"buffer"),r=M5[i]()),i==="string"?r+=n:r.append(n);return r||M5[e.type||"buffer"]()}});var gZ=p(U5=>{f();var{Buffer:$a}=ft(),KVe=$a.alloc,jVe="0000000000000000000",VVe="7777777777777777777",zVe="0".charCodeAt(0),HVe=$a.from("ustar\0","binary"),$Ve=$a.from("00","binary"),GVe=parseInt("7777",8),WVe=257,YVe=263,XVe=function(t){switch(t){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0},QVe=function(t){let e=8*32;for(let r=0;r<148;r++)e+=t[r];for(let r=156;r<512;r++)e+=t[r];return e},ol=function(t,e){return t=t.toString(8),t.length>e?VVe.slice(0,e)+" ":jVe.slice(0,e-t.length)+t+" "},L5=function(t){let e=$a.byteLength(t),r=Math.floor(Math.log(e)/Math.log(10))+1;return e+r>=Math.pow(10,r)&&r++,e+r+t};U5.encodePax=function(t){let e="";t.name&&(e+=L5(" path="+t.name+`
`)),t.linkname&&(e+=L5(" linkpath="+t.linkname+`
`));let r=t.pax;if(r)for(let i in r)e+=L5(" "+i+"="+r[i]+`
`);return $a.from(e)};U5.encode=function(t){let e=KVe(512),r=t.name,i="";if(t.typeflag===5&&r[r.length-1]!=="/"&&(r+="/"),$a.byteLength(r)!==r.length)return null;for(;$a.byteLength(r)>100;){let n=r.indexOf("/");if(n===-1)return null;i+=i?"/"+r.slice(0,n):r.slice(0,n),r=r.slice(n+1)}return $a.byteLength(r)>100||$a.byteLength(i)>155||t.linkname&&$a.byteLength(t.linkname)>100?null:(e.write(r),e.write(ol(t.mode&GVe,6),100),e.write(ol(t.uid,6),108),e.write(ol(t.gid,6),116),e.write(ol(t.size,11),124),e.write(ol(t.mtime.getTime()/1e3|0,11),136),e[156]=zVe+XVe(t.type),t.linkname&&e.write(t.linkname,157),HVe.copy(e,WVe),$Ve.copy(e,YVe),t.uname&&e.write(t.uname,265),t.gname&&e.write(t.gname,297),e.write(ol(t.devmajor||0,6),329),e.write(ol(t.devminor||0,6),337),i&&e.write(i,345),e.write(ol(QVe(e),6),148),e)}});var vZ=p((rCt,mZ)=>{f();var{Buffer:F5}=ft(),Uf=z_(),{S_IFMT:ZVe,S_IFBLK:JVe,S_IFCHR:eze,S_IFDIR:tze,S_IFIFO:rze,S_IFLNK:ize}=lZ(),nze=yZ(),W_=gZ(),sze=parseInt("755",8),oze=parseInt("644",8),bZ=F5.alloc(1024);function aze(t){switch(t&ZVe){case JVe:return"block-device";case eze:return"character-device";case tze:return"directory";case rze:return"fifo";case ize:return"symlink"}return"file"}function K5(t){if(t&=511,t)return new Uf(bZ.slice(0,512-t))}function j5(t){if(!t.pax){let e=W_.encode(t);if(e)return e}return cze(t)}function cze(t){let e=W_.encodePax({name:t.name,linkname:t.linkname,pax:t.pax}),r={name:"PaxHeader",mode:t.mode,uid:t.uid,gid:t.gid,size:e.length,mtime:t.mtime,type:"pax-header",linkname:t.linkname&&"PaxHeader",uname:t.uname,gname:t.gname,devmajor:t.devmajor,devminor:t.devminor};return new Uf([W_.encode(r),e,K5(e.length),W_.encode({...r,size:t.size,type:t.type})])}mZ.exports=()=>async function*(t){for await(let{header:e,body:r}of t){if((!e.size||e.type==="symlink")&&(e.size=0),e.type||(e.type=aze(e.mode)),e.mode||(e.mode=e.type==="directory"?sze:oze),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),typeof r=="string"&&(r=F5.from(r)),F5.isBuffer(r)||Uf.isBufferList(r)){e.size=r.length,yield new Uf([j5(e),r,K5(e.size)]);continue}if(e.type==="symlink"&&!e.linkname){e.linkname=(await nze(r)).toString(),yield j5(e);continue}if(yield j5(e),e.type!=="file"&&e.type!=="contiguous-file")continue;let i=0;for await(let s of r)i+=s.length,yield Uf.isBufferList(s)?s:new Uf(s);if(i!==e.size)throw new Error("size mismatch");let n=K5(e.size);n&&(yield n)}yield new Uf(bZ)}});var wZ=p(V5=>{f();V5.extract=cZ();V5.pack=vZ()});var zc=p(On=>{f();"use strict";var uze=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function lze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}On.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(var i in r)lze(r,i)&&(t[i]=r[i])}}return t};On.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var fze={arraySet:function(t,e,r,i,n){if(e.subarray&&t.subarray){t.set(e.subarray(r,r+i),n);return}for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){var e,r,i,n,s,o;for(i=0,e=0,r=t.length;e<r;e++)i+=t[e].length;for(o=new Uint8Array(i),n=0,e=0,r=t.length;e<r;e++)s=t[e],o.set(s,n),n+=s.length;return o}},hze={arraySet:function(t,e,r,i,n){for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){return[].concat.apply([],t)}};On.setTyped=function(t){t?(On.Buf8=Uint8Array,On.Buf16=Uint16Array,On.Buf32=Int32Array,On.assign(On,fze)):(On.Buf8=Array,On.Buf16=Array,On.Buf32=Array,On.assign(On,hze))};On.setTyped(uze)});var VZ=p(qp=>{f();"use strict";var dze=zc(),pze=4,_Z=0,EZ=1,yze=2;function Op(t){for(var e=t.length;--e>=0;)t[e]=0}var gze=0,SZ=1,bze=2,mze=3,vze=258,z5=29,kb=256,qb=kb+1+z5,kp=30,H5=19,xZ=2*qb+1,Ff=15,$5=16,wze=7,G5=256,AZ=16,IZ=17,TZ=18,W5=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Y_=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],_ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],RZ=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Eze=512,Hc=new Array((qb+2)*2);Op(Hc);var Bb=new Array(kp*2);Op(Bb);var Nb=new Array(Eze);Op(Nb);var Db=new Array(vze-mze+1);Op(Db);var Y5=new Array(z5);Op(Y5);var X_=new Array(kp);Op(X_);function X5(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}var PZ,CZ,OZ;function Q5(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function kZ(t){return t<256?Nb[t]:Nb[256+(t>>>7)]}function Mb(t,e){t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255}function Qn(t,e,r){t.bi_valid>$5-r?(t.bi_buf|=e<<t.bi_valid&65535,Mb(t,t.bi_buf),t.bi_buf=e>>$5-t.bi_valid,t.bi_valid+=r-$5):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function Ga(t,e,r){Qn(t,r[e*2],r[e*2+1])}function qZ(t,e){var r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1}function Sze(t){t.bi_valid===16?(Mb(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)}function xze(t,e){var r=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length,l,u,h,d,y,g,m=0;for(d=0;d<=Ff;d++)t.bl_count[d]=0;for(r[t.heap[t.heap_max]*2+1]=0,l=t.heap_max+1;l<xZ;l++)u=t.heap[l],d=r[r[u*2+1]*2+1]+1,d>c&&(d=c,m++),r[u*2+1]=d,!(u>i)&&(t.bl_count[d]++,y=0,u>=a&&(y=o[u-a]),g=r[u*2],t.opt_len+=g*(d+y),s&&(t.static_len+=g*(n[u*2+1]+y)));if(m!==0){do{for(d=c-1;t.bl_count[d]===0;)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[c]--,m-=2}while(m>0);for(d=c;d!==0;d--)for(u=t.bl_count[d];u!==0;)h=t.heap[--l],!(h>i)&&(r[h*2+1]!==d&&(t.opt_len+=(d-r[h*2+1])*r[h*2],r[h*2+1]=d),u--)}}function BZ(t,e,r){var i=new Array(Ff+1),n=0,s,o;for(s=1;s<=Ff;s++)i[s]=n=n+r[s-1]<<1;for(o=0;o<=e;o++){var a=t[o*2+1];a!==0&&(t[o*2]=qZ(i[a]++,a))}}function Aze(){var t,e,r,i,n,s=new Array(Ff+1);for(r=0,i=0;i<z5-1;i++)for(Y5[i]=r,t=0;t<1<<W5[i];t++)Db[r++]=i;for(Db[r-1]=i,n=0,i=0;i<16;i++)for(X_[i]=n,t=0;t<1<<Y_[i];t++)Nb[n++]=i;for(n>>=7;i<kp;i++)for(X_[i]=n<<7,t=0;t<1<<Y_[i]-7;t++)Nb[256+n++]=i;for(e=0;e<=Ff;e++)s[e]=0;for(t=0;t<=143;)Hc[t*2+1]=8,t++,s[8]++;for(;t<=255;)Hc[t*2+1]=9,t++,s[9]++;for(;t<=279;)Hc[t*2+1]=7,t++,s[7]++;for(;t<=287;)Hc[t*2+1]=8,t++,s[8]++;for(BZ(Hc,qb+1,s),t=0;t<kp;t++)Bb[t*2+1]=5,Bb[t*2]=qZ(t,5);PZ=new X5(Hc,W5,kb+1,qb,Ff),CZ=new X5(Bb,Y_,0,kp,Ff),OZ=new X5(new Array(0),_ze,0,H5,wze)}function NZ(t){var e;for(e=0;e<qb;e++)t.dyn_ltree[e*2]=0;for(e=0;e<kp;e++)t.dyn_dtree[e*2]=0;for(e=0;e<H5;e++)t.bl_tree[e*2]=0;t.dyn_ltree[G5*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function DZ(t){t.bi_valid>8?Mb(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function Ize(t,e,r,i){DZ(t),i&&(Mb(t,r),Mb(t,~r)),dze.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}function MZ(t,e,r,i){var n=e*2,s=r*2;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[r]}function Z5(t,e,r){for(var i=t.heap[r],n=r<<1;n<=t.heap_len&&(n<t.heap_len&&MZ(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!MZ(e,i,t.heap[n],t.depth));)t.heap[r]=t.heap[n],r=n,n<<=1;t.heap[r]=i}function LZ(t,e,r){var i,n,s=0,o,a;if(t.last_lit!==0)do i=t.pending_buf[t.d_buf+s*2]<<8|t.pending_buf[t.d_buf+s*2+1],n=t.pending_buf[t.l_buf+s],s++,i===0?Ga(t,n,e):(o=Db[n],Ga(t,o+kb+1,e),a=W5[o],a!==0&&(n-=Y5[o],Qn(t,n,a)),i--,o=kZ(i),Ga(t,o,r),a=Y_[o],a!==0&&(i-=X_[o],Qn(t,i,a)));while(s<t.last_lit);Ga(t,G5,e)}function J5(t,e){var r=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems,o,a,c=-1,l;for(t.heap_len=0,t.heap_max=xZ,o=0;o<s;o++)r[o*2]!==0?(t.heap[++t.heap_len]=c=o,t.depth[o]=0):r[o*2+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=c<2?++c:0,r[l*2]=1,t.depth[l]=0,t.opt_len--,n&&(t.static_len-=i[l*2+1]);for(e.max_code=c,o=t.heap_len>>1;o>=1;o--)Z5(t,r,o);l=s;do o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Z5(t,r,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,r[l*2]=r[o*2]+r[a*2],t.depth[l]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,r[o*2+1]=r[a*2+1]=l,t.heap[1]=l++,Z5(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],xze(t,e),BZ(r,c,t.bl_count)}function UZ(t,e,r){var i,n=-1,s,o=e[0*2+1],a=0,c=7,l=4;for(o===0&&(c=138,l=3),e[(r+1)*2+1]=65535,i=0;i<=r;i++)s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)&&(a<l?t.bl_tree[s*2]+=a:s!==0?(s!==n&&t.bl_tree[s*2]++,t.bl_tree[AZ*2]++):a<=10?t.bl_tree[IZ*2]++:t.bl_tree[TZ*2]++,a=0,n=s,o===0?(c=138,l=3):s===o?(c=6,l=3):(c=7,l=4))}function FZ(t,e,r){var i,n=-1,s,o=e[0*2+1],a=0,c=7,l=4;for(o===0&&(c=138,l=3),i=0;i<=r;i++)if(s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)){if(a<l)do Ga(t,s,t.bl_tree);while(--a!=0);else s!==0?(s!==n&&(Ga(t,s,t.bl_tree),a--),Ga(t,AZ,t.bl_tree),Qn(t,a-3,2)):a<=10?(Ga(t,IZ,t.bl_tree),Qn(t,a-3,3)):(Ga(t,TZ,t.bl_tree),Qn(t,a-11,7));a=0,n=s,o===0?(c=138,l=3):s===o?(c=6,l=3):(c=7,l=4)}}function Tze(t){var e;for(UZ(t,t.dyn_ltree,t.l_desc.max_code),UZ(t,t.dyn_dtree,t.d_desc.max_code),J5(t,t.bl_desc),e=H5-1;e>=3&&t.bl_tree[RZ[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e}function Rze(t,e,r,i){var n;for(Qn(t,e-257,5),Qn(t,r-1,5),Qn(t,i-4,4),n=0;n<i;n++)Qn(t,t.bl_tree[RZ[n]*2+1],3);FZ(t,t.dyn_ltree,e-1),FZ(t,t.dyn_dtree,r-1)}function Pze(t){var e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return _Z;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return EZ;for(r=32;r<kb;r++)if(t.dyn_ltree[r*2]!==0)return EZ;return _Z}var KZ=!1;function Cze(t){KZ||(Aze(),KZ=!0),t.l_desc=new Q5(t.dyn_ltree,PZ),t.d_desc=new Q5(t.dyn_dtree,CZ),t.bl_desc=new Q5(t.bl_tree,OZ),t.bi_buf=0,t.bi_valid=0,NZ(t)}function jZ(t,e,r,i){Qn(t,(gze<<1)+(i?1:0),3),Ize(t,e,r,!0)}function Oze(t){Qn(t,SZ<<1,3),Ga(t,G5,Hc),Sze(t)}function kze(t,e,r,i){var n,s,o=0;t.level>0?(t.strm.data_type===yze&&(t.strm.data_type=Pze(t)),J5(t,t.l_desc),J5(t,t.d_desc),o=Tze(t),n=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=n&&(n=s)):n=s=r+5,r+4<=n&&e!==-1?jZ(t,e,r,i):t.strategy===pze||s===n?(Qn(t,(SZ<<1)+(i?1:0),3),LZ(t,Hc,Bb)):(Qn(t,(bze<<1)+(i?1:0),3),Rze(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),LZ(t,t.dyn_ltree,t.dyn_dtree)),NZ(t),i&&DZ(t)}function qze(t,e,r){return t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(Db[r]+kb+1)*2]++,t.dyn_dtree[kZ(e)*2]++),t.last_lit===t.lit_bufsize-1}qp._tr_init=Cze;qp._tr_stored_block=jZ;qp._tr_flush_block=kze;qp._tr_tally=qze;qp._tr_align=Oze});var eT=p((oCt,zZ)=>{f();"use strict";function Bze(t,e,r,i){for(var n=t&65535|0,s=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do n=n+e[i++]|0,s=s+n|0;while(--o);n%=65521,s%=65521}return n|s<<16|0}zZ.exports=Bze});var tT=p((aCt,HZ)=>{f();"use strict";function Nze(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e}var Dze=Nze();function Mze(t,e,r,i){var n=Dze,s=i+r;t^=-1;for(var o=i;o<s;o++)t=t>>>8^n[(t^e[o])&255];return t^-1}HZ.exports=Mze});var Q_=p((cCt,$Z)=>{f();"use strict";$Z.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var tJ=p(Xa=>{f();"use strict";var kn=zc(),Hs=VZ(),GZ=eT(),al=tT(),Lze=Q_(),Kf=0,Uze=1,Fze=3,cl=4,WZ=5,Wa=0,YZ=1,$s=-2,Kze=-3,rT=-5,jze=-1,Vze=1,Z_=2,zze=3,Hze=4,$ze=0,Gze=2,J_=8,Wze=9,Yze=15,Xze=8,Qze=29,Zze=256,iT=Zze+1+Qze,Jze=30,eHe=19,tHe=2*iT+1,rHe=15,It=3,ul=258,Fo=ul+It+1,iHe=32,e2=42,nT=69,t2=73,r2=91,i2=103,jf=113,Lb=666,xi=1,Ub=2,Vf=3,Bp=4,nHe=3;function ll(t,e){return t.msg=Lze[e],e}function XZ(t){return(t<<1)-(t>4?9:0)}function fl(t){for(var e=t.length;--e>=0;)t[e]=0}function hl(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(kn.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))}function en(t,e){Hs._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,hl(t.strm)}function Mt(t,e){t.pending_buf[t.pending++]=e}function Fb(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255}function sHe(t,e,r,i){var n=t.avail_in;return n>i&&(n=i),n===0?0:(t.avail_in-=n,kn.arraySet(e,t.input,t.next_in,n,r),t.state.wrap===1?t.adler=GZ(t.adler,e,n,r):t.state.wrap===2&&(t.adler=al(t.adler,e,n,r)),t.next_in+=n,t.total_in+=n,n)}function QZ(t,e){var r=t.max_chain_length,i=t.strstart,n,s,o=t.prev_length,a=t.nice_match,c=t.strstart>t.w_size-Fo?t.strstart-(t.w_size-Fo):0,l=t.window,u=t.w_mask,h=t.prev,d=t.strstart+ul,y=l[i+o-1],g=l[i+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do if(n=e,!(l[n+o]!==g||l[n+o-1]!==y||l[n]!==l[i]||l[++n]!==l[i+1])){i+=2,n++;do;while(l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&i<d);if(s=ul-(d-i),i=d-ul,s>o){if(t.match_start=e,o=s,s>=a)break;y=l[i+o-1],g=l[i+o]}}while((e=h[e&u])>c&&--r!=0);return o<=t.lookahead?o:t.lookahead}function zf(t){var e=t.w_size,r,i,n,s,o;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Fo)){kn.arraySet(t.window,t.window,e,e,0),t.match_start-=e,t.strstart-=e,t.block_start-=e,i=t.hash_size,r=i;do n=t.head[--r],t.head[r]=n>=e?n-e:0;while(--i);i=e,r=i;do n=t.prev[--r],t.prev[r]=n>=e?n-e:0;while(--i);s+=e}if(t.strm.avail_in===0)break;if(i=sHe(t.strm,t.window,t.strstart+t.lookahead,s),t.lookahead+=i,t.lookahead+t.insert>=It)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+It-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<It)););}while(t.lookahead<Fo&&t.strm.avail_in!==0)}function oHe(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(zf(t),t.lookahead===0&&e===Kf)return xi;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+r;if((t.strstart===0||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,en(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-Fo&&(en(t,!1),t.strm.avail_out===0))return xi}return t.insert=0,e===cl?(en(t,!0),t.strm.avail_out===0?Vf:Bp):(t.strstart>t.block_start&&(en(t,!1),t.strm.avail_out===0),xi)}function sT(t,e){for(var r,i;;){if(t.lookahead<Fo){if(zf(t),t.lookahead<Fo&&e===Kf)return xi;if(t.lookahead===0)break}if(r=0,t.lookahead>=It&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+It-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Fo&&(t.match_length=QZ(t,r)),t.match_length>=It)if(i=Hs._tr_tally(t,t.strstart-t.match_start,t.match_length-It),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=It){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+It-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!=0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=Hs._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(en(t,!1),t.strm.avail_out===0))return xi}return t.insert=t.strstart<It-1?t.strstart:It-1,e===cl?(en(t,!0),t.strm.avail_out===0?Vf:Bp):t.last_lit&&(en(t,!1),t.strm.avail_out===0)?xi:Ub}function Np(t,e){for(var r,i,n;;){if(t.lookahead<Fo){if(zf(t),t.lookahead<Fo&&e===Kf)return xi;if(t.lookahead===0)break}if(r=0,t.lookahead>=It&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+It-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=It-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Fo&&(t.match_length=QZ(t,r),t.match_length<=5&&(t.strategy===Vze||t.match_length===It&&t.strstart-t.match_start>4096)&&(t.match_length=It-1)),t.prev_length>=It&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-It,i=Hs._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-It),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+It-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!=0);if(t.match_available=0,t.match_length=It-1,t.strstart++,i&&(en(t,!1),t.strm.avail_out===0))return xi}else if(t.match_available){if(i=Hs._tr_tally(t,0,t.window[t.strstart-1]),i&&en(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return xi}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Hs._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<It-1?t.strstart:It-1,e===cl?(en(t,!0),t.strm.avail_out===0?Vf:Bp):t.last_lit&&(en(t,!1),t.strm.avail_out===0)?xi:Ub}function aHe(t,e){for(var r,i,n,s,o=t.window;;){if(t.lookahead<=ul){if(zf(t),t.lookahead<=ul&&e===Kf)return xi;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=It&&t.strstart>0&&(n=t.strstart-1,i=o[n],i===o[++n]&&i===o[++n]&&i===o[++n])){s=t.strstart+ul;do;while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<s);t.match_length=ul-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=It?(r=Hs._tr_tally(t,1,t.match_length-It),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=Hs._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(en(t,!1),t.strm.avail_out===0))return xi}return t.insert=0,e===cl?(en(t,!0),t.strm.avail_out===0?Vf:Bp):t.last_lit&&(en(t,!1),t.strm.avail_out===0)?xi:Ub}function cHe(t,e){for(var r;;){if(t.lookahead===0&&(zf(t),t.lookahead===0)){if(e===Kf)return xi;break}if(t.match_length=0,r=Hs._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(en(t,!1),t.strm.avail_out===0))return xi}return t.insert=0,e===cl?(en(t,!0),t.strm.avail_out===0?Vf:Bp):t.last_lit&&(en(t,!1),t.strm.avail_out===0)?xi:Ub}function Ya(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n}var Dp;Dp=[new Ya(0,0,0,0,oHe),new Ya(4,4,8,4,sT),new Ya(4,5,16,8,sT),new Ya(4,6,32,32,sT),new Ya(4,4,16,16,Np),new Ya(8,16,32,32,Np),new Ya(8,16,128,128,Np),new Ya(8,32,128,256,Np),new Ya(32,128,258,1024,Np),new Ya(32,258,258,4096,Np)];function uHe(t){t.window_size=2*t.w_size,fl(t.head),t.max_lazy_match=Dp[t.level].max_lazy,t.good_match=Dp[t.level].good_length,t.nice_match=Dp[t.level].nice_length,t.max_chain_length=Dp[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=It-1,t.match_available=0,t.ins_h=0}function lHe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=J_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new kn.Buf16(tHe*2),this.dyn_dtree=new kn.Buf16((2*Jze+1)*2),this.bl_tree=new kn.Buf16((2*eHe+1)*2),fl(this.dyn_ltree),fl(this.dyn_dtree),fl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new kn.Buf16(rHe+1),this.heap=new kn.Buf16(2*iT+1),fl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new kn.Buf16(2*iT+1),fl(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ZZ(t){var e;return!t||!t.state?ll(t,$s):(t.total_in=t.total_out=0,t.data_type=Gze,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?e2:jf,t.adler=e.wrap===2?0:1,e.last_flush=Kf,Hs._tr_init(e),Wa)}function JZ(t){var e=ZZ(t);return e===Wa&&uHe(t.state),e}function fHe(t,e){return!t||!t.state||t.state.wrap!==2?$s:(t.state.gzhead=e,Wa)}function eJ(t,e,r,i,n,s){if(!t)return $s;var o=1;if(e===jze&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),n<1||n>Wze||r!==J_||i<8||i>15||e<0||e>9||s<0||s>Hze)return ll(t,$s);i===8&&(i=9);var a=new lHe;return t.state=a,a.strm=t,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+It-1)/It),a.window=new kn.Buf8(a.w_size*2),a.head=new kn.Buf16(a.hash_size),a.prev=new kn.Buf16(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new kn.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=(1+2)*a.lit_bufsize,a.level=e,a.strategy=s,a.method=r,JZ(t)}function hHe(t,e){return eJ(t,e,J_,Yze,Xze,$ze)}function dHe(t,e){var r,i,n,s;if(!t||!t.state||e>WZ||e<0)return t?ll(t,$s):$s;if(i=t.state,!t.output||!t.input&&t.avail_in!==0||i.status===Lb&&e!==cl)return ll(t,t.avail_out===0?rT:$s);if(i.strm=t,r=i.last_flush,i.last_flush=e,i.status===e2)if(i.wrap===2)t.adler=0,Mt(i,31),Mt(i,139),Mt(i,8),i.gzhead?(Mt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Mt(i,i.gzhead.time&255),Mt(i,i.gzhead.time>>8&255),Mt(i,i.gzhead.time>>16&255),Mt(i,i.gzhead.time>>24&255),Mt(i,i.level===9?2:i.strategy>=Z_||i.level<2?4:0),Mt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Mt(i,i.gzhead.extra.length&255),Mt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=al(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=nT):(Mt(i,0),Mt(i,0),Mt(i,0),Mt(i,0),Mt(i,0),Mt(i,i.level===9?2:i.strategy>=Z_||i.level<2?4:0),Mt(i,nHe),i.status=jf);else{var o=J_+(i.w_bits-8<<4)<<8,a=-1;i.strategy>=Z_||i.level<2?a=0:i.level<6?a=1:i.level===6?a=2:a=3,o|=a<<6,i.strstart!==0&&(o|=iHe),o+=31-o%31,i.status=jf,Fb(i,o),i.strstart!==0&&(Fb(i,t.adler>>>16),Fb(i,t.adler&65535)),t.adler=1}if(i.status===nT)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=al(t.adler,i.pending_buf,i.pending-n,n)),hl(t),n=i.pending,i.pending===i.pending_buf_size));)Mt(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(t.adler=al(t.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=t2)}else i.status=t2;if(i.status===t2)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=al(t.adler,i.pending_buf,i.pending-n,n)),hl(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.name.length?s=i.gzhead.name.charCodeAt(i.gzindex++)&255:s=0,Mt(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(t.adler=al(t.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.gzindex=0,i.status=r2)}else i.status=r2;if(i.status===r2)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=al(t.adler,i.pending_buf,i.pending-n,n)),hl(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.comment.length?s=i.gzhead.comment.charCodeAt(i.gzindex++)&255:s=0,Mt(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(t.adler=al(t.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.status=i2)}else i.status=i2;if(i.status===i2&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&hl(t),i.pending+2<=i.pending_buf_size&&(Mt(i,t.adler&255),Mt(i,t.adler>>8&255),t.adler=0,i.status=jf)):i.status=jf),i.pending!==0){if(hl(t),t.avail_out===0)return i.last_flush=-1,Wa}else if(t.avail_in===0&&XZ(e)<=XZ(r)&&e!==cl)return ll(t,rT);if(i.status===Lb&&t.avail_in!==0)return ll(t,rT);if(t.avail_in!==0||i.lookahead!==0||e!==Kf&&i.status!==Lb){var c=i.strategy===Z_?cHe(i,e):i.strategy===zze?aHe(i,e):Dp[i.level].func(i,e);if((c===Vf||c===Bp)&&(i.status=Lb),c===xi||c===Vf)return t.avail_out===0&&(i.last_flush=-1),Wa;if(c===Ub&&(e===Uze?Hs._tr_align(i):e!==WZ&&(Hs._tr_stored_block(i,0,0,!1),e===Fze&&(fl(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),hl(t),t.avail_out===0))return i.last_flush=-1,Wa}return e!==cl?Wa:i.wrap<=0?YZ:(i.wrap===2?(Mt(i,t.adler&255),Mt(i,t.adler>>8&255),Mt(i,t.adler>>16&255),Mt(i,t.adler>>24&255),Mt(i,t.total_in&255),Mt(i,t.total_in>>8&255),Mt(i,t.total_in>>16&255),Mt(i,t.total_in>>24&255)):(Fb(i,t.adler>>>16),Fb(i,t.adler&65535)),hl(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Wa:YZ)}function pHe(t){var e;return!t||!t.state?$s:(e=t.state.status,e!==e2&&e!==nT&&e!==t2&&e!==r2&&e!==i2&&e!==jf&&e!==Lb?ll(t,$s):(t.state=null,e===jf?ll(t,Kze):Wa))}function yHe(t,e){var r=e.length,i,n,s,o,a,c,l,u;if(!t||!t.state||(i=t.state,o=i.wrap,o===2||o===1&&i.status!==e2||i.lookahead))return $s;for(o===1&&(t.adler=GZ(t.adler,e,r,0)),i.wrap=0,r>=i.w_size&&(o===0&&(fl(i.head),i.strstart=0,i.block_start=0,i.insert=0),u=new kn.Buf8(i.w_size),kn.arraySet(u,e,r-i.w_size,i.w_size,0),e=u,r=i.w_size),a=t.avail_in,c=t.next_in,l=t.input,t.avail_in=r,t.next_in=0,t.input=e,zf(i);i.lookahead>=It;){n=i.strstart,s=i.lookahead-(It-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+It-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++;while(--s);i.strstart=n,i.lookahead=It-1,zf(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=It-1,i.match_available=0,t.next_in=c,t.input=l,t.avail_in=a,i.wrap=o,Wa}Xa.deflateInit=hHe;Xa.deflateInit2=eJ;Xa.deflateReset=JZ;Xa.deflateResetKeep=ZZ;Xa.deflateSetHeader=fHe;Xa.deflate=dHe;Xa.deflateEnd=pHe;Xa.deflateSetDictionary=yHe;Xa.deflateInfo="pako deflate (from Nodeca project)"});var oT=p(Mp=>{f();"use strict";var n2=zc(),rJ=!0,iJ=!0;try{String.fromCharCode.apply(null,[0])}catch(t){rJ=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){iJ=!1}var Kb=new n2.Buf8(256);for($c=0;$c<256;$c++)Kb[$c]=$c>=252?6:$c>=248?5:$c>=240?4:$c>=224?3:$c>=192?2:1;var $c;Kb[254]=Kb[254]=1;Mp.string2buf=function(t){var e,r,i,n,s,o=t.length,a=0;for(n=0;n<o;n++)r=t.charCodeAt(n),(r&64512)==55296&&n+1<o&&(i=t.charCodeAt(n+1),(i&64512)==56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(e=new n2.Buf8(a),s=0,n=0;s<a;n++)r=t.charCodeAt(n),(r&64512)==55296&&n+1<o&&(i=t.charCodeAt(n+1),(i&64512)==56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};function nJ(t,e){if(e<65534&&(t.subarray&&iJ||!t.subarray&&rJ))return String.fromCharCode.apply(null,n2.shrinkBuf(t,e));for(var r="",i=0;i<e;i++)r+=String.fromCharCode(t[i]);return r}Mp.buf2binstring=function(t){return nJ(t,t.length)};Mp.binstring2buf=function(t){for(var e=new n2.Buf8(t.length),r=0,i=e.length;r<i;r++)e[r]=t.charCodeAt(r);return e};Mp.buf2string=function(t,e){var r,i,n,s,o=e||t.length,a=new Array(o*2);for(i=0,r=0;r<o;){if(n=t[r++],n<128){a[i++]=n;continue}if(s=Kb[n],s>4){a[i++]=65533,r+=s-1;continue}for(n&=s===2?31:s===3?15:7;s>1&&r<o;)n=n<<6|t[r++]&63,s--;if(s>1){a[i++]=65533;continue}n<65536?a[i++]=n:(n-=65536,a[i++]=55296|n>>10&1023,a[i++]=56320|n&1023)}return nJ(a,i)};Mp.utf8border=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&(t[r]&192)==128;)r--;return r<0||r===0?e:r+Kb[t[r]]>e?r:e}});var aT=p((fCt,sJ)=>{f();"use strict";function gHe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}sJ.exports=gHe});var uJ=p(zb=>{f();"use strict";var jb=tJ(),Vb=zc(),cT=oT(),uT=Q_(),bHe=aT(),oJ=Object.prototype.toString,mHe=0,lT=4,Lp=0,aJ=1,cJ=2,vHe=-1,wHe=0,_He=8;function Hf(t){if(!(this instanceof Hf))return new Hf(t);this.options=Vb.assign({level:vHe,method:_He,chunkSize:16384,windowBits:15,memLevel:8,strategy:wHe,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new bHe,this.strm.avail_out=0;var r=jb.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==Lp)throw new Error(uT[r]);if(e.header&&jb.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(typeof e.dictionary=="string"?i=cT.string2buf(e.dictionary):oJ.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,r=jb.deflateSetDictionary(this.strm,i),r!==Lp)throw new Error(uT[r]);this._dict_set=!0}}Hf.prototype.push=function(t,e){var r=this.strm,i=this.options.chunkSize,n,s;if(this.ended)return!1;s=e===~~e?e:e===!0?lT:mHe,typeof t=="string"?r.input=cT.string2buf(t):oJ.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new Vb.Buf8(i),r.next_out=0,r.avail_out=i),n=jb.deflate(r,s),n!==aJ&&n!==Lp)return this.onEnd(n),this.ended=!0,!1;(r.avail_out===0||r.avail_in===0&&(s===lT||s===cJ))&&(this.options.to==="string"?this.onData(cT.buf2binstring(Vb.shrinkBuf(r.output,r.next_out))):this.onData(Vb.shrinkBuf(r.output,r.next_out)))}while((r.avail_in>0||r.avail_out===0)&&n!==aJ);return s===lT?(n=jb.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Lp):(s===cJ&&(this.onEnd(Lp),r.avail_out=0),!0)};Hf.prototype.onData=function(t){this.chunks.push(t)};Hf.prototype.onEnd=function(t){t===Lp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Vb.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function fT(t,e){var r=new Hf(e);if(r.push(t,!0),r.err)throw r.msg||uT[r.err];return r.result}function EHe(t,e){return e=e||{},e.raw=!0,fT(t,e)}function SHe(t,e){return e=e||{},e.gzip=!0,fT(t,e)}zb.Deflate=Hf;zb.deflate=fT;zb.deflateRaw=EHe;zb.gzip=SHe});var fJ=p((dCt,lJ)=>{f();"use strict";var s2=30,xHe=12;lJ.exports=function(e,r){var i,n,s,o,a,c,l,u,h,d,y,g,m,E,v,A,R,F,q,B,z,G,Y,P,b;i=e.state,n=e.next_in,P=e.input,s=n+(e.avail_in-5),o=e.next_out,b=e.output,a=o-(r-e.avail_out),c=o+(e.avail_out-257),l=i.dmax,u=i.wsize,h=i.whave,d=i.wnext,y=i.window,g=i.hold,m=i.bits,E=i.lencode,v=i.distcode,A=(1<<i.lenbits)-1,R=(1<<i.distbits)-1;e:do{m<15&&(g+=P[n++]<<m,m+=8,g+=P[n++]<<m,m+=8),F=E[g&A];t:for(;;){if(q=F>>>24,g>>>=q,m-=q,q=F>>>16&255,q===0)b[o++]=F&65535;else if(q&16){B=F&65535,q&=15,q&&(m<q&&(g+=P[n++]<<m,m+=8),B+=g&(1<<q)-1,g>>>=q,m-=q),m<15&&(g+=P[n++]<<m,m+=8,g+=P[n++]<<m,m+=8),F=v[g&R];r:for(;;){if(q=F>>>24,g>>>=q,m-=q,q=F>>>16&255,q&16){if(z=F&65535,q&=15,m<q&&(g+=P[n++]<<m,m+=8,m<q&&(g+=P[n++]<<m,m+=8)),z+=g&(1<<q)-1,z>l){e.msg="invalid distance too far back",i.mode=s2;break e}if(g>>>=q,m-=q,q=o-a,z>q){if(q=z-q,q>h&&i.sane){e.msg="invalid distance too far back",i.mode=s2;break e}if(G=0,Y=y,d===0){if(G+=u-q,q<B){B-=q;do b[o++]=y[G++];while(--q);G=o-z,Y=b}}else if(d<q){if(G+=u+d-q,q-=d,q<B){B-=q;do b[o++]=y[G++];while(--q);if(G=0,d<B){q=d,B-=q;do b[o++]=y[G++];while(--q);G=o-z,Y=b}}}else if(G+=d-q,q<B){B-=q;do b[o++]=y[G++];while(--q);G=o-z,Y=b}for(;B>2;)b[o++]=Y[G++],b[o++]=Y[G++],b[o++]=Y[G++],B-=3;B&&(b[o++]=Y[G++],B>1&&(b[o++]=Y[G++]))}else{G=o-z;do b[o++]=b[G++],b[o++]=b[G++],b[o++]=b[G++],B-=3;while(B>2);B&&(b[o++]=b[G++],B>1&&(b[o++]=b[G++]))}}else if((q&64)==0){F=v[(F&65535)+(g&(1<<q)-1)];continue r}else{e.msg="invalid distance code",i.mode=s2;break e}break}}else if((q&64)==0){F=E[(F&65535)+(g&(1<<q)-1)];continue t}else if(q&32){i.mode=xHe;break e}else{e.msg="invalid literal/length code",i.mode=s2;break e}break}}while(n<s&&o<c);B=m>>3,n-=B,m-=B<<3,g&=(1<<m)-1,e.next_in=n,e.next_out=o,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=o<c?257+(c-o):257-(o-c),i.hold=g,i.bits=m}});var mJ=p((pCt,bJ)=>{f();"use strict";var hJ=zc(),Up=15,dJ=852,pJ=592,yJ=0,hT=1,gJ=2,AHe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],IHe=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],THe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],RHe=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];bJ.exports=function(e,r,i,n,s,o,a,c){var l=c.bits,u=0,h=0,d=0,y=0,g=0,m=0,E=0,v=0,A=0,R=0,F,q,B,z,G,Y=null,P=0,b,w=new hJ.Buf16(Up+1),S=new hJ.Buf16(Up+1),C=null,D=0,W,j,M;for(u=0;u<=Up;u++)w[u]=0;for(h=0;h<n;h++)w[r[i+h]]++;for(g=l,y=Up;y>=1&&w[y]===0;y--);if(g>y&&(g=y),y===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,c.bits=1,0;for(d=1;d<y&&w[d]===0;d++);for(g<d&&(g=d),v=1,u=1;u<=Up;u++)if(v<<=1,v-=w[u],v<0)return-1;if(v>0&&(e===yJ||y!==1))return-1;for(S[1]=0,u=1;u<Up;u++)S[u+1]=S[u]+w[u];for(h=0;h<n;h++)r[i+h]!==0&&(a[S[r[i+h]]++]=h);if(e===yJ?(Y=C=a,b=19):e===hT?(Y=AHe,P-=257,C=IHe,D-=257,b=256):(Y=THe,C=RHe,b=-1),R=0,h=0,u=d,G=o,m=g,E=0,B=-1,A=1<<g,z=A-1,e===hT&&A>dJ||e===gJ&&A>pJ)return 1;for(;;){W=u-E,a[h]<b?(j=0,M=a[h]):a[h]>b?(j=C[D+a[h]],M=Y[P+a[h]]):(j=32+64,M=0),F=1<<u-E,q=1<<m,d=q;do q-=F,s[G+(R>>E)+q]=W<<24|j<<16|M|0;while(q!==0);for(F=1<<u-1;R&F;)F>>=1;if(F!==0?(R&=F-1,R+=F):R=0,h++,--w[u]==0){if(u===y)break;u=r[i+a[h]]}if(u>g&&(R&z)!==B){for(E===0&&(E=g),G+=d,m=u-E,v=1<<m;m+E<y&&(v-=w[m+E],!(v<=0));)m++,v<<=1;if(A+=1<<m,e===hT&&A>dJ||e===gJ&&A>pJ)return 1;B=R&z,s[B]=g<<24|m<<16|G-o|0}}return R!==0&&(s[G+R]=u-E<<24|64<<16|0),c.bits=g,0}});var JJ=p(Ko=>{f();"use strict";var ys=zc(),dT=eT(),Qa=tT(),PHe=fJ(),Hb=mJ(),CHe=0,vJ=1,wJ=2,_J=4,OHe=5,o2=6,$f=0,kHe=1,qHe=2,Gs=-2,EJ=-3,pT=-4,BHe=-5,SJ=8,xJ=1,AJ=2,IJ=3,TJ=4,RJ=5,PJ=6,CJ=7,OJ=8,kJ=9,qJ=10,a2=11,Gc=12,yT=13,BJ=14,gT=15,NJ=16,DJ=17,MJ=18,LJ=19,c2=20,u2=21,UJ=22,FJ=23,KJ=24,jJ=25,VJ=26,bT=27,zJ=28,HJ=29,Sr=30,mT=31,NHe=32,DHe=852,MHe=592,LHe=15,UHe=LHe;function $J(t){return(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24)}function FHe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new ys.Buf16(320),this.work=new ys.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function GJ(t){var e;return!t||!t.state?Gs:(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=xJ,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new ys.Buf32(DHe),e.distcode=e.distdyn=new ys.Buf32(MHe),e.sane=1,e.back=-1,$f)}function WJ(t){var e;return!t||!t.state?Gs:(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,GJ(t))}function YJ(t,e){var r,i;return!t||!t.state||(i=t.state,e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?Gs:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,WJ(t))}function XJ(t,e){var r,i;return t?(i=new FHe,t.state=i,i.window=null,r=YJ(t,e),r!==$f&&(t.state=null),r):Gs}function KHe(t){return XJ(t,UHe)}var QJ=!0,vT,wT;function jHe(t){if(QJ){var e;for(vT=new ys.Buf32(512),wT=new ys.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Hb(vJ,t.lens,0,288,vT,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Hb(wJ,t.lens,0,32,wT,0,t.work,{bits:5}),QJ=!1}t.lencode=vT,t.lenbits=9,t.distcode=wT,t.distbits=5}function ZJ(t,e,r,i){var n,s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new ys.Buf8(s.wsize)),i>=s.wsize?(ys.arraySet(s.window,e,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),ys.arraySet(s.window,e,r-i,n,s.wnext),i-=n,i?(ys.arraySet(s.window,e,r-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0}function VHe(t,e){var r,i,n,s,o,a,c,l,u,h,d,y,g,m,E=0,v,A,R,F,q,B,z,G,Y=new ys.Buf8(4),P,b,w=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return Gs;r=t.state,r.mode===Gc&&(r.mode=yT),o=t.next_out,n=t.output,c=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,l=r.hold,u=r.bits,h=a,d=c,G=$f;e:for(;;)switch(r.mode){case xJ:if(r.wrap===0){r.mode=yT;break}for(;u<16;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}if(r.wrap&2&&l===35615){r.check=0,Y[0]=l&255,Y[1]=l>>>8&255,r.check=Qa(r.check,Y,2,0),l=0,u=0,r.mode=AJ;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((l&255)<<8)+(l>>8))%31){t.msg="incorrect header check",r.mode=Sr;break}if((l&15)!==SJ){t.msg="unknown compression method",r.mode=Sr;break}if(l>>>=4,u-=4,z=(l&15)+8,r.wbits===0)r.wbits=z;else if(z>r.wbits){t.msg="invalid window size",r.mode=Sr;break}r.dmax=1<<z,t.adler=r.check=1,r.mode=l&512?qJ:Gc,l=0,u=0;break;case AJ:for(;u<16;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}if(r.flags=l,(r.flags&255)!==SJ){t.msg="unknown compression method",r.mode=Sr;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Sr;break}r.head&&(r.head.text=l>>8&1),r.flags&512&&(Y[0]=l&255,Y[1]=l>>>8&255,r.check=Qa(r.check,Y,2,0)),l=0,u=0,r.mode=IJ;case IJ:for(;u<32;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}r.head&&(r.head.time=l),r.flags&512&&(Y[0]=l&255,Y[1]=l>>>8&255,Y[2]=l>>>16&255,Y[3]=l>>>24&255,r.check=Qa(r.check,Y,4,0)),l=0,u=0,r.mode=TJ;case TJ:for(;u<16;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}r.head&&(r.head.xflags=l&255,r.head.os=l>>8),r.flags&512&&(Y[0]=l&255,Y[1]=l>>>8&255,r.check=Qa(r.check,Y,2,0)),l=0,u=0,r.mode=RJ;case RJ:if(r.flags&1024){for(;u<16;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}r.length=l,r.head&&(r.head.extra_len=l),r.flags&512&&(Y[0]=l&255,Y[1]=l>>>8&255,r.check=Qa(r.check,Y,2,0)),l=0,u=0}else r.head&&(r.head.extra=null);r.mode=PJ;case PJ:if(r.flags&1024&&(y=r.length,y>a&&(y=a),y&&(r.head&&(z=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),ys.arraySet(r.head.extra,i,s,y,z)),r.flags&512&&(r.check=Qa(r.check,i,y,s)),a-=y,s+=y,r.length-=y),r.length))break e;r.length=0,r.mode=CJ;case CJ:if(r.flags&2048){if(a===0)break e;y=0;do z=i[s+y++],r.head&&z&&r.length<65536&&(r.head.name+=String.fromCharCode(z));while(z&&y<a);if(r.flags&512&&(r.check=Qa(r.check,i,y,s)),a-=y,s+=y,z)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=OJ;case OJ:if(r.flags&4096){if(a===0)break e;y=0;do z=i[s+y++],r.head&&z&&r.length<65536&&(r.head.comment+=String.fromCharCode(z));while(z&&y<a);if(r.flags&512&&(r.check=Qa(r.check,i,y,s)),a-=y,s+=y,z)break e}else r.head&&(r.head.comment=null);r.mode=kJ;case kJ:if(r.flags&512){for(;u<16;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}if(l!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Sr;break}l=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Gc;break;case qJ:for(;u<32;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}t.adler=r.check=$J(l),l=0,u=0,r.mode=a2;case a2:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=l,r.bits=u,qHe;t.adler=r.check=1,r.mode=Gc;case Gc:if(e===OHe||e===o2)break e;case yT:if(r.last){l>>>=u&7,u-=u&7,r.mode=bT;break}for(;u<3;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}switch(r.last=l&1,l>>>=1,u-=1,l&3){case 0:r.mode=BJ;break;case 1:if(jHe(r),r.mode=c2,e===o2){l>>>=2,u-=2;break e}break;case 2:r.mode=DJ;break;case 3:t.msg="invalid block type",r.mode=Sr}l>>>=2,u-=2;break;case BJ:for(l>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}if((l&65535)!=(l>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Sr;break}if(r.length=l&65535,l=0,u=0,r.mode=gT,e===o2)break e;case gT:r.mode=NJ;case NJ:if(y=r.length,y){if(y>a&&(y=a),y>c&&(y=c),y===0)break e;ys.arraySet(n,i,s,y,o),a-=y,s+=y,c-=y,o+=y,r.length-=y;break}r.mode=Gc;break;case DJ:for(;u<14;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}if(r.nlen=(l&31)+257,l>>>=5,u-=5,r.ndist=(l&31)+1,l>>>=5,u-=5,r.ncode=(l&15)+4,l>>>=4,u-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Sr;break}r.have=0,r.mode=MJ;case MJ:for(;r.have<r.ncode;){for(;u<3;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}r.lens[w[r.have++]]=l&7,l>>>=3,u-=3}for(;r.have<19;)r.lens[w[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,P={bits:r.lenbits},G=Hb(CHe,r.lens,0,19,r.lencode,0,r.work,P),r.lenbits=P.bits,G){t.msg="invalid code lengths set",r.mode=Sr;break}r.have=0,r.mode=LJ;case LJ:for(;r.have<r.nlen+r.ndist;){for(;E=r.lencode[l&(1<<r.lenbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=u);){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}if(R<16)l>>>=v,u-=v,r.lens[r.have++]=R;else{if(R===16){for(b=v+2;u<b;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}if(l>>>=v,u-=v,r.have===0){t.msg="invalid bit length repeat",r.mode=Sr;break}z=r.lens[r.have-1],y=3+(l&3),l>>>=2,u-=2}else if(R===17){for(b=v+3;u<b;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}l>>>=v,u-=v,z=0,y=3+(l&7),l>>>=3,u-=3}else{for(b=v+7;u<b;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}l>>>=v,u-=v,z=0,y=11+(l&127),l>>>=7,u-=7}if(r.have+y>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Sr;break}for(;y--;)r.lens[r.have++]=z}}if(r.mode===Sr)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Sr;break}if(r.lenbits=9,P={bits:r.lenbits},G=Hb(vJ,r.lens,0,r.nlen,r.lencode,0,r.work,P),r.lenbits=P.bits,G){t.msg="invalid literal/lengths set",r.mode=Sr;break}if(r.distbits=6,r.distcode=r.distdyn,P={bits:r.distbits},G=Hb(wJ,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,P),r.distbits=P.bits,G){t.msg="invalid distances set",r.mode=Sr;break}if(r.mode=c2,e===o2)break e;case c2:r.mode=u2;case u2:if(a>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=l,r.bits=u,PHe(t,d),o=t.next_out,n=t.output,c=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,l=r.hold,u=r.bits,r.mode===Gc&&(r.back=-1);break}for(r.back=0;E=r.lencode[l&(1<<r.lenbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=u);){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}if(A&&(A&240)==0){for(F=v,q=A,B=R;E=r.lencode[B+((l&(1<<F+q)-1)>>F)],v=E>>>24,A=E>>>16&255,R=E&65535,!(F+v<=u);){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}l>>>=F,u-=F,r.back+=F}if(l>>>=v,u-=v,r.back+=v,r.length=R,A===0){r.mode=VJ;break}if(A&32){r.back=-1,r.mode=Gc;break}if(A&64){t.msg="invalid literal/length code",r.mode=Sr;break}r.extra=A&15,r.mode=UJ;case UJ:if(r.extra){for(b=r.extra;u<b;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=FJ;case FJ:for(;E=r.distcode[l&(1<<r.distbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=u);){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}if((A&240)==0){for(F=v,q=A,B=R;E=r.distcode[B+((l&(1<<F+q)-1)>>F)],v=E>>>24,A=E>>>16&255,R=E&65535,!(F+v<=u);){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}l>>>=F,u-=F,r.back+=F}if(l>>>=v,u-=v,r.back+=v,A&64){t.msg="invalid distance code",r.mode=Sr;break}r.offset=R,r.extra=A&15,r.mode=KJ;case KJ:if(r.extra){for(b=r.extra;u<b;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Sr;break}r.mode=jJ;case jJ:if(c===0)break e;if(y=d-c,r.offset>y){if(y=r.offset-y,y>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Sr;break}y>r.wnext?(y-=r.wnext,g=r.wsize-y):g=r.wnext-y,y>r.length&&(y=r.length),m=r.window}else m=n,g=o-r.offset,y=r.length;y>c&&(y=c),c-=y,r.length-=y;do n[o++]=m[g++];while(--y);r.length===0&&(r.mode=u2);break;case VJ:if(c===0)break e;n[o++]=r.length,c--,r.mode=u2;break;case bT:if(r.wrap){for(;u<32;){if(a===0)break e;a--,l|=i[s++]<<u,u+=8}if(d-=c,t.total_out+=d,r.total+=d,d&&(t.adler=r.check=r.flags?Qa(r.check,n,d,o-d):dT(r.check,n,d,o-d)),d=c,(r.flags?l:$J(l))!==r.check){t.msg="incorrect data check",r.mode=Sr;break}l=0,u=0}r.mode=zJ;case zJ:if(r.wrap&&r.flags){for(;u<32;){if(a===0)break e;a--,l+=i[s++]<<u,u+=8}if(l!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Sr;break}l=0,u=0}r.mode=HJ;case HJ:G=kHe;break e;case Sr:G=EJ;break e;case mT:return pT;case NHe:default:return Gs}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=l,r.bits=u,(r.wsize||d!==t.avail_out&&r.mode<Sr&&(r.mode<bT||e!==_J))&&ZJ(t,t.output,t.next_out,d-t.avail_out)?(r.mode=mT,pT):(h-=t.avail_in,d-=t.avail_out,t.total_in+=h,t.total_out+=d,r.total+=d,r.wrap&&d&&(t.adler=r.check=r.flags?Qa(r.check,n,d,t.next_out-d):dT(r.check,n,d,t.next_out-d)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Gc?128:0)+(r.mode===c2||r.mode===gT?256:0),(h===0&&d===0||e===_J)&&G===$f&&(G=BHe),G)}function zHe(t){if(!t||!t.state)return Gs;var e=t.state;return e.window&&(e.window=null),t.state=null,$f}function HHe(t,e){var r;return!t||!t.state||(r=t.state,(r.wrap&2)==0)?Gs:(r.head=e,e.done=!1,$f)}function $He(t,e){var r=e.length,i,n,s;return!t||!t.state||(i=t.state,i.wrap!==0&&i.mode!==a2)?Gs:i.mode===a2&&(n=1,n=dT(n,e,r,0),n!==i.check)?EJ:(s=ZJ(t,e,r,r),s?(i.mode=mT,pT):(i.havedict=1,$f))}Ko.inflateReset=WJ;Ko.inflateReset2=YJ;Ko.inflateResetKeep=GJ;Ko.inflateInit=KHe;Ko.inflateInit2=XJ;Ko.inflate=VHe;Ko.inflateEnd=zHe;Ko.inflateGetHeader=HHe;Ko.inflateSetDictionary=$He;Ko.inflateInfo="pako inflate (from Nodeca project)"});var _T=p((gCt,eee)=>{f();"use strict";eee.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var ree=p((bCt,tee)=>{f();"use strict";function GHe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}tee.exports=GHe});var nee=p(Gb=>{f();"use strict";var Fp=JJ(),$b=zc(),l2=oT(),ci=_T(),ET=Q_(),WHe=aT(),YHe=ree(),iee=Object.prototype.toString;function Gf(t){if(!(this instanceof Gf))return new Gf(t);this.options=$b.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new WHe,this.strm.avail_out=0;var r=Fp.inflateInit2(this.strm,e.windowBits);if(r!==ci.Z_OK)throw new Error(ET[r]);if(this.header=new YHe,Fp.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=l2.string2buf(e.dictionary):iee.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Fp.inflateSetDictionary(this.strm,e.dictionary),r!==ci.Z_OK)))throw new Error(ET[r])}Gf.prototype.push=function(t,e){var r=this.strm,i=this.options.chunkSize,n=this.options.dictionary,s,o,a,c,l,u=!1;if(this.ended)return!1;o=e===~~e?e:e===!0?ci.Z_FINISH:ci.Z_NO_FLUSH,typeof t=="string"?r.input=l2.binstring2buf(t):iee.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new $b.Buf8(i),r.next_out=0,r.avail_out=i),s=Fp.inflate(r,ci.Z_NO_FLUSH),s===ci.Z_NEED_DICT&&n&&(s=Fp.inflateSetDictionary(this.strm,n)),s===ci.Z_BUF_ERROR&&u===!0&&(s=ci.Z_OK,u=!1),s!==ci.Z_STREAM_END&&s!==ci.Z_OK)return this.onEnd(s),this.ended=!0,!1;r.next_out&&(r.avail_out===0||s===ci.Z_STREAM_END||r.avail_in===0&&(o===ci.Z_FINISH||o===ci.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=l2.utf8border(r.output,r.next_out),c=r.next_out-a,l=l2.buf2string(r.output,a),r.next_out=c,r.avail_out=i-c,c&&$b.arraySet(r.output,r.output,a,c,0),this.onData(l)):this.onData($b.shrinkBuf(r.output,r.next_out))),r.avail_in===0&&r.avail_out===0&&(u=!0)}while((r.avail_in>0||r.avail_out===0)&&s!==ci.Z_STREAM_END);return s===ci.Z_STREAM_END&&(o=ci.Z_FINISH),o===ci.Z_FINISH?(s=Fp.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===ci.Z_OK):(o===ci.Z_SYNC_FLUSH&&(this.onEnd(ci.Z_OK),r.avail_out=0),!0)};Gf.prototype.onData=function(t){this.chunks.push(t)};Gf.prototype.onEnd=function(t){t===ci.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=$b.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function ST(t,e){var r=new Gf(e);if(r.push(t,!0),r.err)throw r.msg||ET[r.err];return r.result}function XHe(t,e){return e=e||{},e.raw=!0,ST(t,e)}Gb.Inflate=Gf;Gb.inflate=ST;Gb.inflateRaw=XHe;Gb.ungzip=ST});var aee=p((vCt,oee)=>{f();"use strict";var QHe=zc().assign,ZHe=uJ(),JHe=nee(),e$e=_T(),see={};QHe(see,ZHe,JHe,e$e);oee.exports=see});var uee=p((wCt,cee)=>{f();"use strict";var t$e=un();async function r$e(t){let e=new Uint8Array(0);for await(let r of t)e=t$e([e,r],e.length+r.length);return e}cee.exports=r$e});var mee=p((_Ct,bee)=>{f();"use strict";var{exporter:i$e,recursive:n$e}=Do(),Wb=ae(),{normalizeCidPath:s$e}=zi(),o$e=Oe(),{CID:lee}=(Ae(),Ce),{pack:fee}=wZ(),{pipe:hee}=Pr(),{gzip:dee}=aee(),pee=ko(),yee=uee(),gee=6;bee.exports=function({repo:t,preload:e}){async function*r(i,n={}){if(n.compressionLevel<0||n.compressionLevel>9)throw Wb(new Error("Compression level must be between 1 and 9"),"ERR_INVALID_PARAMS");if(n.preload!==!1){let a;try{a=s$e(i).split("/")}catch(c){throw Wb(c,"ERR_INVALID_PATH")}e(lee.parse(a[0]))}let s=lee.asCID(i)||i,o=await i$e(s,t.blocks,n);if(o.type==="file"||o.type==="raw"){let a=[];!n.compress||n.archive===!0?a.push([{header:{name:o.path,mode:o.type==="file"&&o.unixfs.mode,mtime:o.type==="file"&&o.unixfs.mtime?new Date(o.unixfs.mtime.secs*1e3):void 0,size:o.size,type:"file"},body:o.content()}],fee(),c=>pee(c,l=>l.slice())):a.push(o.content),n.compress&&a.push(async function*(c){let l=await yee(c);yield dee(l,{level:n.compressionLevel||gee})}),yield*hee(...a);return}if(o.type==="directory"){let a=[n$e(s,t.blocks,n),async function*(c){for await(let l of c){let u={header:{name:l.path,size:l.size}};if(l.type==="file")u.header.type="file",u.header.mode=l.unixfs.mode!=null?l.unixfs.mode:void 0,u.header.mtime=l.unixfs.mtime?new Date(l.unixfs.mtime.secs*1e3):void 0,u.body=l.content();else if(l.type==="raw")u.header.type="file",u.body=l.content();else if(l.type==="directory")u.header.type="directory",u.header.mode=l.unixfs.mode!=null?l.unixfs.mode:void 0,u.header.mtime=l.unixfs.mtime?new Date(l.unixfs.mtime.secs*1e3):void 0;else throw Wb(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield u}},fee(),c=>pee(c,l=>l.slice())];if(n.compress){if(!n.archive)throw Wb(new Error("file is not regular"),"ERR_INVALID_PATH");n.compress&&a.push(async function*(c){let l=await yee(c);yield dee(l,{level:n.compressionLevel||gee})})}yield*hee(...a);return}throw Wb(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return o$e(r)}});var Eee=p((ECt,_ee)=>{f();"use strict";var{exporter:a$e}=Do(),c$e=ae(),{normalizeCidPath:u$e,mapFile:vee}=zi(),l$e=Oe(),{CID:wee}=(Ae(),Ce);_ee.exports=function({repo:t,preload:e}){async function*r(i,n={}){let s=u$e(i),o=s.split("/");n.preload!==!1&&e(wee.parse(o[0]));let a=wee.asCID(s)||s,c=await a$e(a,t.blocks,n);if(c.type==="file"){yield vee(c);return}if(c.type==="directory"){for await(let l of c.content())yield vee(l);return}throw c$e(new Error(`Unknown UnixFS type ${c.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return l$e(r)}});var Aee=p((SCt,xee)=>{f();"use strict";var f$e=dY(),h$e=yQ(),d$e=WQ(),p$e=mee(),y$e=Eee(),See=class{constructor({preload:e,repo:r,options:i}){let n=h$e({preload:e,repo:r,options:i});this.addAll=n,this.add=f$e({addAll:n}),this.cat=d$e({repo:r,preload:e}),this.get=p$e({repo:r,preload:e}),this.ls=y$e({repo:r,preload:e})}};xee.exports=See});var f2=p((xCt,g$e)=>{g$e.exports={name:"ipfs-core",version:"0.9.1",description:"JavaScript implementation of the IPFS specification",keywords:["IPFS"],homepage:"https://github.com/ipfs/js-ipfs/tree/master/packages/ipfs-core#readme",bugs:"https://github.com/ipfs/js-ipfs/issues",license:"(Apache-2.0 OR MIT)",leadMaintainer:"Alex Potsides <alex@achingbrain.net>",main:"src/index.js",types:"dist/src/index.d.ts",files:["src","dist","!dist/*.tsbuildinfo"],browser:{"./src/runtime/init-assets-nodejs.js":"./src/runtime/init-assets-browser.js","./src/runtime/config-nodejs.js":"./src/runtime/config-browser.js","./src/runtime/dns-nodejs.js":"./src/runtime/dns-browser.js","./src/runtime/libp2p-nodejs.js":"./src/runtime/libp2p-browser.js","./src/runtime/libp2p-pubsub-routers-nodejs.js":"./src/runtime/libp2p-pubsub-routers-browser.js","./src/runtime/preload-nodejs.js":"./src/runtime/preload-browser.js","./src/runtime/repo-nodejs.js":"./src/runtime/repo-browser.js","ipfs-utils/src/files/glob-source":!1},typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"],"src/":["dist/src/index"]}},repository:{type:"git",url:"git+https://github.com/ipfs/js-ipfs.git"},scripts:{build:"aegir build",lint:"aegir ts -p check && aegir lint",test:"aegir test","test:node":"aegir test -t node","test:browser":"aegir test -t browser","test:webworker":"aegir test -t webworker","test:electron-main":"aegir test -t electron-main","test:electron-renderer":"aegir test -t electron-renderer","test:bootstrapers":"IPFS_TEST=bootstrapers aegir test -t browser -f test/bootstrapers.js",coverage:"nyc --reporter=text --reporter=lcov npm run test:node",clean:"rimraf ./dist","dep-check":"aegir dep-check -i interface-ipfs-core -i ipfs-core-types -i abort-controller"},dependencies:{"@ipld/car":"^3.1.0","@ipld/dag-cbor":"^6.0.5","@ipld/dag-pb":"^2.1.3","abort-controller":"^3.0.0","array-shuffle":"^2.0.0","blockstore-datastore-adapter":"1.0.0","datastore-core":"^5.0.1","datastore-fs":"^5.0.2","datastore-level":"^6.0.2","datastore-pubsub":"^0.7.0",debug:"^4.1.1",dlv:"^1.1.3","err-code":"^3.0.1","hamt-sharding":"^2.0.0",hashlru:"^2.3.0","interface-blockstore":"^1.0.0","interface-datastore":"^5.0.0","ipfs-bitswap":"^6.0.0","ipfs-core-types":"^0.6.1","ipfs-core-utils":"^0.9.1","ipfs-http-client":"^51.0.1","ipfs-repo":"^11.0.1","ipfs-unixfs":"^5.0.0","ipfs-unixfs-exporter":"^6.0.2","ipfs-unixfs-importer":"^8.0.2","ipfs-utils":"^8.1.4",ipns:"^0.13.3","is-domain-name":"^1.0.1","is-ipfs":"^6.0.1","it-all":"^1.0.4","it-drain":"^1.0.3","it-filter":"^1.0.2","it-first":"^1.0.4","it-last":"^1.0.4","it-map":"^1.0.4","it-merge":"^1.0.2","it-peekable":"^1.0.2","it-pipe":"^1.1.0","it-pushable":"^1.4.2","it-tar":"^4.0.0","it-to-buffer":"^2.0.0","just-safe-set":"^2.2.1",libp2p:"^0.32.0","libp2p-bootstrap":"^0.13.0","libp2p-crypto":"^0.19.6","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.10.0","libp2p-floodsub":"^0.27.0","libp2p-gossipsub":"^0.11.0","libp2p-kad-dht":"^0.23.1","libp2p-mdns":"^0.17.0","libp2p-mplex":"^0.10.2","libp2p-noise":"^4.0.0","libp2p-record":"^0.10.3","libp2p-tcp":"^0.17.1","libp2p-webrtc-star":"^0.23.0","libp2p-websockets":"^0.16.1",mafmt:"^10.0.0","merge-options":"^3.0.4",mortice:"^2.0.0",multiaddr:"^10.0.0","multiaddr-to-uri":"^8.0.0",multiformats:"^9.4.1","native-abort-controller":"^1.0.3","p-queue":"^6.6.1",pako:"^1.0.2","parse-duration":"^1.0.0","peer-id":"^0.15.1","streaming-iterables":"^6.0.0",uint8arrays:"^2.1.6"},devDependencies:{"@types/dlv":"^1.1.2","@types/pako":"^1.0.2","@types/rimraf":"^3.0.1",aegir:"^34.0.2",delay:"^5.0.0","go-ipfs":"0.9.1","interface-blockstore-tests":"^1.0.0","interface-ipfs-core":"^0.148.0","ipfsd-ctl":"^10.0.3","iso-url":"^1.0.0",nanoid:"^3.1.12","p-defer":"^3.0.0",rimraf:"^3.0.2",sinon:"^11.1.1"}}});var Tee=p((ACt,Iee)=>{f();"use strict";var xT=f2(),b$e=Oe();Iee.exports=({repo:t})=>{async function e(r={}){let i=await t.version.get();return{version:xT.version,repo:`${i}`,commit:xT.gitHead||"","interface-ipfs-core":xT.devDependencies["interface-ipfs-core"]}}return b$e(e)}});var Pee=p((ICt,Ree)=>{f();"use strict";var m$e=f2().version,{Multiaddr:v$e}=tt(),w$e=Oe(),h2=Je(),_$e=et(),{NotStartedError:E$e}=Qu();Ree.exports=({peerId:t,network:e})=>{async function r(i={}){i.peerId===t.toB58String()&&delete i.peerId;let n=e.try();if(!n){if(i.peerId)throw new E$e;return{id:t.toB58String(),publicKey:h2(t.pubKey.bytes,"base64pad"),addresses:[],agentVersion:`js-ipfs/${m$e}`,protocolVersion:"9000",protocols:[]}}let s=i.peerId?_$e.createFromB58String(i.peerId.toString()):t,{libp2p:o}=n,a=i.peerId?o.peerStore.keyBook.get(s):s.pubKey,c=i.peerId?o.peerStore.addressBook.getMultiaddrsForPeer(s):o.multiaddrs,l=i.peerId?o.peerStore.protoBook.get(s):Array.from(o.upgrader.protocols.keys()),u=h2(o.peerStore.metadataBook.getValue(s,"AgentVersion")||new Uint8Array),h=h2(o.peerStore.metadataBook.getValue(s,"ProtocolVersion")||new Uint8Array),d=s.toB58String();return{id:d,publicKey:h2(a.bytes,"base64pad"),addresses:(c||[]).map(y=>{let g=y.toString();return g.endsWith(`/p2p/${d}`)?g:`${g}/p2p/${d}`}).sort().map(y=>new v$e(y)),agentVersion:u,protocolVersion:h,protocols:(l||[]).sort()}}return w$e(r)}});var TT=p((TCt,IT)=>{f();"use strict";var ui=u4(),AT=P_(),Kp=Oe(),S$e=me()("ipfs:core:config");IT.exports=({repo:t})=>{return{getAll:Kp(e),get:Kp(r),set:Kp(i),replace:Kp(n),profiles:{apply:Kp(s),list:Kp(x$e)}};async function e(o={}){return t.config.getAll(o)}async function r(o,a){return o?t.config.get(o,a):Promise.reject(new Error("key argument is required"))}async function i(o,a,c){return t.config.set(o,a,c)}async function n(o,a){return t.config.replace(o,a)}async function s(o,a={dryRun:!1}){let{dryRun:c}=a,l=d2[o];if(!l)throw new Error(`No profile with name '${o}' exists`);try{let u=await t.config.getAll(a),h=JSON.parse(JSON.stringify(u));return h=l.transform(h),c||await t.config.replace(h,a),delete u.Identity.PrivKey,delete h.Identity.PrivKey,{original:u,updated:h}}catch(u){throw S$e(u),new Error(`Could not apply profile '${o}' to config: ${u.message}`)}}};async function x$e(t){return Object.keys(d2).map(e=>({name:e,description:d2[e].description}))}var d2={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:t=>(ui(t,"Discovery.MDNS.Enabled",!1),ui(t,"Discovery.webRTCStar.Enabled",!1),t.Swarm={...t.Swarm||{},DisableNatPortMap:!0},t)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:t=>(ui(t,"Discovery.MDNS.Enabled",!0),ui(t,"Discovery.webRTCStar.Enabled",!0),ui(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!1}),t)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:t=>{let e=AT();return ui(t,"Addresses.API",e.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),ui(t,"Addresses.Gateway",e.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),ui(t,"Addresses.Swarm",e.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),ui(t,"Addresses.Delegates",[]),ui(t,"Bootstrap",[]),ui(t,"Discovery.MDNS.Enabled",!1),ui(t,"Discovery.webRTCStar.Enabled",!1),ui(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!0}),t}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:t=>{let e=AT();return ui(t,"Addresses.API",e.Addresses.API),ui(t,"Addresses.Gateway",e.Addresses.Gateway),ui(t,"Addresses.Swarm",e.Addresses.Swarm),ui(t,"Addresses.Delegates",e.Addresses.Delegates),ui(t,"Bootstrap",e.Bootstrap),ui(t,"Discovery.MDNS.Enabled",e.Discovery.MDNS.Enabled),ui(t,"Discovery.webRTCStar.Enabled",e.Discovery.webRTCStar.Enabled),ui(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!1}),t}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:t=>{let e=t.Swarm||{},r=e.ConnMgr||{};return r.LowWater=20,r.HighWater=40,e.ConnMgr=r,t.Swarm=e,t}},"default-power":{description:'Inverse of "lowpower" profile.',transform:t=>{let e=AT();return t.Swarm=e.Swarm,t}}};IT.exports.profiles=d2});function PT(t){let e=vI({version:1,roots:t}),r=RT.default.encode(e.length),i=new Uint8Array(r.length+e.length);return i.set(r,0),i.set(e,r.length),i}function Cee(t){return{async setRoots(e){let r=PT(e);await t.write(r)},async writeBlock(e){let{cid:r,bytes:i}=e;await t.write(new Uint8Array(RT.default.encode(r.bytes.length+i.length))),await t.write(r.bytes),i.length&&await t.write(i)},async close(){return t.end()}}}var RT,Oee=Ge(()=>{f();RT=jk(os());Uc()});function p2(){}function kee(){let t=[],e=null,r=p2,i=!1,n=null,s=p2,o=()=>(e||(e=new Promise(l=>{r=()=>{e=null,r=p2,l()}})),e),a={write(l){t.push(l);let u=o();return s(),u},async end(){i=!0;let l=o();return s(),l}},c={async next(){let l=t.shift();return l?(t.length===0&&r(),{done:!1,value:l}):i?(r(),{done:!0,value:void 0}):(n||(n=new Promise(u=>{s=()=>(n=null,s=p2,u(c.next()))})),n)}};return{writer:a,iterator:c}}var qee=Ge(()=>{f()});async function y2(t){let e=await t.upTo(8),r=dl.default.decode(e);return t.seek(dl.default.decode.bytes),r}async function OT(t){let e=await y2(t);if(e===0)throw new Error("Invalid CAR header (zero length)");let r=await t.exactly(e);t.seek(e);let i=wI(r);if(i==null||Array.isArray(i)||typeof i!="object")throw new Error("Invalid CAR header format");if(i.version!==1)throw typeof i.version=="string"?new Error(`Invalid CAR version: "${i.version}"`):new Error(`Invalid CAR version: ${i.version}`);if(!Array.isArray(i.roots))throw new Error("Invalid CAR header format");if(Object.keys(i).filter(n=>n!=="roots"&&n!=="version").length)throw new Error("Invalid CAR header format");return i}async function A$e(t){let e=await t.upTo(8);dl.default.decode(e);let r=dl.default.decode.bytes,i=dl.default.decode(e.subarray(dl.default.decode.bytes)),n=dl.default.decode.bytes,s=r+n+i,o=await t.exactly(s);return t.seek(s),o}async function I$e(t){let e=await t.exactly(2);if(e[0]===CT.SHA2_256&&e[1]===CT.LENGTH){let o=await t.exactly(34);t.seek(34);let a=ed(o);return rt.create(0,CT.DAG_PB,a)}let r=await y2(t);if(r!==1)throw new Error(`Unexpected CID version (${r})`);let i=await y2(t),n=await A$e(t),s=ed(n);return rt.create(r,i,s)}async function Bee(t){let e=t.pos,r=await y2(t);if(r===0)throw new Error("Invalid CAR section (zero length)");r+=t.pos-e;let i=await I$e(t),n=r-(t.pos-e);return{cid:i,length:r,blockLength:n}}async function T$e(t){let{cid:e,blockLength:r}=await Bee(t),i=await t.exactly(r);return t.seek(r),{bytes:i,cid:e}}async function R$e(t){let e=t.pos,{cid:r,length:i,blockLength:n}=await Bee(t),s={cid:r,length:i,blockLength:n,offset:e,blockOffset:t.pos};return t.seek(s.blockLength),s}function Nee(t){let e=OT(t);return{header:()=>e,async*blocks(){for(await e;(await t.upTo(8)).length>0;)yield await T$e(t)},async*blocksIndex(){for(await e;(await t.upTo(8)).length>0;)yield await R$e(t)}}}function g2(t){let e=0;return{async upTo(r){return t.subarray(e,e+Math.min(r,t.length-e))},async exactly(r){if(r>t.length-e)throw new Error("Unexpected end of data");return t.subarray(e,e+r)},seek(r){e+=r},get pos(){return e}}}function P$e(t){let e=0,r=0,i=0,n=new Uint8Array(0),s=async o=>{r=n.length-i;let a=[n.subarray(i)];for(;r<o;){let l=await t();if(l==null)break;r<0?l.length>r&&a.push(l.subarray(-r)):a.push(l),r+=l.length}n=new Uint8Array(a.reduce((l,u)=>l+u.length,0));let c=0;for(let l of a)n.set(l,c),c+=l.length;i=0};return{async upTo(o){return n.length-i<o&&await s(o),n.subarray(i,i+Math.min(n.length-i,o))},async exactly(o){if(n.length-i<o&&await s(o),n.length-i<o)throw new Error("Unexpected end of data");return n.subarray(i,i+o)},seek(o){e+=o,i+=o},get pos(){return e}}}function Dee(t){let e=t[Symbol.asyncIterator]();async function r(){let i=await e.next();return i.done?null:i.value}return P$e(r)}var dl,CT,kT=Ge(()=>{f();dl=jk(os());Ae();An();Uc();CT={SHA2_256:18,LENGTH:32,DAG_PB:112}});var Lee={};Gt(Lee,{CarWriter:()=>Yb,CarWriterOut:()=>b2,__browser:()=>O$e});function Mee(){let t=kee(),{writer:e,iterator:r}=t;return{encoder:Cee(e),iterator:r}}function C$e(t){if(t===void 0)return[];if(!Array.isArray(t)){let r=rt.asCID(t);if(!r)throw new TypeError("roots must be a single CID or an array of CIDs");return[r]}let e=[];for(let r of t){let i=rt.asCID(r);if(!i)throw new TypeError("roots must be a single CID or an array of CIDs");e.push(i)}return e}var Yb,b2,O$e,Uee=Ge(()=>{f();Ae();Oee();qee();kT();Yb=class{constructor(e,r){this._encoder=r,this._mutex=r.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let r=rt.asCID(e.cid);if(!r)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:r,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=C$e(e);let{encoder:r,iterator:i}=Mee(),n=new Yb(e,r),s=new b2(i);return{writer:n,out:s}}static createAppender(){let{encoder:e,iterator:r}=Mee();e.setRoots=()=>Promise.resolve();let i=new Yb([],e),n=new b2(r);return{writer:i,out:n}}static async updateRootsInBytes(e,r){let i=g2(e);await OT(i);let n=PT(r);if(i.pos!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${i.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}},b2=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}};O$e=!0});var Vee=p((UCt,jee)=>{f();"use strict";var{CID:k$e}=(Ae(),Ce),q$e=(i_(),r_),{base58btc:B$e}=(si(),ni),{CarWriter:N$e}=(Uee(),Lee),D$e=Oe(),Fee=me()("ipfs:components:dag:import"),M$e=(Rs(),ns),L$e=(qx(),Bv),U$e=[M$e.code,L$e.code];jee.exports=({repo:t,preload:e,codecs:r})=>{async function*i(n,s={}){s.preload!==!1&&e(n);let o=k$e.asCID(n);if(!o)throw new Error(`Unexpected error converting CID type: ${n}`);Fee(`Exporting ${o} as car`);let{writer:a,out:c}=await N$e.create([o]),l=null;(async()=>{try{await Kee(t,{signal:s.signal,timeout:s.timeout},o,a,r),a.close()}catch(u){l=u}})();for await(let u of c){if(l)break;yield u}if(l)throw l}return D$e(i)};async function Kee(t,e,r,i,n,s=new Set){let o=r.toString(B$e);if(s.has(o))return;let a=await F$e(t,e,r,n);Fee(`Adding block ${r} to car`),await i.put(a),s.add(o);for(let c of a.links)await Kee(t,e,c,i,n,s)}async function F$e(t,e,r,i){let n=await t.blocks.get(r,e),s=[],o=await i.getCodec(r.code);if(o)s=[...q$e.createUnsafe({bytes:n,cid:r,codec:o}).links()].map(c=>c[1]);else if(!U$e.includes(r.code))throw new Error(`Can't decode links in block with codec 0x${r.code.toString(16)} to form complete DAG`);return{cid:r,bytes:n,links:s}}});var $ee=p((FCt,Hee)=>{f();"use strict";var K$e=Oe(),j$e=lp(),V$e=$n(),{resolve:zee}=zi(),z$e=ae();Hee.exports=({codecs:t,repo:e,preload:r})=>K$e(async function(s,o={}){if(o.preload!==!1&&r(s),o.path){let h=o.localResolve?await j$e(zee(s,o.path,t,e,o)):await V$e(zee(s,o.path,t,e,o));if(!h)throw z$e(new Error("Not found"),"ERR_NOT_FOUND");return h}let a=await t.getCodec(s.code),c=await e.blocks.get(s,o);return{value:a.decode(c),remainderPath:""}})});var Xee={};Gt(Xee,{CarBlockIterator:()=>Xb,CarCIDIterator:()=>Qb,CarIteratorBase:()=>m2});async function Gee(t){if(!(t instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return Yee(g2(t))}async function Wee(t){if(!t||typeof t[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return Yee(Dee(t))}async function Yee(t){let e=Nee(t),{version:r,roots:i}=await e.header();return{version:r,roots:i,iterator:e.blocks()}}var m2,Xb,Qb,Qee=Ge(()=>{f();kT();m2=class{constructor(e,r,i){this._version=e,this._roots=r,this._iterable=i,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},Xb=class extends m2{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:r,roots:i,iterator:n}=await Gee(e);return new Xb(r,i,n)}static async fromIterable(e){let{version:r,roots:i,iterator:n}=await Wee(e);return new Xb(r,i,n)}},Qb=class extends m2{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;let e=this._iterable[Symbol.asyncIterator]();return{async next(){let r=await e.next();return r.done?r:{done:!1,value:r.value.cid}}}}static async fromBytes(e){let{version:r,roots:i,iterator:n}=await Gee(e);return new Qb(r,i,n)}static async fromIterable(e){let{version:r,roots:i,iterator:n}=await Wee(e);return new Qb(r,i,n)}}});var ete=p((jCt,Jee)=>{f();"use strict";var{CarBlockIterator:H$e}=(Qee(),Xee),$$e=Oe(),G$e=Rb(),W$e=Ka(),Y$e=ko(),Zee=me()("ipfs:components:dag:import");Jee.exports=({repo:t})=>{async function*e(r,i={}){let n=await t.gcLock.readLock();try{let s={signal:i.signal,timeout:i.timeout},o=G$e(r),{value:a,done:c}=await o.peek();if(c)return;a&&o.push(a);let l;a instanceof Uint8Array?l=[o]:l=o;for await(let u of l){let h=await X$e(t,s,u);if(i.pinRoots!==!1)for(let d of h){let y="";try{await t.blocks.has(d)?(Zee(`Pinning root ${d}`),await t.pins.pinRecursively(d)):y="blockstore: block not found"}catch(g){y=g.message}yield{root:{cid:d,pinErrorMsg:y}}}}}finally{n()}}return $$e(e)};async function X$e(t,e,r){let i=await H$e.fromIterable(r),n=await i.getRoots();return await W$e(t.blocks.putMany(Y$e(i,({cid:s,bytes:o})=>(Zee(`Import block ${s}`),{key:s,value:o})),{signal:e.signal})),n}});var rte=p((VCt,tte)=>{f();"use strict";var{CID:Q$e}=(Ae(),Ce),Z$e=Oe();tte.exports=({repo:t,codecs:e,hashers:r,preload:i})=>{async function n(s,o={}){let a=o.pin?await t.gcLock.readLock():null;try{let c=o.format||"dag-cbor",l=o.version!=null?o.version:c==="dag-pb"?0:1,u=await e.getCodec(c);if(!u)throw new Error(`Unknown codec ${o.format}, please configure additional BlockCodecs for this IPFS instance`);let h=await r.getHasher(o.hashAlg||"sha2-256");if(!h)throw new Error(`Unknown hash algorithm ${o.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let d=u.encode(s),y=await h.digest(d),g=Q$e.create(l,u.code,y);return await t.blocks.put(g,d,{signal:o.signal}),o.pin&&await t.pins.pinRecursively(g),o.preload!==!1&&i(g),g}finally{a&&a()}}return Z$e(n)}});var nte=p((zCt,ite)=>{f();"use strict";var J$e=Oe(),eGe=Jg(),{resolvePath:tGe}=zi();ite.exports=({repo:t,codecs:e,preload:r})=>{async function i(n,s={}){let{cid:o}=eGe(n);return s.preload!==!1&&r(o),tGe(t,e,n,s)}return J$e(i)}});var ate=p((HCt,ote)=>{f();"use strict";var rGe=Vee(),iGe=$ee(),nGe=ete(),sGe=rte(),oGe=nte(),ste=class{constructor({repo:e,codecs:r,hashers:i,preload:n}){this.export=rGe({repo:e,preload:n,codecs:r}),this.get=iGe({codecs:r,repo:e,preload:n}),this.import=nGe({repo:e}),this.resolve=oGe({repo:e,codecs:r,preload:n}),this.put=sGe({repo:e,codecs:r,hashers:i,preload:n})}};ote.exports=ste});var w2=p(($Ct,cte)=>{f();var{Multiaddr:aGe}=tt(),v2=(t,e)=>e,cGe=(t,e,r,i)=>{if(i&&i.assumeHttp===!1)return`tcp://${t}:${e}`;let n="tcp",s=`:${e}`;return r[r.length-1].protocol==="tcp"&&(n=e==="443"?"https":"http",s=e==="443"||e==="80"?"":s),`${n}://${t}${s}`},uGe={ip4:v2,ip6:(t,e,r,i)=>i.length===1&&i[0].protocol==="ip6"?e:`[${e}]`,tcp:(t,e,r,i,n)=>i.some(s=>["http","https","ws","wss"].includes(s.protocol))?`${t}:${e}`:cGe(t,e,i,n),udp:(t,e)=>`udp://${t}:${e}`,dnsaddr:v2,dns4:v2,dns6:v2,ipfs:(t,e)=>`${t}/ipfs/${e}`,p2p:(t,e)=>`${t}/p2p/${e}`,http:t=>`http://${t}`,https:t=>`https://${t}`,ws:t=>`ws://${t}`,wss:t=>`wss://${t}`,"p2p-websocket-star":t=>`${t}/p2p-websocket-star`,"p2p-webrtc-star":t=>`${t}/p2p-webrtc-star`,"p2p-webrtc-direct":t=>`${t}/p2p-webrtc-direct`};cte.exports=(t,e)=>{let r=new aGe(t),i=t.toString().split("/").slice(1);return r.tuples().map(n=>({protocol:i.shift(),content:n[1]?i.shift():null})).reduce((n,s,o,a)=>{let c=uGe[s.protocol];if(!c)throw new Error(`Unsupported protocol ${s.protocol}`);return c(n,s.content,o,a,e)},"")}});var lte=p((GCt,ute)=>{f();"use strict";ute.exports=t=>{if(!Array.isArray(t))throw new TypeError(`Expected an array, got ${typeof t}`);t=[...t];for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}});var dte=p((WCt,hte)=>{f();"use strict";var{default:lGe}=Kc(),fGe=$y(),fte=me(),hGe=Object.assign(fte("ipfs:preload"),{error:fte("ipfs:preload:error")}),dGe=new lGe({concurrency:4});hte.exports=function(e,r={}){return hGe(e),dGe.add(async()=>{let n=(await fGe.post(e,{signal:r.signal})).body.getReader();try{for(;;){let{done:s}=await n.read();if(s)return}}finally{n.releaseLock()}})}});var gte=p((YCt,yte)=>{f();"use strict";var pGe=w2(),pte=me(),yGe=lte(),{AbortController:gGe}=sn(),bGe=dte(),mGe=eb(),Zb=Object.assign(pte("ipfs:preload"),{error:pte("ipfs:preload:error")}),vGe=(t={})=>{if(t.enabled=Boolean(t.enabled),t.addresses=t.addresses||[],t.cache=t.cache||1e3,!t.enabled||!t.addresses.length)return Zb("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let e=!0,r=[],i=t.addresses.map(pGe),n=mGe(t.cache),s=async o=>{try{if(e)throw new Error(`preload ${o} but preloader is not started`);let a=o.toString();if(n.has(a))return;n.set(a,!0);let c=yGe(i),l=!1,u=Date.now();for(let h of c){if(e)throw new Error(`preload aborted for ${a}`);let d;try{d=new gGe,r=r.concat(d),await bGe(`${h}/api/v0/refs?r=true&arg=${encodeURIComponent(a)}`,{signal:d.signal}),l=!0}catch(y){y.type!=="aborted"&&Zb.error(y)}finally{r=r.filter(y=>y!==d)}if(l)break}Zb(`${l?"":"un"}successfully preloaded ${a} in ${Date.now()-u}ms`)}catch(a){Zb.error(a)}};return s.start=()=>{e=!1},s.stop=()=>{e=!0,Zb(`aborting ${r.length} pending preload request(s)`),r.forEach(o=>o.abort()),r=[]},s};yte.exports=vGe});var vte=p((XCt,mte)=>{f();"use strict";var bte=me(),_2=Object.assign(bte("ipfs:mfs-preload"),{error:bte("ipfs:mfs-preload:error")});mte.exports=({preload:t,files:e,options:r={}})=>{if(r.interval=r.interval||30*1e3,!r.enabled){_2("MFS preload disabled");let o=async()=>{};return{start:o,stop:o}}let i="",n,s=async()=>{try{let o=await e.stat("/"),a=o.cid.toString();i!==a&&(_2(`preloading updated MFS root ${i} -> ${o.cid}`),await t(o.cid),i=a)}catch(o){_2.error("failed to preload MFS root",o)}finally{n=setTimeout(s,r.interval)}};return{async start(){let o=await e.stat("/");i=o.cid.toString(),_2(`monitoring MFS root ${o.cid}`),n=setTimeout(s,r.interval)},stop(){clearTimeout(n)}}}});var qT=p((QCt,wte)=>{f();"use strict";var wGe=P4(),E2;wte.exports=(t=!1)=>{if(E2)return E2;let e=wGe({singleProcess:t});return E2={readLock:r=>async(...i)=>{let n=await e.readLock();try{return await r.apply(null,i)}finally{n()}},writeLock:r=>async(...i)=>{let n=await e.writeLock();try{return await r.apply(null,i)}finally{n()}}},E2}});var S2=p((ZCt,Ate)=>{f();"use strict";var{CID:_te}=(Ae(),Ce),{UnixFS:_Ge}=Ei(),EGe=(At(),xt),{sha256:SGe}=(ai(),$r),Ete=me()("ipfs:mfs:utils:with-mfs-root"),Ste=ae(),{MFS_ROOT_KEY:xte}=zi(),xGe=async(t,e)=>{if(e&&e.signal&&e.signal.aborted)throw Ste(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await t.repo.datastore.open();let r;try{let i=await t.repo.datastore.get(xte);r=_te.decode(i)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i;Ete("Creating new MFS root");let n=EGe.encode({Data:new _Ge({type:"directory"}).marshal(),Links:[]}),s=await SGe.digest(n);if(r=_te.createV0(s),await t.repo.blocks.put(r,n),e&&e.signal&&e.signal.aborted)throw Ste(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await t.repo.datastore.put(xte,r.bytes)}return Ete(`Loaded MFS root /ipfs/${r}`),r};Ate.exports=xGe});var x2=p((JCt,Ite)=>{f();"use strict";var AGe=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);Ite.exports=AGe});var Wc=p((eOt,Rte)=>{f();"use strict";var IGe=S2(),TGe=x2(),{exporter:RGe}=Do(),Tte=ae(),{CID:PGe}=(Ae(),Ce),BT="ipfs",CGe=async(t,e,r)=>{let i=await IGe(t,r),n={entryType:"file"},s="";if(e instanceof PGe?s=`/ipfs/${e}`:s=e,s=s.trim(),s=s.replace(/(\/\/+)/g,"/"),s.endsWith("/")&&s.length>1&&(s=s.substring(0,s.length-1)),!s)throw Tte(new Error("paths must not be empty"),"ERR_NO_PATH");if(s.substring(0,1)!=="/")throw Tte(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");s.substring(s.length-1)==="/"&&(s=s.substring(0,s.length-1));let o=TGe(s);if(o[0]===BT){let c;o.length===2?c=`/${o.join("/")}`:c=`/${o.slice(0,o.length-1).join("/")}`,n={type:"ipfs",depth:o.length-2,entryType:"file",mfsPath:`/${o.join("/")}`,mfsDirectory:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}else{let c=`/${BT}/${i}${o.length?"/"+o.join("/"):""}`,l=`/${BT}/${i}/${o.slice(0,o.length-1).join("/")}`;n={type:"mfs",depth:o.length,entryType:"file",mfsDirectory:l,mfsPath:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}let a=n.type==="mfs"?n.mfsPath:n.path;try{let c=await RGe(a,t.repo.blocks,r);n.cid=c.cid,n.mfsPath=`/ipfs/${c.path}`,n.entryType=c.type,n.content=c.content,(n.entryType==="file"||n.entryType==="directory")&&(c.type==="file"||c.type==="directory")&&(n.unixfs=c.unixfs)}catch(c){if(c.code!=="ERR_NOT_FOUND")throw c}return n.exists=Boolean(n.cid),n};Rte.exports=CGe});var Jb=p((tOt,Ote)=>{f();"use strict";var OGe=wr().bind({ignoreUndefined:!0}),kGe=Wc(),{exporter:qGe}=Do(),BGe=me()("ipfs:mfs:stat"),NGe=ae(),DGe=Oe(),Pte=(At(),xt),MGe={withLocal:!1};Ote.exports=t=>{async function e(r,i={}){i=OGe(MGe,i),BGe(`Fetching stats for ${r}`);let{type:n,cid:s,mfsPath:o}=await kGe(t,r,i),a=n==="ipfs"&&s?s:o,c;try{c=await qGe(a,t.repo.blocks)}catch(l){throw l.code==="ERR_NOT_FOUND"?NGe(new Error(`${r} does not exist`),"ERR_NOT_FOUND"):l}if(!Cte[c.type])throw new Error(`Cannot stat codec ${c.cid.code}`);return Cte[c.type](c)}return DGe(e)};var Cte={raw:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:t=>{let e={cid:t.cid,type:"file",size:t.unixfs.fileSize(),cumulativeSize:Pte.encode(t.node).length+(t.node.Links||[]).reduce((r,i)=>r+(i.Tsize||0),0),blocks:t.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:t.unixfs.mode};return t.unixfs.mtime&&(e.mtime=t.unixfs.mtime),e},directory:t=>{let e={cid:t.cid,type:"directory",size:0,cumulativeSize:Pte.encode(t.node).length+(t.node.Links||[]).reduce((r,i)=>r+(i.Tsize||0),0),blocks:t.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:t.unixfs.mode};return t.unixfs.mtime&&(e.mtime=t.unixfs.mtime),e},object:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})}});var jp=p((rOt,kte)=>{f();"use strict";var{walkPath:LGe}=Do(),UGe=me()("ipfs:mfs:utils:to-trail"),FGe=async(t,e)=>{UGe(`Creating trail for path ${e}`);let r=[];for await(let i of LGe(e,t.repo.blocks))r.push({name:i.name,cid:i.cid,size:i.size,type:i.type});return r};kte.exports=FGe});var DT=p((iOt,Mte)=>{f();"use strict";var A2=(At(),xt),{Bucket:qte,createHAMT:KGe}=L_(),jGe=U_(),NT=k_(),I2=me()("ipfs:mfs:core:utils:hamt-utils"),{UnixFS:Bte}=Ei(),VGe=$n(),{CID:zGe}=(Ae(),Ce),HGe=async(t,e,r,i)=>{let n=NT();if(!i.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");let s=Uint8Array.from(r._children.bitField().reverse()),o=Bte.unmarshal(i.parent.Data),a=new Bte({type:"hamt-sharded-directory",data:s,fanout:r.tableSize(),hashType:n.hamtHashCode,mode:o.mode,mtime:o.mtime}),c=await t.hashers.getHasher(i.hashAlg),l={Data:a.marshal(),Links:e.sort((y,g)=>(y.Name||"").localeCompare(g.Name||""))},u=A2.encode(l),h=await c.digest(u),d=zGe.create(i.cidVersion,A2.code,h);return i.flush&&await t.repo.blocks.put(d,u),{node:l,cid:d,size:e.reduce((y,g)=>y+(g.Tsize||0),u.length)}},Nte=async(t,e,r,i)=>{let n=new qte({hash:e._options.hash,bits:e._options.bits},r,i);return r._putObjectAt(i,n),await T2(t,n,e),n},Dte=async t=>{let e=NT(),r=KGe({hashFn:e.hamtHashFn,bits:e.hamtBucketBits});return await T2(t,r,r),r},T2=async(t,e,r)=>{await Promise.all(t.map(i=>{let n=i.Name||"";if(n.length===2){let s=parseInt(n,16);return e._putObjectAt(s,new qte({hash:r._options.hash,bits:r._options.bits},e,s)),Promise.resolve()}return r.put(n.substring(2),{size:i.Tsize,cid:i.Hash})}))},R2=t=>t.toString(16).toUpperCase().padStart(2,"0").substring(0,2),$Ge=async(t,e,r)=>{let i=await Dte(r.Links),n=await i._findNewBucketAndPos(e),s=[{bucket:n.bucket,prefix:R2(n.pos)}],o=n.bucket;for(;o!==i;)s.push({bucket:o,prefix:R2(o._posAtParent)}),o=o._parent;s.reverse(),s[0].node=r;for(let a=0;a<s.length;a++){let c=s[a];if(!c.node)throw new Error("Could not generate HAMT path");let l=c.node.Links.filter(y=>(y.Name||"").substring(0,2)===c.prefix).pop();if(!l){I2(`Link ${c.prefix}${e} will be added`);continue}if(l.Name===`${c.prefix}${e}`){I2(`Link ${c.prefix}${e} will be replaced`);continue}I2(`Found subshard ${c.prefix}`);let u=await t.repo.blocks.get(l.Hash),h=A2.decode(u);if(!s[a+1]){I2(`Loaded new subshard ${c.prefix}`),await Nte(h.Links,i,c.bucket,parseInt(c.prefix,16));let y=await i._findNewBucketAndPos(e);s.push({bucket:y.bucket,prefix:R2(y.pos),node:h});continue}let d=s[a+1];await T2(h.Links,d.bucket,i),d.node=h}return await i.put(e,!0),s.reverse(),{rootBucket:i,path:s}},GGe=async(t,e,r={})=>{let i=NT(),n=new jGe({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1,mtime:r.mtime,mode:r.mode},{hamtHashFn:i.hamtHashFn,hamtHashCode:i.hamtHashCode,hamtBucketBits:i.hamtBucketBits,hasher:i.hasher,...r,codec:A2});for(let s=0;s<e.length;s++)await n._bucket.put(e[s].name,{size:e[s].size,cid:e[s].cid});return VGe(n.flush(t.repo.blocks))};Mte.exports={generatePath:$Ge,updateHamtDirectory:HGe,recreateHamtLevel:Nte,recreateInitialHamtLevel:Dte,addLinksToHamtBucket:T2,toPrefix:R2,createShard:GGe}});var Yf=p((nOt,Ute)=>{f();"use strict";var Wf=(At(),xt),{sha256:WGe,sha512:YGe}=(ai(),$r),{CID:Lte}=(Ae(),Ce),Za=me()("ipfs:mfs:core:utils:add-link"),{UnixFS:MT}=Ei(),XGe=U_(),QGe=k_(),{updateHamtDirectory:ZGe,recreateHamtLevel:JGe,recreateInitialHamtLevel:eWe,createShard:tWe,toPrefix:LT,addLinksToHamtBucket:rWe}=DT(),Yc=ae(),iWe=$n(),nWe=async(t,e)=>{let r=e.parent;if(e.parentCid){let n=Lte.asCID(e.parentCid);if(n===null)throw Yc(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(n.code!==Wf.code)throw Yc(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");Za(`Loading parent node ${n}`);let s=await t.repo.blocks.get(n);r=Wf.decode(s)}if(!r)throw Yc(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!e.cid)throw Yc(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!e.name)throw Yc(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!e.size&&e.size!==0)throw Yc(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!r.Data)throw Yc(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");let i=MT.unmarshal(r.Data);return i.type==="hamt-sharded-directory"?(Za("Adding link to sharded directory"),aWe(t,{...e,parent:r})):r.Links.length>=e.shardSplitThreshold?(Za("Converting directory to sharded directory"),sWe(t,{...e,parent:r,mtime:i.mtime,mode:i.mode})):(Za(`Adding ${e.name} (${e.cid}) to regular directory`),oWe(t,{...e,parent:r}))},sWe=async(t,e)=>{let r=await tWe(t,e.parent.Links.map(i=>({name:i.Name||"",size:i.Tsize||0,cid:i.Hash})).concat({name:e.name,size:e.size,cid:e.cid}),e);return Za(`Converted directory to sharded directory ${r.cid}`),r},oWe=async(t,e)=>{let r=e.parent.Links.filter(l=>l.Name!==e.name);if(r.push({Name:e.name,Tsize:e.size,Hash:e.cid}),!e.parent.Data)throw Yc(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");let i=MT.unmarshal(e.parent.Data),n;if(i.mtime){let l=Date.now(),u=Math.floor(l/1e3);i.mtime={secs:u,nsecs:(l-u*1e3)*1e3},n=i.marshal()}else n=e.parent.Data;e.parent=Wf.prepare({Data:n,Links:r});let s=await t.hashers.getHasher(e.hashAlg),o=Wf.encode(e.parent),a=await s.digest(o),c=Lte.create(e.cidVersion,Wf.code,a);return e.flush&&await t.repo.blocks.put(c,o),{node:e.parent,cid:c,size:o.length}},aWe=async(t,e)=>{let{shard:r,path:i}=await cWe(t,e),n=await iWe(r.flush(t.repo.blocks)),s=await t.repo.blocks.get(n.cid),o=Wf.decode(s),a=e.parent.Links.filter(l=>(l.Name||"").substring(0,2)!==i[0].prefix),c=o.Links.find(l=>(l.Name||"").substring(0,2)===i[0].prefix);if(!c)throw new Error(`No link found with prefix ${i[0].prefix}`);return a.push(c),ZGe(t,a,i[0].bucket,e)},cWe=async(t,e)=>{let r={name:e.name,cid:e.cid,size:e.size};if(!e.parent.Data)throw Yc(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");let i=await eWe(e.parent.Links),n=MT.unmarshal(e.parent.Data),s=QGe(),o;switch(e.hashAlg){case"sha2-256":o=WGe;break;case"sha2-512":o=YGe;break;default:throw new Error(`TODO vmx 2021-03-31: Proper error message for unsupported hash algorithms like ${e.hashAlg}`)}let a=new XGe({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1,mode:n.mode},{hamtHashFn:s.hamtHashFn,hamtHashCode:s.hamtHashCode,hamtBucketBits:s.hamtBucketBits,hasher:o,...e});a._bucket=i,n.mtime&&(a.mtime=new Date);let c=await i._findNewBucketAndPos(r.name),l=uWe(c);l[0].node=e.parent;let u=0;for(;u<l.length;){let h=l[u];u++;let d=h.node;if(!d)throw new Error("Segment had no node");let y=d.Links.find(v=>(v.Name||"").substring(0,2)===h.prefix);if(!y){Za(`Link ${h.prefix}${r.name} will be added`),u=l.length;break}if(y.Name===`${h.prefix}${r.name}`){Za(`Link ${h.prefix}${r.name} will be replaced`),u=l.length;break}if((y.Name||"").length>2){Za(`Link ${y.Name} ${y.Hash} will be replaced with a subshard`),u=l.length;break}Za(`Found subshard ${h.prefix}`);let g=await t.repo.blocks.get(y.Hash),m=Wf.decode(g);if(!l[u]){Za(`Loaded new subshard ${h.prefix}`),await JGe(m.Links,i,h.bucket,parseInt(h.prefix,16));let v=await i._findNewBucketAndPos(r.name);l.push({bucket:v.bucket,prefix:LT(v.pos),node:m});break}let E=l[u];await rWe(m.Links,E.bucket,i),E.node=m}return await a._bucket.put(r.name,{size:r.size,cid:r.cid}),{shard:a,path:l}},uWe=t=>{let e=[{bucket:t.bucket,prefix:LT(t.pos)}],r=t.bucket._parent,i=t.bucket._posAtParent;for(;r;)e.push({bucket:r,prefix:LT(i)}),i=r._posAtParent,r=r._parent;return e.reverse(),e};Ute.exports=nWe});var Xf=p((sOt,Kte)=>{f();"use strict";var Fte=me()("ipfs:mfs:utils:update-tree"),lWe=Yf(),{decode:fWe}=(At(),xt),hWe={shardSplitThreshold:1e3},dWe=async(t,e,r)=>{r=Object.assign({},hWe,r),Fte("Trail",e),e=e.slice().reverse();let i=0,n;for await(let o of t.repo.blocks.getMany(e.map(a=>a.cid))){let a=fWe(o),c=e[i].cid,l=e[i].name;if(i++,!n){n={cid:c,name:l,size:o.length};continue}let u=await lWe(t,{parent:a,name:n.name,cid:n.cid,size:n.size,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold,hashAlg:r.hashAlg,cidVersion:r.cidVersion});n={cid:u.cid,name:l,size:u.size}}let{cid:s}=n;return Fte(`Final CID ${s}`),s};Kte.exports=dWe});var Qf=p((oOt,jte)=>{f();"use strict";var pWe=me()("ipfs:mfs:utils:update-mfs-root"),{MFS_ROOT_KEY:yWe}=zi(),gWe=ae(),bWe=async(t,e,r)=>{if(r&&r.signal&&r.signal.aborted)throw gWe(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return pWe(`New MFS root will be ${e}`),await t.repo.datastore.put(yWe,e.bytes),e};jte.exports=bWe});var Hte=p((aOt,zte)=>{f();"use strict";var{UnixFS:mWe}=Ei(),Vte=(At(),xt),{CID:vWe}=(Ae(),Ce),wWe=async(t,e,r)=>{let i=new mWe({type:e,mode:r.mode,mtime:r.mtime}),n=await t.hashers.getHasher(r.hashAlg),s={Data:i.marshal(),Links:[]},o=Vte.encode(s),a=await n.digest(o),c=vWe.create(r.cidVersion,Vte.code,a);return r.flush&&await t.repo.blocks.put(c,o),{cid:c,node:s}};zte.exports=wWe});var P2=p((cOt,Gte)=>{f();"use strict";var Vp=ae(),$te=me()("ipfs:mfs:mkdir"),{exporter:_We}=Do(),EWe=Hte(),SWe=x2(),xWe=Qf(),AWe=Xf(),IWe=Yf(),TWe=S2(),RWe=wr().bind({ignoreUndefined:!0}),PWe=Oe(),CWe={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};Gte.exports=t=>{async function e(r,i={}){let n=RWe(CWe,i);if(!r)throw new Error("no path given to Mkdir");if(r=r.trim(),r==="/"){if(n.parents)return;throw Vp(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if(r.substring(0,1)!=="/")throw Vp(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");$te(`Creating ${r}`);let s=SWe(r);if(s[0]==="ipfs")throw Vp(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let o=await TWe(t,n),a,c=[],l=await EWe(t,"directory",n);for(let h=0;h<=s.length;h++){let d=s.slice(0,h),y=`/ipfs/${o}/${d.join("/")}`;try{if(a=await _We(y,t.repo.blocks),a.type!=="file"&&a.type!=="directory")throw Vp(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(h===s.length){if(n.parents)return;throw Vp(new Error("file already exists"),"ERR_ALREADY_EXISTS")}c.push({name:a.name,cid:a.cid})}catch(g){if(g.code==="ERR_NOT_FOUND"){if(h<s.length&&!n.parents)throw Vp(new Error(`Intermediate directory path ${y} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await OWe(t,d[d.length-1],l,c[c.length-1],c,n)}else throw g}}let u=await AWe(t,c,n);await xWe(t,u,n)}return PWe(e)};var OWe=async(t,e,r,i,n,s)=>{$te(`Adding empty dir called ${e} to ${i.cid}`);let o=await IWe(t,{parent:i.node,parentCid:i.cid,size:0,cid:r.cid,name:e,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});n[n.length-1].cid=o.cid,n.push({name:e,cid:r.cid})}});var k2=p((uOt,Jte)=>{f();"use strict";var Wte=P2(),kWe=Jb(),C2=me()("ipfs:mfs:cp"),Zf=ae(),Yte=Xf(),Xte=Qf(),qWe=Yf(),O2=Wc(),BWe=wr().bind({ignoreUndefined:!0}),NWe=jp(),DWe=Oe(),MWe={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};Jte.exports=t=>{async function e(r,i,n={}){let s=BWe(MWe,n);Array.isArray(r)||(r=[r]);let o=await Promise.all(r.map(d=>O2(t,d,s))),a=await O2(t,i,s);if(!o.length||!a)throw Zf(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let c=o.find(d=>!d.exists);if(c)throw Zf(new Error(`${c.path} does not exist`),"ERR_INVALID_PARAMS");let l=Qte(a);if(a.exists){if(C2("Destination exists"),o.length===1&&!l)throw Zf(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(C2("Destination does not exist"),o.length>1){if(!s.parents)throw Zf(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await Wte(t)(a.path,s),a=await O2(t,a.path,s)}else if(a.parts.length>1){let d=`/${a.parts.slice(0,-1).join("/")}`;try{await kWe(t)(d,s)}catch(y){if(y.code!=="ERR_NOT_FOUND")throw y;if(!s.parents)throw Zf(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await Wte(t)(d,s),a=await O2(t,a.path,s)}}let u=Qte(a)?a.mfsPath:a.mfsDirectory,h=await NWe(t,u);if(o.length===1){let d=o.pop();if(!d)throw Zf(new Error("could not find source"),"ERR_INVALID_PARAMS");let y=l?d.name:a.name;return C2(`Only one source, copying to destination ${l?"directory":"file"} ${y}`),LWe(t,d,y,h,s)}return C2("Multiple sources, wrapping in a directory"),UWe(t,o,a,h,s)}return DWe(e)};var Qte=t=>t.unixfs&&t.unixfs.type&&t.unixfs.type.includes("directory"),LWe=async(t,e,r,i,n)=>{let s=i.pop();if(!s)throw Zf(new Error("destination had no parent"),"ERR_INVALID_PARAMS");s=await Zte(t,e,r,s,n),i.push(s);let o=await Yte(t,i,n);await Xte(t,o,n)},UWe=async(t,e,r,i,n)=>{for(let o=0;o<e.length;o++){let a=e[o];r=await Zte(t,a,a.name,r,n)}i[i.length-1]=r;let s=await Yte(t,i,n);await Xte(t,s,n)},Zte=async(t,e,r,i,n)=>{let s=await t.repo.blocks.get(e.cid),{node:o,cid:a}=await qWe(t,{parentCid:i.cid,size:s.length,cid:e.cid,name:r,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold});return i.node=o,i.cid=a,i.size=o.size,i}});var ire=p((lOt,rre)=>{f();"use strict";var UT=(At(),xt),{CID:ere}=(Ae(),Ce),pl=me()("ipfs:mfs:core:utils:remove-link"),{UnixFS:FWe}=Ei(),{generatePath:KWe,updateHamtDirectory:FT}=DT(),Jf=ae(),jWe=async(t,e)=>{let r=e.parent;if(e.parentCid){let n=ere.asCID(e.parentCid);if(n===null)throw Jf(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");pl(`Loading parent node ${n}`);let s=await t.repo.blocks.get(n);r=UT.decode(s)}if(!r)throw Jf(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!e.name)throw Jf(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!r.Data)throw Jf(new Error("Parent node had no data"),"ERR_INVALID_NODE");return FWe.unmarshal(r.Data).type==="hamt-sharded-directory"?(pl(`Removing ${e.name} from sharded directory`),zWe(t,{...e,parent:r})):(pl(`Removing link ${e.name} regular directory`),VWe(t,{...e,parent:r}))},VWe=async(t,e)=>{e.parent.Links=e.parent.Links.filter(o=>o.Name!==e.name);let r=await UT.encode(e.parent),n=await(await t.hashers.getHasher(e.hashAlg)).digest(r),s=ere.create(e.cidVersion,UT.code,n);return await t.repo.blocks.put(s,r),pl(`Updated regular directory ${s}`),{node:e.parent,cid:s}},zWe=async(t,e)=>{let{rootBucket:r,path:i}=await KWe(t,e.name,e.parent);await r.del(e.name);let{node:n}=await tre(t,i,e.name,e);return FT(t,n.Links,r,e)},tre=async(t,e,r,i)=>{let n=e.pop();if(!n)throw Jf(new Error("Could not find parent"),"EINVALIDPARENT");let{bucket:s,prefix:o,node:a}=n;if(!a)throw Jf(new Error("Could not find parent"),"EINVALIDPARENT");let c=a.Links.find(y=>(y.Name||"").substring(0,2)===o);if(!c)throw Jf(new Error(`No link found with prefix ${o} for file ${r}`),"ERR_NOT_FOUND");if(c.Name===`${o}${r}`){pl(`Removing existing link ${c.Name}`);let y=a.Links.filter(g=>g.Name!==c.Name);return await s.del(r),FT(t,y,s,i)}pl(`Descending into sub-shard ${c.Name} for ${o}${r}`);let l=await tre(t,e,r,i),u=l.cid,h=l.size,d=o;if(l.node.Links.length===1){pl(`Removing subshard for ${o}`);let y=l.node.Links[0];d=`${o}${(y.Name||"").substring(2)}`,u=y.Hash,h=y.Tsize||0}return pl(`Updating shard ${o} with name ${d}`),HWe(t,s,a,o,d,h,u,i)},HWe=(t,e,r,i,n,s,o,a)=>{let c=r.Links.filter(l=>l.Name!==i);return c.push({Name:n,Tsize:s,Hash:o}),FT(t,c,e,a)};rre.exports=jWe});var B2=p((fOt,sre)=>{f();"use strict";var q2=ae(),$We=Xf(),GWe=Qf(),WWe=ire(),nre=Wc(),YWe=jp(),XWe=Oe(),QWe=wr().bind({ignoreUndefined:!0}),ZWe={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};sre.exports=t=>{async function e(r,i={}){let n=QWe(ZWe,i);Array.isArray(r)||(r=[r]);let s=await Promise.all(r.map(o=>nre(t,o,n)));if(!s.length)throw q2(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach(o=>{if(o.path==="/")throw q2(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(let o of s)await JWe(t,o.path,n)}return XWe(e)};var JWe=async(t,e,r)=>{let i=await nre(t,e,r),n=await YWe(t,i.mfsPath),s=n[n.length-1];n.pop();let o=n[n.length-1];if(!o)throw q2(new Error(`${e} does not exist`),"ERR_NOT_FOUND");if(s.type==="directory"&&!r.recursive)throw q2(new Error(`${e} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:a}=await WWe(t,{parentCid:o.cid,name:s.name,hashAlg:r.hashAlg,cidVersion:r.cidVersion,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold});o.cid=a;let c=await $We(t,n,r);await GWe(t,c,r)}});var fre=p((hOt,lre)=>{f();"use strict";var eYe=wr().bind({ignoreUndefined:!0}),tYe=Wc(),rYe=me()("ipfs:mfs:touch"),e1=ae(),{UnixFS:ore}=Ei(),iYe=jp(),nYe=Yf(),sYe=Xf(),oYe=Qf(),eh=(At(),xt),{CID:are}=(Ae(),Ce),{pipe:aYe}=Pr(),{importer:cYe}=F_(),{recursive:uYe}=Do(),lYe=$n(),fYe=k2(),hYe=B2(),dYe=Lf(),pYe=Oe(),cre={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function yYe(t,e,r){let i=0;return(t.includes("x")||t.includes("X")&&(r||e&1||e&8||e&64))&&(i+=1),t.includes("w")&&(i+=2),t.includes("r")&&(i+=4),i}function gYe(t,e){let r=0;return t.includes("u")&&(r+=e<<6),t.includes("g")&&(r+=e<<3),t.includes("o")&&(r+=e),r}function bYe(t,e,r){return e.includes("t")&&(r+=parseInt("1000",8)),e.includes("s")&&(t.includes("u")&&(r+=parseInt("4000",8)),t.includes("g")&&(r+=parseInt("2000",8))),r}function mYe(t,e,r){e||(e=0);let i=t.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!i)throw new Error(`Invalid file mode: ${t}`);let[,n,s,o]=i;(n==="a"||!n)&&(n="ugo");let a=yYe(o,e,r);return a=gYe(n,a),a=bYe(n,o,a),s==="="?(n.includes("u")&&(e=e&parseInt("7077",8),e=e|a),n.includes("g")&&(e=e&parseInt("7707",8),e=e|a),n.includes("o")&&(e=e&parseInt("7770",8),e=e|a),e):s==="+"?a|e:s==="-"?a^e:e}function ure(t,e){if(t instanceof String||typeof t=="string"){let r=`${t}`;r.match(/^\d+$/g)?t=parseInt(r,8):t=0+r.split(",").reduce((i,n)=>mYe(n,i,e.isDirectory()),e.mode||0)}return t}lre.exports=t=>{async function e(r,i,n={}){let s=eYe(cre,n);rYe(`Fetching stats for ${r}`);let{cid:o,mfsDirectory:a,name:c}=await tYe(t,r,s);if(o.code!==eh.code)throw e1(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){let G=await aYe(async function*(){for await(let Y of uYe(o,t.repo.blocks)){if(Y.type!=="file"&&Y.type!=="directory")throw e1(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");Y.unixfs.mode=ure(i,Y.unixfs);let P=eh.prepare({Data:Y.unixfs.marshal(),Links:Y.node.Links});yield{path:Y.path,content:P}}},Y=>cYe(Y,t.repo.blocks,{...s,pin:!1,dagBuilder:async function*(P,b,w){for await(let S of P)yield async function(){let C=S.content,D=eh.encode(C),W=await dYe(D,b,w);if(!C.Data)throw e1(new Error(`${W} had no data`),"ERR_INVALID_NODE");let j=ore.unmarshal(C.Data);return{cid:W,size:D.length,path:S.path,unixfs:j}}}}),Y=>lYe(Y));if(!G)throw e1(new Error(`Could not chmod ${r}`),"ERR_COULD_NOT_CHMOD");await hYe(t)(r,s),await fYe(t)(`/ipfs/${G.cid}`,r,s);return}let l=await t.repo.blocks.get(o),u=eh.decode(l);if(!u.Data)throw e1(new Error(`${o} had no data`),"ERR_INVALID_NODE");let h=ore.unmarshal(u.Data);h.mode=ure(i,h);let d=eh.encode({Data:h.marshal(),Links:u.Links}),y=s.hashAlg||cre.hashAlg,m=await(await t.hashers.getHasher(y)).digest(d),E=are.create(s.cidVersion,eh.code,m);s.flush&&await t.repo.blocks.put(E,d);let v=await iYe(t,a),A=v[v.length-1],R=are.decode(A.cid.bytes),F=await t.repo.blocks.get(R),q=eh.decode(F),B=await nYe(t,{parent:q,name:c,cid:E,size:d.length,flush:s.flush,hashAlg:y,cidVersion:o.version,shardSplitThreshold:1/0});A.cid=B.cid;let z=await sYe(t,v,s);await oYe(t,z,s)}return pYe(e)}});var dre=p((dOt,hre)=>{f();"use strict";var vYe=Jb(),wYe=Oe(),_Ye=wr().bind({ignoreUndefined:!0}),EYe={};hre.exports=t=>{async function e(r,i={}){i=_Ye(EYe,i);let{cid:n}=await vYe(t)(r,i);return n}return wYe(e)}});var yre=p((pOt,pre)=>{f();"use strict";var SYe=k2(),xYe=B2(),AYe=wr().bind({ignoreUndefined:!0}),IYe=Oe(),TYe={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};pre.exports=t=>{async function e(r,i,n={}){let s=AYe(TYe,n);await SYe(t)(r,i,s),await xYe(t)(r,{...s,recursive:!0})}return IYe(e)}});var _re=p((yOt,wre)=>{f();"use strict";var RYe=wr().bind({ignoreUndefined:!0}),PYe=Wc(),CYe=me()("ipfs:mfs:touch"),gre=ae(),{UnixFS:bre}=Ei(),OYe=jp(),kYe=Yf(),qYe=Xf(),BYe=Qf(),th=(At(),xt),{CID:mre}=(Ae(),Ce),NYe=Oe(),vre={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};wre.exports=t=>{async function e(r,i={}){let n=RYe(vre,i);n.mtime=n.mtime||new Date,CYe(`Touching ${r} mtime: ${n.mtime}`);let{cid:s,mfsDirectory:o,name:a,exists:c}=await PYe(t,r,n),l=i.hashAlg||vre.hashAlg,u=await t.hashers.getHasher(l),h,d,y=n.cidVersion;if(c){if(s.code!==th.code)throw gre(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");y=s.version;let q=await t.repo.blocks.get(s),B=th.decode(q);if(!B.Data)throw gre(new Error(`${r} had no data`),"ERR_INVALID_NODE");let z=bre.unmarshal(B.Data);z.mtime=n.mtime,h=th.encode({Data:z.marshal(),Links:B.Links});let G=await u.digest(h);d=mre.create(n.cidVersion,th.code,G),n.flush&&await t.repo.blocks.put(d,h)}else{let q=new bre({type:"file",mtime:n.mtime});h=th.encode({Data:q.marshal(),Links:[]});let B=await u.digest(h);d=mre.create(n.cidVersion,th.code,B),n.flush&&await t.repo.blocks.put(d,h)}let g=await OYe(t,o),m=g[g.length-1],E=m.cid,v=await t.repo.blocks.get(E),A=th.decode(v),R=await kYe(t,{parent:A,name:a,cid:d,size:h.length,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:y});m.cid=R.cid;let F=await qYe(t,g,n);await BYe(t,F,n)}return NYe(e)}});var Are=p((gOt,xre)=>{f();"use strict";var Ere=ae(),t1=me()("ipfs:mfs:utils:to-async-iterator"),{MFS_MAX_CHUNK_SIZE:Sre}=zi(),DYe=ct(),MYe=t=>{if(!t)throw Ere(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof t=="string"||t instanceof String)&&(t1("Content was a string"),t=DYe(t.toString())),t.length)return t1("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield t}};if(t[Symbol.asyncIterator])return t1("Content was an async iterator"),t;if(t[Symbol.iterator])return t1("Content was an iterator"),t;if(globalThis.Blob&&t instanceof globalThis.Blob){t1("Content was an HTML5 Blob");let e=0,r={next:()=>e>t.size?{done:!0}:new Promise((i,n)=>{let s=t.slice(e,Sre);e+=Sre;let o=new globalThis.FileReader,a=c=>{if(o.removeEventListener("loadend",a,!1),c.error)return n(c.error);i({done:!1,value:new Uint8Array(o.result)})};o.addEventListener("loadend",a),o.readAsArrayBuffer(s)})};return{[Symbol.asyncIterator]:()=>r}}throw Ere(new Error(`Don't know how to convert ${t} into an async iterator`),"ERR_INVALID_PARAMS")};xre.exports=MYe});var Cre=p((bOt,Pre)=>{f();"use strict";var Ja=me()("ipfs:mfs:write"),{importer:LYe}=F_(),{decode:UYe}=(At(),xt),{sha256:FYe,sha512:KYe}=(ai(),$r),jYe=Jb(),VYe=P2(),zYe=Yf(),HYe=wr().bind({ignoreUndefined:!0}),Ire=qT(),$Ye=Are(),KT=Wc(),GYe=x2(),WYe=jp(),YYe=Xf(),XYe=Qf(),Xc=ae(),{MFS_MAX_CHUNK_SIZE:QYe}=zi(),ZYe=$n(),JYe=Oe(),{parseMode:eXe,parseMtime:tXe}=Ei(),rXe={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(t,e)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};Pre.exports=t=>{async function e(r,i,n={}){let s=HYe(rXe,n),o,a,c;if(Ja("Reading source, destination and parent"),await Ire().readLock(async()=>{o=await $Ye(i),a=await KT(t,r,s),c=await KT(t,a.mfsDirectory,s)})(),Ja("Read source, destination and parent"),!s.parents&&!c.exists)throw Xc(new Error("directory does not exist"),"ERR_NO_EXIST");if(o==null)throw Xc(new Error("could not create source"),"ERR_NO_SOURCE");if(a==null)throw Xc(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!a.exists)throw Xc(new Error("file does not exist"),"ERR_NO_EXIST");if(a.entryType!=="file")throw Xc(new Error("not a file"),"ERR_NOT_A_FILE");return iXe(t,r,o,a,s)}return JYe(e)};var iXe=async(t,e,r,i,n)=>{let s=await nXe(t,r,i,n);await Ire().writeLock(async()=>{let o=GYe(e),a=o.pop();if(a==null)throw Xc(new Error("source does not exist"),"ERR_NO_EXIST");let c=!1;try{await jYe(t)(`/${o.join("/")}`,n),c=!0}catch(E){if(E.code!=="ERR_NOT_FOUND")throw E}c||await VYe(t)(`/${o.join("/")}`,n);let l=await KT(t,e,n),u=await WYe(t,l.mfsDirectory),h=u[u.length-1];if(!h)throw Xc(new Error("directory does not exist"),"ERR_NO_EXIST");if(!h.type||!h.type.includes("directory"))throw Xc(new Error(`cannot write to ${h.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let d=await t.repo.blocks.get(h.cid),y=UYe(d),g=await zYe(t,{parent:y,name:a,cid:s.cid,size:s.size,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:n.cidVersion});h.cid=g.cid;let m=await YYe(t,u,n);await XYe(t,m,n)})()},nXe=async(t,e,r,i)=>{r.exists?Ja(`Overwriting file ${r.cid} offset ${i.offset} length ${i.length}`):Ja(`Writing file offset ${i.offset} length ${i.length}`);let n=[];if(i.offset>0)if(r.unixfs){if(Ja(`Writing first ${i.offset} bytes of original file`),n.push(()=>r.content({offset:0,length:i.offset})),r.unixfs.fileSize()<i.offset){let u=i.offset-r.unixfs.fileSize();Ja(`Writing zeros for extra ${u} bytes`),n.push(Rre(u))}}else Ja(`Writing zeros for first ${i.offset} bytes`),n.push(Rre(i.offset));n.push(Tre(e,i.length));let s=oXe(sXe(n),u=>{if(r.unixfs&&!i.truncate){let h=r.unixfs.fileSize();if(h>u)return Ja(`Writing last ${h-u} of ${h} bytes from original file starting at offset ${u}`),r.content({offset:u});Ja("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),o;i.mode!==void 0&&i.mode!==null?o=eXe(i.mode):r&&r.unixfs&&(o=r.unixfs.mode);let a;i.mtime!=null?a=tXe(i.mtime):r&&r.unixfs&&(a=r.unixfs.mtime);let c;switch(i.hashAlg){case"sha2-256":c=FYe;break;case"sha2-512":c=KYe;break;default:throw new Error(`TODO vmx 2021-03-31: Proper error message for unsupported hash algorithms like ${i.hashAlg}`)}let l=await ZYe(LYe([{content:s,mode:o,mtime:a}],t.repo.blocks,{progress:i.progress,hasher:c,cidVersion:i.cidVersion,strategy:i.strategy,rawLeaves:i.rawLeaves,reduceSingleLeafToSelf:i.reduceSingleLeafToSelf,leafType:i.leafType}));if(!l)throw Xc(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return Ja(`Wrote ${l.cid}`),{cid:l.cid,size:l.size}},Tre=(t,e)=>async function*(){let i=0;for await(let n of t){if(i+=n.length,i>e){yield n.slice(0,e-i);return}yield n}},Rre=(t,e=QYe)=>{let r=new Uint8Array(e);async function*i(){for(;;)yield r.slice()}return Tre(i(),t)},sXe=async function*(t){for(let e=0;e<t.length;e++)yield*t[e]()},oXe=async function*(t,e){let r=0;for await(let i of t)r+=i.length,yield i;for await(let i of e(r))r+=i.length,yield i}});var qre=p((mOt,kre)=>{f();"use strict";var{exporter:aXe}=Do(),cXe=wr().bind({ignoreUndefined:!0}),uXe=Wc(),Ore=ae(),lXe=Oe(),fXe={offset:0,length:1/0};kre.exports=t=>{function e(r,i={}){return i=cXe(fXe,i),{[Symbol.asyncIterator]:async function*(){let s=await uXe(t,r,i),o=await aXe(s.mfsPath,t.repo.blocks);if(o.type!=="file")throw Ore(new Error(`${r} was not a file`),"ERR_NOT_FILE");if(!o.content)throw Ore(new Error(`Could not load content stream from ${r}`),"ERR_NO_CONTENT");for await(let a of o.content({offset:i.offset,length:i.length}))yield a}}}return lXe(e)}});var Dre=p((vOt,Nre)=>{f();"use strict";var{exporter:hXe}=Do(),dXe=Wc(),pXe=Oe(),yXe=ko(),Bre=t=>{let e={cid:t.cid,name:t.name,type:t.type==="directory"?"directory":"file",size:t.size};return(t.type==="file"||t.type==="directory")&&(e.mode=t.unixfs.mode,e.mtime=t.unixfs.mtime),e};Nre.exports=t=>{async function*e(r,i={}){let n=await dXe(t,r,i),s=await hXe(n.mfsPath,t.repo.blocks);if(s.type==="directory"){yield*yXe(s.content(i),Bre);return}yield Bre(s)}return pXe(e)}});var Kre=p((wOt,Fre)=>{f();"use strict";var gXe=qT(),Mre=zd(),bXe={stat:Jb()},mXe={chmod:fre(),cp:k2(),flush:dre(),mkdir:P2(),mv:yre(),rm:B2(),touch:_re()},Lre={write:Cre(),read:qre(),ls:Dre()},Ure=({options:t,mfs:e,operations:r,lock:i})=>{Object.keys(r).forEach(n=>{e[n]=i(r[n](t))})},vXe={repoOwner:!0,repo:null};function wXe(t){let{repoOwner:e}=Object.assign({},vXe||{},t),r=gXe(e),i=o=>r.readLock(o),n=o=>r.writeLock(o),s={};return Ure({options:t,mfs:s,operations:bXe,lock:i}),Ure({options:t,mfs:s,operations:mXe,lock:n}),Object.keys(Lre).forEach(o=>{s[o]=Lre[o](t)}),s}Fre.exports=({repo:t,preload:e,hashers:r,options:i})=>{let n=wXe({repo:t,repoOwner:Boolean(i.repoOwner),hashers:r}),s=o=>(...c)=>{let l=c.filter(u=>Mre.ipfsPath(u)||Mre.cid(u));if(l.length){let u=c[c.length-1];u&&u.preload!==!1&&l.forEach(h=>e(h))}return o(...c)};return{...n,chmod:n.chmod,cp:s(n.cp),mkdir:n.mkdir,stat:s(n.stat),rm:n.rm,read:s(n.read),touch:n.touch,write:n.write,mv:s(n.mv),flush:n.flush,ls:s(async function*(...o){for await(let a of n.ls(...o))yield{...a,size:a.size||0}})}}});var Vre=p((_Ot,jre)=>{f();"use strict";var _Xe=Oe();jre.exports=({keychain:t})=>_Xe((r,i)=>t.exportKey(r,i))});var Gre=p((EOt,$re)=>{f();"use strict";var EXe=Oe(),zre="ed25519",Hre=2048;$re.exports=({keychain:t})=>EXe((r,i={type:zre,size:Hre})=>t.createKey(r,i.type||zre,i.size||Hre))});var Yre=p((SOt,Wre)=>{f();"use strict";var SXe=Oe();Wre.exports=({keychain:t})=>SXe((r,i,n)=>t.importKey(r,i,n))});var Qre=p((xOt,Xre)=>{f();"use strict";var xXe=Oe();Xre.exports=({keychain:t})=>xXe(r=>t.findKeyByName(r))});var Jre=p((AOt,Zre)=>{f();"use strict";var AXe=Oe();Zre.exports=({keychain:t})=>AXe(()=>t.listKeys())});var tie=p((IOt,eie)=>{f();"use strict";var IXe=Oe();eie.exports=({keychain:t})=>IXe(async(r,i)=>{let n=await t.renameKey(r,i);return{was:r,now:n.name,id:n.id,overwrite:!1}})});var iie=p((TOt,rie)=>{f();"use strict";var TXe=Oe();rie.exports=({keychain:t})=>TXe(r=>t.removeKey(r))});var oie=p((ROt,sie)=>{f();"use strict";var RXe=Vre(),PXe=Gre(),CXe=Yre(),OXe=Qre(),kXe=Jre(),qXe=tie(),BXe=iie(),nie=class{constructor({keychain:e}){this.gen=PXe({keychain:e}),this.list=kXe({keychain:e}),this.rm=BXe({keychain:e}),this.rename=qXe({keychain:e}),this.export=RXe({keychain:e}),this.import=CXe({keychain:e}),this.info=OXe({keychain:e})}};sie.exports=nie});var yl=p((POt,aie)=>{f();"use strict";var NXe=(At(),xt),DXe=Oe();aie.exports=({repo:t,preload:e})=>{async function r(i,n={}){n.preload!==!1&&e(i);let s=await t.blocks.get(i,n);return NXe.decode(s)}return DXe(r)}});var uie=p((COt,cie)=>{f();"use strict";var MXe=Oe();cie.exports=({repo:t,preload:e})=>{let r=yl()({repo:t,preload:e});async function i(n,s={}){return(await r(n,s)).Data||new Uint8Array(0)}return MXe(i)}});var hie=p((OOt,fie)=>{f();"use strict";var LXe=(At(),xt),UXe=(Uc(),Af),FXe=(Rs(),ns),{CID:lie}=(Ae(),Ce),KXe=Oe();function jT(t,e=[]){for(let r in t){let i=t[r];if(r==="/"&&Object.keys(t).length===1)try{e.push({Name:"",Tsize:0,Hash:lie.parse(i)});continue}catch(n){}if(i instanceof lie){e.push({Name:"",Tsize:0,Hash:i});continue}Array.isArray(i)&&jT(i,e),i&&typeof i=="object"&&jT(i,e)}return e}fie.exports=({repo:t,codecs:e})=>{async function r(i,n={}){let s=await e.getCodec(i.code),o=await t.blocks.get(i,n),a=s.decode(o);if(i.code===FXe.code)return[];if(i.code===LXe.code)return a.Links;if(i.code===UXe.code)return jT(a);throw new Error(`Cannot resolve links from codec ${i.code}`)}return KXe(r)}});var pie=p((kOt,die)=>{f();"use strict";var jXe=(At(),xt),{sha256:VXe}=(ai(),$r),{UnixFS:zXe}=Ei(),HXe=Oe(),{CID:$Xe}=(Ae(),Ce);die.exports=({repo:t,preload:e})=>{async function r(i={}){let n;if(i.template)if(i.template==="unixfs-dir")n=new zXe({type:"directory"}).marshal();else throw new Error("unknown template");let s=jXe.encode({Data:n,Links:[]}),o=await VXe.digest(s),a=$Xe.createV0(o);return await t.blocks.put(a,s,{signal:i.signal}),i.preload!==!1&&e(a),a}return HXe(r)}});var zp=p((qOt,yie)=>{f();"use strict";var GXe=(At(),xt),{CID:WXe}=(Ae(),Ce),{sha256:YXe}=(ai(),$r),XXe=Oe();yie.exports=({repo:t,preload:e})=>{async function r(i,n={}){let s=await t.gcLock.readLock();try{let o=GXe.encode(i),a=await YXe.digest(o),c=WXe.createV0(a);return await t.blocks.put(c,o,{signal:n.signal}),n.preload!==!1&&e(c),n.pin&&await t.pins.pinRecursively(c,{signal:n.signal}),c}finally{s()}}return XXe(r)}});var bie=p((BOt,gie)=>{f();"use strict";var QXe=(At(),xt),ZXe=Oe();gie.exports=({repo:t,preload:e})=>{let r=yl()({repo:t,preload:e});async function i(n,s={}){let o=await r(n,s),c=QXe.encode(o).length,l=o.Links.reduce((u,h)=>u+(h.Tsize||0),0);return{Hash:n,NumLinks:o.Links.length,BlockSize:c,LinksSize:c-(o.Data||[]).length,DataSize:(o.Data||[]).length,CumulativeSize:c+l}}return ZXe(i)}});var vie=p((NOt,mie)=>{f();"use strict";var JXe=Oe();mie.exports=({repo:t,preload:e})=>{let r=yl()({repo:t,preload:e}),i=zp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a);return i({...c,Links:c.Links.concat([o])},a)}return JXe(n)}});var _ie=p((DOt,wie)=>{f();"use strict";var eQe=Oe(),tQe=un();wie.exports=({repo:t,preload:e})=>{let r=yl()({repo:t,preload:e}),i=zp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a),l=tQe([c.Data||[],o]);return i({...c,Data:l},a)}return eQe(n)}});var Sie=p((MOt,Eie)=>{f();"use strict";var rQe=Oe();Eie.exports=({repo:t,preload:e})=>{let r=yl()({repo:t,preload:e}),i=zp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a),l=(typeof o=="string"?o:o.Name)||"";return c.Links=c.Links.filter(u=>u.Name!==l),i(c,a)}return rQe(n)}});var Aie=p((LOt,xie)=>{f();"use strict";var iQe=Oe();xie.exports=({repo:t,preload:e})=>{let r=yl()({repo:t,preload:e}),i=zp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a);return i({...c,Data:o},a)}return iQe(n)}});var Rie=p((UOt,Tie)=>{f();"use strict";var nQe=vie(),sQe=_ie(),oQe=Sie(),aQe=Aie(),Iie=class{constructor({repo:e,preload:r}){this.addLink=nQe({repo:e,preload:r}),this.appendData=sQe({repo:e,preload:r}),this.rmLink=oQe({repo:e,preload:r}),this.setData=aQe({repo:e,preload:r})}};Tie.exports=Iie});var Oie=p((FOt,Cie)=>{f();"use strict";var cQe=uie(),uQe=yl(),lQe=hie(),fQe=pie(),hQe=zp(),dQe=bie(),pQe=Rie(),Pie=class{constructor({repo:e,codecs:r,preload:i}){this.data=cQe({repo:e,preload:i}),this.get=uQe({repo:e,preload:i}),this.links=lQe({repo:e,codecs:r}),this.new=fQe({repo:e,preload:i}),this.put=hQe({repo:e,preload:i}),this.stat=dQe({repo:e,preload:i}),this.patch=new pQe({repo:e,preload:i})}};Cie.exports=Pie});var qie=p((KOt,kie)=>{f();"use strict";var yQe=me()("ipfs:repo:gc"),gQe=Oe(),bQe=S2();kie.exports=({repo:t,hashers:e})=>{async function*r(i={}){let n=Date.now(),s;try{s=await bQe({repo:t,hashers:e},i),await t.pins.pinRecursively(s),yield*t.gc()}finally{s&&await t.pins.unpin(s)}yQe(`Complete (${Date.now()-n}ms)`)}return gQe(r)}});var VT=p((jOt,Bie)=>{f();"use strict";var mQe=Oe();Bie.exports=({repo:t})=>{async function e(r={}){let i=await t.stat();return{numObjects:BigInt(i.numObjects.toString()),repoSize:BigInt(i.repoSize.toString()),repoPath:i.repoPath,version:`${i.version}`,storageMax:BigInt(i.storageMax.toString())}}return mQe(e)}});var Die=p((VOt,Nie)=>{f();"use strict";var{repoVersion:vQe}=Of(),wQe=Oe();Nie.exports=({repo:t})=>{async function e(r={}){try{await t._checkInitialized(r)}catch(i){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(s=>s.test(i.message)))return vQe;throw i}return t.version.get()}return wQe(e)}});var Uie=p((zOt,Lie)=>{f();"use strict";var _Qe=qie(),EQe=VT(),SQe=Die(),Mie=class{constructor({repo:e,hashers:r}){this.gc=_Qe({repo:e,hashers:r}),this.stat=EQe({repo:e}),this.version=SQe({repo:e}),this.setApiAddr=i=>e.apiAddr.set(i)}};Lie.exports=Mie});var jie=p((HOt,Kie)=>{f();"use strict";var{default:xQe}=Qg(),AQe=ae(),IQe=Oe();function Fie(t,e){let r;if(t.metrics?e.peer?r=t.metrics.forPeer(e.peer):e.proto?r=t.metrics.forProtocol(e.proto):r=t.metrics.global:r=void 0,!r)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};let{movingAverages:i,snapshot:n}=r;return{totalIn:BigInt(n.dataReceived.integerValue().toString()),totalOut:BigInt(n.dataSent.integerValue().toString()),rateIn:i.dataReceived[6e4].movingAverage()/60,rateOut:i.dataSent[6e4].movingAverage()/60}}Kie.exports=({network:t})=>IQe(async function*(r={}){let{libp2p:i}=await t.use(r);if(!r.poll){yield Fie(i,r);return}let n=r.interval||1e3,s=-1;try{if(s=typeof n=="string"?xQe(n)||-1:n,!s||s<0)throw new Error("invalid duration")}catch(a){throw AQe(a,"ERR_INVALID_POLL_INTERVAL")}let o;try{for(;;)yield Fie(i,r),await new Promise(a=>{o=setTimeout(a,s)})}finally{clearTimeout(o)}})});var Hie=p(($Ot,zie)=>{f();"use strict";var TQe=jie(),RQe=VT(),PQe=f5(),Vie=class{constructor({repo:e,network:r}){this.repo=RQe({repo:e}),this.bw=TQe({network:r}),this.bitswap=PQe({network:r})}};zie.exports=Vie});var zT=p((GOt,$ie)=>{f();"use strict";$ie.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),i=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;e[r]=n;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,r);if(o.value!==n||o.enumerable!==!0)return!1}return!0}});var r1=p((WOt,Gie)=>{f();"use strict";var CQe=zT();Gie.exports=function(){return CQe()&&!!Symbol.toStringTag}});var Xie=p((YOt,Yie)=>{f();"use strict";var Wie=typeof Symbol!="undefined"&&Symbol,OQe=zT();Yie.exports=function(){return typeof Wie!="function"||typeof Symbol!="function"||typeof Wie("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:OQe()}});var Zie=p((XOt,Qie)=>{f();"use strict";var kQe="Function.prototype.bind called on incompatible ",HT=Array.prototype.slice,qQe=Object.prototype.toString,BQe="[object Function]";Qie.exports=function(e){var r=this;if(typeof r!="function"||qQe.call(r)!==BQe)throw new TypeError(kQe+r);for(var i=HT.call(arguments,1),n,s=function(){if(this instanceof n){var u=r.apply(this,i.concat(HT.call(arguments)));return Object(u)===u?u:this}else return r.apply(e,i.concat(HT.call(arguments)))},o=Math.max(0,r.length-i.length),a=[],c=0;c<o;c++)a.push("$"+c);if(n=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),r.prototype){var l=function(){};l.prototype=r.prototype,n.prototype=new l,l.prototype=null}return n}});var N2=p((QOt,Jie)=>{f();"use strict";var NQe=Zie();Jie.exports=Function.prototype.bind||NQe});var tne=p((ZOt,ene)=>{f();"use strict";var DQe=N2();ene.exports=DQe.call(Function.call,Object.prototype.hasOwnProperty)});var U2=p((JOt,sne)=>{f();"use strict";var Ct,i1=SyntaxError,rne=Function,Hp=TypeError,$T=function(t){try{return rne('"use strict"; return ('+t+").constructor;")()}catch(e){}},rh=Object.getOwnPropertyDescriptor;if(rh)try{rh({},"")}catch(t){rh=null}var GT=function(){throw new Hp},MQe=rh?function(){try{return arguments.callee,GT}catch(t){try{return rh(arguments,"callee").get}catch(e){return GT}}}():GT,$p=Xie()(),gl=Object.getPrototypeOf||function(t){return t.__proto__},Gp={},LQe=typeof Uint8Array=="undefined"?Ct:gl(Uint8Array),Wp={"%AggregateError%":typeof AggregateError=="undefined"?Ct:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?Ct:ArrayBuffer,"%ArrayIteratorPrototype%":$p?gl([][Symbol.iterator]()):Ct,"%AsyncFromSyncIteratorPrototype%":Ct,"%AsyncFunction%":Gp,"%AsyncGenerator%":Gp,"%AsyncGeneratorFunction%":Gp,"%AsyncIteratorPrototype%":Gp,"%Atomics%":typeof Atomics=="undefined"?Ct:Atomics,"%BigInt%":typeof BigInt=="undefined"?Ct:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?Ct:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?Ct:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?Ct:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?Ct:FinalizationRegistry,"%Function%":rne,"%GeneratorFunction%":Gp,"%Int8Array%":typeof Int8Array=="undefined"?Ct:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?Ct:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?Ct:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":$p?gl(gl([][Symbol.iterator]())):Ct,"%JSON%":typeof JSON=="object"?JSON:Ct,"%Map%":typeof Map=="undefined"?Ct:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!$p?Ct:gl(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?Ct:Promise,"%Proxy%":typeof Proxy=="undefined"?Ct:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?Ct:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?Ct:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!$p?Ct:gl(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?Ct:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":$p?gl(""[Symbol.iterator]()):Ct,"%Symbol%":$p?Symbol:Ct,"%SyntaxError%":i1,"%ThrowTypeError%":MQe,"%TypedArray%":LQe,"%TypeError%":Hp,"%Uint8Array%":typeof Uint8Array=="undefined"?Ct:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?Ct:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?Ct:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?Ct:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?Ct:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?Ct:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?Ct:WeakSet},UQe=function t(e){var r;if(e==="%AsyncFunction%")r=$T("async function () {}");else if(e==="%GeneratorFunction%")r=$T("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=$T("async function* () {}");else if(e==="%AsyncGenerator%"){var i=t("%AsyncGeneratorFunction%");i&&(r=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=t("%AsyncGenerator%");n&&(r=gl(n.prototype))}return Wp[e]=r,r},ine={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},D2=N2(),M2=tne(),FQe=D2.call(Function.call,Array.prototype.concat),KQe=D2.call(Function.apply,Array.prototype.splice),nne=D2.call(Function.call,String.prototype.replace),L2=D2.call(Function.call,String.prototype.slice),jQe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,VQe=/\\(\\)?/g,zQe=function(e){var r=L2(e,0,1),i=L2(e,-1);if(r==="%"&&i!=="%")throw new i1("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&r!=="%")throw new i1("invalid intrinsic syntax, expected opening `%`");var n=[];return nne(e,jQe,function(s,o,a,c){n[n.length]=a?nne(c,VQe,"$1"):o||s}),n},HQe=function(e,r){var i=e,n;if(M2(ine,i)&&(n=ine[i],i="%"+n[0]+"%"),M2(Wp,i)){var s=Wp[i];if(s===Gp&&(s=UQe(i)),typeof s=="undefined"&&!r)throw new Hp("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:s}}throw new i1("intrinsic "+e+" does not exist!")};sne.exports=function(e,r){if(typeof e!="string"||e.length===0)throw new Hp("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Hp('"allowMissing" argument must be a boolean');var i=zQe(e),n=i.length>0?i[0]:"",s=HQe("%"+n+"%",r),o=s.name,a=s.value,c=!1,l=s.alias;l&&(n=l[0],KQe(i,FQe([0,1],l)));for(var u=1,h=!0;u<i.length;u+=1){var d=i[u],y=L2(d,0,1),g=L2(d,-1);if((y==='"'||y==="'"||y==="`"||g==='"'||g==="'"||g==="`")&&y!==g)throw new i1("property names with quotes must have matching quotes");if((d==="constructor"||!h)&&(c=!0),n+="."+d,o="%"+n+"%",M2(Wp,o))a=Wp[o];else if(a!=null){if(!(d in a)){if(!r)throw new Hp("base intrinsic for "+e+" exists, but the property is not available.");return}if(rh&&u+1>=i.length){var m=rh(a,d);h=!!m,h&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[d]}else h=M2(a,d),a=a[d];h&&!c&&(Wp[o]=a)}}return a}});var fne=p((ekt,F2)=>{f();"use strict";var WT=N2(),Yp=U2(),one=Yp("%Function.prototype.apply%"),ane=Yp("%Function.prototype.call%"),cne=Yp("%Reflect.apply%",!0)||WT.call(ane,one),une=Yp("%Object.getOwnPropertyDescriptor%",!0),ih=Yp("%Object.defineProperty%",!0),$Qe=Yp("%Math.max%");if(ih)try{ih({},"a",{value:1})}catch(t){ih=null}F2.exports=function(e){var r=cne(WT,ane,arguments);if(une&&ih){var i=une(r,"length");i.configurable&&ih(r,"length",{value:1+$Qe(0,e.length-(arguments.length-1))})}return r};var lne=function(){return cne(WT,one,arguments)};ih?ih(F2.exports,"apply",{value:lne}):F2.exports.apply=lne});var K2=p((tkt,pne)=>{f();"use strict";var hne=U2(),dne=fne(),GQe=dne(hne("String.prototype.indexOf"));pne.exports=function(e,r){var i=hne(e,!!r);return typeof i=="function"&&GQe(e,".prototype.")>-1?dne(i):i}});var bne=p((rkt,gne)=>{f();"use strict";var WQe=r1()(),YQe=K2(),YT=YQe("Object.prototype.toString"),j2=function(e){return WQe&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:YT(e)==="[object Arguments]"},yne=function(e){return j2(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&YT(e)!=="[object Array]"&&YT(e.callee)==="[object Function]"},XQe=function(){return j2(arguments)}();j2.isLegacyArguments=yne;gne.exports=XQe?j2:yne});var wne=p((ikt,vne)=>{f();"use strict";var QQe=Object.prototype.toString,ZQe=Function.prototype.toString,JQe=/^\s*(?:function)?\*/,mne=r1()(),XT=Object.getPrototypeOf,eZe=function(){if(!mne)return!1;try{return Function("return function*() {}")()}catch(t){}},QT;vne.exports=function(e){if(typeof e!="function")return!1;if(JQe.test(ZQe.call(e)))return!0;if(!mne){var r=QQe.call(e);return r==="[object GeneratorFunction]"}if(!XT)return!1;if(typeof QT=="undefined"){var i=eZe();QT=i?XT(i):!1}return XT(e)===QT}});var ZT=p((nkt,_ne)=>{f();var tZe=Object.prototype.hasOwnProperty,rZe=Object.prototype.toString;_ne.exports=function(e,r,i){if(rZe.call(r)!=="[object Function]")throw new TypeError("iterator must be a function");var n=e.length;if(n===+n)for(var s=0;s<n;s++)r.call(i,e[s],s,e);else for(var o in e)tZe.call(e,o)&&r.call(i,e[o],o,e)}});var eR=p((skt,Ene)=>{f();"use strict";var JT=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"];Ene.exports=function(){for(var e=[],r=0;r<JT.length;r++)typeof globalThis[JT[r]]=="function"&&(e[e.length]=JT[r]);return e}});var tR=p((okt,Sne)=>{f();"use strict";var iZe=U2(),V2=iZe("%Object.getOwnPropertyDescriptor%");if(V2)try{V2([],"length")}catch(t){V2=null}Sne.exports=V2});var nR=p((akt,Rne)=>{f();"use strict";var xne=ZT(),nZe=eR(),rR=K2(),sZe=rR("Object.prototype.toString"),Ane=r1()(),Ine=nZe(),oZe=rR("Array.prototype.indexOf",!0)||function(e,r){for(var i=0;i<e.length;i+=1)if(e[i]===r)return i;return-1},aZe=rR("String.prototype.slice"),Tne={},z2=tR(),iR=Object.getPrototypeOf;Ane&&z2&&iR&&xne(Ine,function(t){var e=new globalThis[t];if(Symbol.toStringTag in e){var r=iR(e),i=z2(r,Symbol.toStringTag);if(!i){var n=iR(r);i=z2(n,Symbol.toStringTag)}Tne[t]=i.get}});var cZe=function(e){var r=!1;return xne(Tne,function(i,n){if(!r)try{r=i.call(e)===n}catch(s){}}),r};Rne.exports=function(e){if(!e||typeof e!="object")return!1;if(!Ane||!(Symbol.toStringTag in e)){var r=aZe(sZe(e),8,-1);return oZe(Ine,r)>-1}return z2?cZe(e):!1}});var Bne=p((ckt,qne)=>{f();"use strict";var Pne=ZT(),uZe=eR(),Cne=K2(),lZe=Cne("Object.prototype.toString"),One=r1()(),fZe=uZe(),hZe=Cne("String.prototype.slice"),kne={},sR=tR(),oR=Object.getPrototypeOf;One&&sR&&oR&&Pne(fZe,function(t){if(typeof globalThis[t]=="function"){var e=new globalThis[t];if(Symbol.toStringTag in e){var r=oR(e),i=sR(r,Symbol.toStringTag);if(!i){var n=oR(r);i=sR(n,Symbol.toStringTag)}kne[t]=i.get}}});var dZe=function(e){var r=!1;return Pne(kne,function(i,n){if(!r)try{var s=i.call(e);s===n&&(r=s)}catch(o){}}),r},pZe=nR();qne.exports=function(e){return pZe(e)?!One||!(Symbol.toStringTag in e)?hZe(lZe(e),8,-1):dZe(e):!1}});var Wne=p(vt=>{f();"use strict";var yZe=bne(),gZe=wne(),jo=Bne(),Nne=nR();function Xp(t){return t.call.bind(t)}var Dne=typeof BigInt!="undefined",Mne=typeof Symbol!="undefined",Ws=Xp(Object.prototype.toString),bZe=Xp(Number.prototype.valueOf),mZe=Xp(String.prototype.valueOf),vZe=Xp(Boolean.prototype.valueOf);Dne&&(Lne=Xp(BigInt.prototype.valueOf));var Lne;Mne&&(Une=Xp(Symbol.prototype.valueOf));var Une;function n1(t,e){if(typeof t!="object")return!1;try{return e(t),!0}catch(r){return!1}}vt.isArgumentsObject=yZe;vt.isGeneratorFunction=gZe;vt.isTypedArray=Nne;function wZe(t){return typeof Promise!="undefined"&&t instanceof Promise||t!==null&&typeof t=="object"&&typeof t.then=="function"&&typeof t.catch=="function"}vt.isPromise=wZe;function _Ze(t){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(t):Nne(t)||Kne(t)}vt.isArrayBufferView=_Ze;function EZe(t){return jo(t)==="Uint8Array"}vt.isUint8Array=EZe;function SZe(t){return jo(t)==="Uint8ClampedArray"}vt.isUint8ClampedArray=SZe;function xZe(t){return jo(t)==="Uint16Array"}vt.isUint16Array=xZe;function AZe(t){return jo(t)==="Uint32Array"}vt.isUint32Array=AZe;function IZe(t){return jo(t)==="Int8Array"}vt.isInt8Array=IZe;function TZe(t){return jo(t)==="Int16Array"}vt.isInt16Array=TZe;function RZe(t){return jo(t)==="Int32Array"}vt.isInt32Array=RZe;function PZe(t){return jo(t)==="Float32Array"}vt.isFloat32Array=PZe;function CZe(t){return jo(t)==="Float64Array"}vt.isFloat64Array=CZe;function OZe(t){return jo(t)==="BigInt64Array"}vt.isBigInt64Array=OZe;function kZe(t){return jo(t)==="BigUint64Array"}vt.isBigUint64Array=kZe;function H2(t){return Ws(t)==="[object Map]"}H2.working=typeof Map!="undefined"&&H2(new Map);function qZe(t){return typeof Map=="undefined"?!1:H2.working?H2(t):t instanceof Map}vt.isMap=qZe;function $2(t){return Ws(t)==="[object Set]"}$2.working=typeof Set!="undefined"&&$2(new Set);function BZe(t){return typeof Set=="undefined"?!1:$2.working?$2(t):t instanceof Set}vt.isSet=BZe;function G2(t){return Ws(t)==="[object WeakMap]"}G2.working=typeof WeakMap!="undefined"&&G2(new WeakMap);function NZe(t){return typeof WeakMap=="undefined"?!1:G2.working?G2(t):t instanceof WeakMap}vt.isWeakMap=NZe;function aR(t){return Ws(t)==="[object WeakSet]"}aR.working=typeof WeakSet!="undefined"&&aR(new WeakSet);function DZe(t){return aR(t)}vt.isWeakSet=DZe;function W2(t){return Ws(t)==="[object ArrayBuffer]"}W2.working=typeof ArrayBuffer!="undefined"&&W2(new ArrayBuffer);function Fne(t){return typeof ArrayBuffer=="undefined"?!1:W2.working?W2(t):t instanceof ArrayBuffer}vt.isArrayBuffer=Fne;function Y2(t){return Ws(t)==="[object DataView]"}Y2.working=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"&&Y2(new DataView(new ArrayBuffer(1),0,1));function Kne(t){return typeof DataView=="undefined"?!1:Y2.working?Y2(t):t instanceof DataView}vt.isDataView=Kne;var cR=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:void 0;function s1(t){return Ws(t)==="[object SharedArrayBuffer]"}function jne(t){return typeof cR=="undefined"?!1:(typeof s1.working=="undefined"&&(s1.working=s1(new cR)),s1.working?s1(t):t instanceof cR)}vt.isSharedArrayBuffer=jne;function MZe(t){return Ws(t)==="[object AsyncFunction]"}vt.isAsyncFunction=MZe;function LZe(t){return Ws(t)==="[object Map Iterator]"}vt.isMapIterator=LZe;function UZe(t){return Ws(t)==="[object Set Iterator]"}vt.isSetIterator=UZe;function FZe(t){return Ws(t)==="[object Generator]"}vt.isGeneratorObject=FZe;function KZe(t){return Ws(t)==="[object WebAssembly.Module]"}vt.isWebAssemblyCompiledModule=KZe;function Vne(t){return n1(t,bZe)}vt.isNumberObject=Vne;function zne(t){return n1(t,mZe)}vt.isStringObject=zne;function Hne(t){return n1(t,vZe)}vt.isBooleanObject=Hne;function $ne(t){return Dne&&n1(t,Lne)}vt.isBigIntObject=$ne;function Gne(t){return Mne&&n1(t,Une)}vt.isSymbolObject=Gne;function jZe(t){return Vne(t)||zne(t)||Hne(t)||$ne(t)||Gne(t)}vt.isBoxedPrimitive=jZe;function VZe(t){return typeof Uint8Array!="undefined"&&(Fne(t)||jne(t))}vt.isAnyArrayBuffer=VZe;["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(t){Object.defineProperty(vt,t,{enumerable:!1,value:function(){throw new Error(t+" is not supported in userland")}})})});var Xne=p((lkt,Yne)=>{f();Yne.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var rse=p(wt=>{f();var Qne=Object.getOwnPropertyDescriptors||function(e){for(var r=Object.keys(e),i={},n=0;n<r.length;n++)i[r[n]]=Object.getOwnPropertyDescriptor(e,r[n]);return i},zZe=/%[sdj%]/g;wt.format=function(t){if(!eE(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(bl(arguments[r]));return e.join(" ")}for(var r=1,i=arguments,n=i.length,s=String(t).replace(zZe,function(a){if(a==="%%")return"%";if(r>=n)return a;switch(a){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(c){return"[Circular]"}default:return a}}),o=i[r];r<n;o=i[++r])J2(o)||!Qp(o)?s+=" "+o:s+=" "+bl(o);return s};wt.deprecate=function(t,e){if(typeof process!="undefined"&&process.noDeprecation===!0)return t;if(typeof process=="undefined")return function(){return wt.deprecate(t,e).apply(this,arguments)};var r=!1;function i(){if(!r){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),r=!0}return t.apply(this,arguments)}return i};var X2={},Zne=/^$/;process.env.NODE_DEBUG&&(Q2=process.env.NODE_DEBUG,Q2=Q2.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),Zne=new RegExp("^"+Q2+"$","i"));var Q2;wt.debuglog=function(t){if(t=t.toUpperCase(),!X2[t])if(Zne.test(t)){var e=process.pid;X2[t]=function(){var r=wt.format.apply(wt,arguments);console.error("%s %d: %s",t,e,r)}}else X2[t]=function(){};return X2[t]};function bl(t,e){var r={seen:[],stylize:$Ze};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),fR(e)?r.showHidden=e:e&&wt._extend(r,e),nh(r.showHidden)&&(r.showHidden=!1),nh(r.depth)&&(r.depth=2),nh(r.colors)&&(r.colors=!1),nh(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=HZe),Z2(r,t,r.depth)}wt.inspect=bl;bl.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};bl.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function HZe(t,e){var r=bl.styles[e];return r?"["+bl.colors[r][0]+"m"+t+"["+bl.colors[r][1]+"m":t}function $Ze(t,e){return t}function GZe(t){var e={};return t.forEach(function(r,i){e[r]=!0}),e}function Z2(t,e,r){if(t.customInspect&&e&&rE(e.inspect)&&e.inspect!==wt.inspect&&!(e.constructor&&e.constructor.prototype===e)){var i=e.inspect(r,t);return eE(i)||(i=Z2(t,i,r)),i}var n=WZe(t,e);if(n)return n;var s=Object.keys(e),o=GZe(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),a1(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return uR(e);if(s.length===0){if(rE(e)){var a=e.name?": "+e.name:"";return t.stylize("[Function"+a+"]","special")}if(o1(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(tE(e))return t.stylize(Date.prototype.toString.call(e),"date");if(a1(e))return uR(e)}var c="",l=!1,u=["{","}"];if(Jne(e)&&(l=!0,u=["[","]"]),rE(e)){var h=e.name?": "+e.name:"";c=" [Function"+h+"]"}if(o1(e)&&(c=" "+RegExp.prototype.toString.call(e)),tE(e)&&(c=" "+Date.prototype.toUTCString.call(e)),a1(e)&&(c=" "+uR(e)),s.length===0&&(!l||e.length==0))return u[0]+c+u[1];if(r<0)return o1(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var d;return l?d=YZe(t,e,r,o,s):d=s.map(function(y){return lR(t,e,r,o,y,l)}),t.seen.pop(),XZe(d,c,u)}function WZe(t,e){if(nh(e))return t.stylize("undefined","undefined");if(eE(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(ese(e))return t.stylize(""+e,"number");if(fR(e))return t.stylize(""+e,"boolean");if(J2(e))return t.stylize("null","null")}function uR(t){return"["+Error.prototype.toString.call(t)+"]"}function YZe(t,e,r,i,n){for(var s=[],o=0,a=e.length;o<a;++o)tse(e,String(o))?s.push(lR(t,e,r,i,String(o),!0)):s.push("");return n.forEach(function(c){c.match(/^\d+$/)||s.push(lR(t,e,r,i,c,!0))}),s}function lR(t,e,r,i,n,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},c.get?c.set?a=t.stylize("[Getter/Setter]","special"):a=t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),tse(i,n)||(o="["+n+"]"),a||(t.seen.indexOf(c.value)<0?(J2(r)?a=Z2(t,c.value,null):a=Z2(t,c.value,r-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(l){return"  "+l}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(l){return"   "+l}).join(`
`))):a=t.stylize("[Circular]","special")),nh(o)){if(s&&n.match(/^\d+$/))return a;o=JSON.stringify(""+n),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function XZe(t,e,r){var i=0,n=t.reduce(function(s,o){return i++,o.indexOf(`
`)>=0&&i++,s+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?r[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}wt.types=Wne();function Jne(t){return Array.isArray(t)}wt.isArray=Jne;function fR(t){return typeof t=="boolean"}wt.isBoolean=fR;function J2(t){return t===null}wt.isNull=J2;function QZe(t){return t==null}wt.isNullOrUndefined=QZe;function ese(t){return typeof t=="number"}wt.isNumber=ese;function eE(t){return typeof t=="string"}wt.isString=eE;function ZZe(t){return typeof t=="symbol"}wt.isSymbol=ZZe;function nh(t){return t===void 0}wt.isUndefined=nh;function o1(t){return Qp(t)&&hR(t)==="[object RegExp]"}wt.isRegExp=o1;wt.types.isRegExp=o1;function Qp(t){return typeof t=="object"&&t!==null}wt.isObject=Qp;function tE(t){return Qp(t)&&hR(t)==="[object Date]"}wt.isDate=tE;wt.types.isDate=tE;function a1(t){return Qp(t)&&(hR(t)==="[object Error]"||t instanceof Error)}wt.isError=a1;wt.types.isNativeError=a1;function rE(t){return typeof t=="function"}wt.isFunction=rE;function JZe(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t=="undefined"}wt.isPrimitive=JZe;wt.isBuffer=Xne();function hR(t){return Object.prototype.toString.call(t)}function dR(t){return t<10?"0"+t.toString(10):t.toString(10)}var eJe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function tJe(){var t=new Date,e=[dR(t.getHours()),dR(t.getMinutes()),dR(t.getSeconds())].join(":");return[t.getDate(),eJe[t.getMonth()],e].join(" ")}wt.log=function(){console.log("%s - %s",tJe(),wt.format.apply(wt,arguments))};wt.inherits=Xi();wt._extend=function(t,e){if(!e||!Qp(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t};function tse(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var sh=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;wt.promisify=function(e){if(typeof e!="function")throw new TypeError('The "original" argument must be of type Function');if(sh&&e[sh]){var r=e[sh];if(typeof r!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(r,sh,{value:r,enumerable:!1,writable:!1,configurable:!0}),r}function r(){for(var i,n,s=new Promise(function(c,l){i=c,n=l}),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push(function(c,l){c?n(c):i(l)});try{e.apply(this,o)}catch(c){n(c)}return s}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),sh&&Object.defineProperty(r,sh,{value:r,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(r,Qne(e))};wt.promisify.custom=sh;function rJe(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}function iJe(t){if(typeof t!="function")throw new TypeError('The "original" argument must be of type Function');function e(){for(var r=[],i=0;i<arguments.length;i++)r.push(arguments[i]);var n=r.pop();if(typeof n!="function")throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return n.apply(s,arguments)};t.apply(this,r).then(function(a){process.nextTick(o.bind(null,null,a))},function(a){process.nextTick(rJe.bind(null,a,o))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),Object.defineProperties(e,Qne(t)),e}wt.callbackify=iJe});var pR=p((hkt,ise)=>{f();"use strict";ise.exports=function(...e){let r=e.reduce((i,n)=>Object.assign(i,n),{});return Object.assign(r,{bufferKeys:r.bufferKeys||!1,snapshots:r.snapshots||!1,permanence:r.permanence||!1,seek:r.seek||!1,clear:r.clear||!1,status:r.status||!1,createIfMissing:r.createIfMissing||!1,errorIfExists:r.errorIfExists||!1,deferredOpen:r.deferredOpen||!1,openCallback:r.openCallback||!1,promises:r.promises||!1,streams:r.streams||!1,encodings:r.encodings||!1,additionalMethods:Object.assign({},r.additionalMethods)})}});var sse=p((dkt,nse)=>{f();nse.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var iE=p((pkt,ase)=>{f();var ose;ase.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:globalThis):t=>(ose||(ose=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0))});var nE=p((ykt,use)=>{f();"use strict";var cse=iE();use.exports=function(t,...e){e.length===0?cse(t):cse(()=>t(...e))}});var yR=p((gkt,lse)=>{f();"use strict";function ml(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._ended=!1,this._nexting=!1}ml.prototype.next=function(t){if(typeof t!="function")throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(t,new Error("cannot call next() after end()")),this):this._nexting?(this._nextTick(t,new Error("cannot call next() before previous next() has completed")),this):(this._nexting=!0,this._next((e,...r)=>{this._nexting=!1,t(e,...r)}),this)};ml.prototype._next=function(t){this._nextTick(t)};ml.prototype.seek=function(t){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");t=this.db._serializeKey(t),this._seek(t)};ml.prototype._seek=function(t){};ml.prototype.end=function(t){if(typeof t!="function")throw new Error("end() requires a callback argument");if(this._ended)return this._nextTick(t,new Error("end() already called on iterator"));this._ended=!0,this._end(t)};ml.prototype._end=function(t){this._nextTick(t)};ml.prototype._nextTick=nE();lse.exports=ml});var gR=p((bkt,hse)=>{f();"use strict";var fse=Object.freeze({});function Vo(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._operations=[],this._written=!1}Vo.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")};Vo.prototype.put=function(t,e,r){this._checkWritten();let i=this.db._checkKey(t)||this.db._checkValue(e);if(i)throw i;return t=this.db._serializeKey(t),e=this.db._serializeValue(e),this._put(t,e,r??fse),this};Vo.prototype._put=function(t,e,r){this._operations.push({...r,type:"put",key:t,value:e})};Vo.prototype.del=function(t,e){this._checkWritten();let r=this.db._checkKey(t);if(r)throw r;return t=this.db._serializeKey(t),this._del(t,e??fse),this};Vo.prototype._del=function(t,e){this._operations.push({...e,type:"del",key:t})};Vo.prototype.clear=function(){return this._checkWritten(),this._clear(),this};Vo.prototype._clear=function(){this._operations=[]};Vo.prototype.write=function(t,e){if(this._checkWritten(),typeof t=="function"&&(e=t),typeof e!="function")throw new Error("write() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),this._written=!0,this._write(t,e)};Vo.prototype._write=function(t,e){this.db._batch(this._operations,t,e)};Vo.prototype._nextTick=nE();hse.exports=Vo});var yse=p((mkt,pse)=>{f();"use strict";var nJe=pR(),sJe=sse(),oJe=yR(),aJe=gR(),cJe=Object.prototype.hasOwnProperty,uJe=["lt","lte","gt","gte"];function xr(t){this.status="new",this.supports=nJe(t,{status:!0})}xr.prototype.open=function(t,e){let r=this.status;if(typeof t=="function"&&(e=t),typeof e!="function")throw new Error("open() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),t.createIfMissing=t.createIfMissing!==!1,t.errorIfExists=!!t.errorIfExists,this.status="opening",this._open(t,i=>{if(i)return this.status=r,e(i);this.status="open",e()})};xr.prototype._open=function(t,e){this._nextTick(e)};xr.prototype.close=function(t){let e=this.status;if(typeof t!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(r=>{if(r)return this.status=e,t(r);this.status="closed",t()})};xr.prototype._close=function(t){this._nextTick(t)};xr.prototype.get=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("get() requires a callback argument");let i=this._checkKey(t);if(i)return this._nextTick(r,i);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(t,e,r)};xr.prototype._get=function(t,e,r){this._nextTick(function(){r(new Error("NotFound"))})};xr.prototype.put=function(t,e,r,i){if(typeof r=="function"&&(i=r),typeof i!="function")throw new Error("put() requires a callback argument");let n=this._checkKey(t)||this._checkValue(e);if(n)return this._nextTick(i,n);t=this._serializeKey(t),e=this._serializeValue(e),(typeof r!="object"||r===null)&&(r={}),this._put(t,e,r,i)};xr.prototype._put=function(t,e,r,i){this._nextTick(i)};xr.prototype.del=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("del() requires a callback argument");let i=this._checkKey(t);if(i)return this._nextTick(r,i);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),this._del(t,e,r)};xr.prototype._del=function(t,e,r){this._nextTick(r)};xr.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(r=e),typeof t=="function"&&(r=t),typeof r!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return this._nextTick(r,new Error("batch(array) requires an array argument"));if(t.length===0)return this._nextTick(r);(typeof e!="object"||e===null)&&(e={});let i=new Array(t.length);for(let n=0;n<t.length;n++){if(typeof t[n]!="object"||t[n]===null)return this._nextTick(r,new Error("batch(array) element must be an object and not `null`"));let s=Object.assign({},t[n]);if(s.type!=="put"&&s.type!=="del")return this._nextTick(r,new Error("`type` must be 'put' or 'del'"));let o=this._checkKey(s.key);if(o)return this._nextTick(r,o);if(s.key=this._serializeKey(s.key),s.type==="put"){let a=this._checkValue(s.value);if(a)return this._nextTick(r,a);s.value=this._serializeValue(s.value)}i[n]=s}this._batch(i,e,r)};xr.prototype._batch=function(t,e,r){this._nextTick(r)};xr.prototype.clear=function(t,e){if(typeof t=="function")e=t;else if(typeof e!="function")throw new Error("clear() requires a callback argument");t=dse(this,t),t.reverse=!!t.reverse,t.limit="limit"in t?t.limit:-1,this._clear(t,e)};xr.prototype._clear=function(t,e){t.keys=!0,t.values=!1,t.keyAsBuffer=!0,t.valueAsBuffer=!0;let r=this._iterator(t),i={},n=s=>{if(s)return r.end(function(){e(s)});r.next((o,a)=>{if(o)return n(o);if(a===void 0)return r.end(e);this._del(a,i,n)})};n()};xr.prototype._setupIteratorOptions=function(t){return t=dse(this,t),t.reverse=!!t.reverse,t.keys=t.keys!==!1,t.values=t.values!==!1,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=t.keyAsBuffer!==!1,t.valueAsBuffer=t.valueAsBuffer!==!1,t};function dse(t,e){let r={};for(let i in e){if(!cJe.call(e,i))continue;if(i==="start"||i==="end")throw new Error('Legacy range options ("start" and "end") have been removed');let n=e[i];lJe(i)&&(n=t._serializeKey(n)),r[i]=n}return r}function lJe(t){return uJe.indexOf(t)!==-1}xr.prototype.iterator=function(t){return(typeof t!="object"||t===null)&&(t={}),t=this._setupIteratorOptions(t),this._iterator(t)};xr.prototype._iterator=function(t){return new oJe(this)};xr.prototype._chainedBatch=function(){return new aJe(this)};xr.prototype._serializeKey=function(t){return t};xr.prototype._serializeValue=function(t){return t};xr.prototype._checkKey=function(t){if(t==null)return new Error("key cannot be `null` or `undefined`");if(sJe(t)&&t.length===0)return new Error("key cannot be an empty Buffer");if(t==="")return new Error("key cannot be an empty String");if(Array.isArray(t)&&t.length===0)return new Error("key cannot be an empty Array")};xr.prototype._checkValue=function(t){if(t==null)return new Error("value cannot be `null` or `undefined`")};xr.prototype._nextTick=nE();pse.exports=xr});var vl=p(sE=>{f();"use strict";sE.AbstractLevelDOWN=yse();sE.AbstractIterator=yR();sE.AbstractChainedBatch=gR()});var mse=p((wkt,bse)=>{f();"use strict";var gse=vl().AbstractIterator,fJe=Xi();function Zp(t,e){gse.call(this,t),this._options=e,this._iterator=null,this._operations=[]}fJe(Zp,gse);Zp.prototype.setDb=function(t){let e=this._iterator=t.iterator(this._options);for(let r of this._operations)e[r.method](...r.args)};Zp.prototype._operation=function(t,e){if(this._iterator)return this._iterator[t](...e);this._operations.push({method:t,args:e})};for(let t of["next","end"])Zp.prototype["_"+t]=function(...e){this._operation(t,e)};Zp.prototype.seek=function(...t){this._operation("seek",t)};bse.exports=Zp});var Sse=p((_kt,bR)=>{f();"use strict";var vse=vl().AbstractLevelDOWN,hJe=Xi(),wse=mse(),_se="put get del batch clear".split(" "),dJe="approximateSize compactRange".split(" ");function oh(t){vse.call(this,t.supports||{});for(let e of dJe)typeof t[e]=="function"&&!this.supports.additionalMethods[e]&&(this.supports.additionalMethods[e]=!0);this._db=t,this._operations=[],Ese(this)}hJe(oh,vse);oh.prototype.type="deferred-leveldown";oh.prototype._open=function(t,e){this._db.open(t,r=>{if(r)return e(r);for(let i of this._operations)i.iterator?i.iterator.setDb(this._db):this._db[i.method](...i.args);this._operations=[],pJe(this),e()})};oh.prototype._close=function(t){this._db.close(e=>{if(e)return t(e);Ese(this),t()})};function pJe(t){for(let e of _se.concat("iterator"))t["_"+e]=function(...r){return this._db[e](...r)};for(let e of Object.keys(t.supports.additionalMethods))t[e]=function(...r){return this._db[e](...r)}}function Ese(t){for(let e of _se)t["_"+e]=function(...r){this._operations.push({method:e,args:r})};for(let e of Object.keys(t.supports.additionalMethods))t[e]=function(...r){this._operations.push({method:e,args:r})};t._iterator=function(e){let r=new wse(t,e);return this._operations.push({iterator:r}),r}}oh.prototype._serializeKey=function(t){return t};oh.prototype._serializeValue=function(t){return t};bR.exports=oh;bR.exports.DeferredIterator=wse});var mR=p((Ekt,xse)=>{f();xse.exports=vr().EventEmitter});var vR=p(()=>{f()});var Rse=p((Akt,Tse)=>{f();"use strict";function Ase(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function yJe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ase(Object(r),!0).forEach(function(i){gJe(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ase(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function gJe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ise(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function mJe(t,e,r){return e&&Ise(t.prototype,e),r&&Ise(t,r),t}var vJe=ft(),oE=vJe.Buffer,wJe=vR(),wR=wJe.inspect,_Je=wR&&wR.custom||"inspect";function EJe(t,e,r){oE.prototype.copy.call(t,e,r)}Tse.exports=function(){function t(){bJe(this,t),this.head=null,this.tail=null,this.length=0}return mJe(t,[{key:"push",value:function(r){var i={data:r,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(r){var i={data:r,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=r+i.data;return n}},{key:"concat",value:function(r){if(this.length===0)return oE.alloc(0);for(var i=oE.allocUnsafe(r>>>0),n=this.head,s=0;n;)EJe(n.data,i,s),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(r,i){var n;return r<this.head.data.length?(n=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?n=this.shift():n=i?this._getString(r):this._getBuffer(r),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var i=this.head,n=1,s=i.data;for(r-=s.length;i=i.next;){var o=i.data,a=r>o.length?o.length:r;if(a===o.length?s+=o:s+=o.slice(0,r),r-=a,r===0){a===o.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(a));break}++n}return this.length-=n,s}},{key:"_getBuffer",value:function(r){var i=oE.allocUnsafe(r),n=this.head,s=1;for(n.data.copy(i),r-=n.data.length;n=n.next;){var o=n.data,a=r>o.length?o.length:r;if(o.copy(i,i.length-r,0,a),r-=a,r===0){a===o.length?(++s,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(a));break}++s}return this.length-=s,i}},{key:_Je,value:function(r,i){return wR(this,yJe({},i,{depth:0,customInspect:!1}))}}]),t}()});var ER=p((Ikt,Cse)=>{f();"use strict";function SJe(t,e){var r=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(_R,this,t)):process.nextTick(_R,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?r._writableState?r._writableState.errorEmitted?process.nextTick(aE,r):(r._writableState.errorEmitted=!0,process.nextTick(Pse,r,s)):process.nextTick(Pse,r,s):e?(process.nextTick(aE,r),e(s)):process.nextTick(aE,r)}),this)}function Pse(t,e){_R(t,e),aE(t)}function aE(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function xJe(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function _R(t,e){t.emit("error",e)}function AJe(t,e){var r=t._readableState,i=t._writableState;r&&r.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}Cse.exports={destroy:SJe,undestroy:xJe,errorOrDestroy:AJe}});var ah=p((Tkt,qse)=>{f();"use strict";function IJe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var Ose={};function Ys(t,e,r){r||(r=Error);function i(s,o,a){return typeof e=="string"?e:e(s,o,a)}var n=function(s){IJe(o,s);function o(a,c,l){return s.call(this,i(a,c,l))||this}return o}(r);n.prototype.name=r.name,n.prototype.code=t,Ose[t]=n}function kse(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(i){return String(i)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:r===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function TJe(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function RJe(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function PJe(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}Ys("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);Ys("ERR_INVALID_ARG_TYPE",function(t,e,r){var i;typeof e=="string"&&TJe(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var n;if(RJe(t," argument"))n="The ".concat(t," ").concat(i," ").concat(kse(e,"type"));else{var s=PJe(t,".")?"property":"argument";n='The "'.concat(t,'" ').concat(s," ").concat(i," ").concat(kse(e,"type"))}return n+=". Received type ".concat(typeof r),n},TypeError);Ys("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Ys("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});Ys("ERR_STREAM_PREMATURE_CLOSE","Premature close");Ys("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});Ys("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Ys("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Ys("ERR_STREAM_WRITE_AFTER_END","write after end");Ys("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Ys("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);Ys("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");qse.exports.codes=Ose});var SR=p((Rkt,Bse)=>{f();"use strict";var CJe=ah().codes.ERR_INVALID_OPT_VALUE;function OJe(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function kJe(t,e,r,i){var n=OJe(e,i,r);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var s=i?r:"highWaterMark";throw new CJe(s,n)}return Math.floor(n)}return t.objectMode?16:16*1024}Bse.exports={getHighWaterMark:kJe}});var Dse=p((Pkt,Nse)=>{f();Nse.exports=qJe;function qJe(t,e){if(xR("noDeprecation"))return t;var r=!1;function i(){if(!r){if(xR("throwDeprecation"))throw new Error(e);xR("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}return i}function xR(t){try{if(!globalThis.localStorage)return!1}catch(r){return!1}var e=globalThis.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}});var TR=p((Ckt,jse)=>{f();"use strict";jse.exports=Wr;function Mse(t){var e=this;this.next=null,this.entry=null,this.finish=function(){oet(e,t)}}var Jp;Wr.WritableState=c1;var BJe={deprecate:Dse()},Lse=mR(),cE=ft().Buffer,NJe=globalThis.Uint8Array||function(){};function DJe(t){return cE.from(t)}function MJe(t){return cE.isBuffer(t)||t instanceof NJe}var AR=ER(),LJe=SR(),UJe=LJe.getHighWaterMark,wl=ah().codes,FJe=wl.ERR_INVALID_ARG_TYPE,KJe=wl.ERR_METHOD_NOT_IMPLEMENTED,jJe=wl.ERR_MULTIPLE_CALLBACK,VJe=wl.ERR_STREAM_CANNOT_PIPE,zJe=wl.ERR_STREAM_DESTROYED,HJe=wl.ERR_STREAM_NULL_VALUES,$Je=wl.ERR_STREAM_WRITE_AFTER_END,GJe=wl.ERR_UNKNOWN_ENCODING,e0=AR.errorOrDestroy;Xi()(Wr,Lse);function WJe(){}function c1(t,e,r){Jp=Jp||ch(),t=t||{},typeof r!="boolean"&&(r=e instanceof Jp),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=UJe(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=t.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){tet(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Mse(this)}c1.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(c1.prototype,"buffer",{get:BJe.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}})();var uE;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(uE=Function.prototype[Symbol.hasInstance],Object.defineProperty(Wr,Symbol.hasInstance,{value:function(e){return uE.call(this,e)?!0:this!==Wr?!1:e&&e._writableState instanceof c1}})):uE=function(e){return e instanceof this};function Wr(t){Jp=Jp||ch();var e=this instanceof Jp;if(!e&&!uE.call(Wr,this))return new Wr(t);this._writableState=new c1(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),Lse.call(this)}Wr.prototype.pipe=function(){e0(this,new VJe)};function YJe(t,e){var r=new $Je;e0(t,r),process.nextTick(e,r)}function XJe(t,e,r,i){var n;return r===null?n=new HJe:typeof r!="string"&&!e.objectMode&&(n=new FJe("chunk",["string","Buffer"],r)),n?(e0(t,n),process.nextTick(i,n),!1):!0}Wr.prototype.write=function(t,e,r){var i=this._writableState,n=!1,s=!i.objectMode&&MJe(t);return s&&!cE.isBuffer(t)&&(t=DJe(t)),typeof e=="function"&&(r=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof r!="function"&&(r=WJe),i.ending?YJe(this,r):(s||XJe(this,i,t,r))&&(i.pendingcb++,n=ZJe(this,i,s,t,e,r)),n};Wr.prototype.cork=function(){this._writableState.corked++};Wr.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&Fse(this,t))};Wr.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new GJe(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Wr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function QJe(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=cE.from(e,r)),e}Object.defineProperty(Wr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ZJe(t,e,r,i,n,s){if(!r){var o=QJe(e,i,n);i!==o&&(r=!0,n="buffer",i=o)}var a=e.objectMode?1:i.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else IR(t,e,!1,a,i,n,s);return c}function IR(t,e,r,i,n,s,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new zJe("write")):r?t._writev(n,e.onwrite):t._write(n,s,e.onwrite),e.sync=!1}function JJe(t,e,r,i,n){--e.pendingcb,r?(process.nextTick(n,i),process.nextTick(u1,t,e),t._writableState.errorEmitted=!0,e0(t,i)):(n(i),t._writableState.errorEmitted=!0,e0(t,i),u1(t,e))}function eet(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function tet(t,e){var r=t._writableState,i=r.sync,n=r.writecb;if(typeof n!="function")throw new jJe;if(eet(r),e)JJe(t,r,i,e,n);else{var s=Kse(r)||t.destroyed;!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&Fse(t,r),i?process.nextTick(Use,t,r,s,n):Use(t,r,s,n)}}function Use(t,e,r,i){r||ret(t,e),e.pendingcb--,i(),u1(t,e)}function ret(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function Fse(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=r;for(var o=0,a=!0;r;)n[o]=r,r.isBuf||(a=!1),r=r.next,o+=1;n.allBuffers=a,IR(t,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new Mse(e),e.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,l=r.encoding,u=r.callback,h=e.objectMode?1:c.length;if(IR(t,e,!1,h,c,l,u),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}Wr.prototype._write=function(t,e,r){r(new KJe("_write()"))};Wr.prototype._writev=null;Wr.prototype.end=function(t,e,r){var i=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||set(this,i,r),this};Object.defineProperty(Wr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Kse(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function iet(t,e){t._final(function(r){e.pendingcb--,r&&e0(t,r),e.prefinished=!0,t.emit("prefinish"),u1(t,e)})}function net(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(iet,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function u1(t,e){var r=Kse(e);if(r&&(net(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var i=t._readableState;(!i||i.autoDestroy&&i.endEmitted)&&t.destroy()}return r}function set(t,e,r){e.ending=!0,u1(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function oet(t,e,r){var i=t.entry;for(t.entry=null;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree.next=t}Object.defineProperty(Wr.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});Wr.prototype.destroy=AR.destroy;Wr.prototype._undestroy=AR.undestroy;Wr.prototype._destroy=function(t,e){e(t)}});var ch=p((Okt,zse)=>{f();"use strict";var aet=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};zse.exports=ec;var Vse=CR(),RR=TR();Xi()(ec,Vse);for(PR=aet(RR.prototype),lE=0;lE<PR.length;lE++)fE=PR[lE],ec.prototype[fE]||(ec.prototype[fE]=RR.prototype[fE]);var PR,fE,lE;function ec(t){if(!(this instanceof ec))return new ec(t);Vse.call(this,t),RR.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",cet)))}Object.defineProperty(ec.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(ec.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(ec.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function cet(){this._writableState.ended||process.nextTick(uet,this)}function uet(t){t.end()}Object.defineProperty(ec.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var Gse=p((OR,$se)=>{f();var hE=ft(),Qc=hE.Buffer;function Hse(t,e){for(var r in t)e[r]=t[r]}Qc.from&&Qc.alloc&&Qc.allocUnsafe&&Qc.allocUnsafeSlow?$se.exports=hE:(Hse(hE,OR),OR.Buffer=t0);function t0(t,e,r){return Qc(t,e,r)}Hse(Qc,t0);t0.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return Qc(t,e,r)};t0.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var i=Qc(t);return e!==void 0?typeof r=="string"?i.fill(e,r):i.fill(e):i.fill(0),i};t0.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Qc(t)};t0.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return hE.SlowBuffer(t)}});var BR=p(Yse=>{f();"use strict";var kR=Gse().Buffer,Wse=kR.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function fet(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function het(t){var e=fet(t);if(typeof e!="string"&&(kR.isEncoding===Wse||!Wse(t)))throw new Error("Unknown encoding: "+t);return e||t}Yse.StringDecoder=l1;function l1(t){this.encoding=het(t);var e;switch(this.encoding){case"utf16le":this.text=met,this.end=vet,e=4;break;case"utf8":this.fillLast=yet,e=4;break;case"base64":this.text=wet,this.end=_et,e=3;break;default:this.write=Eet,this.end=xet;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=kR.allocUnsafe(e)}l1.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};l1.prototype.end=bet;l1.prototype.text=get;l1.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function qR(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function det(t,e,r){var i=e.length-1;if(i<r)return 0;var n=qR(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<r||n===-2?0:(n=qR(e[i]),n>=0?(n>0&&(t.lastNeed=n-2),n):--i<r||n===-2?0:(n=qR(e[i]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function pet(t,e,r){if((e[0]&192)!=128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!=128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!=128)return t.lastNeed=2,"\uFFFD"}}function yet(t){var e=this.lastTotal-this.lastNeed,r=pet(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function get(t,e){var r=det(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var i=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function bet(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function met(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function vet(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function wet(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function _et(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Eet(t){return t.toString(this.encoding)}function xet(t){return t&&t.length?this.write(t):""}});var dE=p((qkt,Zse)=>{f();"use strict";var Xse=ah().codes.ERR_STREAM_PREMATURE_CLOSE;function Aet(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];t.apply(this,i)}}}function Iet(){}function Tet(t){return t.setHeader&&typeof t.abort=="function"}function Qse(t,e,r){if(typeof e=="function")return Qse(t,null,e);e||(e={}),r=Aet(r||Iet);var i=e.readable||e.readable!==!1&&t.readable,n=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||a()},o=t._writableState&&t._writableState.finished,a=function(){n=!1,o=!0,i||r.call(t)},c=t._readableState&&t._readableState.endEmitted,l=function(){i=!1,c=!0,n||r.call(t)},u=function(g){r.call(t,g)},h=function(){var g;if(i&&!c)return(!t._readableState||!t._readableState.ended)&&(g=new Xse),r.call(t,g);if(n&&!o)return(!t._writableState||!t._writableState.ended)&&(g=new Xse),r.call(t,g)},d=function(){t.req.on("finish",a)};return Tet(t)?(t.on("complete",a),t.on("abort",h),t.req?d():t.on("request",d)):n&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",l),t.on("finish",a),e.error!==!1&&t.on("error",u),t.on("close",h),function(){t.removeListener("complete",a),t.removeListener("abort",h),t.removeListener("request",d),t.req&&t.req.removeListener("finish",a),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",a),t.removeListener("end",l),t.removeListener("error",u),t.removeListener("close",h)}}Zse.exports=Qse});var eoe=p((Bkt,Jse)=>{f();"use strict";var pE;function _l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ret=dE(),El=Symbol("lastResolve"),uh=Symbol("lastReject"),f1=Symbol("error"),yE=Symbol("ended"),lh=Symbol("lastPromise"),NR=Symbol("handlePromise"),fh=Symbol("stream");function Sl(t,e){return{value:t,done:e}}function Pet(t){var e=t[El];if(e!==null){var r=t[fh].read();r!==null&&(t[lh]=null,t[El]=null,t[uh]=null,e(Sl(r,!1)))}}function Cet(t){process.nextTick(Pet,t)}function Oet(t,e){return function(r,i){t.then(function(){if(e[yE]){r(Sl(void 0,!0));return}e[NR](r,i)},i)}}var ket=Object.getPrototypeOf(function(){}),qet=Object.setPrototypeOf((pE={get stream(){return this[fh]},next:function(){var e=this,r=this[f1];if(r!==null)return Promise.reject(r);if(this[yE])return Promise.resolve(Sl(void 0,!0));if(this[fh].destroyed)return new Promise(function(o,a){process.nextTick(function(){e[f1]?a(e[f1]):o(Sl(void 0,!0))})});var i=this[lh],n;if(i)n=new Promise(Oet(i,this));else{var s=this[fh].read();if(s!==null)return Promise.resolve(Sl(s,!1));n=new Promise(this[NR])}return this[lh]=n,n}},_l(pE,Symbol.asyncIterator,function(){return this}),_l(pE,"return",function(){var e=this;return new Promise(function(r,i){e[fh].destroy(null,function(n){if(n){i(n);return}r(Sl(void 0,!0))})})}),pE),ket),Bet=function(e){var r,i=Object.create(qet,(r={},_l(r,fh,{value:e,writable:!0}),_l(r,El,{value:null,writable:!0}),_l(r,uh,{value:null,writable:!0}),_l(r,f1,{value:null,writable:!0}),_l(r,yE,{value:e._readableState.endEmitted,writable:!0}),_l(r,NR,{value:function(s,o){var a=i[fh].read();a?(i[lh]=null,i[El]=null,i[uh]=null,s(Sl(a,!1))):(i[El]=s,i[uh]=o)},writable:!0}),r));return i[lh]=null,Ret(e,function(n){if(n&&n.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=i[uh];s!==null&&(i[lh]=null,i[El]=null,i[uh]=null,s(n)),i[f1]=n;return}var o=i[El];o!==null&&(i[lh]=null,i[El]=null,i[uh]=null,o(Sl(void 0,!0))),i[yE]=!0}),e.on("readable",Cet.bind(null,i)),i};Jse.exports=Bet});var roe=p((Nkt,toe)=>{f();toe.exports=function(){throw new Error("Readable.from is not available in the browser")}});var CR=p((Mkt,hoe)=>{f();"use strict";hoe.exports=qt;var r0;qt.ReadableState=noe;var Dkt=vr().EventEmitter,ioe=function(e,r){return e.listeners(r).length},h1=mR(),gE=ft().Buffer,Net=globalThis.Uint8Array||function(){};function Det(t){return gE.from(t)}function Met(t){return gE.isBuffer(t)||t instanceof Net}var DR=vR(),yt;DR&&DR.debuglog?yt=DR.debuglog("stream"):yt=function(){};var Let=Rse(),MR=ER(),Uet=SR(),Fet=Uet.getHighWaterMark,bE=ah().codes,Ket=bE.ERR_INVALID_ARG_TYPE,jet=bE.ERR_STREAM_PUSH_AFTER_EOF,Vet=bE.ERR_METHOD_NOT_IMPLEMENTED,zet=bE.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,i0,LR,UR;Xi()(qt,h1);var d1=MR.errorOrDestroy,FR=["error","close","destroy","pause","resume"];function Het(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function noe(t,e,r){r0=r0||ch(),t=t||{},typeof r!="boolean"&&(r=e instanceof r0),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=Fet(this,t,"readableHighWaterMark",r),this.buffer=new Let,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(i0||(i0=BR().StringDecoder),this.decoder=new i0(t.encoding),this.encoding=t.encoding)}function qt(t){if(r0=r0||ch(),!(this instanceof qt))return new qt(t);var e=this instanceof r0;this._readableState=new noe(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),h1.call(this)}Object.defineProperty(qt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});qt.prototype.destroy=MR.destroy;qt.prototype._undestroy=MR.undestroy;qt.prototype._destroy=function(t,e){e(t)};qt.prototype.push=function(t,e){var r=this._readableState,i;return r.objectMode?i=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=gE.from(t,e),e=""),i=!0),soe(this,t,e,!1,i)};qt.prototype.unshift=function(t){return soe(this,t,null,!0,!1)};function soe(t,e,r,i,n){yt("readableAddChunk",e);var s=t._readableState;if(e===null)s.reading=!1,Wet(t,s);else{var o;if(n||(o=$et(s,e)),o)d1(t,o);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==gE.prototype&&(e=Det(e)),i)s.endEmitted?d1(t,new zet):KR(t,s,e,!0);else if(s.ended)d1(t,new jet);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||e.length!==0?KR(t,s,e,!1):jR(t,s)):KR(t,s,e,!1)}else i||(s.reading=!1,jR(t,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function KR(t,e,r,i){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&mE(t)),jR(t,e)}function $et(t,e){var r;return!Met(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new Ket("chunk",["string","Buffer","Uint8Array"],e)),r}qt.prototype.isPaused=function(){return this._readableState.flowing===!1};qt.prototype.setEncoding=function(t){i0||(i0=BR().StringDecoder);var e=new i0(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";r!==null;)i+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),i!==""&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var ooe=1073741824;function Get(t){return t>=ooe?t=ooe:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function aoe(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=Get(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}qt.prototype.read=function(t){yt("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return yt("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?zR(this):mE(this),null;if(t=aoe(t,e),t===0&&e.ended)return e.length===0&&zR(this),null;var i=e.needReadable;yt("need readable",i),(e.length===0||e.length-t<e.highWaterMark)&&(i=!0,yt("length less than watermark",i)),e.ended||e.reading?(i=!1,yt("reading or ended",i)):i&&(yt("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=aoe(r,e)));var n;return t>0?n=loe(t,e):n=null,n===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&zR(this)),n!==null&&this.emit("data",n),n};function Wet(t,e){if(yt("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?mE(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,coe(t)))}}function mE(t){var e=t._readableState;yt("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(yt("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(coe,t))}function coe(t){var e=t._readableState;yt("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,VR(t)}function jR(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(Yet,t,e))}function Yet(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(yt("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}qt.prototype._read=function(t){d1(this,new Vet("_read()"))};qt.prototype.pipe=function(t,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t);break}i.pipesCount+=1,yt("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,s=n?a:m;i.endEmitted?process.nextTick(s):r.once("end",s),t.on("unpipe",o);function o(E,v){yt("onunpipe"),E===r&&v&&v.hasUnpiped===!1&&(v.hasUnpiped=!0,u())}function a(){yt("onend"),t.end()}var c=Xet(r);t.on("drain",c);var l=!1;function u(){yt("cleanup"),t.removeListener("close",y),t.removeListener("finish",g),t.removeListener("drain",c),t.removeListener("error",d),t.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",m),r.removeListener("data",h),l=!0,i.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}r.on("data",h);function h(E){yt("ondata");var v=t.write(E);yt("dest.write",v),v===!1&&((i.pipesCount===1&&i.pipes===t||i.pipesCount>1&&foe(i.pipes,t)!==-1)&&!l&&(yt("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(E){yt("onerror",E),m(),t.removeListener("error",d),ioe(t,"error")===0&&d1(t,E)}Het(t,"error",d);function y(){t.removeListener("finish",g),m()}t.once("close",y);function g(){yt("onfinish"),t.removeListener("close",y),m()}t.once("finish",g);function m(){yt("unpipe"),r.unpipe(t)}return t.emit("pipe",r),i.flowing||(yt("pipe resume"),r.resume()),t};function Xet(t){return function(){var r=t._readableState;yt("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&ioe(t,"data")&&(r.flowing=!0,VR(t))}}qt.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=foe(e.pipes,t);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};qt.prototype.on=function(t,e){var r=h1.prototype.on.call(this,t,e),i=this._readableState;return t==="data"?(i.readableListening=this.listenerCount("readable")>0,i.flowing!==!1&&this.resume()):t==="readable"&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,yt("on readable",i.length,i.reading),i.length?mE(this):i.reading||process.nextTick(Qet,this)),r};qt.prototype.addListener=qt.prototype.on;qt.prototype.removeListener=function(t,e){var r=h1.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(uoe,this),r};qt.prototype.removeAllListeners=function(t){var e=h1.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(uoe,this),e};function uoe(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function Qet(t){yt("readable nexttick read 0"),t.read(0)}qt.prototype.resume=function(){var t=this._readableState;return t.flowing||(yt("resume"),t.flowing=!t.readableListening,Zet(this,t)),t.paused=!1,this};function Zet(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(Jet,t,e))}function Jet(t,e){yt("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),VR(t),e.flowing&&!e.reading&&t.read(0)}qt.prototype.pause=function(){return yt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(yt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function VR(t){var e=t._readableState;for(yt("flow",e.flowing);e.flowing&&t.read()!==null;);}qt.prototype.wrap=function(t){var e=this,r=this._readableState,i=!1;t.on("end",function(){if(yt("wrapped end"),r.decoder&&!r.ended){var o=r.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),t.on("data",function(o){if(yt("wrapped data"),r.decoder&&(o=r.decoder.write(o)),!(r.objectMode&&o==null)&&!(!r.objectMode&&(!o||!o.length))){var a=e.push(o);a||(i=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(a){return function(){return t[a].apply(t,arguments)}}(n));for(var s=0;s<FR.length;s++)t.on(FR[s],this.emit.bind(this,FR[s]));return this._read=function(o){yt("wrapped _read",o),i&&(i=!1,t.resume())},this};typeof Symbol=="function"&&(qt.prototype[Symbol.asyncIterator]=function(){return LR===void 0&&(LR=eoe()),LR(this)});Object.defineProperty(qt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(qt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(qt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});qt._fromList=loe;Object.defineProperty(qt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function loe(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function zR(t){var e=t._readableState;yt("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(ett,e,t))}function ett(t,e){if(yt("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(qt.from=function(t,e){return UR===void 0&&(UR=roe()),UR(qt,t,e)});function foe(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}});var HR=p((Lkt,poe)=>{f();"use strict";poe.exports=Zc;var vE=ah().codes,ttt=vE.ERR_METHOD_NOT_IMPLEMENTED,rtt=vE.ERR_MULTIPLE_CALLBACK,itt=vE.ERR_TRANSFORM_ALREADY_TRANSFORMING,ntt=vE.ERR_TRANSFORM_WITH_LENGTH_0,wE=ch();Xi()(Zc,wE);function stt(t,e){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(i===null)return this.emit("error",new rtt);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),i(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function Zc(t){if(!(this instanceof Zc))return new Zc(t);wE.call(this,t),this._transformState={afterTransform:stt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",ott)}function ott(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){doe(t,e,r)}):doe(this,null,null)}Zc.prototype.push=function(t,e){return this._transformState.needTransform=!1,wE.prototype.push.call(this,t,e)};Zc.prototype._transform=function(t,e,r){r(new ttt("_transform()"))};Zc.prototype._write=function(t,e,r){var i=this._transformState;if(i.writecb=r,i.writechunk=t,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};Zc.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Zc.prototype._destroy=function(t,e){wE.prototype._destroy.call(this,t,function(r){e(r)})};function doe(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new ntt;if(t._transformState.transforming)throw new itt;return t.push(null)}});var boe=p((Ukt,goe)=>{f();"use strict";goe.exports=p1;var yoe=HR();Xi()(p1,yoe);function p1(t){if(!(this instanceof p1))return new p1(t);yoe.call(this,t)}p1.prototype._transform=function(t,e,r){r(null,t)}});var Eoe=p((Fkt,_oe)=>{f();"use strict";var $R;function att(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var moe=ah().codes,ctt=moe.ERR_MISSING_ARGS,utt=moe.ERR_STREAM_DESTROYED;function voe(t){if(t)throw t}function ltt(t){return t.setHeader&&typeof t.abort=="function"}function ftt(t,e,r,i){i=att(i);var n=!1;t.on("close",function(){n=!0}),$R===void 0&&($R=dE()),$R(t,{readable:e,writable:r},function(o){if(o)return i(o);n=!0,i()});var s=!1;return function(o){if(!n&&!s){if(s=!0,ltt(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();i(o||new utt("pipe"))}}}function woe(t){t()}function htt(t,e){return t.pipe(e)}function dtt(t){return!t.length||typeof t[t.length-1]!="function"?voe:t.pop()}function ptt(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i=dtt(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new ctt("streams");var n,s=e.map(function(o,a){var c=a<e.length-1,l=a>0;return ftt(o,c,l,function(u){n||(n=u),u&&s.forEach(woe),!c&&(s.forEach(woe),i(n))})});return e.reduce(htt)}_oe.exports=ptt});var GR=p((Xs,Soe)=>{f();Xs=Soe.exports=CR();Xs.Stream=Xs;Xs.Readable=Xs;Xs.Writable=TR();Xs.Duplex=ch();Xs.Transform=HR();Xs.PassThrough=boe();Xs.finished=dE();Xs.pipeline=Eoe()});var Ioe=p((Kkt,Aoe)=>{f();"use strict";var ytt=Xi(),{Readable:xoe}=GR();Aoe.exports=n0;ytt(n0,xoe);function n0(t,e){if(!(this instanceof n0))return new n0(t,e);e=e||{},xoe.call(this,Object.assign({},e,{objectMode:!0})),this._iterator=t,this._options=e,this.on("end",this.destroy.bind(this,null,null))}n0.prototype._read=function(){this.destroyed||this._iterator.next((t,e,r)=>{if(!this.destroyed){if(t)return this.destroy(t);e===void 0&&r===void 0?this.push(null):this._options.keys!==!1&&this._options.values===!1?this.push(e):this._options.keys===!1&&this._options.values!==!1?this.push(r):this.push({key:e,value:r})}})};n0.prototype._destroy=function(t,e){this._iterator.end(function(r){e(t||r)})}});var Roe=p((Toe,_E)=>{f();(function(t,e,r){typeof _E!="undefined"&&_E.exports?_E.exports=r():e[t]=r()})("prr",Toe,function(){var t=typeof Object.defineProperty=="function"?function(i,n,s){return Object.defineProperty(i,n,s),i}:function(i,n,s){return i[n]=s.value,i},e=function(i,n){var s=typeof n=="object",o=!s&&typeof n=="string",a=function(c){return s?!!n[c]:o?n.indexOf(c[0])>-1:!1};return{enumerable:a("enumerable"),configurable:a("configurable"),writable:a("writable"),value:i}},r=function(i,n,s,o){var a;if(o=e(s,o),typeof n=="object"){for(a in n)Object.hasOwnProperty.call(n,a)&&(o.value=n[a],t(i,a,o));return i}return t(i,n,o)};return r})});var Ooe=p((jkt,Coe)=>{f();var gtt=Roe();function Poe(t,e,r){!!e&&typeof e!="string"&&(e=e.message||e.name),gtt(this,{type:t,name:t,cause:typeof e!="string"?e:r,message:e},"ewr")}function WR(t,e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),Poe.call(this,"CustomError",t,e)}WR.prototype=new Error;function btt(t,e,r){var i=function(n,s){Poe.call(this,e,n,s),e=="FilesystemError"&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(t.errno[this.cause.errno]?t.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,i)};return i.prototype=r?new r:new WR,i}Coe.exports=function(t){var e=function(r,i){return btt(t,r,i)};return{CustomError:WR,FilesystemError:e("FilesystemError"),createError:e}}});var koe=p((Vkt,tc)=>{f();var mtt=tc.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];tc.exports.errno={};tc.exports.code={};mtt.forEach(function(t){tc.exports.errno[t.errno]=t,tc.exports.code[t.code]=t});tc.exports.custom=Ooe()(tc.exports);tc.exports.create=tc.exports.custom.createError});var EE=p((zkt,qoe)=>{f();"use strict";var hh=koe().create,dh=hh("LevelUPError"),YR=hh("NotFoundError",dh);YR.prototype.notFound=!0;YR.prototype.status=404;qoe.exports={LevelUPError:dh,InitializationError:hh("InitializationError",dh),OpenError:hh("OpenError",dh),ReadError:hh("ReadError",dh),WriteError:hh("WriteError",dh),NotFoundError:YR,EncodingError:hh("EncodingError",dh)}});var QR=p(XR=>{f();"use strict";XR.fromCallback=function(t){if(t===void 0){var e=new Promise(function(r,i){t=function(n,s){n?i(n):r(s)}});t.promise=e}return t};XR.fromPromise=function(t,e){if(e===void 0)return t;t.then(function(r){process.nextTick(e,null,r)}).catch(function(r){process.nextTick(e,r)})}});var y1=p(ZR=>{f();"use strict";ZR.getCallback=function(t,e){return typeof t=="function"?t:e};ZR.getOptions=function(t){return typeof t=="object"&&t!==null?t:{}}});var Noe=p((Gkt,Boe)=>{f();"use strict";var g1=EE().WriteError,vtt=QR(),wtt=y1().getCallback,_tt=y1().getOptions;function b1(t){this.db=t,this.batch=t.db.batch(),this.ops=[],this.length=0}b1.prototype.put=function(t,e,r){try{this.batch.put(t,e,r)}catch(i){throw new g1(i)}return this.ops.push({...r,type:"put",key:t,value:e}),this.length++,this};b1.prototype.del=function(t,e){try{this.batch.del(t,e)}catch(r){throw new g1(r)}return this.ops.push({...e,type:"del",key:t}),this.length++,this};b1.prototype.clear=function(){try{this.batch.clear()}catch(t){throw new g1(t)}return this.ops=[],this.length=0,this};b1.prototype.write=function(t,e){let r=this.db,i=this.ops;e=wtt(t,e),e=vtt.fromCallback(e),t=_tt(t);try{this.batch.write(t,function(n){if(n)return e(new g1(n));r.emit("batch",i),e()})}catch(n){throw new g1(n)}return e.promise};Boe.exports=b1});var Loe=p((Wkt,Moe)=>{f();"use strict";var Doe=iE();Moe.exports=function(t,...e){e.length===0?Doe(t):Doe(()=>t(...e))}});var joe=p((Ykt,Koe)=>{f();"use strict";var SE=vr().EventEmitter,Ett=rse().inherits,Uoe=Sse(),Stt=Ioe(),xtt=Noe(),s0=EE(),Att=pR(),ph=QR(),m1=y1().getCallback,o0=y1().getOptions,xE=Loe(),AE=s0.WriteError,Foe=s0.ReadError,Itt=s0.NotFoundError,Ttt=s0.OpenError,Rtt=s0.InitializationError;function lr(t,e,r){if(!(this instanceof lr))return new lr(t,e,r);let i;if(SE.call(this),this.setMaxListeners(1/0),typeof e=="function"&&(r=e,e={}),e=e||{},!t||typeof t!="object"){if(i=new Rtt("First argument must be an abstract-leveldown compliant store"),typeof r=="function")return xE(r,i);throw i}if(typeof t.status!="string")throw new Error(".status required, old abstract-leveldown");this.options=o0(e),this._db=t,this.db=new Uoe(t),this.open(r||(n=>{n&&this.emit("error",n)})),this.supports=Att(this.db.supports,{status:!1,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(let n of Object.keys(this.supports.additionalMethods))this[n]==null&&(this[n]=function(...s){return this.db[n](...s)})}lr.prototype.emit=SE.prototype.emit;lr.prototype.once=SE.prototype.once;Ett(lr,SE);lr.prototype.open=function(t,e){return typeof t=="function"&&(e=t,t=null),e=ph.fromCallback(e),t||(t=this.options),this.isOpen()?(xE(e,null,this),e.promise):this._isOpening()?(this.once("open",()=>{e(null,this)}),e.promise):(this.emit("opening"),this.db.open(t,r=>{if(r)return e(new Ttt(r));this.db=this._db,e(null,this),this.emit("open"),this.emit("ready")}),e.promise)};lr.prototype.close=function(t){return t=ph.fromCallback(t),this.isOpen()?(this.db.close((e,...r)=>{this.emit("closed"),t(e,...r)}),this.emit("closing"),this.db=new Uoe(this._db)):this.isClosed()?xE(t):this.db.status==="closing"?this.once("closed",t):this._isOpening()&&this.once("open",()=>{this.close(t)}),t.promise};lr.prototype.isOpen=function(){return this.db.status==="open"};lr.prototype._isOpening=function(){return this.db.status==="opening"};lr.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)};lr.prototype.get=function(t,e,r){return r=m1(e,r),r=ph.fromCallback(r),v1(this,r)||(e=o0(e),this.db.get(t,e,function(i,n){if(i)return/notfound/i.test(i)||i.notFound?i=new Itt("Key not found in database ["+t+"]",i):i=new Foe(i),r(i);r(null,n)})),r.promise};lr.prototype.put=function(t,e,r,i){return i=m1(r,i),i=ph.fromCallback(i),v1(this,i)||(r=o0(r),this.db.put(t,e,r,n=>{if(n)return i(new AE(n));this.emit("put",t,e),i()})),i.promise};lr.prototype.del=function(t,e,r){return r=m1(e,r),r=ph.fromCallback(r),v1(this,r)||(e=o0(e),this.db.del(t,e,i=>{if(i)return r(new AE(i));this.emit("del",t),r()})),r.promise};lr.prototype.batch=function(t,e,r){return arguments.length?(typeof t=="function"?r=t:r=m1(e,r),r=ph.fromCallback(r),v1(this,r)||(e=o0(e),this.db.batch(t,e,i=>{if(i)return r(new AE(i));this.emit("batch",t),r()})),r.promise):new xtt(this)};lr.prototype.iterator=function(t){return this.db.iterator(t)};lr.prototype.clear=function(t,e){return e=m1(t,e),t=o0(t),e=ph.fromCallback(e),v1(this,e)||this.db.clear(t,r=>{if(r)return e(new AE(r));this.emit("clear",t),e()}),e.promise};lr.prototype.readStream=lr.prototype.createReadStream=function(t){return t=Object.assign({keys:!0,values:!0},t),typeof t.limit!="number"&&(t.limit=-1),new Stt(this.db.iterator(t),t)};lr.prototype.keyStream=lr.prototype.createKeyStream=function(t){return this.createReadStream(Object.assign({},t,{keys:!0,values:!1}))};lr.prototype.valueStream=lr.prototype.createValueStream=function(t){return this.createReadStream(Object.assign({},t,{keys:!1,values:!0}))};lr.prototype.toString=function(){return"LevelUP"};lr.prototype.type="levelup";function v1(t,e){if(!t._isOpening()&&!t.isOpen())return xE(e,new Foe("Database is not open")),!0}lr.errors=s0;Koe.exports=lr});var Voe=p(Jc=>{f();"use strict";var{Buffer:JR}=ft();Jc.utf8=Jc["utf-8"]={encode:function(t){return e8(t)?t:String(t)},decode:IE,buffer:!1,type:"utf8"};Jc.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"};Jc.binary={encode:function(t){return e8(t)?t:JR.from(t)},decode:IE,buffer:!0,type:"binary"};Jc.none={encode:IE,decode:IE,buffer:!1,type:"id"};Jc.id=Jc.none;var Ptt=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let t of Ptt)Jc[t]={encode:function(e){return e8(e)?e:JR.from(e,t)},decode:function(e){return e.toString(t)},buffer:!0,type:t};function IE(t){return t}function e8(t){return t==null||JR.isBuffer(t)}});var Hoe=p((Qkt,zoe)=>{f();"use strict";var t8=Voe(),Ctt=new Set(["lt","gt","lte","gte"]);zoe.exports=qn;function qn(t){if(!(this instanceof qn))return new qn(t);this.opts=t||{},this.encodings=t8}qn.prototype._encoding=function(t){return typeof t=="string"&&(t=t8[t]),t||(t=t8.id),t};qn.prototype._keyEncoding=function(t,e){return this._encoding(e&&e.keyEncoding||t&&t.keyEncoding||this.opts.keyEncoding)};qn.prototype._valueEncoding=function(t,e){return this._encoding(e&&(e.valueEncoding||e.encoding)||t&&(t.valueEncoding||t.encoding)||this.opts.valueEncoding||this.opts.encoding)};qn.prototype.encodeKey=function(t,e,r){return this._keyEncoding(e,r).encode(t)};qn.prototype.encodeValue=function(t,e,r){return this._valueEncoding(e,r).encode(t)};qn.prototype.decodeKey=function(t,e){return this._keyEncoding(e).decode(t)};qn.prototype.decodeValue=function(t,e){return this._valueEncoding(e).decode(t)};qn.prototype.encodeBatch=function(t,e){return t.map(r=>{let i={type:r.type,key:this.encodeKey(r.key,e,r)};return this.keyAsBuffer(e,r)&&(i.keyEncoding="binary"),r.prefix&&(i.prefix=r.prefix),"value"in r&&(i.value=this.encodeValue(r.value,e,r),this.valueAsBuffer(e,r)&&(i.valueEncoding="binary")),i})};qn.prototype.encodeLtgt=function(t){let e={};for(let r of Object.keys(t)){if(r==="start"||r==="end")throw new Error('Legacy range options ("start" and "end") have been removed');e[r]=Ctt.has(r)?this.encodeKey(t[r],t):t[r]}return e};qn.prototype.createStreamDecoder=function(t){return t.keys&&t.values?(e,r)=>({key:this.decodeKey(e,t),value:this.decodeValue(r,t)}):t.keys?e=>this.decodeKey(e,t):t.values?(e,r)=>this.decodeValue(r,t):function(){}};qn.prototype.keyAsBuffer=function(t){return this._keyEncoding(t).buffer};qn.prototype.valueAsBuffer=function(t){return this._valueEncoding(t).buffer}});var Qoe=p((Zkt,Xoe)=>{f();"use strict";var $oe=vl().AbstractLevelDOWN,Goe=vl().AbstractChainedBatch,Woe=vl().AbstractIterator,r8=Xi(),Ott=Hoe(),Yoe=EE().EncodingError,ktt=["approximateSize","compactRange"];Xoe.exports=bn;function bn(t,e){if(!(this instanceof bn))return new bn(t,e);let r=t.supports||{},i=r.additionalMethods||{};$oe.call(this,r),this.supports.encodings=!0,this.supports.additionalMethods={},ktt.forEach(function(n){let s=typeof t[n]=="function";(i[n]||s)&&(this.supports.additionalMethods[n]=!0,this[n]=function(o,a,c,l){return o=this.codec.encodeKey(o,c),a=this.codec.encodeKey(a,c),this.db[n](o,a,c,l)})},this),e=e||{},typeof e.keyEncoding=="undefined"&&(e.keyEncoding="utf8"),typeof e.valueEncoding=="undefined"&&(e.valueEncoding="utf8"),this.db=t,this.codec=new Ott(e)}r8(bn,$oe);bn.prototype.type="encoding-down";bn.prototype._serializeKey=bn.prototype._serializeValue=function(t){return t};bn.prototype._open=function(t,e){this.db.open(t,e)};bn.prototype._close=function(t){this.db.close(t)};bn.prototype._put=function(t,e,r,i){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.db.put(t,e,r,i)};bn.prototype._get=function(t,e,r){t=this.codec.encodeKey(t,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(t,e,(i,n)=>{if(i)return r(i);try{n=this.codec.decodeValue(n,e)}catch(s){return r(new Yoe(s))}r(null,n)})};bn.prototype._del=function(t,e,r){t=this.codec.encodeKey(t,e),this.db.del(t,e,r)};bn.prototype._chainedBatch=function(){return new a0(this)};bn.prototype._batch=function(t,e,r){t=this.codec.encodeBatch(t,e),this.db.batch(t,e,r)};bn.prototype._iterator=function(t){return t.keyAsBuffer=this.codec.keyAsBuffer(t),t.valueAsBuffer=this.codec.valueAsBuffer(t),new w1(this,t)};bn.prototype._clear=function(t,e){t=this.codec.encodeLtgt(t),this.db.clear(t,e)};function w1(t,e){Woe.call(this,t),this.codec=t.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=t.db.iterator(this.opts)}r8(w1,Woe);w1.prototype._next=function(t){this.it.next((e,r,i)=>{if(e)return t(e);try{this.keys&&typeof r!="undefined"?r=this.codec.decodeKey(r,this.opts):r=void 0,this.values&&typeof i!="undefined"?i=this.codec.decodeValue(i,this.opts):i=void 0}catch(n){return t(new Yoe(n))}t(null,r,i)})};w1.prototype._seek=function(t){t=this.codec.encodeKey(t,this.opts),this.it.seek(t)};w1.prototype._end=function(t){this.it.end(t)};function a0(t,e){Goe.call(this,t),this.codec=t.codec,this.batch=t.db.batch()}r8(a0,Goe);a0.prototype._put=function(t,e,r){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.batch.put(t,e)};a0.prototype._del=function(t,e){t=this.codec.encodeKey(t,e),this.batch.del(t)};a0.prototype._clear=function(){this.batch.clear()};a0.prototype._write=function(t,e){this.batch.write(t,e)}});var eae=p((Jkt,Joe)=>{f();"use strict";var Zoe=joe(),qtt=Qoe();function Btt(t){function e(i,n,s){return typeof i=="function"?s=i:typeof n=="function"&&(s=n),r(n)||(n=r(i)?i:{}),Zoe(qtt(t(i,n),n),n,s)}function r(i){return typeof i=="object"&&i!==null}for(let i of["destroy","repair"])typeof t[i]=="function"&&(e[i]=function(...n){t[i](...n)});return e.errors=Zoe.errors,e}Joe.exports=Btt});var rae=p(li=>{f();li.compare=function(t,e){if(Buffer.isBuffer(t)){for(var r=Math.min(t.length,e.length),i=0;i<r;i++){var n=t[i]-e[i];if(n)return n}return t.length-e.length}return t<e?-1:t>e?1:0};function tae(t){return t!==void 0&&t!==""}function c0(t,e){return Object.hasOwnProperty.call(t,e)}function rc(t,e){return Object.hasOwnProperty.call(t,e)&&e}var Ntt=li.lowerBoundKey=function(t){return rc(t,"gt")||rc(t,"gte")||rc(t,"min")||(t.reverse?rc(t,"end"):rc(t,"start"))||void 0},i8=li.lowerBound=function(t,e){var r=Ntt(t);return r?t[r]:e},n8=li.lowerBoundInclusive=function(t){return!c0(t,"gt")},s8=li.upperBoundInclusive=function(t){return!c0(t,"lt")},Dtt=li.lowerBoundExclusive=function(t){return!n8(t)},Mtt=li.upperBoundExclusive=function(t){return!s8(t)},Ltt=li.upperBoundKey=function(t){return rc(t,"lt")||rc(t,"lte")||rc(t,"max")||(t.reverse?rc(t,"start"):rc(t,"end"))||void 0},o8=li.upperBound=function(t,e){var r=Ltt(t);return r?t[r]:e};li.start=function(t,e){return t.reverse?o8(t,e):i8(t,e)};li.end=function(t,e){return t.reverse?i8(t,e):o8(t,e)};li.startInclusive=function(t){return t.reverse?s8(t):n8(t)};li.endInclusive=function(t){return t.reverse?n8(t):s8(t)};function Utt(t){return t}li.toLtgt=function(t,e,r,i,n){e=e||{},r=r||Utt;var s=arguments.length>3,o=li.lowerBoundKey(t),a=li.upperBoundKey(t);return o?o==="gt"?e.gt=r(t.gt,!1):e.gte=r(t[o],!1):s&&(e.gte=r(i,!1)),a?a==="lt"?e.lt=r(t.lt,!0):e.lte=r(t[a],!0):s&&(e.lte=r(n,!0)),t.reverse!=null&&(e.reverse=!!t.reverse),c0(e,"max")&&delete e.max,c0(e,"min")&&delete e.min,c0(e,"start")&&delete e.start,c0(e,"end")&&delete e.end,e};li.contains=function(t,e,r){r=r||li.compare;var i=i8(t);if(tae(i)){var n=r(e,i);if(n<0||n===0&&Dtt(t))return!1}var s=o8(t);if(tae(s)){var n=r(e,s);if(n>0||n===0&&Mtt(t))return!1}return!0};li.filter=function(t,e){return function(r){return li.contains(t,r,e)}}});var a8=p((tqt,iae)=>{f();"use strict";var TE=rae(),xl=Symbol("none");iae.exports=function(e){let r=TE.lowerBound(e,xl),i=TE.upperBound(e,xl),n=TE.lowerBoundExclusive(e,xl),s=TE.upperBoundExclusive(e,xl);return r!==xl&&i!==xl?IDBKeyRange.bound(r,i,n,s):r!==xl?IDBKeyRange.lowerBound(r,n):i!==xl?IDBKeyRange.upperBound(i,s):null}});var c8=p((rqt,sae)=>{f();"use strict";var RE=ft().Buffer,Ftt=function(){if(globalThis.TextDecoder){let t=new TextDecoder("utf-8");return t.decode.bind(t)}else return function(e){return nae(e).toString()}}(),Ktt=function(){if(globalThis.TextDecoder){let t=new TextDecoder("utf-8");return t.decode.bind(t)}else return function(e){return RE.from(e).toString()}}();function nae(t){let e=RE.from(t.buffer);return t.byteLength===t.buffer.byteLength?e:e.slice(t.byteOffset,t.byteOffset+t.byteLength)}sae.exports=function(t,e){return t instanceof Uint8Array?e?nae(t):Ftt(t):t instanceof ArrayBuffer?e?RE.from(t):Ktt(t):e?RE.from(String(t)):String(t)}});var uae=p((iqt,cae)=>{f();"use strict";var jtt=Xi(),oae=vl().AbstractIterator,Vtt=a8(),aae=c8(),ztt=function(){};cae.exports=zo;function zo(t,e,r){if(oae.call(this,t),this._limit=r.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=r.keys,this._values=r.values,this._keyAsBuffer=r.keyAsBuffer,this._valueAsBuffer=r.valueAsBuffer,this._limit===0){this._completed=!0;return}let i;try{i=Vtt(r)}catch(n){this._completed=!0;return}this.createIterator(e,i,r.reverse)}jtt(zo,oae);zo.prototype.createIterator=function(t,e,r){let i=this.db.db.transaction([t],"readonly"),s=i.objectStore(t).openCursor(e,r?"prev":"next");s.onsuccess=o=>{let a=o.target.result;a&&this.onItem(a)},this._transaction=i,i.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},i.oncomplete=()=>{this.onComplete()}};zo.prototype.onItem=function(t){this._cache.push(t.key,t.value),(this._limit<=0||++this._count<this._limit)&&t.continue(),this.maybeNext()};zo.prototype.onAbort=function(t){this._aborted=!0,this._error=t,this.maybeNext()};zo.prototype.onComplete=function(){this._completed=!0,this.maybeNext()};zo.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)};zo.prototype._next=function(t){if(this._aborted){let e=this._error;this._error=null,this._nextTick(t,e)}else if(this._cache.length>0){let e=this._cache.shift(),r=this._cache.shift();this._keys&&e!==void 0?e=this._deserializeKey(e,this._keyAsBuffer):e=void 0,this._values&&r!==void 0?r=this._deserializeValue(r,this._valueAsBuffer):r=void 0,this._nextTick(t,null,e,r)}else this._completed?this._nextTick(t):this._callback=t};zo.prototype._deserializeKey=aae;zo.prototype._deserializeValue=aae;zo.prototype._end=function(t){if(this._aborted||this._completed)return this._nextTick(t,this._error);this.onItem=ztt,this.onAbort=t,this.onComplete=t}});var hae=p((nqt,fae)=>{f();"use strict";var lae=ft().Buffer,Htt=function(){if(globalThis.TextEncoder){let t=new TextEncoder("utf-8");return t.encode.bind(t)}else return lae.from}();fae.exports=function(t,e){return e?lae.isBuffer(t)?t:Htt(String(t)):String(t)}});var dae=p(PE=>{f();"use strict";var $tt=ft().Buffer;PE.test=function(t){return function(r){try{return r.cmp(t,0),!0}catch(i){return!1}}};PE.bufferKeys=PE.test($tt.alloc(0))});var yae=p((oqt,pae)=>{f();"use strict";pae.exports=function(e,r,i,n,s){if(n.limit===0)return e._nextTick(s);let o=e.db.transaction([r],"readwrite"),a=o.objectStore(r),c=0;o.oncomplete=function(){s()},o.onabort=function(){s(o.error||new Error("aborted by user"))};let l=a.openKeyCursor?"openKeyCursor":"openCursor",u=n.reverse?"prev":"next";a[l](i,u).onsuccess=function(h){let d=h.target.result;d&&(a.delete(d.key).onsuccess=function(){(n.limit<=0||++c<n.limit)&&d.continue()})}}});var wae=p((aqt,vae)=>{f();"use strict";vae.exports=Ai;var gae=vl().AbstractLevelDOWN,Gtt=Xi(),Wtt=uae(),bae=hae(),u8=c8(),Ytt=dae(),Xtt=yae(),Qtt=a8(),mae="level-js-";function Ai(t,e){if(!(this instanceof Ai))return new Ai(t,e);if(gae.call(this,{bufferKeys:Ytt.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0}),e=e||{},typeof t!="string")throw new Error("constructor requires a location string argument");this.location=t,this.prefix=e.prefix==null?mae:e.prefix,this.version=parseInt(e.version||1,10)}Gtt(Ai,gae);Ai.prototype.type="level-js";Ai.prototype._open=function(t,e){let r=indexedDB.open(this.prefix+this.location,this.version);r.onerror=function(){e(r.error||new Error("unknown error"))},r.onsuccess=()=>{this.db=r.result,e()},r.onupgradeneeded=i=>{let n=i.target.result;n.objectStoreNames.contains(this.location)||n.createObjectStore(this.location)}};Ai.prototype.store=function(t){return this.db.transaction([this.location],t).objectStore(this.location)};Ai.prototype.await=function(t,e){let r=t.transaction;r.onabort=function(){e(r.error||new Error("aborted by user"))},r.oncomplete=function(){e(null,t.result)}};Ai.prototype._get=function(t,e,r){let i=this.store("readonly"),n;try{n=i.get(t)}catch(s){return this._nextTick(r,s)}this.await(n,function(s,o){if(s)return r(s);if(o===void 0)return r(new Error("NotFound"));r(null,u8(o,e.asBuffer))})};Ai.prototype._del=function(t,e,r){let i=this.store("readwrite"),n;try{n=i.delete(t)}catch(s){return this._nextTick(r,s)}this.await(n,r)};Ai.prototype._put=function(t,e,r,i){let n=this.store("readwrite"),s;try{s=n.put(e,t)}catch(o){return this._nextTick(i,o)}this.await(s,i)};Ai.prototype._serializeKey=function(t){return bae(t,this.supports.bufferKeys)};Ai.prototype._serializeValue=function(t){return bae(t,!0)};Ai.prototype._iterator=function(t){return new Wtt(this,this.location,t)};Ai.prototype._batch=function(t,e,r){if(t.length===0)return this._nextTick(r);let i=this.store("readwrite"),n=i.transaction,s=0,o;n.onabort=function(){r(o||n.error||new Error("aborted by user"))},n.oncomplete=function(){r()};function a(){let c=t[s++],l=c.key,u;try{u=c.type==="del"?i.delete(l):i.put(c.value,l)}catch(h){o=h,n.abort();return}s<t.length&&(u.onsuccess=a)}a()};Ai.prototype._clear=function(t,e){let r,i;try{r=Qtt(t)}catch(n){return this._nextTick(e)}if(t.limit>=0)return Xtt(this,this.location,r,t,e);try{let n=this.store("readwrite");i=r?n.delete(r):n.clear()}catch(n){return this._nextTick(e,n)}this.await(i,e)};Ai.prototype._close=function(t){this.db.close(),this._nextTick(t)};Ai.prototype.upgrade=function(t){if(this.status!=="open")return this._nextTick(t,new Error("cannot upgrade() before open()"));let e=this.iterator(),r={},i=this;e._deserializeKey=e._deserializeValue=a,n();function n(c){if(c)return o(c);e.next(s)}function s(c,l,u){if(c||l===void 0)return o(c);let h=i._serializeKey(u8(l,!0)),d=i._serializeValue(u8(u,!0));i._batch([{type:"del",key:l},{type:"put",key:h,value:d}],r,n)}function o(c){e.end(function(l){t(c||l)})}function a(c){return c}};Ai.destroy=function(t,e,r){typeof e=="function"&&(r=e,e=mae);let i=indexedDB.deleteDatabase(e+t);i.onsuccess=function(){r()},i.onerror=function(n){r(n)}}});var Eae=p((cqt,_ae)=>{f();_ae.exports=eae()(wae())});var Tae=p((uqt,Iae)=>{f();"use strict";var{Key:Ztt,Errors:_1,Adapter:Jtt,utils:{sortAll:Sae}}=Ft(),CE=ja(),ert=ko(),xae=ip(),Aae=class extends Jtt{constructor(e,r){super();this.path=e,this.opts=r,r&&r.db?(this.database=r.db,delete r.db):this.database=Eae()}_initDb(){return new Promise((e,r)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},i=>{if(i)return r(i);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw _1.dbOpenFailedError(e)}}async put(e,r){try{await this.db.put(e.toString(),r)}catch(i){throw _1.dbWriteFailedError(i)}}async get(e){let r;try{r=await this.db.get(e.toString())}catch(i){throw i.notFound?_1.notFoundError(i):_1.dbWriteFailedError(i)}return r}async has(e){try{await this.db.get(e.toString())}catch(r){if(r.notFound)return!1;throw r}return!0}async delete(e){try{await this.db.del(e.toString())}catch(r){throw _1.dbDeleteFailedError(r)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(r,i)=>{e.push({type:"put",key:r.toString(),value:i})},delete:r=>{e.push({type:"del",key:r.toString()})},commit:()=>this.db.batch(e)}}query(e){let r=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(r=e.filters.reduce((s,o)=>CE(s,o),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((s,o)=>Sae(s,o),r));let{offset:i,limit:n}=e;if(i){let s=0;r=CE(r,()=>s++>=i)}return n&&(r=xae(r,n)),r}queryKeys(e){let r=ert(this._query({values:!1,prefix:e.prefix}),({key:s})=>s);Array.isArray(e.filters)&&(r=e.filters.reduce((s,o)=>CE(s,o),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((s,o)=>Sae(s,o),r));let{offset:i,limit:n}=e;if(i){let s=0;r=CE(r,()=>s++>=i)}return n&&(r=xae(r,n)),r}_query(e){let r={keys:!0,keyAsBuffer:!0,values:e.values};if(e.prefix!=null){let i=e.prefix.toString();r.gte=i,r.lt=i+"\xFF"}return trt(this.db.iterator(r))}};function trt(t){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,r)=>{t.next((i,n,s)=>{if(i)return r(i);if(n==null)return t.end(o=>{if(o)return r(o);e({done:!0,value:void 0})});e({done:!1,value:{key:new Ztt(n,!1),value:s}})})}),return:()=>new Promise((e,r)=>{t.end(i=>{if(i)return r(i);e({done:!0,value:void 0})})})}}}}Iae.exports=Aae});var l8=p((lqt,kae)=>{f();"use strict";var Rae=Ka(),u0=ja(),Pae=ip(),rrt=rp(),Cae=(t,e)=>async function*(){yield*(await rrt(t)).sort(e)}(),Oae=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,i){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:i,value:n}of e)await this.put(i,n,r),yield{key:i,value:n}}async*getMany(e,r={}){for await(let i of e)yield this.get(i,r)}async*deleteMany(e,r={}){for await(let i of e)await this.delete(i,r),yield i}batch(){let e=[],r=[];return{put(i,n){e.push({key:i,value:n})},delete(i){r.push(i)},commit:async i=>{await Rae(this.putMany(e,i)),e=[],await Rae(this.deleteMany(r,i)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let i=this._all(e,r);if(e.prefix!=null&&(i=u0(i,n=>n.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>u0(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Cae(n,s),i)),e.offset!=null){let n=0;i=u0(i,()=>n++>=(e.offset||0))}return e.limit!=null&&(i=Pae(i,e.limit)),i}queryKeys(e,r){let i=this._allKeys(e,r);if(e.prefix!=null&&(i=u0(i,n=>n.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>u0(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Cae(n,s),i)),e.offset!=null){let n=0;i=u0(i,()=>n++>=e.offset)}return e.limit!=null&&(i=Pae(i,e.limit)),i}};kae.exports=Oae});var Bae=p((fqt,qae)=>{f();"use strict";var irt=ae();function nrt(t){return t=t||new Error("Not Found"),irt(t,"ERR_NOT_FOUND")}qae.exports={notFoundError:nrt}});var Fae=p((hqt,Uae)=>{f();"use strict";var srt=l8(),{base32:l0}=(an(),on),Nae=(Rs(),ns),{CID:Dae}=(Ae(),Ce),Mae=(An(),xn),ort=Bae(),Lae=class extends srt{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,r){this.data[l0.encode(e.multihash.bytes)]=r}async get(e){if(!await this.has(e))throw ort.notFoundError();return this.data[l0.encode(e.multihash.bytes)]}async has(e){return this.data[l0.encode(e.multihash.bytes)]!==void 0}async delete(e){delete this.data[l0.encode(e.multihash.bytes)]}async*_all(){yield*Object.entries(this.data).map(([e,r])=>({key:Dae.createV1(Nae.code,Mae.decode(l0.decode(e))),value:r}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>Dae.createV1(Nae.code,Mae.decode(l0.decode(e))))}};Uae.exports=Lae});var OE=p((dqt,Kae)=>{f();"use strict";var art=l8(),crt=Fae();Kae.exports={BlockstoreAdapter:art,MemoryBlockstore:crt}});var Wae=p((pqt,Gae)=>{f();"use strict";var jae=Ka(),Vae=za(),{Key:urt}=Ft(),{CID:zae}=(Ae(),Ce),lrt=(Rs(),ns),frt=(An(),xn),{base32:E1,base32pad:hrt}=(an(),on),{base58btc:Hae}=(si(),ni),drt=ae(),{BlockstoreAdapter:prt}=OE();function f0(t){if(!(t instanceof zae))throw drt(new Error("Not a valid cid"),"ERR_INVALID_CID");return new urt("/"+E1.encode(t.multihash.bytes).slice(1).toUpperCase(),!1)}function Al(t){return zae.createV1(lrt.code,frt.decode(E1.decode("b"+t.toString().slice(1).toLowerCase())))}function f8(t){let e,r=t.substring(0,1);return r==="/"?f8(t.substring(1)):(r.toLowerCase()==="b"?e=E1.decode(t.toLowerCase()).subarray(2):r.toLowerCase()==="c"?e=hrt.decode(t.toLowerCase()).subarray(2):r==="z"?e=Hae.decode(t).subarray(2):r==="Q"?e=Hae.decode("z"+t):e=E1.decode("b"+t.toLowerCase()).subarray(2),E1.encode(e).substring(1).toUpperCase()||"C")}function yrt(t){return{...t,prefix:t.prefix?`/${f8(t.prefix)}`:void 0,filters:t.filters?t.filters.map(e=>r=>e({key:Al(r.key),value:r.value})):void 0,orders:t.orders?t.orders.map(e=>(r,i)=>e({key:Al(r.key),value:r.value},{key:Al(i.key),value:i.value})):void 0}}function grt(t){return{...t,prefix:t.prefix?`/${f8(t.prefix)}`:void 0,filters:t.filters?t.filters.map(e=>r=>e(Al(r))):void 0,orders:t.orders?t.orders.map(e=>(r,i)=>e(Al(r),Al(i))):void 0}}var $ae=class extends prt{constructor(e){super();this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,r){for await(let{key:i,value:n}of this.child.query(yrt(e),r))yield{key:Al(i),value:n}}async*queryKeys(e,r){for await(let i of this.child.queryKeys(grt(e),r))yield Al(i)}async get(e,r){return this.child.get(f0(e),r)}async*getMany(e,r){for await(let i of e)yield this.get(i,r)}async put(e,r,i){await this.child.put(f0(e),r,i)}async*putMany(e,r){let i=Vae();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{let s=this.child;await jae(this.child.putMany(async function*(){for await(let o of e){let a=f0(o.key);await s.has(a,r)||(yield{key:a,value:o.value}),i.push(o)}}())),i.end()}catch(s){i.end(s)}}),yield*i}has(e,r){return this.child.has(f0(e),r)}delete(e,r){return this.child.delete(f0(e),r)}deleteMany(e,r){let i=Vae();return jae(this.child.deleteMany(async function*(){for await(let n of e)yield f0(n),i.push(n);i.end()}(),r)).catch(n=>{i.end(n)}),i}};Gae.exports=$ae});var Xae=p((yqt,Yae)=>{f();"use strict";var{createRepo:brt}=Of(),S1=Tae(),mrt=Wae();Yae.exports=(t,e,r)=>{let i=r.path||"ipfs";return brt(i,n=>e.getCodec(n),{root:new S1(i,{prefix:"",version:2}),blocks:new mrt(new S1(`${i}/blocks`,{prefix:"",version:2})),datastore:new S1(`${i}/datastore`,{prefix:"",version:2}),keys:new S1(`${i}/keys`,{prefix:"",version:2}),pins:new S1(`${i}/pins`,{prefix:"",version:2})},{autoMigrate:r.autoMigrate,onMigrationProgress:r.onMigrationProgress||t})}});var h8=p((gqt,ece)=>{f();"use strict";var Qae=()=>{},Zae=Symbol.for("@libp2p/js-interfaces/topology"),Jae=class{constructor({min:e=0,max:r=1/0,handlers:i={}}){this.min=e,this.max=r,this._onConnect=i.onConnect||Qae,this._onDisconnect=i.onDisconnect||Qae,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[Zae](){return!0}static isTopology(e){return Boolean(e&&e[Zae])}set registrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};ece.exports=Jae});var kE=p((bqt,ice)=>{f();"use strict";var vrt=h8(),tce=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),rce=class extends vrt{constructor({min:e,max:r,multicodecs:i,handlers:n}){super({min:e,max:r,handlers:n});if(!i)throw new Error("one or more multicodec should be provided");if(!n)throw new Error("the handlers should be provided");if(typeof n.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof n.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(i)?i:[i],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[tce](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[tce])}set registrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),this._updatePeers(this._registrar.peerStore.peers.values())}_updatePeers(e){for(let{id:r,protocols:i}of e)if(this.multicodecs.filter(n=>i.includes(n)).length){this.peers.add(r.toB58String());let n=this._registrar.getConnection(r);n&&this._onConnect(r,n)}else this.peers.delete(r.toB58String())}_onProtocolChange({peerId:e,protocols:r}){let i=this.peers.has(e.toB58String()),n=r.filter(s=>this.multicodecs.includes(s));i&&n.length===0&&this._onDisconnect(e);for(let s of r)if(this.multicodecs.includes(s)){let o=this._registrar.peerStore.get(e);this._updatePeers([o]);return}}_onPeerConnect(e){let r=e.remotePeer,i=this._registrar.peerStore.protoBook.get(r);!i||this.multicodecs.find(n=>i.includes(n))&&(this.peers.add(r.toB58String()),this._onConnect(r,e))}};ice.exports=rce});var qE=p(nce=>{f();"use strict";nce.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}});var p8=p((vqt,sce)=>{f();"use strict";var Il=Bi(),h0=Il.Reader,d8=Il.Writer,_t=Il.util,Ii=Il.roots["libp2p-pubsub-rpc"]||(Il.roots["libp2p-pubsub-rpc"]={});Ii.RPC=function(){function t(e){if(this.subscriptions=[],this.msgs=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.subscriptions=_t.emptyArray,t.prototype.msgs=_t.emptyArray,t.encode=function(r,i){if(i||(i=d8.create()),r.subscriptions!=null&&r.subscriptions.length)for(var n=0;n<r.subscriptions.length;++n)Ii.RPC.SubOpts.encode(r.subscriptions[n],i.uint32(10).fork()).ldelim();if(r.msgs!=null&&r.msgs.length)for(var n=0;n<r.msgs.length;++n)Ii.RPC.Message.encode(r.msgs[n],i.uint32(18).fork()).ldelim();return i},t.decode=function(r,i){r instanceof h0||(r=h0.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Ii.RPC;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(Ii.RPC.SubOpts.decode(r,r.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(Ii.RPC.Message.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Ii.RPC)return r;var i=new Ii.RPC;if(r.subscriptions){if(!Array.isArray(r.subscriptions))throw TypeError(".RPC.subscriptions: array expected");i.subscriptions=[];for(var n=0;n<r.subscriptions.length;++n){if(typeof r.subscriptions[n]!="object")throw TypeError(".RPC.subscriptions: object expected");i.subscriptions[n]=Ii.RPC.SubOpts.fromObject(r.subscriptions[n])}}if(r.msgs){if(!Array.isArray(r.msgs))throw TypeError(".RPC.msgs: array expected");i.msgs=[];for(var n=0;n<r.msgs.length;++n){if(typeof r.msgs[n]!="object")throw TypeError(".RPC.msgs: object expected");i.msgs[n]=Ii.RPC.Message.fromObject(r.msgs[n])}}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.subscriptions=[],n.msgs=[]),r.subscriptions&&r.subscriptions.length){n.subscriptions=[];for(var s=0;s<r.subscriptions.length;++s)n.subscriptions[s]=Ii.RPC.SubOpts.toObject(r.subscriptions[s],i)}if(r.msgs&&r.msgs.length){n.msgs=[];for(var s=0;s<r.msgs.length;++s)n.msgs[s]=Ii.RPC.Message.toObject(r.msgs[s],i)}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Il.util.toJSONOptions)},t.SubOpts=function(){function e(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.subscribe=null,e.prototype.topicID=null;var r;return Object.defineProperty(e.prototype,"_subscribe",{get:_t.oneOfGetter(r=["subscribe"]),set:_t.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_topicID",{get:_t.oneOfGetter(r=["topicID"]),set:_t.oneOfSetter(r)}),e.encode=function(n,s){return s||(s=d8.create()),n.subscribe!=null&&Object.hasOwnProperty.call(n,"subscribe")&&s.uint32(8).bool(n.subscribe),n.topicID!=null&&Object.hasOwnProperty.call(n,"topicID")&&s.uint32(18).string(n.topicID),s},e.decode=function(n,s){n instanceof h0||(n=h0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Ii.RPC.SubOpts;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.subscribe=n.bool();break;case 2:a.topicID=n.string();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof Ii.RPC.SubOpts)return n;var s=new Ii.RPC.SubOpts;return n.subscribe!=null&&(s.subscribe=Boolean(n.subscribe)),n.topicID!=null&&(s.topicID=String(n.topicID)),s},e.toObject=function(n,s){s||(s={});var o={};return n.subscribe!=null&&n.hasOwnProperty("subscribe")&&(o.subscribe=n.subscribe,s.oneofs&&(o._subscribe="subscribe")),n.topicID!=null&&n.hasOwnProperty("topicID")&&(o.topicID=n.topicID,s.oneofs&&(o._topicID="topicID")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Il.util.toJSONOptions)},e}(),t.Message=function(){function e(i){if(this.topicIDs=[],i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.from=null,e.prototype.data=null,e.prototype.seqno=null,e.prototype.topicIDs=_t.emptyArray,e.prototype.signature=null,e.prototype.key=null;var r;return Object.defineProperty(e.prototype,"_from",{get:_t.oneOfGetter(r=["from"]),set:_t.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_data",{get:_t.oneOfGetter(r=["data"]),set:_t.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_seqno",{get:_t.oneOfGetter(r=["seqno"]),set:_t.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_signature",{get:_t.oneOfGetter(r=["signature"]),set:_t.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_key",{get:_t.oneOfGetter(r=["key"]),set:_t.oneOfSetter(r)}),e.encode=function(n,s){if(s||(s=d8.create()),n.from!=null&&Object.hasOwnProperty.call(n,"from")&&s.uint32(10).bytes(n.from),n.data!=null&&Object.hasOwnProperty.call(n,"data")&&s.uint32(18).bytes(n.data),n.seqno!=null&&Object.hasOwnProperty.call(n,"seqno")&&s.uint32(26).bytes(n.seqno),n.topicIDs!=null&&n.topicIDs.length)for(var o=0;o<n.topicIDs.length;++o)s.uint32(34).string(n.topicIDs[o]);return n.signature!=null&&Object.hasOwnProperty.call(n,"signature")&&s.uint32(42).bytes(n.signature),n.key!=null&&Object.hasOwnProperty.call(n,"key")&&s.uint32(50).bytes(n.key),s},e.decode=function(n,s){n instanceof h0||(n=h0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Ii.RPC.Message;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.from=n.bytes();break;case 2:a.data=n.bytes();break;case 3:a.seqno=n.bytes();break;case 4:a.topicIDs&&a.topicIDs.length||(a.topicIDs=[]),a.topicIDs.push(n.string());break;case 5:a.signature=n.bytes();break;case 6:a.key=n.bytes();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof Ii.RPC.Message)return n;var s=new Ii.RPC.Message;if(n.from!=null&&(typeof n.from=="string"?_t.base64.decode(n.from,s.from=_t.newBuffer(_t.base64.length(n.from)),0):n.from.length&&(s.from=n.from)),n.data!=null&&(typeof n.data=="string"?_t.base64.decode(n.data,s.data=_t.newBuffer(_t.base64.length(n.data)),0):n.data.length&&(s.data=n.data)),n.seqno!=null&&(typeof n.seqno=="string"?_t.base64.decode(n.seqno,s.seqno=_t.newBuffer(_t.base64.length(n.seqno)),0):n.seqno.length&&(s.seqno=n.seqno)),n.topicIDs){if(!Array.isArray(n.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");s.topicIDs=[];for(var o=0;o<n.topicIDs.length;++o)s.topicIDs[o]=String(n.topicIDs[o])}return n.signature!=null&&(typeof n.signature=="string"?_t.base64.decode(n.signature,s.signature=_t.newBuffer(_t.base64.length(n.signature)),0):n.signature.length&&(s.signature=n.signature)),n.key!=null&&(typeof n.key=="string"?_t.base64.decode(n.key,s.key=_t.newBuffer(_t.base64.length(n.key)),0):n.key.length&&(s.key=n.key)),s},e.toObject=function(n,s){s||(s={});var o={};if((s.arrays||s.defaults)&&(o.topicIDs=[]),n.from!=null&&n.hasOwnProperty("from")&&(o.from=s.bytes===String?_t.base64.encode(n.from,0,n.from.length):s.bytes===Array?Array.prototype.slice.call(n.from):n.from,s.oneofs&&(o._from="from")),n.data!=null&&n.hasOwnProperty("data")&&(o.data=s.bytes===String?_t.base64.encode(n.data,0,n.data.length):s.bytes===Array?Array.prototype.slice.call(n.data):n.data,s.oneofs&&(o._data="data")),n.seqno!=null&&n.hasOwnProperty("seqno")&&(o.seqno=s.bytes===String?_t.base64.encode(n.seqno,0,n.seqno.length):s.bytes===Array?Array.prototype.slice.call(n.seqno):n.seqno,s.oneofs&&(o._seqno="seqno")),n.topicIDs&&n.topicIDs.length){o.topicIDs=[];for(var a=0;a<n.topicIDs.length;++a)o.topicIDs[a]=n.topicIDs[a]}return n.signature!=null&&n.hasOwnProperty("signature")&&(o.signature=s.bytes===String?_t.base64.encode(n.signature,0,n.signature.length):s.bytes===Array?Array.prototype.slice.call(n.signature):n.signature,s.oneofs&&(o._signature="signature")),n.key!=null&&n.hasOwnProperty("key")&&(o.key=s.bytes===String?_t.base64.encode(n.key,0,n.key.length):s.bytes===Array?Array.prototype.slice.call(n.key):n.key,s.oneofs&&(o._key="key")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Il.util.toJSONOptions)},e}(),t}();sce.exports=Ii});var y8=p((wqt,ace)=>{f();"use strict";var{Buffer:Ho}=ft(),oce=Symbol.for("BufferList");function fr(t){if(!(this instanceof fr))return new fr(t);fr._init.call(this,t)}fr._init=function(e){Object.defineProperty(this,oce,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};fr.prototype._new=function(e){return new fr(e)};fr.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};fr.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};fr.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};fr.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};fr.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Ho.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,l=s&&r||0,u=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Ho.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,l),l+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-u)return s?this._bufs[o[0]].copy(e,r,u,u+c):this._bufs[o[0]].slice(u,u+c);s||(e=Ho.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-u;if(c>d)this._bufs[h].copy(e,l,u),l+=d;else{this._bufs[h].copy(e,l,u,u+c),l+=d;break}c-=d,u&&(u=0)}return e.length>l?e.slice(0,l):e};fr.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};fr.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};fr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};fr.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};fr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Ho.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Ho.from(e));return this};fr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};fr.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Ho.from([t]):typeof t=="string"?t=Ho.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Ho.from(t.buffer,t.byteOffset,t.byteLength):Ho.isBuffer(t)||(t=Ho.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,t))return c;s++}s=0}return-1};fr.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?fr.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:fr.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();fr.prototype._isBufferList=function(e){return e instanceof fr||fr.isBufferList(e)};fr.isBufferList=function(e){return e!=null&&e[oce]};ace.exports=fr});var g8=p((_qt,lce)=>{f();"use strict";var cce=os(),{Buffer:wrt}=ft(),uce=(t,e,r)=>{let i=cce.encode(t,e,r);return uce.bytes=cce.encode.bytes,e||wrt.from(i)};lce.exports=uce});var gce=p((Eqt,BE)=>{f();"use strict";var{Buffer:fce}=ft(),hce=y8(),dce=g8(),b8=8,pce=10*1024;function yce(t){t=t||{};let e=Math.max(t.poolSize||pce,t.minPoolSize||b8),r=t.lengthEncoder||dce;return async function*(n){let s=fce.alloc(e),o=0;for await(let a of n){r(a.length,s,o);let c=s.slice(o,o+r.bytes);o+=r.bytes,s.length-o<b8&&(s=fce.alloc(e),o=0),yield new hce().append(c).append(a)}}}yce.single=(t,e)=>{e=e||{};let r=e.lengthEncoder||dce;return new hce([r(t.length),t.slice()])};BE.exports=yce;BE.exports.MIN_POOL_SIZE=b8;BE.exports.DEFAULT_POOL_SIZE=pce});var m8=p((Sqt,vce)=>{f();"use strict";var bce=os(),{Buffer:_rt}=ft(),Ert=t=>new Proxy({},{get:(e,r)=>r[0]==="l"?t[r]:t.get(parseInt(r))}),mce=t=>{let e=bce.decode(_rt.isBuffer(t)?t:Ert(t));return mce.bytes=bce.decode.bytes,e};vce.exports=mce});var Sce=p((xqt,NE)=>{f();"use strict";var{Buffer:Srt}=ft(),v8=y8(),xrt=m8(),wce=8,_ce=1024*1024*4,Ece=Srt.alloc(0),Tl={LENGTH:"readLength",DATA:"readData"},Art={[Tl.LENGTH]:(t,e,r,i)=>{e=e.append(t);let n;try{n=i.lengthDecoder(e)}catch(s){if(e.length>i.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:Tl.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(n>i.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return t=e.shallowSlice(i.lengthDecoder.bytes),e=new v8,i.onLength&&i.onLength(n),n<=0?(i.onData&&i.onData(Ece),{mode:Tl.LENGTH,chunk:t,buffer:e,data:Ece}):{mode:Tl.DATA,chunk:t,buffer:e,state:{dataLength:n},data:void 0}},[Tl.DATA]:(t,e,r,i)=>{if(e=e.append(t),!r)throw new Error("state is required");if(e.length<r.dataLength)return{mode:Tl.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:n}=r,s=e.shallowSlice(0,n),o=e.length>n?e.shallowSlice(n):void 0;return e=new v8,i.onData&&i.onData(s),{mode:Tl.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function w8(t){t=t||{};let e={lengthDecoder:t.lengthDecoder||xrt,maxLengthLength:t.maxLengthLength||wce,maxDataLength:t.maxDataLength||_ce,onLength:t.onLength,onData:t.onData};return async function*(i){let n=new v8,s=Tl.LENGTH,o;for await(let a of i){let c=a;for(;c;){let l=Art[s](c,n,o,e);s=l.mode,c=l.chunk,n=l.buffer,o=l.state,l.data&&(yield l.data)}}if(n.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}w8.fromReader=(t,e)=>{let r=1,i={[Symbol.asyncIterator](){return this},next:async()=>{try{return await t.next(r)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}};return w8({...e||{},onLength:s=>{r=s}})(i)};NE.exports=w8;NE.exports.MAX_LENGTH_LENGTH=wce;NE.exports.MAX_DATA_LENGTH=_ce});var Ice=p((Aqt,Ace)=>{f();"use strict";var{Buffer:Irt}=ft(),xce=(t,e,r)=>(e=e||Irt.allocUnsafe(4),e.writeInt32BE(t,r),e);xce.bytes=4;Ace.exports=xce});var Pce=p((Iqt,Rce)=>{f();"use strict";var Tce=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return t.readInt32BE(0)};Tce.bytes=4;Rce.exports=Tce});var $o=p(yh=>{f();"use strict";yh.encode=gce();yh.decode=Sce();yh.varintEncode=g8();yh.varintDecode=m8();yh.int32BEEncode=Ice();yh.int32BEDecode=Pce()});var DE=p((Rqt,Cce)=>{f();Cce.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var kce=p((Cqt,Oce)=>{f();Oce.exports=class extends Error{constructor(e,r){super(e||"The operation was aborted");this.type="aborted",this.code=r||"ABORT_ERR"}}});var ic=p((Oqt,gh)=>{f();var Trt=DE(),_8=kce(),qce=(t,e,r)=>E8(t,Array.isArray(e)?e:[{signal:e,options:r}]),E8=(t,e)=>{t=Trt(t),e=e.map(({signal:i,options:n})=>({signal:i,options:n||{}}));async function*r(){let i,n=()=>{i&&i()};for(let{signal:s}of e)s.addEventListener("abort",n);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:l,abortCode:u}=c;throw new _8(l,u)}let o=new Promise((a,c)=>{i=()=>{let{options:l}=e.find(({signal:d})=>d.aborted),{abortMessage:u,abortCode:h}=l;c(new _8(u,h))}});s=await Promise.race([o,t.next()]),i=null}catch(o){for(let{signal:l}of e)l.removeEventListener("abort",n);let a=e.find(({signal:l})=>l.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(t),typeof t.return=="function"&&await t.return(),c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",n)}return r()},Bce=(t,e,r)=>Nce(t,Array.isArray(e)?e:[{signal:e,options:r}]),Nce=(t,e)=>r=>t(E8(r,e)),Rrt=(t,e,r)=>Prt(t,Array.isArray(e)?e:[{signal:e,options:r}]),Prt=(t,e)=>({sink:Nce(t.sink,e),source:E8(t.source,e)});gh.exports=qce;gh.exports.AbortError=_8;gh.exports.source=qce;gh.exports.sink=Bce;gh.exports.transform=Bce;gh.exports.duplex=Rrt});var Kce=p((kqt,Fce)=>{f();"use strict";var Dce=me(),Crt=Object.assign(Dce("libp2p-pubsub:peer-streams"),{error:Dce("libp2p-pubsub:peer-streams:err")}),{EventEmitter:Ort}=vr(),Mce=$o(),krt=za(),{pipe:Lce}=Pr(),{source:qrt}=ic(),Brt=Ql().default,Uce=class extends Ort{constructor({id:e,protocol:r}){super();this.id=e,this.protocol=r,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new Brt,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let r=this.id.toB58String();throw new Error("No writable connection to "+r)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=qrt(Lce(this._rawInboundStream,Mce.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let r=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=krt({onEnd:i=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,i&&this.emit("close")}}),Lce(this.outboundStream,Mce.encode(),this._rawOutboundStream).catch(i=>{Crt.error(i)}),r||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};Fce.exports=Uce});var Vce=p(jce=>{f();"use strict";var Nrt={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};jce.SignaturePolicy=Nrt});var S8=p((Bqt,$ce)=>{f();"use strict";var Drt=fg(),Mrt=Je(),zce=ct(),Hce=et(),{sha256:Lrt}=(ai(),$r),Urt=()=>Drt(8),Frt=(t,e)=>{let r;t instanceof Uint8Array?r=Hce.createFromBytes(t).id:r=Hce.parse(t).id;let i=new Uint8Array(r.length+e.length);return i.set(r,0),i.set(e,r.length),i},Krt=t=>Lrt.encode(t),jrt=(t,e)=>{let r;Array.isArray(e)?r=i=>e.indexOf(i)>-1:r=i=>e.has(i);for(let i of t)if(r(i))return!0;return!1},Vrt=t=>Array.isArray(t)?t:[t],zrt=(t,e)=>{let r=Object.assign({},t);return t.from instanceof Uint8Array&&(r.from=Mrt(t.from,"base58btc")),e&&(r.receivedFrom=e),r},Hrt=t=>{let e=Object.assign({},t);return typeof t.from=="string"&&(e.from=zce(t.from,"base58btc")),typeof t.data=="string"&&(e.data=zce(t.data)),e};$ce.exports={randomSeqno:Urt,msgId:Frt,noSignMsgId:Krt,anyMatch:jrt,ensureArray:Vrt,normalizeInRpcMessage:zrt,normalizeOutRpcMessage:Hrt}});var Qce=p((Nqt,Xce)=>{f();"use strict";var x8=et(),{RPC:Gce}=p8(),Wce=un(),$rt=ct(),A8=$rt("libp2p-pubsub:"),{normalizeOutRpcMessage:Grt}=S8();async function Wrt(t,e){let r=Wce([A8,Gce.Message.encode(Grt(e)).finish()]),i=await t.privKey.sign(r);return{...e,signature:i,key:t.pubKey.bytes}}async function Yrt(t){if(!t.signature)throw new Error("Message must contain a signature to be verified");if(!t.from)throw new Error("Message must contain a from property to be verified");let e=Wce([A8,Gce.Message.encode({...t,from:x8.createFromB58String(t.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await Yce(t)).verify(e,t.signature)}async function Yce(t){if(!t.from)throw new Error("Could not get the public key from the originator id");let e=x8.createFromB58String(t.from);if(t.key){let r=await x8.createFromPubKey(t.key);if(r.equals(e))return r.pubKey;throw new Error("Public Key does not match the originator")}else{if(e.pubKey)return e.pubKey;throw new Error("Could not get the public key from the originator id")}}Xce.exports={messagePublicKey:Yce,signMessage:Wrt,SignPrefix:A8,verifySignature:Yrt}});var tue=p((Dqt,eue)=>{f();"use strict";var Zce=me(),{EventEmitter:Xrt}=vr(),Zn=ae(),{pipe:Qrt}=Pr(),Zrt=kE(),{codes:Go}=qE(),{RPC:Jce}=p8(),Jrt=Kce(),{SignaturePolicy:eu}=Vce(),Rl=S8(),{signMessage:eit,verifySignature:tit}=Qce(),ME=class extends Xrt{constructor({debugName:e,multicodecs:r,libp2p:i,globalSignaturePolicy:n=eu.StrictSign,canRelayMessage:s=!1,emitSelf:o=!1}){if(typeof e!="string")throw new Error("a debugname `string` is required");if(!r)throw new Error("multicodecs are required");if(!i)throw new Error("libp2p is required");super();if(this.log=Object.assign(Zce(e),{err:Zce(`${e}:error`)}),this.multicodecs=Rl.ensureArray(r),this._libp2p=i,this.registrar=i.registrar,this.peerId=i.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!eu[n])throw Zn(new Error("Invalid global signature policy"),Go.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=n,this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);let e=new Zrt({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=this.registrar.register(e),this.log("started"),this.started=!0}stop(){!this.started||(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:r,connection:i}){let n=i.remotePeer,s=n.toB58String(),o=this._addPeer(n,e),a=o.attachInboundStream(r);this._processMessages(s,a,o)}async _onPeerConnected(e,r){let i=e.toB58String();this.log("connected",i);try{let{stream:n,protocol:s}=await r.newStream(this.multicodecs);await this._addPeer(e,s).attachOutboundStream(n)}catch(n){this.log.err(n)}this._sendSubscriptions(i,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,r){let i=e.toB58String();this.log("connection ended",i,r?r.message:""),this._removePeer(e)}_addPeer(e,r){let i=e.toB58String(),n=this.peers.get(i);if(n)return n;this.log("new peer",i);let s=new Jrt({id:e,protocol:r});return this.peers.set(i,s),s.once("close",()=>this._removePeer(e)),s}_removePeer(e){if(!e)return;let r=e.toB58String(),i=this.peers.get(r);if(!!i){i.removeAllListeners(),i.close(),this.log("delete peer",r),this.peers.delete(r);for(let n of this.topics.values())n.delete(r);return i}}async _processMessages(e,r,i){try{await Qrt(r,async n=>{for await(let s of n){let o=s instanceof Uint8Array?s:s.slice(),a=this._decodeRpc(o);await this._processRpc(e,i,a)}})}catch(n){this._onPeerDisconnected(i.id,n)}}async _processRpc(e,r,i){this.log("rpc from",e);let n=i.subscriptions,s=i.msgs;if(n.length&&(n.forEach(o=>{this._processRpcSubOpt(e,o)}),this.emit("pubsub:subscription-change",r.id,n)),!this._acceptFrom(e))return this.log("received message from unacceptable peer %s",e),!1;if(s.length)for(let o of s){if(!(this.canRelayMessage||o.topicIDs&&o.topicIDs.some(c=>this.subscriptions.has(c)))){this.log("received message we didn't subscribe to. Dropping.");continue}let a=Rl.normalizeInRpcMessage(o,e);await this._processRpcMessage(a)}return!0}_processRpcSubOpt(e,r){let i=r.topicID;if(!i)return;let n=this.topics.get(i);n||(n=new Set,this.topics.set(i,n)),r.subscribe?n.add(e):n.delete(e)}async _processRpcMessage(e){if(!(this.peerId.toB58String()===e.from&&!this.emitSelf)){try{await this.validate(e)}catch(r){this.log("Message is invalid, dropping it. %O",r);return}return this._emitMessage(e),this._publish(Rl.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(r=>{this.subscriptions.has(r)&&this.emit(r,e)})}getMsgId(e){let r=this.globalSignaturePolicy;switch(r){case eu.StrictSign:return Rl.msgId(e.from,e.seqno);case eu.StrictNoSign:return Rl.noSignMsgId(e.data);default:throw Zn(new Error("Cannot get message id: unhandled signature policy: "+r),Go.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return Jce.decode(e)}_encodeRpc(e){return Jce.encode(e).finish()}_sendRpc(e,r){let i=this.peers.get(e);if(!i||!i.isWritable){let n=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(n);return}i.write(this._encodeRpc(r))}_sendSubscriptions(e,r,i){return this._sendRpc(e,{subscriptions:r.map(n=>({topicID:n,subscribe:i}))})}async validate(e){let r=this.globalSignaturePolicy;switch(r){case eu.StrictNoSign:if(e.from)throw Zn(new Error("StrictNoSigning: from should not be present"),Go.ERR_UNEXPECTED_FROM);if(e.signature)throw Zn(new Error("StrictNoSigning: signature should not be present"),Go.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw Zn(new Error("StrictNoSigning: key should not be present"),Go.ERR_UNEXPECTED_KEY);if(e.seqno)throw Zn(new Error("StrictNoSigning: seqno should not be present"),Go.ERR_UNEXPECTED_SEQNO);break;case eu.StrictSign:if(!e.signature)throw Zn(new Error("StrictSigning: Signing required and no signature was present"),Go.ERR_MISSING_SIGNATURE);if(!e.seqno)throw Zn(new Error("StrictSigning: Signing required and no seqno was present"),Go.ERR_MISSING_SEQNO);if(!await tit(e))throw Zn(new Error("StrictSigning: Invalid message signature"),Go.ERR_INVALID_SIGNATURE);break;default:throw Zn(new Error("Cannot validate message: unhandled signature policy: "+r),Go.ERR_UNHANDLED_SIGNATURE_POLICY)}for(let i of e.topicIDs){let n=this.topicValidators.get(i);n&&await n(i,e)}}_buildMessage(e){let r=this.globalSignaturePolicy;switch(r){case eu.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=Rl.randomSeqno(),eit(this.peerId,e);case eu.StrictNoSign:return Promise.resolve(e);default:throw Zn(new Error("Cannot build message: unhandled signature policy: "+r),Go.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw Zn(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||typeof e!="string")throw Zn(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");let r=this.topics.get(e);return r?Array.from(r):[]}async publish(e,r){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,r);let n={receivedFrom:this.peerId.toB58String(),data:r,topicIDs:[e]},s=await this._buildMessage(n),o=Rl.normalizeInRpcMessage(s);this.emitSelf&&this._emitMessage(o),await this._publish(o)}_publish(e){throw Zn(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((r,i)=>this._sendSubscriptions(i,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&this.listenerCount(e)===0&&(this.subscriptions.delete(e),this.peers.forEach((r,i)=>this._sendSubscriptions(i,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}};ME.utils=Rl;ME.SignaturePolicy=eu;eue.exports=ME});var rue=p(LE=>{f();"use strict";Object.defineProperty(LE,"__esModule",{value:!0});LE.createGossipRpc=void 0;function rit(t=[],e={}){return{subscriptions:[],msgs:t,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},e)}}LE.createGossipRpc=rit});var iue=p(UE=>{f();"use strict";Object.defineProperty(UE,"__esModule",{value:!0});UE.shuffle=void 0;function iit(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let i=e(),n=t[r];t[r]=t[i],t[i]=n}return t}UE.shuffle=iit});var bh=p(Pe=>{f();"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.ERR_TOPIC_VALIDATOR_IGNORE=Pe.ERR_TOPIC_VALIDATOR_REJECT=Pe.TimeCacheDuration=Pe.GossipsubIWantFollowupTime=Pe.GossipsubMaxIHaveMessages=Pe.GossipsubMaxIHaveLength=Pe.GossipsubGraftFloodThreshold=Pe.GossipsubOpportunisticGraftPeers=Pe.GossipsubOpportunisticGraftTicks=Pe.GossipsubDirectConnectInitialDelay=Pe.GossipsubDirectConnectTicks=Pe.GossipsubConnectionTimeout=Pe.GossipsubMaxPendingConnections=Pe.GossipsubConnectors=Pe.GossipsubPruneBackoffTicks=Pe.GossipsubPruneBackoff=Pe.GossipsubPrunePeers=Pe.GossipsubFanoutTTL=Pe.GossipsubHeartbeatInterval=Pe.GossipsubHeartbeatInitialDelay=Pe.GossipsubGossipRetransmission=Pe.GossipsubGossipFactor=Pe.GossipsubDlazy=Pe.GossipsubHistoryGossip=Pe.GossipsubHistoryLength=Pe.GossipsubDout=Pe.GossipsubDscore=Pe.GossipsubDhi=Pe.GossipsubDlo=Pe.GossipsubD=Pe.GossipsubIDv11=Pe.GossipsubIDv10=Pe.FloodsubID=Pe.minute=Pe.second=void 0;Pe.second=1e3;Pe.minute=60*Pe.second;Pe.FloodsubID="/floodsub/1.0.0";Pe.GossipsubIDv10="/meshsub/1.0.0";Pe.GossipsubIDv11="/meshsub/1.1.0";Pe.GossipsubD=6;Pe.GossipsubDlo=4;Pe.GossipsubDhi=12;Pe.GossipsubDscore=4;Pe.GossipsubDout=2;Pe.GossipsubHistoryLength=5;Pe.GossipsubHistoryGossip=3;Pe.GossipsubDlazy=6;Pe.GossipsubGossipFactor=.25;Pe.GossipsubGossipRetransmission=3;Pe.GossipsubHeartbeatInitialDelay=100;Pe.GossipsubHeartbeatInterval=Pe.second;Pe.GossipsubFanoutTTL=Pe.minute;Pe.GossipsubPrunePeers=16;Pe.GossipsubPruneBackoff=Pe.minute;Pe.GossipsubPruneBackoffTicks=15;Pe.GossipsubConnectors=8;Pe.GossipsubMaxPendingConnections=128;Pe.GossipsubConnectionTimeout=30*Pe.second;Pe.GossipsubDirectConnectTicks=300;Pe.GossipsubDirectConnectInitialDelay=Pe.second;Pe.GossipsubOpportunisticGraftTicks=60;Pe.GossipsubOpportunisticGraftPeers=2;Pe.GossipsubGraftFloodThreshold=10*Pe.second;Pe.GossipsubMaxIHaveLength=5e3;Pe.GossipsubMaxIHaveMessages=10;Pe.GossipsubIWantFollowupTime=3*Pe.second;Pe.TimeCacheDuration=120*1e3;Pe.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";Pe.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE"});var sue=p(FE=>{f();"use strict";Object.defineProperty(FE,"__esModule",{value:!0});FE.hasGossipProtocol=void 0;var nue=bh();function nit(t){return t===nue.GossipsubIDv10||t===nue.GossipsubIDv11}FE.hasGossipProtocol=nit});var oue=p(KE=>{f();"use strict";Object.defineProperty(KE,"__esModule",{value:!0});KE.messageIdToString=void 0;var sit=Je();function oit(t){return sit(t,"base64")}KE.messageIdToString=oit});var mh=p(nc=>{f();"use strict";var ait=nc&&nc.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),jE=nc&&nc.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&ait(e,t,r)};Object.defineProperty(nc,"__esModule",{value:!0});jE(rue(),nc);jE(iue(),nc);jE(sue(),nc);jE(oue(),nc)});var cue=p(zE=>{f();"use strict";Object.defineProperty(zE,"__esModule",{value:!0});zE.MessageCache=void 0;var VE=mh(),aue=class{constructor(e,r,i){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let n=0;n<r;n++)this.history[n]=[];this.gossip=e,this.msgIdFn=i}put(e){let r=this.getMsgId(e),i=VE.messageIdToString(r);this.msgs.set(i,e),this.history[0].push({msgID:r,topics:e.topicIDs})}getMsgId(e){return this.msgIdFn(e)}get(e){return this.msgs.get(VE.messageIdToString(e))}getForPeer(e,r){let i=VE.messageIdToString(e),n=this.msgs.get(i);if(!n)return[void 0,0];let s=this.peertx.get(i);s||(s=new Map,this.peertx.set(i,s));let o=(s.get(r)||0)+1;return s.set(r,o),[n,o]}getGossipIDs(e){let r=[];for(let i=0;i<this.gossip;i++)this.history[i].forEach(n=>{for(let s of n.topics)if(s===e){r.push(n.msgID);break}});return r}shift(){this.history[this.history.length-1].forEach(r=>{let i=VE.messageIdToString(r.msgID);this.msgs.delete(i),this.peertx.delete(i)}),this.history.pop(),this.history.unshift([])}};zE.MessageCache=aue});var lue=p((uue,x1)=>{f();(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof aa=="function"&&typeof x1=="object"&&x1&&x1.exports&&(x1.exports=e(Bi()))})(uue,function(t){"use strict";var e=t.Reader,r=t.Writer,i=t.util,n=t.roots.default||(t.roots.default={});return n.RPC=function(){function s(a){if(this.subscriptions=[],this.msgs=[],a)for(var c=Object.keys(a),l=0;l<c.length;++l)a[c[l]]!=null&&(this[c[l]]=a[c[l]])}s.prototype.subscriptions=i.emptyArray,s.prototype.msgs=i.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:i.oneOfGetter(o=["control"]),set:i.oneOfSetter(o)}),s.encode=function(c,l){if(l||(l=r.create()),c.subscriptions!=null&&c.subscriptions.length)for(var u=0;u<c.subscriptions.length;++u)n.RPC.SubOpts.encode(c.subscriptions[u],l.uint32(10).fork()).ldelim();if(c.msgs!=null&&c.msgs.length)for(var u=0;u<c.msgs.length;++u)n.RPC.Message.encode(c.msgs[u],l.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&n.RPC.ControlMessage.encode(c.control,l.uint32(26).fork()).ldelim(),l},s.decode=function(c,l){c instanceof e||(c=e.create(c));for(var u=l===void 0?c.len:c.pos+l,h=new n.RPC;c.pos<u;){var d=c.uint32();switch(d>>>3){case 1:h.subscriptions&&h.subscriptions.length||(h.subscriptions=[]),h.subscriptions.push(n.RPC.SubOpts.decode(c,c.uint32()));break;case 2:h.msgs&&h.msgs.length||(h.msgs=[]),h.msgs.push(n.RPC.Message.decode(c,c.uint32()));break;case 3:h.control=n.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(d&7);break}}return h},s.fromObject=function(c){if(c instanceof n.RPC)return c;var l=new n.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");l.subscriptions=[];for(var u=0;u<c.subscriptions.length;++u){if(typeof c.subscriptions[u]!="object")throw TypeError(".RPC.subscriptions: object expected");l.subscriptions[u]=n.RPC.SubOpts.fromObject(c.subscriptions[u])}}if(c.msgs){if(!Array.isArray(c.msgs))throw TypeError(".RPC.msgs: array expected");l.msgs=[];for(var u=0;u<c.msgs.length;++u){if(typeof c.msgs[u]!="object")throw TypeError(".RPC.msgs: object expected");l.msgs[u]=n.RPC.Message.fromObject(c.msgs[u])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");l.control=n.RPC.ControlMessage.fromObject(c.control)}return l},s.toObject=function(c,l){l||(l={});var u={};if((l.arrays||l.defaults)&&(u.subscriptions=[],u.msgs=[]),c.subscriptions&&c.subscriptions.length){u.subscriptions=[];for(var h=0;h<c.subscriptions.length;++h)u.subscriptions[h]=n.RPC.SubOpts.toObject(c.subscriptions[h],l)}if(c.msgs&&c.msgs.length){u.msgs=[];for(var h=0;h<c.msgs.length;++h)u.msgs[h]=n.RPC.Message.toObject(c.msgs[h],l)}return c.control!=null&&c.hasOwnProperty("control")&&(u.control=n.RPC.ControlMessage.toObject(c.control,l),l.oneofs&&(u._control="control")),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s.SubOpts=function(){function a(l){if(l)for(var u=Object.keys(l),h=0;h<u.length;++h)l[u[h]]!=null&&(this[u[h]]=l[u[h]])}a.prototype.subscribe=null,a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_subscribe",{get:i.oneOfGetter(c=["subscribe"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(u,h){return h||(h=r.create()),u.subscribe!=null&&Object.hasOwnProperty.call(u,"subscribe")&&h.uint32(8).bool(u.subscribe),u.topicID!=null&&Object.hasOwnProperty.call(u,"topicID")&&h.uint32(18).string(u.topicID),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var d=h===void 0?u.len:u.pos+h,y=new n.RPC.SubOpts;u.pos<d;){var g=u.uint32();switch(g>>>3){case 1:y.subscribe=u.bool();break;case 2:y.topicID=u.string();break;default:u.skipType(g&7);break}}return y},a.fromObject=function(u){if(u instanceof n.RPC.SubOpts)return u;var h=new n.RPC.SubOpts;return u.subscribe!=null&&(h.subscribe=Boolean(u.subscribe)),u.topicID!=null&&(h.topicID=String(u.topicID)),h},a.toObject=function(u,h){h||(h={});var d={};return u.subscribe!=null&&u.hasOwnProperty("subscribe")&&(d.subscribe=u.subscribe,h.oneofs&&(d._subscribe="subscribe")),u.topicID!=null&&u.hasOwnProperty("topicID")&&(d.topicID=u.topicID,h.oneofs&&(d._topicID="topicID")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.Message=function(){function a(l){if(this.topicIDs=[],l)for(var u=Object.keys(l),h=0;h<u.length;++h)l[u[h]]!=null&&(this[u[h]]=l[u[h]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topicIDs=i.emptyArray,a.prototype.signature=null,a.prototype.key=null;var c;return Object.defineProperty(a.prototype,"_from",{get:i.oneOfGetter(c=["from"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_data",{get:i.oneOfGetter(c=["data"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_seqno",{get:i.oneOfGetter(c=["seqno"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signature",{get:i.oneOfGetter(c=["signature"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_key",{get:i.oneOfGetter(c=["key"]),set:i.oneOfSetter(c)}),a.encode=function(u,h){if(h||(h=r.create()),u.from!=null&&Object.hasOwnProperty.call(u,"from")&&h.uint32(10).bytes(u.from),u.data!=null&&Object.hasOwnProperty.call(u,"data")&&h.uint32(18).bytes(u.data),u.seqno!=null&&Object.hasOwnProperty.call(u,"seqno")&&h.uint32(26).bytes(u.seqno),u.topicIDs!=null&&u.topicIDs.length)for(var d=0;d<u.topicIDs.length;++d)h.uint32(34).string(u.topicIDs[d]);return u.signature!=null&&Object.hasOwnProperty.call(u,"signature")&&h.uint32(42).bytes(u.signature),u.key!=null&&Object.hasOwnProperty.call(u,"key")&&h.uint32(50).bytes(u.key),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var d=h===void 0?u.len:u.pos+h,y=new n.RPC.Message;u.pos<d;){var g=u.uint32();switch(g>>>3){case 1:y.from=u.bytes();break;case 2:y.data=u.bytes();break;case 3:y.seqno=u.bytes();break;case 4:y.topicIDs&&y.topicIDs.length||(y.topicIDs=[]),y.topicIDs.push(u.string());break;case 5:y.signature=u.bytes();break;case 6:y.key=u.bytes();break;default:u.skipType(g&7);break}}return y},a.fromObject=function(u){if(u instanceof n.RPC.Message)return u;var h=new n.RPC.Message;if(u.from!=null&&(typeof u.from=="string"?i.base64.decode(u.from,h.from=i.newBuffer(i.base64.length(u.from)),0):u.from.length&&(h.from=u.from)),u.data!=null&&(typeof u.data=="string"?i.base64.decode(u.data,h.data=i.newBuffer(i.base64.length(u.data)),0):u.data.length&&(h.data=u.data)),u.seqno!=null&&(typeof u.seqno=="string"?i.base64.decode(u.seqno,h.seqno=i.newBuffer(i.base64.length(u.seqno)),0):u.seqno.length&&(h.seqno=u.seqno)),u.topicIDs){if(!Array.isArray(u.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");h.topicIDs=[];for(var d=0;d<u.topicIDs.length;++d)h.topicIDs[d]=String(u.topicIDs[d])}return u.signature!=null&&(typeof u.signature=="string"?i.base64.decode(u.signature,h.signature=i.newBuffer(i.base64.length(u.signature)),0):u.signature.length&&(h.signature=u.signature)),u.key!=null&&(typeof u.key=="string"?i.base64.decode(u.key,h.key=i.newBuffer(i.base64.length(u.key)),0):u.key.length&&(h.key=u.key)),h},a.toObject=function(u,h){h||(h={});var d={};if((h.arrays||h.defaults)&&(d.topicIDs=[]),u.from!=null&&u.hasOwnProperty("from")&&(d.from=h.bytes===String?i.base64.encode(u.from,0,u.from.length):h.bytes===Array?Array.prototype.slice.call(u.from):u.from,h.oneofs&&(d._from="from")),u.data!=null&&u.hasOwnProperty("data")&&(d.data=h.bytes===String?i.base64.encode(u.data,0,u.data.length):h.bytes===Array?Array.prototype.slice.call(u.data):u.data,h.oneofs&&(d._data="data")),u.seqno!=null&&u.hasOwnProperty("seqno")&&(d.seqno=h.bytes===String?i.base64.encode(u.seqno,0,u.seqno.length):h.bytes===Array?Array.prototype.slice.call(u.seqno):u.seqno,h.oneofs&&(d._seqno="seqno")),u.topicIDs&&u.topicIDs.length){d.topicIDs=[];for(var y=0;y<u.topicIDs.length;++y)d.topicIDs[y]=u.topicIDs[y]}return u.signature!=null&&u.hasOwnProperty("signature")&&(d.signature=h.bytes===String?i.base64.encode(u.signature,0,u.signature.length):h.bytes===Array?Array.prototype.slice.call(u.signature):u.signature,h.oneofs&&(d._signature="signature")),u.key!=null&&u.hasOwnProperty("key")&&(d.key=h.bytes===String?i.base64.encode(u.key,0,u.key.length):h.bytes===Array?Array.prototype.slice.call(u.key):u.key,h.oneofs&&(d._key="key")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlMessage=function(){function a(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var l=Object.keys(c),u=0;u<l.length;++u)c[l[u]]!=null&&(this[l[u]]=c[l[u]])}return a.prototype.ihave=i.emptyArray,a.prototype.iwant=i.emptyArray,a.prototype.graft=i.emptyArray,a.prototype.prune=i.emptyArray,a.encode=function(l,u){if(u||(u=r.create()),l.ihave!=null&&l.ihave.length)for(var h=0;h<l.ihave.length;++h)n.RPC.ControlIHave.encode(l.ihave[h],u.uint32(10).fork()).ldelim();if(l.iwant!=null&&l.iwant.length)for(var h=0;h<l.iwant.length;++h)n.RPC.ControlIWant.encode(l.iwant[h],u.uint32(18).fork()).ldelim();if(l.graft!=null&&l.graft.length)for(var h=0;h<l.graft.length;++h)n.RPC.ControlGraft.encode(l.graft[h],u.uint32(26).fork()).ldelim();if(l.prune!=null&&l.prune.length)for(var h=0;h<l.prune.length;++h)n.RPC.ControlPrune.encode(l.prune[h],u.uint32(34).fork()).ldelim();return u},a.decode=function(l,u){l instanceof e||(l=e.create(l));for(var h=u===void 0?l.len:l.pos+u,d=new n.RPC.ControlMessage;l.pos<h;){var y=l.uint32();switch(y>>>3){case 1:d.ihave&&d.ihave.length||(d.ihave=[]),d.ihave.push(n.RPC.ControlIHave.decode(l,l.uint32()));break;case 2:d.iwant&&d.iwant.length||(d.iwant=[]),d.iwant.push(n.RPC.ControlIWant.decode(l,l.uint32()));break;case 3:d.graft&&d.graft.length||(d.graft=[]),d.graft.push(n.RPC.ControlGraft.decode(l,l.uint32()));break;case 4:d.prune&&d.prune.length||(d.prune=[]),d.prune.push(n.RPC.ControlPrune.decode(l,l.uint32()));break;default:l.skipType(y&7);break}}return d},a.fromObject=function(l){if(l instanceof n.RPC.ControlMessage)return l;var u=new n.RPC.ControlMessage;if(l.ihave){if(!Array.isArray(l.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");u.ihave=[];for(var h=0;h<l.ihave.length;++h){if(typeof l.ihave[h]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");u.ihave[h]=n.RPC.ControlIHave.fromObject(l.ihave[h])}}if(l.iwant){if(!Array.isArray(l.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");u.iwant=[];for(var h=0;h<l.iwant.length;++h){if(typeof l.iwant[h]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");u.iwant[h]=n.RPC.ControlIWant.fromObject(l.iwant[h])}}if(l.graft){if(!Array.isArray(l.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");u.graft=[];for(var h=0;h<l.graft.length;++h){if(typeof l.graft[h]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");u.graft[h]=n.RPC.ControlGraft.fromObject(l.graft[h])}}if(l.prune){if(!Array.isArray(l.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");u.prune=[];for(var h=0;h<l.prune.length;++h){if(typeof l.prune[h]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");u.prune[h]=n.RPC.ControlPrune.fromObject(l.prune[h])}}return u},a.toObject=function(l,u){u||(u={});var h={};if((u.arrays||u.defaults)&&(h.ihave=[],h.iwant=[],h.graft=[],h.prune=[]),l.ihave&&l.ihave.length){h.ihave=[];for(var d=0;d<l.ihave.length;++d)h.ihave[d]=n.RPC.ControlIHave.toObject(l.ihave[d],u)}if(l.iwant&&l.iwant.length){h.iwant=[];for(var d=0;d<l.iwant.length;++d)h.iwant[d]=n.RPC.ControlIWant.toObject(l.iwant[d],u)}if(l.graft&&l.graft.length){h.graft=[];for(var d=0;d<l.graft.length;++d)h.graft[d]=n.RPC.ControlGraft.toObject(l.graft[d],u)}if(l.prune&&l.prune.length){h.prune=[];for(var d=0;d<l.prune.length;++d)h.prune[d]=n.RPC.ControlPrune.toObject(l.prune[d],u)}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIHave=function(){function a(l){if(this.messageIDs=[],l)for(var u=Object.keys(l),h=0;h<u.length;++h)l[u[h]]!=null&&(this[u[h]]=l[u[h]])}a.prototype.topicID=null,a.prototype.messageIDs=i.emptyArray;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(u,h){if(h||(h=r.create()),u.topicID!=null&&Object.hasOwnProperty.call(u,"topicID")&&h.uint32(10).string(u.topicID),u.messageIDs!=null&&u.messageIDs.length)for(var d=0;d<u.messageIDs.length;++d)h.uint32(18).bytes(u.messageIDs[d]);return h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var d=h===void 0?u.len:u.pos+h,y=new n.RPC.ControlIHave;u.pos<d;){var g=u.uint32();switch(g>>>3){case 1:y.topicID=u.string();break;case 2:y.messageIDs&&y.messageIDs.length||(y.messageIDs=[]),y.messageIDs.push(u.bytes());break;default:u.skipType(g&7);break}}return y},a.fromObject=function(u){if(u instanceof n.RPC.ControlIHave)return u;var h=new n.RPC.ControlIHave;if(u.topicID!=null&&(h.topicID=String(u.topicID)),u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");h.messageIDs=[];for(var d=0;d<u.messageIDs.length;++d)typeof u.messageIDs[d]=="string"?i.base64.decode(u.messageIDs[d],h.messageIDs[d]=i.newBuffer(i.base64.length(u.messageIDs[d])),0):u.messageIDs[d].length&&(h.messageIDs[d]=u.messageIDs[d])}return h},a.toObject=function(u,h){h||(h={});var d={};if((h.arrays||h.defaults)&&(d.messageIDs=[]),u.topicID!=null&&u.hasOwnProperty("topicID")&&(d.topicID=u.topicID,h.oneofs&&(d._topicID="topicID")),u.messageIDs&&u.messageIDs.length){d.messageIDs=[];for(var y=0;y<u.messageIDs.length;++y)d.messageIDs[y]=h.bytes===String?i.base64.encode(u.messageIDs[y],0,u.messageIDs[y].length):h.bytes===Array?Array.prototype.slice.call(u.messageIDs[y]):u.messageIDs[y]}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIWant=function(){function a(c){if(this.messageIDs=[],c)for(var l=Object.keys(c),u=0;u<l.length;++u)c[l[u]]!=null&&(this[l[u]]=c[l[u]])}return a.prototype.messageIDs=i.emptyArray,a.encode=function(l,u){if(u||(u=r.create()),l.messageIDs!=null&&l.messageIDs.length)for(var h=0;h<l.messageIDs.length;++h)u.uint32(10).bytes(l.messageIDs[h]);return u},a.decode=function(l,u){l instanceof e||(l=e.create(l));for(var h=u===void 0?l.len:l.pos+u,d=new n.RPC.ControlIWant;l.pos<h;){var y=l.uint32();switch(y>>>3){case 1:d.messageIDs&&d.messageIDs.length||(d.messageIDs=[]),d.messageIDs.push(l.bytes());break;default:l.skipType(y&7);break}}return d},a.fromObject=function(l){if(l instanceof n.RPC.ControlIWant)return l;var u=new n.RPC.ControlIWant;if(l.messageIDs){if(!Array.isArray(l.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");u.messageIDs=[];for(var h=0;h<l.messageIDs.length;++h)typeof l.messageIDs[h]=="string"?i.base64.decode(l.messageIDs[h],u.messageIDs[h]=i.newBuffer(i.base64.length(l.messageIDs[h])),0):l.messageIDs[h].length&&(u.messageIDs[h]=l.messageIDs[h])}return u},a.toObject=function(l,u){u||(u={});var h={};if((u.arrays||u.defaults)&&(h.messageIDs=[]),l.messageIDs&&l.messageIDs.length){h.messageIDs=[];for(var d=0;d<l.messageIDs.length;++d)h.messageIDs[d]=u.bytes===String?i.base64.encode(l.messageIDs[d],0,l.messageIDs[d].length):u.bytes===Array?Array.prototype.slice.call(l.messageIDs[d]):l.messageIDs[d]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlGraft=function(){function a(l){if(l)for(var u=Object.keys(l),h=0;h<u.length;++h)l[u[h]]!=null&&(this[u[h]]=l[u[h]])}a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(u,h){return h||(h=r.create()),u.topicID!=null&&Object.hasOwnProperty.call(u,"topicID")&&h.uint32(10).string(u.topicID),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var d=h===void 0?u.len:u.pos+h,y=new n.RPC.ControlGraft;u.pos<d;){var g=u.uint32();switch(g>>>3){case 1:y.topicID=u.string();break;default:u.skipType(g&7);break}}return y},a.fromObject=function(u){if(u instanceof n.RPC.ControlGraft)return u;var h=new n.RPC.ControlGraft;return u.topicID!=null&&(h.topicID=String(u.topicID)),h},a.toObject=function(u,h){h||(h={});var d={};return u.topicID!=null&&u.hasOwnProperty("topicID")&&(d.topicID=u.topicID,h.oneofs&&(d._topicID="topicID")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlPrune=function(){function a(l){if(this.peers=[],l)for(var u=Object.keys(l),h=0;h<u.length;++h)l[u[h]]!=null&&(this[u[h]]=l[u[h]])}a.prototype.topicID=null,a.prototype.peers=i.emptyArray,a.prototype.backoff=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_backoff",{get:i.oneOfGetter(c=["backoff"]),set:i.oneOfSetter(c)}),a.encode=function(u,h){if(h||(h=r.create()),u.topicID!=null&&Object.hasOwnProperty.call(u,"topicID")&&h.uint32(10).string(u.topicID),u.peers!=null&&u.peers.length)for(var d=0;d<u.peers.length;++d)n.RPC.PeerInfo.encode(u.peers[d],h.uint32(18).fork()).ldelim();return u.backoff!=null&&Object.hasOwnProperty.call(u,"backoff")&&h.uint32(24).uint64(u.backoff),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var d=h===void 0?u.len:u.pos+h,y=new n.RPC.ControlPrune;u.pos<d;){var g=u.uint32();switch(g>>>3){case 1:y.topicID=u.string();break;case 2:y.peers&&y.peers.length||(y.peers=[]),y.peers.push(n.RPC.PeerInfo.decode(u,u.uint32()));break;case 3:y.backoff=u.uint64();break;default:u.skipType(g&7);break}}return y},a.fromObject=function(u){if(u instanceof n.RPC.ControlPrune)return u;var h=new n.RPC.ControlPrune;if(u.topicID!=null&&(h.topicID=String(u.topicID)),u.peers){if(!Array.isArray(u.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");h.peers=[];for(var d=0;d<u.peers.length;++d){if(typeof u.peers[d]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");h.peers[d]=n.RPC.PeerInfo.fromObject(u.peers[d])}}return u.backoff!=null&&(i.Long?(h.backoff=i.Long.fromValue(u.backoff)).unsigned=!0:typeof u.backoff=="string"?h.backoff=parseInt(u.backoff,10):typeof u.backoff=="number"?h.backoff=u.backoff:typeof u.backoff=="object"&&(h.backoff=new i.LongBits(u.backoff.low>>>0,u.backoff.high>>>0).toNumber(!0))),h},a.toObject=function(u,h){h||(h={});var d={};if((h.arrays||h.defaults)&&(d.peers=[]),u.topicID!=null&&u.hasOwnProperty("topicID")&&(d.topicID=u.topicID,h.oneofs&&(d._topicID="topicID")),u.peers&&u.peers.length){d.peers=[];for(var y=0;y<u.peers.length;++y)d.peers[y]=n.RPC.PeerInfo.toObject(u.peers[y],h)}return u.backoff!=null&&u.hasOwnProperty("backoff")&&(typeof u.backoff=="number"?d.backoff=h.longs===String?String(u.backoff):u.backoff:d.backoff=h.longs===String?i.Long.prototype.toString.call(u.backoff):h.longs===Number?new i.LongBits(u.backoff.low>>>0,u.backoff.high>>>0).toNumber(!0):u.backoff,h.oneofs&&(d._backoff="backoff")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.PeerInfo=function(){function a(l){if(l)for(var u=Object.keys(l),h=0;h<u.length;++h)l[u[h]]!=null&&(this[u[h]]=l[u[h]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var c;return Object.defineProperty(a.prototype,"_peerID",{get:i.oneOfGetter(c=["peerID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:i.oneOfGetter(c=["signedPeerRecord"]),set:i.oneOfSetter(c)}),a.encode=function(u,h){return h||(h=r.create()),u.peerID!=null&&Object.hasOwnProperty.call(u,"peerID")&&h.uint32(10).bytes(u.peerID),u.signedPeerRecord!=null&&Object.hasOwnProperty.call(u,"signedPeerRecord")&&h.uint32(18).bytes(u.signedPeerRecord),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var d=h===void 0?u.len:u.pos+h,y=new n.RPC.PeerInfo;u.pos<d;){var g=u.uint32();switch(g>>>3){case 1:y.peerID=u.bytes();break;case 2:y.signedPeerRecord=u.bytes();break;default:u.skipType(g&7);break}}return y},a.fromObject=function(u){if(u instanceof n.RPC.PeerInfo)return u;var h=new n.RPC.PeerInfo;return u.peerID!=null&&(typeof u.peerID=="string"?i.base64.decode(u.peerID,h.peerID=i.newBuffer(i.base64.length(u.peerID)),0):u.peerID.length&&(h.peerID=u.peerID)),u.signedPeerRecord!=null&&(typeof u.signedPeerRecord=="string"?i.base64.decode(u.signedPeerRecord,h.signedPeerRecord=i.newBuffer(i.base64.length(u.signedPeerRecord)),0):u.signedPeerRecord.length&&(h.signedPeerRecord=u.signedPeerRecord)),h},a.toObject=function(u,h){h||(h={});var d={};return u.peerID!=null&&u.hasOwnProperty("peerID")&&(d.peerID=h.bytes===String?i.base64.encode(u.peerID,0,u.peerID.length):h.bytes===Array?Array.prototype.slice.call(u.peerID):u.peerID,h.oneofs&&(d._peerID="peerID")),u.signedPeerRecord!=null&&u.hasOwnProperty("signedPeerRecord")&&(d.signedPeerRecord=h.bytes===String?i.base64.encode(u.signedPeerRecord,0,u.signedPeerRecord.length):h.bytes===Array?Array.prototype.slice.call(u.signedPeerRecord):u.signedPeerRecord,h.oneofs&&(d._signedPeerRecord="signedPeerRecord")),d},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s}(),n})});var I8=p(HE=>{f();"use strict";Object.defineProperty(HE,"__esModule",{value:!0});HE.getGossipPeers=void 0;var fue=mh();function cit(t,e,r,i=()=>!0){let n=t.topics.get(e);if(!n)return new Set;let s=[];return n.forEach(o=>{let a=t.peers.get(o);!a||fue.hasGossipProtocol(a.protocol)&&i(o)&&s.push(o)}),s=fue.shuffle(s),r>0&&s.length>r&&(s=s.slice(0,r)),new Set(s)}HE.getGossipPeers=cit});var due=p(sc=>{f();"use strict";var uit=sc&&sc.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),lit=sc&&sc.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),fit=sc&&sc.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&uit(e,t,r);return lit(e,t),e};Object.defineProperty(sc,"__esModule",{value:!0});sc.Heartbeat=void 0;var A1=fit(bh()),$E=I8(),hit=mh(),hue=class{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;let e=this._heartbeat.bind(this),r=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,A1.GossipsubHeartbeatInterval)},A1.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(i,n)=>{this._heartbeatTimer._intervalId=setInterval(i,n)},cancel:()=>{clearTimeout(r),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){!this._heartbeatTimer||(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){let{D:e,Dlo:r,Dhi:i,Dscore:n,Dout:s}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;let o=new Map,a=d=>{let y=o.get(d);return y===void 0&&(y=this.gossipsub.score.score(d),o.set(d,y)),y},c=new Map,l=new Map,u=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((d,y)=>{let g=E=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",E,y),this.gossipsub.score.prune(E,y),this.gossipsub._addBackoff(E,y),d.delete(E);let v=l.get(E);v?v.push(y):l.set(E,[y])},m=E=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",E,y),this.gossipsub.score.graft(E,y),d.add(E);let v=c.get(E);v?v.push(y):c.set(E,[y])};if(d.forEach(E=>{let v=a(E);v<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",E,v,y),g(E),u.set(E,!0))}),d.size<r){let E=this.gossipsub.backoff.get(y),v=e-d.size;$E.getGossipPeers(this.gossipsub,y,v,R=>!d.has(R)&&!this.gossipsub.direct.has(R)&&(!E||!E.has(R))&&a(R)>=0).forEach(m)}if(d.size>i){let E=Array.from(d);E.sort((A,R)=>a(R)-a(A)),E=E.slice(0,n).concat(hit.shuffle(E.slice(n)));let v=0;if(E.slice(0,e).forEach(A=>{this.gossipsub.outbound.get(A)&&v++}),v<s){let A=F=>{let q=E[F];for(let B=F;B>0;B--)E[B]=E[B-1];E[0]=q};if(v>0){let F=v;for(let q=1;q<e&&F>0;q++)this.gossipsub.outbound.get(E[q])&&(A(q),F--)}let R=e-v;for(let F=e;F<E.length&&R>0;F++)this.gossipsub.outbound.get(E[F])&&(A(F),R--)}E.slice(e).forEach(g)}if(d.size>=r){let E=0;if(d.forEach(v=>{this.gossipsub.outbound.get(v)&&E++}),E<s){let v=s-E,A=this.gossipsub.backoff.get(y);$E.getGossipPeers(this.gossipsub,y,v,R=>!d.has(R)&&!this.gossipsub.direct.has(R)&&(!A||!A.has(R))&&a(R)>=0).forEach(m)}}if(this.gossipsub.heartbeatTicks%A1.GossipsubOpportunisticGraftTicks==0&&d.size>1){let E=Array.from(d).sort((R,F)=>a(R)-a(F)),v=d.size/2,A=a(E[v]);if(A<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){let R=this.gossipsub.backoff.get(y);$E.getGossipPeers(this.gossipsub,y,A1.GossipsubOpportunisticGraftPeers,q=>d.has(q)&&!this.gossipsub.direct.has(q)&&(!R||!R.has(q))&&a(q)>A).forEach(q=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",q,y),m(q)})}}this.gossipsub._emitGossip(y,d)});let h=this.gossipsub._now();this.gossipsub.lastpub.forEach((d,y)=>{d+A1.GossipsubFanoutTTL<h&&(this.gossipsub.fanout.delete(y),this.gossipsub.lastpub.delete(y))}),this.gossipsub.fanout.forEach((d,y)=>{let g=this.gossipsub.topics.get(y);if(d.forEach(m=>{(!g.has(m)||a(m)<this.gossipsub._options.scoreThresholds.publishThreshold)&&d.delete(m)}),d.size<e){let m=e-d.size;$E.getGossipPeers(this.gossipsub,y,m,v=>!d.has(v)&&!this.gossipsub.direct.has(v)&&a(v)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(v=>{d.add(v)})}this.gossipsub._emitGossip(y,d)}),this.gossipsub._sendGraftPrune(c,l,u),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}};sc.Heartbeat=hue});var T8=p(d0=>{f();"use strict";Object.defineProperty(d0,"__esModule",{value:!0});d0.ERR_INVALID_PEER_SCORE_THRESHOLDS=d0.ERR_INVALID_PEER_SCORE_PARAMS=void 0;d0.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";d0.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var R8=p(mn=>{f();"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.validateTopicScoreParams=mn.validatePeerScoreParams=mn.createTopicScoreParams=mn.createPeerScoreParams=mn.defaultTopicScoreParams=mn.defaultPeerScoreParams=void 0;var Zt=T8(),Jt=ae();mn.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};mn.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function dit(t={}){return Object.assign(Object.assign(Object.assign({},mn.defaultPeerScoreParams),t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,i])=>(e[r]=pue(i),e),{}):{}})}mn.createPeerScoreParams=dit;function pue(t={}){return Object.assign(Object.assign({},mn.defaultTopicScoreParams),t)}mn.createTopicScoreParams=pue;function pit(t){for(let[e,r]of Object.entries(t.topics))try{yue(r)}catch(i){throw Jt(new Error(`invalid score parameters for topic ${e}: ${i.message}`),Zt.ERR_INVALID_PEER_SCORE_PARAMS)}if(t.topicScoreCap<0)throw Jt(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw Jt(new Error("missing application specific score function"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight>0)throw Jt(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw Jt(new Error("invalid IPColocationFactorThreshold; must be at least 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight>0)throw Jt(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw Jt(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayInterval<1e3)throw Jt(new Error("invalid DecayInterval; must be at least 1s"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayToZero<=0||t.decayToZero>=1)throw Jt(new Error("invalid DecayToZero; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS)}mn.validatePeerScoreParams=pit;function yue(t){if(t.topicWeight<0)throw Jt(new Error("invalid topic weight; must be >= 0"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshQuantum===0)throw Jt(new Error("invalid TimeInMeshQuantum; must be non zero"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight<0)throw Jt(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw Jt(new Error("invalid TimeInMeshQuantum; must be positive"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw Jt(new Error("invalid TimeInMeshCap; must be positive"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight<0)throw Jt(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw Jt(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw Jt(new Error("invalid FirstMessageDeliveriesCap; must be positive"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight>0)throw Jt(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw Jt(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw Jt(new Error("invalid MeshMessageDeliveriesCap; must be positive"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw Jt(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWindow<0)throw Jt(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw Jt(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight>0)throw Jt(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw Jt(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesWeight>0)throw Jt(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw Jt(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS)}mn.validateTopicScoreParams=yue});var gue=p(tu=>{f();"use strict";Object.defineProperty(tu,"__esModule",{value:!0});tu.validatePeerScoreThresholds=tu.createPeerScoreThresholds=tu.defaultPeerScoreThresholds=void 0;var I1=T8(),T1=ae();tu.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function yit(t={}){return Object.assign(Object.assign({},tu.defaultPeerScoreThresholds),t)}tu.createPeerScoreThresholds=yit;function git(t){if(t.gossipThreshold>0)throw T1(new Error("invalid gossip threshold; it must be <= 0"),I1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.publishThreshold>0||t.publishThreshold>t.gossipThreshold)throw T1(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),I1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.graylistThreshold>0||t.graylistThreshold>t.publishThreshold)throw T1(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),I1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.acceptPXThreshold<0)throw T1(new Error("invalid accept PX threshold; it must be >= 0"),I1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.opportunisticGraftThreshold<0)throw T1(new Error("invalid opportunistic grafting threshold; it must be >= 0"),I1.ERR_INVALID_PEER_SCORE_THRESHOLDS)}tu.validatePeerScoreThresholds=git});var bue=p(Pl=>{f();"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});Pl.ensureTopicStats=Pl.createTopicStats=Pl.createPeerStats=void 0;function bit(t={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,i])=>(e[r]=P8(i),e),{}):{}})}Pl.createPeerStats=bit;function P8(t={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},t)}Pl.createTopicStats=P8;function mit(t,e,r){let i=e.topics[t];if(i)return i;if(!!r.topics[t])return e.topics[t]=i=P8(),i}Pl.ensureTopicStats=mit});var mue=p(GE=>{f();"use strict";Object.defineProperty(GE,"__esModule",{value:!0});GE.computeScore=void 0;function vit(t,e,r,i){let n=0;return Object.entries(e.topics).forEach(([a,c])=>{let l=r.topics[a];if(!l)return;let u=0;if(c.inMesh){let g=c.meshTime/l.timeInMeshQuantum;g>l.timeInMeshCap&&(g=l.timeInMeshCap),u+=g*l.timeInMeshWeight}if(u+=c.firstMessageDeliveries*l.firstMessageDeliveriesWeight,c.meshMessageDeliveriesActive&&c.meshMessageDeliveries<l.meshMessageDeliveriesThreshold){let g=l.meshMessageDeliveriesThreshold-c.meshMessageDeliveries;u+=g*g*l.meshMessageDeliveriesWeight}u+=c.meshFailurePenalty*l.meshFailurePenaltyWeight,u+=c.invalidMessageDeliveries*c.invalidMessageDeliveries*l.invalidMessageDeliveriesWeight,n+=u*l.topicWeight}),r.topicScoreCap>0&&n>r.topicScoreCap&&(n=r.topicScoreCap),n+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(a=>{if(r.IPColocationFactorWhitelist.has(a))return;let c=i.get(a),l=c?c.size:0;if(l>r.IPColocationFactorThreshold){let u=l-r.IPColocationFactorThreshold;n+=u*u*r.IPColocationFactorWeight}}),n+=e.behaviourPenalty*e.behaviourPenalty*r.behaviourPenaltyWeight,n}GE.computeScore=vit});var wue=p((Qqt,vue)=>{f();"use strict";function Yr(t,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}Yr.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var i=this.size();if(!(r>=i||r<-i))return r<0&&(r+=i),r=this._head+r&this._capacityMask,this._list[r]}};Yr.prototype.get=function(e){return this.peekAt(e)};Yr.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};Yr.prototype.peekFront=function(){return this.peek()};Yr.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(Yr.prototype,"length",{get:function(){return this.size()}});Yr.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Yr.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Yr.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};Yr.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Yr.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),i}};Yr.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var i=this.size(),n=this._list.length;if(!(r>=i||r<-i)){r<0&&(r+=i),r=this._head+r&this._capacityMask;var s=this._list[r],o;if(e<i/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+n&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=i-1-e;o>0;o--)this._list[r]=this._list[r=r+1+n&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}};Yr.prototype.remove=function(e,r){var i=e,n,s=r;if(i===(i|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(i>=o||i<-o||r<1)){if(i<0&&(i+=o),r===1||!r)return n=new Array(1),n[0]=this.removeOne(i),n;if(i===0&&i+r>=o)return n=this.toArray(),this.clear(),n;i+r>o&&(r=o-i);var c;for(n=new Array(r),c=0;c<r;c++)n[c]=this._list[this._head+i+c&this._capacityMask];if(i=this._head+i&this._capacityMask,e+r===o){for(this._tail=this._tail-r+a&this._capacityMask,c=r;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+r+a&this._capacityMask,c=r-1;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(i<o/2){for(this._head=this._head+e+r+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[i=i-1+a&this._capacityMask]);for(i=this._head-1+a&this._capacityMask;s>0;)this._list[i=i-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+r+a&this._capacityMask,c=o-(r+e);c>0;c--)this.push(this._list[i++]);for(i=this._tail;s>0;)this._list[i=i+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),n}}};Yr.prototype.splice=function(e,r){var i=e;if(i===(i|0)){var n=this.size();if(i<0&&(i+=n),!(i>n))if(arguments.length>2){var s,o,a,c=arguments.length,l=this._list.length,u=2;if(!n||i<n/2){for(o=new Array(i),s=0;s<i;s++)o[s]=this._list[this._head+s&this._capacityMask];for(r===0?(a=[],i>0&&(this._head=this._head+i+l&this._capacityMask)):(a=this.remove(i,r),this._head=this._head+i+l&this._capacityMask);c>u;)this.unshift(arguments[--c]);for(s=i;s>0;s--)this.unshift(o[s-1])}else{o=new Array(n-(i+r));var h=o.length;for(s=0;s<h;s++)o[s]=this._list[this._head+i+r+s&this._capacityMask];for(r===0?(a=[],i!=n&&(this._tail=this._head+i+l&this._capacityMask)):(a=this.remove(i,r),this._tail=this._tail-h+l&this._capacityMask);u<c;)this.push(arguments[u++]);for(s=0;s<h;s++)this.push(o[s])}return a}else return this.remove(i,r)}};Yr.prototype.clear=function(){this._head=0,this._tail=0};Yr.prototype.isEmpty=function(){return this._head===this._tail};Yr.prototype.toArray=function(){return this._copyArray(!1)};Yr.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};Yr.prototype._copyArray=function(e){var r=[],i=this._list,n=i.length,s;if(e||this._head>this._tail){for(s=this._head;s<n;s++)r.push(i[s]);for(s=0;s<this._tail;s++)r.push(i[s])}else for(s=this._head;s<this._tail;s++)r.push(i[s]);return r};Yr.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length*=2,this._capacityMask=this._capacityMask<<1|1};Yr.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};vue.exports=Yr});var Sue=p(ru=>{f();"use strict";var wit=ru&&ru.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ru,"__esModule",{value:!0});ru.MessageDeliveries=ru.DeliveryRecordStatus=void 0;var _it=bh(),Eit=wit(wue()),Sit=mh(),_ue;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(_ue=ru.DeliveryRecordStatus||(ru.DeliveryRecordStatus={}));var Eue=class{constructor(){this.records=new Map,this.queue=new Eit.default}ensureRecord(e){let r=Sit.messageIdToString(e),i=this.records.get(r);if(i)return i;i={status:_ue.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(r,i);let n={msgId:r,expire:Date.now()+_it.TimeCacheDuration};return this.queue.push(n),i}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};ru.MessageDeliveries=Eue});var Aue=p(g0=>{f();"use strict";var xit=g0&&g0.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(g0,"__esModule",{value:!0});g0.PeerScore=void 0;var Ait=R8(),p0=bue(),Iit=mue(),Wo=Sue(),Tit=bh(),Rit=xit(et()),Pit=me(),Cit=qE(),{ERR_INVALID_SIGNATURE:Oit,ERR_MISSING_SIGNATURE:kit}=Cit.codes,y0=Pit("libp2p:gossipsub:score"),xue=class{constructor(e,r,i){Ait.validatePeerScoreParams(e),this.params=e,this._connectionManager=r,this.peerStats=new Map,this.peerIPs=new Map,this.deliveryRecords=new Wo.MessageDeliveries,this.msgId=i}start(){if(this._backgroundInterval){y0("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),y0("started")}stop(){if(!this._backgroundInterval){y0("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),y0("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((i,n)=>{if(!i.connected){e>i.expire&&(this._removeIPs(n,i.ips),this.peerStats.delete(n));return}Object.entries(i.topics).forEach(([s,o])=>{let a=this.params.topics[s];!a||(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),i.behaviourPenalty*=this.params.behaviourPenaltyDecay,i.behaviourPenalty<r&&(i.behaviourPenalty=0)})}score(e){let r=this.peerStats.get(e);return r?Iit.computeScore(e,r,this.params,this.peerIPs):0}addPenalty(e,r){let i=this.peerStats.get(e);!i||(i.behaviourPenalty+=r)}addPeer(e){let r=p0.createPeerStats({connected:!0});this.peerStats.set(e,r);let i=this._getIPs(e);this._setIPs(e,i,r.ips),r.ips=i}removePeer(e){let r=this.peerStats.get(e);if(!!r){if(this.score(e)>0){this._removeIPs(e,r.ips),this.peerStats.delete(e);return}Object.entries(r.topics).forEach(([i,n])=>{n.firstMessageDeliveries=0;let s=this.params.topics[i].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let i=this.peerStats.get(e);if(!i)return;let n=p0.ensureTopicStats(r,i,this.params);!n||(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1)}prune(e,r){let i=this.peerStats.get(e);if(!i)return;let n=p0.ensureTopicStats(r,i,this.params);if(!n)return;let s=this.params.topics[r].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}validateMessage(e){this.deliveryRecords.ensureRecord(this.msgId(e))}deliverMessage(e){let r=e.receivedFrom;this._markFirstMessageDelivery(r,e);let i=this.deliveryRecords.ensureRecord(this.msgId(e)),n=Date.now();if(i.status!==Wo.DeliveryRecordStatus.unknown){y0("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",r,n-i.firstSeen,Wo.DeliveryRecordStatus[i.status]);return}i.status=Wo.DeliveryRecordStatus.valid,i.validated=n,i.peers.forEach(s=>{s!==r&&this._markDuplicateMessageDelivery(s,e)})}rejectMessage(e,r){let i=e.receivedFrom;switch(r){case kit:case Oit:this._markInvalidMessageDelivery(i,e);return}let n=this.deliveryRecords.ensureRecord(this.msgId(e));if(n.status!==Wo.DeliveryRecordStatus.unknown){y0("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",i,Date.now()-n.firstSeen,Wo.DeliveryRecordStatus[n.status]);return}switch(r){case Tit.ERR_TOPIC_VALIDATOR_IGNORE:n.status=Wo.DeliveryRecordStatus.ignored;return}n.status=Wo.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(i,e),n.peers.forEach(s=>{this._markInvalidMessageDelivery(s,e)})}duplicateMessage(e){let r=e.receivedFrom,i=this.deliveryRecords.ensureRecord(this.msgId(e));if(!i.peers.has(r))switch(i.status){case Wo.DeliveryRecordStatus.unknown:i.peers.add(r);break;case Wo.DeliveryRecordStatus.valid:i.peers.add(r),this._markDuplicateMessageDelivery(r,e,i.validated);break;case Wo.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(r,e);break}}_markInvalidMessageDelivery(e,r){let i=this.peerStats.get(e);!i||r.topicIDs.forEach(n=>{let s=p0.ensureTopicStats(n,i,this.params);!s||(s.invalidMessageDeliveries+=1)})}_markFirstMessageDelivery(e,r){let i=this.peerStats.get(e);!i||r.topicIDs.forEach(n=>{let s=p0.ensureTopicStats(n,i,this.params);if(!s)return;let o=this.params.topics[n].firstMessageDeliveriesCap;s.firstMessageDeliveries+=1,s.firstMessageDeliveries>o&&(s.firstMessageDeliveries=o),!!s.inMesh&&(o=this.params.topics[n].meshMessageDeliveriesCap,s.meshMessageDeliveries+=1,s.meshMessageDeliveries>o&&(s.meshMessageDeliveries=o))})}_markDuplicateMessageDelivery(e,r,i=0){let n=this.peerStats.get(e);if(!n)return;let s=i?Date.now():0;r.topicIDs.forEach(o=>{let a=p0.ensureTopicStats(o,n,this.params);if(!a||!a.inMesh)return;let c=this.params.topics[o];if(i&&s>i+c.meshMessageDeliveriesWindow)return;let l=c.meshMessageDeliveriesCap;a.meshMessageDeliveries+=1,a.meshMessageDeliveries>l&&(a.meshMessageDeliveries=l)})}_getIPs(e){return this._connectionManager.getAll(Rit.default.createFromB58String(e)).map(r=>r.remoteAddr.toOptions().host)}_setIPs(e,r,i){e:for(let n of r){for(let o of i)if(n===o)continue e;let s=this.peerIPs.get(n);s||(s=new Set,this.peerIPs.set(n,s)),s.add(e)}e:for(let n of i){for(let o of r)if(n===o)continue e;let s=this.peerIPs.get(n);!s||(s.delete(e),s.size||this.peerIPs.delete(n))}}_removeIPs(e,r){r.forEach(i=>{let n=this.peerIPs.get(i);!n||(n.delete(e),n.size||this.peerIPs.delete(i))})}_updateIPs(){this.peerStats.forEach((e,r)=>{let i=this._getIPs(r);this._setIPs(r,i,e.ips),e.ips=i})}};g0.PeerScore=xue});var Iue=p(iu=>{f();"use strict";var qit=iu&&iu.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),C8=iu&&iu.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&qit(e,t,r)};Object.defineProperty(iu,"__esModule",{value:!0});C8(R8(),iu);C8(gue(),iu);C8(Aue(),iu)});var Rue=p(WE=>{f();"use strict";Object.defineProperty(WE,"__esModule",{value:!0});WE.IWantTracer=void 0;var Bit=bh(),O8=mh(),Nit=qE(),{ERR_INVALID_SIGNATURE:Dit,ERR_MISSING_SIGNATURE:Mit}=Nit.codes,Tue=class{constructor(e){this.getMsgId=e,this.promises=new Map}addPromise(e,r){let i=Math.floor(Math.random()*r.length),n=r[i],s=O8.messageIdToString(n),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o)),o.has(e)||o.set(e,Date.now()+Bit.GossipsubIWantFollowupTime)}getBrokenPromises(){let e=Date.now(),r=new Map;return this.promises.forEach((i,n)=>{i.forEach((s,o)=>{s<e&&(r.set(o,(r.get(o)||0)+1),i.delete(o))}),i.size||this.promises.delete(n)}),r}deliverMessage(e){let r=this.getMsgId(e),i=O8.messageIdToString(r);this.promises.delete(i)}rejectMessage(e,r){switch(r){case Dit:case Mit:return}let i=this.getMsgId(e),n=O8.messageIdToString(i);this.promises.delete(n)}clear(){this.promises.clear()}};WE.IWantTracer=Tue});var que=p((rBt,kue)=>{f();var Pue="Expected a function",Cue=0/0,Lit="[object Symbol]",Uit=/^\s+|\s+$/g,Fit=/^[-+]0x[0-9a-f]+$/i,Kit=/^0b[01]+$/i,jit=/^0o[0-7]+$/i,Vit=parseInt,zit=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,Hit=typeof self=="object"&&self&&self.Object===Object&&self,$it=zit||Hit||Function("return this")(),Git=Object.prototype,Wit=Git.toString,Yit=Math.max,Xit=Math.min,k8=function(){return $it.Date.now()};function Qit(t,e,r){var i,n,s,o,a,c,l=0,u=!1,h=!1,d=!0;if(typeof t!="function")throw new TypeError(Pue);e=Oue(e)||0,YE(r)&&(u=!!r.leading,h="maxWait"in r,s=h?Yit(Oue(r.maxWait)||0,e):s,d="trailing"in r?!!r.trailing:d);function y(B){var z=i,G=n;return i=n=void 0,l=B,o=t.apply(G,z),o}function g(B){return l=B,a=setTimeout(v,e),u?y(B):o}function m(B){var z=B-c,G=B-l,Y=e-z;return h?Xit(Y,s-G):Y}function E(B){var z=B-c,G=B-l;return c===void 0||z>=e||z<0||h&&G>=s}function v(){var B=k8();if(E(B))return A(B);a=setTimeout(v,m(B))}function A(B){return a=void 0,d&&i?y(B):(i=n=void 0,o)}function R(){a!==void 0&&clearTimeout(a),l=0,i=c=n=a=void 0}function F(){return a===void 0?o:A(k8())}function q(){var B=k8(),z=E(B);if(i=arguments,n=this,c=B,z){if(a===void 0)return g(c);if(h)return a=setTimeout(v,e),y(c)}return a===void 0&&(a=setTimeout(v,e)),o}return q.cancel=R,q.flush=F,q}function Zit(t,e,r){var i=!0,n=!0;if(typeof t!="function")throw new TypeError(Pue);return YE(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),Qit(t,e,{leading:i,maxWait:e,trailing:n})}function YE(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Jit(t){return!!t&&typeof t=="object"}function ent(t){return typeof t=="symbol"||Jit(t)&&Wit.call(t)==Lit}function Oue(t){if(typeof t=="number")return t;if(ent(t))return Cue;if(YE(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=YE(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(Uit,"");var r=Kit.test(t);return r||jit.test(t)?Vit(t.slice(2),r?2:8):Fit.test(t)?Cue:+t}kue.exports=Zit});var Due=p((Bue,Nue)=>{f();"use strict";var tnt=que();Bue=Nue.exports=q8;function q8(t){if(!(this instanceof q8))return new q8(t);t=t||{};let e=t.validity||30,r=new Map,i=tnt(()=>{r.forEach((n,s)=>{let o=n.validity||e;rnt(n.timestamp)>o&&r.delete(s)})},200);this.put=(n,s,o)=>{this.has(n)||r.set(n,{value:s,timestamp:new Date,validity:o}),i()},this.get=n=>{if(r.has(n))return r.get(n).value;throw new Error("key does not exist")},this.has=n=>r.has(n)}function rnt(t){let r=new Date().getTime()-t.getTime();return Math.floor(r/1e3)}});var bi=p(B8=>{f();"use strict";B8.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required"};B8.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"}});var Uue=p((nBt,Lue)=>{f();"use strict";var b0=Bi(),Mue=b0.Reader,int=b0.Writer,Ar=b0.util,R1=b0.roots["libp2p-envelope"]||(b0.roots["libp2p-envelope"]={});R1.Envelope=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.publicKey=Ar.newBuffer([]),t.prototype.payloadType=Ar.newBuffer([]),t.prototype.payload=Ar.newBuffer([]),t.prototype.signature=Ar.newBuffer([]),t.encode=function(r,i){return i||(i=int.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&i.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&i.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&i.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&i.uint32(42).bytes(r.signature),i},t.decode=function(r,i){r instanceof Mue||(r=Mue.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new R1.Envelope;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof R1.Envelope)return r;var i=new R1.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?Ar.base64.decode(r.publicKey,i.publicKey=Ar.newBuffer(Ar.base64.length(r.publicKey)),0):r.publicKey.length&&(i.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?Ar.base64.decode(r.payloadType,i.payloadType=Ar.newBuffer(Ar.base64.length(r.payloadType)),0):r.payloadType.length&&(i.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?Ar.base64.decode(r.payload,i.payload=Ar.newBuffer(Ar.base64.length(r.payload)),0):r.payload.length&&(i.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?Ar.base64.decode(r.signature,i.signature=Ar.newBuffer(Ar.base64.length(r.signature)),0):r.signature.length&&(i.signature=r.signature)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Ar.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=Ar.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=Ar.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=Ar.newBuffer(n.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Ar.base64.encode(r.publicKey,0,r.publicKey.length):i.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?Ar.base64.encode(r.payloadType,0,r.payloadType.length):i.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(n.payload=i.bytes===String?Ar.base64.encode(r.payload,0,r.payload.length):i.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(n.signature=i.bytes===String?Ar.base64.encode(r.signature,0,r.signature.length):i.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,b0.util.toJSONOptions)},t}();Lue.exports=R1});var P1=p((sBt,jue)=>{f();"use strict";var nnt=ae(),snt=un(),ont=ct(),ant=fw(),cnt=et(),N8=os(),XE=yi(),{codes:unt}=bi(),{Envelope:Fue}=Uue(),Cl=class{constructor({peerId:e,payloadType:r,payload:i,signature:n}){this.peerId=e,this.payloadType=r,this.payload=i,this.signature=n,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=ant.marshalPublicKey(this.peerId.pubKey);return this._marshal=Fue.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return XE(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&XE(this.payloadType,e.payloadType)&&XE(this.payload,e.payload)&&XE(this.signature,e.signature)}validate(e){let r=Kue(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(r,this.signature)}},Kue=(t,e,r)=>{let i=ont(t),n=N8.encode(i.byteLength),s=N8.encode(e.length),o=N8.encode(r.length);return snt([new Uint8Array(n),i,new Uint8Array(s),e,new Uint8Array(o),r])};Cl.createFromProtobuf=async t=>{let e=Fue.decode(t),r=await cnt.createFromPubKey(e.publicKey);return new Cl({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};Cl.seal=async(t,e)=>{let r=t.domain,i=t.codec,n=t.marshal(),s=Kue(r,i,n),o=await e.privKey.sign(s);return new Cl({peerId:e,payloadType:i,payload:n,signature:o})};Cl.openAndCertify=async(t,e)=>{let r=await Cl.createFromProtobuf(t);if(!await r.validate(e))throw nnt(new Error("envelope signature is not valid for the given domain"),unt.ERR_SIGNATURE_NOT_VALID);return r};jue.exports=Cl});var K8=p((nu,zue)=>{f();"use strict";var lnt=nu&&nu.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),fnt=nu&&nu.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Vue=nu&&nu.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&lnt(e,t,r);return fnt(e,t),e},m0=nu&&nu.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):n(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})},D8=Vue(tue()),hnt=cue(),M8=lue(),Bt=Vue(bh()),dnt=due(),QE=I8(),Hi=mh(),L8=Iue(),pnt=Rue(),ynt=Due(),U8=et(),gnt=P1(),F8=class extends D8.default{constructor(e,r={}){let i=[Bt.GossipsubIDv11,Bt.GossipsubIDv10],n=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:Bt.GossipsubD,Dlo:Bt.GossipsubDlo,Dhi:Bt.GossipsubDhi,Dscore:Bt.GossipsubDscore,Dout:Bt.GossipsubDout,Dlazy:Bt.GossipsubDlazy},r),{scoreParams:L8.createPeerScoreParams(r.scoreParams),scoreThresholds:L8.createPeerScoreThresholds(r.scoreThresholds)});n.fallbackToFloodsub&&i.push(Bt.FloodsubID);super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:i,libp2p:e},n));this._options=n,this.direct=new Set(n.directPeers.map(s=>s.id.toB58String())),n.directPeers.forEach(s=>{e.peerStore.addressBook.add(s.id,s.addrs)}),this.seenCache=new ynt,this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=r.messageCache||new hnt.MessageCache(Bt.GossipsubHistoryGossip,Bt.GossipsubHistoryLength,this.getMsgId.bind(this)),this.heartbeat=new dnt.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new pnt.IWantTracer(this.getMsgId.bind(this)),this._libp2p=e,this.score=new L8.PeerScore(this._options.scoreParams,e.connectionManager,this.getMsgId.bind(this))}_decodeRpc(e){return M8.RPC.decode(e)}_encodeRpc(e){return M8.RPC.encode(e).finish()}_addPeer(e,r){let i=super._addPeer(e,r);this.score.addPeer(e.toB58String());let n=!1;for(let s of this._libp2p.connectionManager.getAll(e))if(s.stat.direction==="outbound"&&Array.from(s.registry.values()).some(o=>r===o.protocol)){n=!0;break}return this.outbound.set(i.id.toB58String(),n),i}_removePeer(e){let r=super._removePeer(e),i=e.toB58String();for(let n of this.mesh.values())n.delete(i);for(let n of this.fanout.values())n.delete(i);return this.gossip.delete(i),this.control.delete(i),this.outbound.delete(i),this.score.removePeer(i),r}_processRpc(e,r,i){let n=Object.create(null,{_processRpc:{get:()=>super._processRpc}});return m0(this,void 0,void 0,function*(){return(yield n._processRpc.call(this,e,r,i))?(i.control&&this._processRpcControlMessage(e,i.control),!0):!1})}_processRpcControlMessage(e,r){if(!r)return;let i=r.ihave?this._handleIHave(e,r.ihave):[],n=r.iwant?this._handleIWant(e,r.iwant):[],s=r.graft?this._handleGraft(e,r.graft):[];if(r.prune&&this._handlePrune(e,r.prune),!i.length&&!n.length&&!s.length)return;let o=Hi.createGossipRpc(n,{iwant:i,prune:s});this._sendRpc(e,o)}_processRpcMessage(e){let r=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return m0(this,void 0,void 0,function*(){let i=yield this.getMsgId(e),n=Hi.messageIdToString(i);if(this.seenCache.has(n)){this.score.duplicateMessage(e);return}this.seenCache.put(n),this.score.validateMessage(e),yield r._processRpcMessage.call(this,e)})}_acceptFrom(e){return this.direct.has(e)||this.score.score(e)>=this._options.scoreThresholds.graylistThreshold}validate(e){let r=Object.create(null,{validate:{get:()=>super.validate}});return m0(this,void 0,void 0,function*(){try{yield r.validate.call(this,e)}catch(i){throw this.score.rejectMessage(e,i.code),this.gossipTracer.rejectMessage(e,i.code),i}})}_handleIHave(e,r){if(!r.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),[];let n=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,n),n>Bt.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),[];let s=this.iasked.get(e)||0;if(s>=Bt.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),[];let o=new Map;if(r.forEach(({topicID:l,messageIDs:u})=>{!l||!u||!this.mesh.has(l)||u.forEach(h=>{let d=Hi.messageIdToString(h);this.seenCache.has(d)||o.set(d,h)})}),!o.size)return[];let a=o.size;a+s>Bt.GossipsubMaxIHaveLength&&(a=Bt.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return Hi.shuffle(c),c=c.slice(0,a),this.iasked.set(e,s+a),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}_handleIWant(e,r){if(!r.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,i),[];let n=new Map;return r.forEach(({messageIDs:s})=>{s&&s.forEach(o=>{let[a,c]=this.messageCache.getForPeer(o,e);if(!!a){if(c>Bt.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}n.set(Hi.messageIdToString(o),a)}})}),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values()).map(D8.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,r){let i=[],n=this.score.score(e),s=this._now(),o=this._options.doPX;return r.forEach(({topicID:a})=>{var c;if(!a)return;let l=this.mesh.get(a);if(!l){o=!1;return}if(l.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),i.push(a),o=!1;return}let u=(c=this.backoff.get(a))===null||c===void 0?void 0:c.get(e);if(typeof u=="number"&&s<u){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),o=!1;let h=u+Bt.GossipsubGraftFloodThreshold-Bt.GossipsubPruneBackoff;s<h&&this.score.addPenalty(e,1),this._addBackoff(e,a),i.push(a);return}if(n<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,a),i.push(a),o=!1,this._addBackoff(e,a);return}if(l.size>=this._options.Dhi&&!this.outbound.get(e)){i.push(a),this._addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),l.add(e)}),i.length?i.map(a=>this._makePrune(e,a,o)):[]}_handlePrune(e,r){let i=this.score.score(e);r.forEach(({topicID:n,backoff:s,peers:o})=>{if(!n)return;let a=this.mesh.get(n);if(!!a&&(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),a.delete(e),typeof s=="number"&&s>0?this._doAddBackoff(e,n,s*1e3):this._addBackoff(e,n),o&&o.length)){if(i<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,i,n);return}this._pxConnect(o)}})}_addBackoff(e,r){this._doAddBackoff(e,r,Bt.GossipsubPruneBackoff)}_doAddBackoff(e,r,i){let n=this.backoff.get(r);n||(n=new Map,this.backoff.set(r,n));let s=this._now()+i;(n.get(e)||0)<s&&n.set(e,s)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e)})}_clearBackoff(){if(this.heartbeatTicks%Bt.GossipsubPruneBackoffTicks!=0)return;let e=this._now();this.backoff.forEach((r,i)=>{r.forEach((n,s)=>{n<e&&r.delete(s)}),r.size===0&&this.backoff.delete(i)})}_directConnect(){if(this.heartbeatTicks%Bt.GossipsubDirectConnectTicks!=0)return;let e=[];this.direct.forEach(r=>{let i=this.peers.get(r);(!i||!i.isWritable)&&e.push(r)}),e.length&&e.forEach(r=>{this._connect(r)})}_pxConnect(e){return m0(this,void 0,void 0,function*(){e.length>Bt.GossipsubPrunePeers&&(Hi.shuffle(e),e=e.slice(0,Bt.GossipsubPrunePeers));let r=[];yield Promise.all(e.map(i=>m0(this,void 0,void 0,function*(){if(!i.peerID)return;let s=U8.createFromBytes(i.peerID).toB58String();if(!this.peers.has(s)){if(!i.signedPeerRecord){r.push(s);return}try{let o=yield gnt.openAndCertify(i.signedPeerRecord,"libp2p-peer-record"),a=o.peerId.toB58String();if(s!==a){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",a,s);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(s)}catch(o){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),!!r.length&&r.forEach(i=>this._connect(i))})}start(){super.start(),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(e=>{this._connect(e)})},Bt.GossipsubDirectConnectInitialDelay)}stop(){super.stop(),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),clearTimeout(this._directPeerInitial)}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(U8.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);let r=this.fanout.get(e);if(r)r.forEach(i=>{this.score.score(i)<0&&r.delete(i)}),r.size<this._options.D&&QE.getGossipPeers(this,e,this._options.D-r.size,i=>!r.has(i)&&!this.direct.has(i)&&this.score.score(i)>=0).forEach(i=>r.add(i)),this.mesh.set(e,r),this.fanout.delete(e),this.lastpub.delete(e);else{let i=QE.getGossipPeers(this,e,this._options.D,n=>!this.direct.has(n)&&this.score.score(n)>=0);this.mesh.set(e,i)}this.mesh.get(e).forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this._sendGraft(i,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);let r=this.mesh.get(e);r&&(r.forEach(i=>{this.log("LEAVE: Remove mesh link to %s in %s",i,e),this._sendPrune(i,e)}),this.mesh.delete(e))}_publish(e){return m0(this,void 0,void 0,function*(){e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e),this.gossipTracer.deliverMessage(e));let r=yield this.getMsgId(e),i=Hi.messageIdToString(r);this.seenCache.put(i),this.messageCache.put(e);let n=new Set;e.topicIDs.forEach(o=>{let a=this.topics.get(o);if(!!a)if(this._options.floodPublish&&e.from===this.peerId.toB58String())a.forEach(c=>{(this.direct.has(c)||this.score.score(c)>=this._options.scoreThresholds.publishThreshold)&&n.add(c)});else{this.direct.forEach(l=>{n.add(l)}),a.forEach(l=>{let u=this.score.score(l),h=this.peers.get(l);!h||h.protocol===Bt.FloodsubID&&u>=this._options.scoreThresholds.publishThreshold&&n.add(l)});let c=this.mesh.get(o);if(!c||!c.size){if(c=this.fanout.get(o),!c){let l=QE.getGossipPeers(this,o,this._options.D,u=>this.score.score(u)>=this._options.scoreThresholds.publishThreshold);l.size>0?(c=l,this.fanout.set(o,l)):c=new Set}this.lastpub.set(o,this._now())}c.forEach(l=>{n.add(l)})}});let s=Hi.createGossipRpc([D8.utils.normalizeOutRpcMessage(e)]);n.forEach(o=>{o!==e.from&&this._sendRpc(o,s)})})}_sendGraft(e,r){let i=[{topicID:r}],n=Hi.createGossipRpc([],{graft:i});this._sendRpc(e,n)}_sendPrune(e,r){let i=[this._makePrune(e,r,this._options.doPX)],n=Hi.createGossipRpc([],{prune:i});this._sendRpc(e,n)}_sendRpc(e,r){let i=this.peers.get(e);if(!i||!i.isWritable)return;let n=this.control.get(e);n&&(this._piggybackControl(e,r,n),this.control.delete(e));let s=this.gossip.get(e);s&&(this._piggybackGossip(e,r,s),this.gossip.delete(e)),i.write(M8.RPC.encode(r).finish())}_piggybackControl(e,r,i){let n=(i.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(i.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!n.length&&!s.length||(r.control?(r.control.graft=r.control.graft&&r.control.graft.concat(n),r.control.prune=r.control.prune&&r.control.prune.concat(s)):r.control={ihave:[],iwant:[],graft:n,prune:s})}_piggybackGossip(e,r,i){r.control||(r.control={ihave:[],iwant:[],graft:[],prune:[]}),r.control.ihave=i}_sendGraftPrune(e,r,i){let n=this._options.doPX;for(let[s,o]of e){let a=o.map(h=>({topicID:h})),c=[],l=r.get(s);l&&(c=l.map(h=>this._makePrune(s,h,n&&!i.get(s))),r.delete(s));let u=Hi.createGossipRpc([],{graft:a,prune:c});this._sendRpc(s,u)}for(let[s,o]of r){let a=o.map(l=>this._makePrune(s,l,n&&!i.get(s))),c=Hi.createGossipRpc([],{prune:a});this._sendRpc(s,c)}}_emitGossip(e,r){let i=this.messageCache.getGossipIDs(e);if(!i.length)return;Hi.shuffle(i),i.length>Bt.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",i.length);let n=[],s=this.topics.get(e);if(!s)return;s.forEach(c=>{let l=this.peers.get(c);!l||!r.has(c)&&!this.direct.has(c)&&Hi.hasGossipProtocol(l.protocol)&&this.score.score(c)>=this._options.scoreThresholds.gossipThreshold&&n.push(c)});let o=this._options.Dlazy,a=Bt.GossipsubGossipFactor*n.length;a>o&&(o=a),o>n.length?o=n.length:Hi.shuffle(n),n.slice(0,o).forEach(c=>{let l=i;i.length>Bt.GossipsubMaxIHaveLength&&(l=Hi.shuffle(l.slice()).slice(0,Bt.GossipsubMaxIHaveLength)),this._pushGossip(c,{topicID:e,messageIDs:l})})}_flush(){for(let[e,r]of this.gossip.entries()){this.gossip.delete(e);let i=Hi.createGossipRpc([],{ihave:r});this._sendRpc(e,i)}for(let[e,r]of this.control.entries()){this.control.delete(e);let i=Hi.createGossipRpc([],{graft:r.graft,prune:r.prune});this._sendRpc(e,i)}}_pushGossip(e,r){this.log("Add gossip to %s",e);let i=this.gossip.get(e)||[];this.gossip.set(e,i.concat(r))}_now(){return Date.now()}_makePrune(e,r,i){if(this.peers.get(e).protocol===Bt.GossipsubIDv10)return{topicID:r,peers:[]};let n=Bt.GossipsubPruneBackoff/1e3,s=[];return i&&QE.getGossipPeers(this,r,Bt.GossipsubPrunePeers,a=>a!==e&&this.score.score(a)>=0).forEach(a=>{let c=U8.createFromB58String(a);s.push({peerID:c.toBytes(),signedPeerRecord:this._libp2p.peerStore.addressBook.getRawEnvelope(c)})}),{topicID:r,peers:s,backoff:n}}};F8.multicodec=Bt.GossipsubIDv11;zue.exports=F8});var $ue=p((oBt,Hue)=>{f();"use strict";Hue.exports={gossipsub:K8()}});var Zue=p((aBt,Que)=>{f();"use strict";var j8=et(),{base58btc:bnt}=(si(),ni),{default:mnt}=Kc(),Gue=nl(),Wue=me(),Ol=Wue("libp2p-delegated-peer-routing");Ol.error=Wue("libp2p-delegated-peer-routing:error");var Yue=3e4,vnt=4,Xue=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this._client=e,this._httpQueue=new mnt({concurrency:vnt});let{protocol:r,host:i,port:n}=e.getEndpointConfig();Ol(`enabled DelegatedPeerRouting via ${r}://${i}:${n}`)}async findPeer(e,r={}){let i=e;j8.isPeerId(i)&&(i=e.toB58String()),Ol("findPeer starts: "+e),r.timeout=r.timeout||Yue;try{return await this._httpQueue.add(async()=>{let{addrs:n}=await this._client.dht.findPeer(i,{timeout:r.timeout});return{id:e,multiaddrs:n}})}catch(n){if(n.message.includes("not found"))return;throw n}finally{Ol("findPeer finished: "+e)}}async*getClosestPeers(e,r={}){let i=bnt.encode(e).substring(1);Ol("getClosestPeers starts:",i),r.timeout=r.timeout||Yue;let n=Gue(),s=Gue();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;let o=new Map;for await(let a of this._client.dht.query(i,{timeout:r.timeout}))switch(a.type){case 1:a.responses.forEach(c=>{o.set(c.id,{id:j8.parse(c.id),multiaddrs:c.addrs})});break;case 2:yield o.get(a.id.string)||{id:j8.createFromCID(a.id),multiaddrs:[]};break;default:Ol("getClosestPeers unhandled response",a)}}catch(o){throw Ol.error("getClosestPeers errored:",o),o}finally{s.resolve(),Ol("getClosestPeers finished:",i)}}};Que.exports=Xue});var nle=p((cBt,ile)=>{f();"use strict";var Jue=me(),wnt=et(),_nt=Ka(),{default:ele}=Kc(),tle=nl(),vh=Jue("libp2p-delegated-content-routing");vh.error=Jue("libp2p-delegated-content-routing:error");var Ent=3e4,Snt=4,rle=class{constructor(e,r){if(e==null)throw new Error("missing self peerId");if(r==null)throw new Error("missing ipfs http client");this._client=r,this.peerId=e;let i={concurrency:Snt};this._httpQueue=new ele(i),this._httpQueueRefs=new ele(Object.assign({},i,{concurrency:2}));let{protocol:n,host:s,port:o}=r.getEndpointConfig();vh(`enabled DelegatedContentRouting via ${n}://${s}:${o}`)}async*findProviders(e,r={}){vh(`findProviders starts: ${e}`),r.timeout=r.timeout||Ent;let i=0,n=tle(),s=tle();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;for await(let{id:o,addrs:a}of this._client.dht.findProvs(e,{numProviders:r.numProviders,timeout:r.timeout}))yield{id:wnt.parse(o),multiaddrs:a},i++}catch(o){throw vh.error("findProviders errored:",o),o}finally{s.resolve(),vh(`findProviders finished: ${e} found ${i} providers`)}}async provide(e){vh(`provide starts: ${e}`),await this._httpQueueRefs.add(async()=>{await this._client.block.stat(e),await _nt(this._client.dht.provide(e))}),vh(`provide finished: ${e}`)}};ile.exports=rle});var V8=p((uBt,ole)=>{f();"use strict";var xnt=t=>Promise.reject(new Error(`No codec found for "${t}"`)),sle=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||xnt;for(let r of e.codecs)this.addCodec(r)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let r=typeof e=="string"?this._codecsByName:this._codecsByCode;if(r[e])return r[e];let i=await this._loadCodec(e);return r[e]==null&&this.addCodec(i),i}listCodecs(){return Object.values(this._codecsByName)}};ole.exports=sle});var z8=p((lBt,cle)=>{f();"use strict";var Ant=t=>Promise.reject(new Error(`No hasher found for "${t}"`)),ale=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||Ant;for(let r of e.hashers)this.addHasher(r)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let r=typeof e=="string"?this._hashersByName:this._hashersByCode;if(r[e])return r[e];let i=await this._loadHasher(e);return r[e]==null&&this.addHasher(i),i}listHashers(){return Object.values(this._hashersByName)}};cle.exports=ale});var H8=p((fBt,lle)=>{f();"use strict";var Int=t=>Promise.reject(new Error(`No base found for "${t}"`)),ule=class{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||Int;for(let r of e.bases)this.addBase(r)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];let r=await this._loadBase(e);return this._basesByName[r.name]==null&&this._basesByPrefix[r.prefix]==null&&this.addBase(r),r}listBases(){return Object.values(this._basesByName)}};lle.exports=ule});var Xr=p((hBt,fle)=>{f();"use strict";fle.exports=t=>{if(t==null)return t;let e=/^[A-Z]+$/,r={};return Object.keys(t).reduce((i,n)=>(e.test(n)?i[n.toLowerCase()]=t[n]:e.test(n[0])?i[n[0].toLowerCase()+n.slice(1)]=t[n]:i[n]=t[n],i),r)}});var dle=p((dBt,hle)=>{f();"use strict";var{Multiaddr:Tnt}=tt(),Rnt=w2();hle.exports=t=>{try{t=Rnt(new Tnt(t))}catch(e){}return t=t.toString(),t}});var ple=p(()=>{f()});var yle=p(()=>{f()});var JE=p((mBt,_le)=>{f();"use strict";var{Multiaddr:gle}=tt(),{isBrowser:$8,isWebWorker:G8,isNode:Pnt}=Vy(),{default:Cnt}=Qg(),ble=me()("ipfs-http-client:lib:error-handler"),ZE=$y(),Ont=wr().bind({ignoreUndefined:!0}),mle=dle(),knt=ple(),qnt=yle(),Bnt=$8||G8?location.protocol:"http",Nnt=$8||G8?location.hostname:"localhost",Dnt=$8||G8?location.port:"5001",Mnt=(t={})=>{let e,r={},i;if(typeof t=="string"||gle.isMultiaddr(t))e=new URL(mle(t));else if(t instanceof URL)e=t;else if(typeof t.url=="string"||gle.isMultiaddr(t.url))e=new URL(mle(t.url)),r=t;else if(t.url instanceof URL)e=t.url,r=t;else{r=t||{};let n=(r.protocol||Bnt).replace(":",""),s=(r.host||Nnt).split(":")[0],o=r.port||Dnt;e=new URL(`${n}://${s}:${o}`)}if(r.apiPath?e.pathname=r.apiPath:(e.pathname==="/"||e.pathname===void 0)&&(e.pathname="api/v0"),Pnt){let n=e.protocol.startsWith("https")?qnt.Agent:knt.Agent;i=r.agent||new n({keepAlive:!0,maxSockets:6})}return{...r,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:i}},vle=async t=>{let e;try{if((t.headers.get("Content-Type")||"").startsWith("application/json")){let i=await t.json();ble(i),e=i.Message||i.message}else e=await t.text()}catch(i){ble("Failed to parse error response",i),e=i.message}let r=new ZE.HTTPError(t);throw e&&e.includes("context deadline exceeded")&&(r=new ZE.TimeoutError("Request timed out")),e&&e.includes("request timed out")&&(r=new ZE.TimeoutError("Request timed out")),e&&(r.message=e),r},Lnt=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,wle=t=>t.replace(Lnt,function(e){return"-"+e.toLowerCase()}),Unt=t=>typeof t=="string"?Cnt(t):t,W8=class extends ZE{constructor(e={}){let r=Mnt(e);super({timeout:Unt(r.timeout||0)||6e4*20,headers:r.headers,base:`${r.url}`,handleError:vle,transformSearchParams:n=>{let s=new URLSearchParams;for(let[o,a]of n)a!=="undefined"&&a!=="null"&&o!=="signal"&&s.append(wle(o),a),o==="timeout"&&!isNaN(a)&&s.append(wle(o),a);return s},agent:r.agent});delete this.get,delete this.put,delete this.delete,delete this.options;let i=this.fetch;this.fetch=(n,s={})=>(typeof n=="string"&&!n.startsWith("/")&&(n=`${r.url}/${n}`),i.call(this,n,Ont(s,{method:"POST"})))}};W8.errorHandler=vle;_le.exports=W8});var ve=p((vBt,Ele)=>{f();"use strict";var Fnt=JE(),Knt=t=>e=>t(new Fnt(e),e);Ele.exports=Knt});var Ile=p((wBt,Ale)=>{f();"use strict";var jnt=ae(),Vnt=Rb(),znt=Tb(),Hnt=rp(),{isBytes:Sle,isBlob:$nt,isReadableStream:Gnt}=K_();async function Wnt(t){if(Sle(t))return new Blob([t]);if(typeof t=="string"||t instanceof String)return new Blob([t.toString()]);if($nt(t))return t;if(Gnt(t)&&(t=znt(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let e=Vnt(t),{value:r,done:i}=await e.peek();if(i)return xle(e);if(e.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await Hnt(e))]);if(Sle(r)||typeof r=="string"||r instanceof String)return xle(e)}throw jnt(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT")}async function xle(t){let e=[];for await(let r of t)e.push(r);return new Blob(e)}Ale.exports=Wnt});var Rle=p((_Bt,Tle)=>{f();"use strict";var Ynt=Ile(),Xnt=R5();function Qnt(t){return Xnt(t,Ynt)}Tle.exports={normaliseInput:Qnt}});var eS=p((EBt,Ple)=>{f();"use strict";Ple.exports=t=>{if(t!=null)return typeof t=="string"?t:t.toString(8).padStart(4,"0")}});var Yo=p((SBt,Cle)=>{f();"use strict";var{normaliseInput:Znt}=Rle(),Jnt=eS();async function est(t,e,r={}){let i=[],n=new FormData,s=0,o=0;for await(let{content:a,path:c,mode:l,mtime:u}of Znt(t)){let h="",d=a?"file":"dir";s>0&&(h=`-${s}`);let y=d+h,g=[];if(l!=null&&g.push(`mode=${Jnt(l)}`),u!=null){let{secs:m,nsecs:E}=u;g.push(`mtime=${m}`),E!=null&&g.push(`mtime-nsecs=${E}`)}if(g.length&&(y=`${y}?${g.join("&")}`),a){n.set(y,a,c!=null?encodeURIComponent(c):void 0);let m=o+a.size;i.push({name:c,start:o,end:m}),o=m}else if(c!=null)n.set(y,new File([""],encodeURIComponent(c),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");s++}return{total:o,parts:i,headers:r,body:n}}Cle.exports=est});var Y8=p((xBt,Ole)=>{f();"use strict";var tst=ae();function rst(t){if(t==null)return;let e;if(t.secs!=null&&(e={secs:t.secs,nsecs:t.nsecs}),t.Seconds!=null&&(e={secs:t.Seconds,nsecs:t.FractionalNanoseconds}),Array.isArray(t)&&(e={secs:t[0],nsecs:t[1]}),t instanceof Date){let r=t.getTime(),i=Math.floor(r/1e3);e={secs:i,nsecs:(r-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw tst(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}Ole.exports=rst});var Se=p((ABt,kle)=>{f();"use strict";var ist=eS(),nst=Y8();kle.exports=({arg:t,searchParams:e,hashAlg:r,mtime:i,mode:n,...s}={})=>{e&&(s={...s,...e}),r&&(s.hash=r),i!=null&&(i=nst(i),s.mtime=i.secs,s.mtimeNsecs=i.nsecs),n!=null&&(s.mode=ist(n)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),t==null?t=[]:Array.isArray(t)||(t=[t]);let o=new URLSearchParams(s);return t.forEach(a=>o.append("arg",a)),o}});var Xo=p((IBt,qle)=>{f();"use strict";var{anySignal:sst}=Zl();function ost(t){return t.filter(Boolean)}qle.exports=(...t)=>sst(ost(t))});var X8=p((TBt,Ble)=>{f();"use strict";var{CID:ast}=(Ae(),Ce),cst=Xr(),ust=ve(),lst=Yo(),fst=Se(),hst=Xo(),{AbortController:dst}=sn();Ble.exports=ust(t=>{async function*e(r,i={}){let n=new dst,s=hst(n.signal,i.signal),{headers:o,body:a,total:c,parts:l}=await lst(r,n,i.headers),[u,h]=typeof i.progress=="function"?pst(c,l,i.progress):[void 0,void 0],d=await t.post("add",{searchParams:fst({"stream-channels":!0,...i,progress:Boolean(u)}),timeout:i.timeout,onUploadProgress:h,signal:s,headers:o,body:a});for await(let y of d.ndjson())y=cst(y),y.hash!==void 0?yield gst(y):u&&u(y.bytes||0,y.name)}return e});var pst=(t,e,r)=>e?[void 0,yst(t,e,r)]:[r,void 0],yst=(t,e,r)=>{let i=0,n=e.length;return({loaded:s,total:o})=>{let a=Math.floor(s/o*t);for(;i<n;){let{start:c,end:l,name:u}=e[i];if(a<l){r(a-c,u);break}else r(l-c,u),i+=1}}};function gst({name:t,hash:e,size:r,mode:i,mtime:n,mtimeNsecs:s}){let o={path:t,cid:ast.parse(e),size:parseInt(r)};return i!=null&&(o.mode=parseInt(i,8)),n!=null&&(o.mtime={secs:n,nsecs:s||0}),o}});var Dle=p((RBt,Nle)=>{f();"use strict";var bst=X8(),mst=$n(),vst=ve();Nle.exports=t=>{let e=bst(t);return vst(()=>{async function r(i,n={}){return await mst(e(i,n))}return r})(t)}});var Lle=p((PBt,Mle)=>{f();"use strict";var{CID:wst}=(Ae(),Ce),_st=ve(),Est=Se();Mle.exports=_st(t=>{async function e(r={}){return((await(await t.post("bitswap/wantlist",{timeout:r.timeout,signal:r.signal,searchParams:Est(r),headers:r.headers})).json()).Keys||[]).map(n=>wst.parse(n["/"]))}return e})});var Fle=p((CBt,Ule)=>{f();"use strict";var{CID:Sst}=(Ae(),Ce),xst=ve(),Ast=Se();Ule.exports=xst(t=>{async function e(r,i={}){return((await(await t.post("bitswap/wantlist",{timeout:i.timeout,signal:i.signal,searchParams:Ast({...i,peer:r.toString()}),headers:i.headers})).json()).Keys||[]).map(s=>Sst.parse(s["/"]))}return e})});var Q8=p((OBt,Kle)=>{f();"use strict";var{CID:Ist}=(Ae(),Ce),Tst=ve(),Rst=Se();Kle.exports=Tst(t=>{async function e(r={}){let i=await t.post("bitswap/stat",{searchParams:Rst(r),timeout:r.timeout,signal:r.signal,headers:r.headers});return Pst(await i.json())}return e});function Pst(t){return{provideBufLen:t.ProvideBufLen,wantlist:(t.Wantlist||[]).map(e=>Ist.parse(e["/"])),peers:t.Peers||[],blocksReceived:BigInt(t.BlocksReceived),dataReceived:BigInt(t.DataReceived),blocksSent:BigInt(t.BlocksSent),dataSent:BigInt(t.DataSent),dupBlksReceived:BigInt(t.DupBlksReceived),dupDataReceived:BigInt(t.DupDataReceived)}}});var Vle=p((kBt,jle)=>{f();"use strict";var Cst=ve(),Ost=Se();jle.exports=Cst(t=>{async function e(r,i={}){return(await t.post("bitswap/unwant",{timeout:i.timeout,signal:i.signal,searchParams:Ost({arg:r.toString(),...i}),headers:i.headers})).json()}return e})});var Hle=p((qBt,zle)=>{f();"use strict";zle.exports=t=>({wantlist:Lle()(t),wantlistForPeer:Fle()(t),stat:Q8()(t),unwant:Vle()(t)})});var Z8=p((BBt,$le)=>{f();"use strict";var kst=ve(),qst=Se();$le.exports=kst(t=>{async function e(r,i={}){let n=await t.post("block/get",{timeout:i.timeout,signal:i.signal,searchParams:qst({arg:r.toString(),...i}),headers:i.headers});return new Uint8Array(await n.arrayBuffer())}return e})});var Wle=p((NBt,Gle)=>{f();"use strict";var{CID:Bst}=(Ae(),Ce),Nst=ve(),Dst=Se();Gle.exports=Nst(t=>{async function e(r,i={}){let s=await(await t.post("block/stat",{timeout:i.timeout,signal:i.signal,searchParams:Dst({arg:r.toString(),...i}),headers:i.headers})).json();return{cid:Bst.parse(s.Key),size:s.Size}}return e})});var Xle=p((DBt,Yle)=>{f();"use strict";var{CID:Mst}=(Ae(),Ce),Lst=Yo(),Ust=ve(),Fst=Se(),Kst=Xo(),{AbortController:jst}=sn();Yle.exports=Ust(t=>{async function e(r,i={}){let n=new jst,s=Kst(n.signal,i.signal),o;try{o=await(await t.post("block/put",{timeout:i.timeout,signal:s,searchParams:Fst(i),...await Lst(r,n,i.headers)})).json()}catch(a){if(i.format==="dag-pb")return e(r,{...i,format:"protobuf"});if(i.format==="dag-cbor")return e(r,{...i,format:"cbor"});throw a}return Mst.parse(o.Key)}return e})});var Zle=p((MBt,Qle)=>{f();"use strict";var{CID:Vst}=(Ae(),Ce),zst=ve(),Hst=Se();Qle.exports=zst(t=>{async function*e(r,i={}){Array.isArray(r)||(r=[r]);let n=await t.post("block/rm",{timeout:i.timeout,signal:i.signal,searchParams:Hst({arg:r.map(s=>s.toString()),"stream-channels":!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield $st(s)}return e});function $st(t){let e={cid:Vst.parse(t.Hash)};return t.Error&&(e.error=new Error(t.Error)),e}});var efe=p((LBt,Jle)=>{f();"use strict";Jle.exports=t=>({get:Z8()(t),stat:Wle()(t),put:Xle()(t),rm:Zle()(t)})});var rfe=p((UBt,tfe)=>{f();"use strict";var Gst=ve(),Wst=Se(),{Multiaddr:Yst}=tt();tfe.exports=Gst(t=>{async function e(r,i={}){let n=await t.post("bootstrap/add",{timeout:i.timeout,signal:i.signal,searchParams:Wst({arg:r,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new Yst(o))}}return e})});var nfe=p((FBt,ife)=>{f();"use strict";var Xst=ve(),Qst=Se(),{Multiaddr:Zst}=tt();ife.exports=Xst(t=>{async function e(r={}){let i=await t.post("bootstrap/rm",{timeout:r.timeout,signal:r.signal,searchParams:Qst({...r,all:!0}),headers:r.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new Zst(s))}}return e})});var ofe=p((KBt,sfe)=>{f();"use strict";var Jst=ve(),eot=Se(),{Multiaddr:tot}=tt();sfe.exports=Jst(t=>{async function e(r,i={}){let n=await t.post("bootstrap/rm",{timeout:i.timeout,signal:i.signal,searchParams:eot({arg:r,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new tot(o))}}return e})});var cfe=p((jBt,afe)=>{f();"use strict";var rot=ve(),iot=Se(),{Multiaddr:not}=tt();afe.exports=rot(t=>{async function e(r={}){let i=await t.post("bootstrap/add",{timeout:r.timeout,signal:r.signal,searchParams:iot({...r,default:!0}),headers:r.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new not(s))}}return e})});var lfe=p((VBt,ufe)=>{f();"use strict";var sot=ve(),oot=Se(),{Multiaddr:aot}=tt();ufe.exports=sot(t=>{async function e(r={}){let i=await t.post("bootstrap/list",{timeout:r.timeout,signal:r.signal,searchParams:oot(r),headers:r.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new aot(s))}}return e})});var hfe=p((zBt,ffe)=>{f();"use strict";ffe.exports=t=>({add:rfe()(t),clear:nfe()(t),rm:ofe()(t),reset:cfe()(t),list:lfe()(t)})});var pfe=p((HBt,dfe)=>{f();"use strict";var cot=ve(),uot=Se();dfe.exports=cot(t=>{async function*e(r,i={}){yield*(await t.post("cat",{timeout:i.timeout,signal:i.signal,searchParams:uot({arg:r.toString(),...i}),headers:i.headers})).iterator()}return e})});var gfe=p(($Bt,yfe)=>{f();"use strict";var lot=ve(),fot=Se();yfe.exports=lot(t=>async(r={})=>(await t.post("commands",{timeout:r.timeout,signal:r.signal,searchParams:fot(r),headers:r.headers})).json())});var mfe=p((GBt,bfe)=>{f();"use strict";var hot=ve(),dot=Se();bfe.exports=hot(t=>async(r={})=>await(await t.post("config/show",{timeout:r.timeout,signal:r.signal,searchParams:dot({...r}),headers:r.headers})).json())});var wfe=p((WBt,vfe)=>{f();"use strict";var pot=ve(),yot=Se();vfe.exports=pot(t=>async(r,i={})=>{if(!r)throw new Error("key argument is required");return(await(await t.post("config",{timeout:i.timeout,signal:i.signal,searchParams:yot({arg:r,...i}),headers:i.headers})).json()).Value})});var Efe=p((YBt,_fe)=>{f();"use strict";var got=ve(),bot=Se();_fe.exports=got(t=>async(r,i,n={})=>{if(typeof r!="string")throw new Error("Invalid key type");let s={...n,...mot(r,i)};await(await t.post("config",{timeout:n.timeout,signal:n.signal,searchParams:bot(s),headers:n.headers})).text()});var mot=(t,e)=>{switch(typeof e){case"boolean":return{arg:[t,e.toString()],bool:!0};case"string":return{arg:[t,e]};default:return{arg:[t,JSON.stringify(e)],json:!0}}}});var xfe=p((XBt,Sfe)=>{f();"use strict";var vot=ct(),wot=Yo(),_ot=ve(),Eot=Se(),Sot=Xo(),{AbortController:xot}=sn();Sfe.exports=_ot(t=>async(r,i={})=>{let n=new xot,s=Sot(n.signal,i.signal);await(await t.post("config/replace",{timeout:i.timeout,signal:s,searchParams:Eot(i),...await wot(vot(JSON.stringify(r)),n,i.headers)})).text()})});var Ife=p((QBt,Afe)=>{f();"use strict";var Aot=ve(),Iot=Se();Afe.exports=Aot(t=>{async function e(r,i={}){let s=await(await t.post("config/profile/apply",{timeout:i.timeout,signal:i.signal,searchParams:Iot({arg:r,...i}),headers:i.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}return e})});var Rfe=p((ZBt,Tfe)=>{f();"use strict";var Tot=Xr(),Rot=ve(),Pot=Se();Tfe.exports=Rot(t=>{async function e(r={}){return(await(await t.post("config/profile/list",{timeout:r.timeout,signal:r.signal,searchParams:Pot(r),headers:r.headers})).json()).map(s=>Tot(s))}return e})});var Cfe=p((JBt,Pfe)=>{f();"use strict";Pfe.exports=t=>({apply:Ife()(t),list:Rfe()(t)})});var kfe=p((eNt,Ofe)=>{f();"use strict";Ofe.exports=t=>({getAll:mfe()(t),get:wfe()(t),set:Efe()(t),replace:xfe()(t),profiles:Cfe()(t)})});var Bfe=p((tNt,qfe)=>{f();"use strict";var Cot=ve(),Oot=Se();qfe.exports=Cot(t=>{async function*e(r,i={}){yield*(await t.post("dag/export",{timeout:i.timeout,signal:i.signal,searchParams:Oot({arg:r.toString()}),headers:i.headers})).iterator()}return e})});var Mfe=p((rNt,Dfe)=>{f();"use strict";var{CID:kot}=(Ae(),Ce),Nfe=ae(),qot=async function*(t,e,r,i,n){let s=async l=>{let u=await r.getCodec(l.code),h=await i(l,n);return u.decode(h)},o=e.split("/").filter(Boolean),a=await s(t),c=t;for(o.length||(yield{value:a,remainderPath:""});o.length;){let l=o.shift();if(!l)throw Nfe(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,l))a=a[l],yield{value:a,remainderPath:o.join("/")};else throw Nfe(new Error(`no link named "${l}" under ${c}`),"ERR_NO_LINK");a instanceof kot&&(c=a,a=await s(a))}};Dfe.exports=qot});var Ufe=p((iNt,Lfe)=>{f();"use strict";var Bot=async t=>{for await(let e of t)return e};Lfe.exports=Bot});var jfe=p((nNt,Kfe)=>{f();"use strict";var Not=ve(),Ffe=Mfe(),Dot=Ufe(),Mot=$n(),Lot=ae();Kfe.exports=(t,e)=>Not((i,n)=>{let s=Z8()(n);return async(a,c={})=>{if(c.path){let y=c.localResolve?await Dot(Ffe(a,c.path,t,s,c)):await Mot(Ffe(a,c.path,t,s,c));if(!y)throw Lot(new Error("Not found"),"ERR_NOT_FOUND");return y}let l=await t.getCodec(a.code),u=await s(a,c);return{value:l.decode(u),remainderPath:""}}})(e)});var zfe=p((sNt,Vfe)=>{f();"use strict";var Uot=ve(),Fot=Se(),Kot=Xo(),jot=Yo(),{AbortController:Vot}=sn(),{CID:zot}=(Ae(),Ce);Vfe.exports=Uot(t=>{async function*e(r,i={}){let n=new Vot,s=Kot(n.signal,i.signal),{headers:o,body:a}=await jot(r,n,i.headers),c=await t.post("dag/import",{timeout:i.timeout,signal:s,headers:o,body:a,searchParams:Fot({"pin-roots":i.pinRoots})});for await(let{Root:l}of c.ndjson())if(l!==void 0){let{Cid:{"/":u},PinErrorMsg:h}=l;yield{root:{cid:zot.parse(u),pinErrorMsg:h}}}}return e})});var J8=p((oNt,Hfe)=>{f();"use strict";var{CID:Hot}=(Ae(),Ce),$ot=ve(),Got=Yo(),Wot=Se(),Yot=Xo(),{AbortController:Xot}=sn();Hfe.exports=(t,e)=>$ot(i=>async(s,o={})=>{let a={format:"dag-cbor",hashAlg:"sha2-256",inputEnc:"raw",...o},l=(await t.getCodec(a.format)).encode(s),u=new Xot,h=Yot(u.signal,a.signal),y=await(await i.post("dag/put",{timeout:a.timeout,signal:h,searchParams:Wot(a),...await Got(l,u,a.headers)})).json();return Hot.parse(y.Cid["/"])})(e)});var Gfe=p((aNt,$fe)=>{f();"use strict";var{CID:Qot}=(Ae(),Ce),Zot=ve(),Jot=Se();$fe.exports=Zot(t=>async(r,i={})=>{let s=await(await t.post("dag/resolve",{timeout:i.timeout,signal:i.signal,searchParams:Jot({arg:`${r}${i.path?`/${i.path}`.replace(/\/[/]+/g,"/"):""}`,...i}),headers:i.headers})).json();return{cid:Qot.parse(s.Cid["/"]),remainderPath:s.RemPath}})});var Yfe=p((cNt,Wfe)=>{f();"use strict";Wfe.exports=(t,e)=>({export:Bfe()(e),get:jfe()(t,e),import:zfe()(e),put:J8()(t,e),resolve:Gfe()(e)})});var tS=p((uNt,Xfe)=>{f();"use strict";Xfe.exports={SendingQuery:0,PeerResponse:1,FinalPeer:2,QueryError:3,Provider:4,Value:5,AddingPeer:6,DialingPeer:7}});var Zfe=p((lNt,Qfe)=>{f();"use strict";var eat=ve(),tat=Se(),{Value:rat}=tS(),iat=Je(),nat=ct();Qfe.exports=eat(t=>{async function e(r,i={}){let n=await t.post("dht/get",{timeout:i.timeout,signal:i.signal,searchParams:tat({arg:r instanceof Uint8Array?iat(r):r,...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===rat)return nat(s.Extra,"base64pad");throw new Error("not found")}return e})});var ehe=p((fNt,Jfe)=>{f();"use strict";var{Multiaddr:sat}=tt(),oat=Xr(),aat=ve(),cat=Se(),uat=Yo(),lat=Xo(),{AbortController:fat}=sn(),hat=Je();Jfe.exports=aat(t=>{async function*e(r,i,n={}){let s=new fat,o=lat(s.signal,n.signal),a=await t.post("dht/put",{timeout:n.timeout,signal:o,searchParams:cat({arg:hat(r),...n}),...await uat(i,s,n.headers)});for await(let c of a.ndjson())c=oat(c),c.responses&&(c.responses=c.responses.map(({ID:l,Addrs:u})=>({id:l,addrs:(u||[]).map(h=>new sat(h))}))),yield c}return e})});var rhe=p((hNt,the)=>{f();"use strict";var{Multiaddr:dat}=tt(),pat=ve(),yat=Se(),{Provider:gat}=tS();the.exports=pat(t=>{async function*e(r,i={}){let n=await t.post("dht/findprovs",{timeout:i.timeout,signal:i.signal,searchParams:yat({arg:r.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===gat&&s.Responses)for(let{ID:o,Addrs:a}of s.Responses)yield{id:o,addrs:(a||[]).map(c=>new dat(c))}}return e})});var nhe=p((dNt,ihe)=>{f();"use strict";var{Multiaddr:bat}=tt(),mat=ve(),vat=Se(),{FinalPeer:wat}=tS();ihe.exports=mat(t=>{async function e(r,i={}){let n=await t.post("dht/findpeer",{timeout:i.timeout,signal:i.signal,searchParams:vat({arg:r,...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===wat&&s.Responses){let{ID:o,Addrs:a}=s.Responses[0];return{id:o,addrs:(a||[]).map(c=>new bat(c))}}throw new Error("not found")}return e})});var ohe=p((pNt,she)=>{f();"use strict";var{Multiaddr:_at}=tt(),Eat=Xr(),Sat=ve(),xat=Se();she.exports=Sat(t=>{async function*e(r,i={recursive:!1}){let n=Array.isArray(r)?r:[r],s=await t.post("dht/provide",{timeout:i.timeout,signal:i.signal,searchParams:xat({arg:n.map(o=>o.toString()),...i}),headers:i.headers});for await(let o of s.ndjson())o=Eat(o),o.responses?o.responses=o.responses.map(({ID:a,Addrs:c})=>({id:a,addrs:(c||[]).map(l=>new _at(l))})):o.responses=[],yield o}return e})});var che=p((yNt,ahe)=>{f();"use strict";var{Multiaddr:Aat}=tt(),Iat=Xr(),Tat=ve(),Rat=Se();ahe.exports=Tat(t=>{async function*e(r,i={}){let n=await t.post("dht/query",{timeout:i.timeout,signal:i.signal,searchParams:Rat({arg:r.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())s=Iat(s),s.responses=(s.responses||[]).map(({ID:o,Addrs:a})=>({id:o,addrs:(a||[]).map(c=>new Aat(c))})),yield s}return e})});var lhe=p((gNt,uhe)=>{f();"use strict";uhe.exports=t=>({get:Zfe()(t),put:ehe()(t),findProvs:rhe()(t),findPeer:nhe()(t),provide:ohe()(t),query:che()(t)})});var hhe=p((bNt,fhe)=>{f();"use strict";var Pat=ve(),Cat=Se();fhe.exports=Pat(t=>{async function e(r={}){return(await t.post("diag/net",{timeout:r.timeout,signal:r.signal,searchParams:Cat(r),headers:r.headers})).json()}return e})});var phe=p((mNt,dhe)=>{f();"use strict";var Oat=ve(),kat=Se();dhe.exports=Oat(t=>{async function e(r={}){return(await t.post("diag/sys",{timeout:r.timeout,signal:r.signal,searchParams:kat(r),headers:r.headers})).json()}return e})});var ghe=p((vNt,yhe)=>{f();"use strict";var qat=ve(),Bat=Se();yhe.exports=qat(t=>{async function e(r={}){return(await t.post("diag/cmds",{timeout:r.timeout,signal:r.signal,searchParams:Bat(r),headers:r.headers})).json()}return e})});var mhe=p((wNt,bhe)=>{f();"use strict";bhe.exports=t=>({net:hhe()(t),sys:phe()(t),cmds:ghe()(t)})});var whe=p((_Nt,vhe)=>{f();"use strict";var Nat=ve(),Dat=Se();vhe.exports=Nat(t=>async(r,i={})=>(await(await t.post("dns",{timeout:i.timeout,signal:i.signal,searchParams:Dat({arg:r,...i}),headers:i.headers})).json()).Path)});var Ehe=p((ENt,_he)=>{f();"use strict";var Mat=ve(),Lat=Se();_he.exports=Mat(t=>{async function e(r,i,n={}){await(await t.post("files/chmod",{timeout:n.timeout,signal:n.signal,searchParams:Lat({arg:r,mode:i,...n}),headers:n.headers})).text()}return e})});var xhe=p((SNt,She)=>{f();"use strict";var{CID:Uat}=(Ae(),Ce),Fat=ve(),Kat=Se();She.exports=Fat(t=>{async function e(r,i,n={}){let s=Array.isArray(r)?r:[r];await(await t.post("files/cp",{timeout:n.timeout,signal:n.signal,searchParams:Kat({arg:s.concat(i).map(a=>a instanceof Uat?`/ipfs/${a}`:a),...n}),headers:n.headers})).text()}return e})});var Ihe=p((xNt,Ahe)=>{f();"use strict";var{CID:jat}=(Ae(),Ce),Vat=ve(),zat=Se();Ahe.exports=Vat(t=>{async function e(r,i={}){if(!r||typeof r!="string")throw new Error("ipfs.files.flush requires a path");let s=await(await t.post("files/flush",{timeout:i.timeout,signal:i.signal,searchParams:zat({arg:r,...i}),headers:i.headers})).json();return jat.parse(s.Cid)}return e})});var eP=p((ANt,The)=>{f();"use strict";var Hat=Xr();function $at(t){let e=Hat(t);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs||0},delete e.mtimeNsecs),e}The.exports=$at});var khe=p((INt,Ohe)=>{f();"use strict";var{CID:Rhe}=(Ae(),Ce),Phe=eP(),Gat=ve(),Wat=Se();Ohe.exports=Gat(t=>{async function*e(r,i={}){if(!r)throw new Error("ipfs.files.ls requires a path");let n=await t.post("files/ls",{timeout:i.timeout,signal:i.signal,searchParams:Wat({arg:r instanceof Rhe?`/ipfs/${r}`:r,long:!0,...i,stream:!0}),headers:i.headers});for await(let s of n.ndjson())if("Entries"in s)for(let o of s.Entries||[])yield Che(Phe(o));else yield Che(Phe(s))}return e});function Che(t){return t.hash&&(t.cid=Rhe.parse(t.hash)),delete t.hash,t.type=t.type===1?"directory":"file",t}});var Bhe=p((TNt,qhe)=>{f();"use strict";var Yat=ve(),Xat=Se();qhe.exports=Yat(t=>{async function e(r,i={}){await(await t.post("files/mkdir",{timeout:i.timeout,signal:i.signal,searchParams:Xat({arg:r,...i}),headers:i.headers})).text()}return e})});var Dhe=p((RNt,Nhe)=>{f();"use strict";var Qat=ve(),Zat=Se();Nhe.exports=Qat(t=>{async function e(r,i,n={}){Array.isArray(r)||(r=[r]),await(await t.post("files/mv",{timeout:n.timeout,signal:n.signal,searchParams:Zat({arg:r.concat(i),...n}),headers:n.headers})).text()}return e})});var C1=p((PNt,Mhe)=>{f();Mhe.exports=t=>{if(t[Symbol.asyncIterator])return t;if(t.getReader)return async function*(){let e=t.getReader();try{for(;;){let{done:r,value:i}=await e.read();if(r)return;yield i}}finally{e.releaseLock()}}();throw new Error("unknown stream")}});var Uhe=p((CNt,Lhe)=>{f();"use strict";var Jat=C1(),ect=ve(),tct=Se();Lhe.exports=ect(t=>{async function*e(r,i={}){let n=await t.post("files/read",{timeout:i.timeout,signal:i.signal,searchParams:tct({arg:r,count:i.length,...i}),headers:i.headers});yield*Jat(n.body)}return e})});var Khe=p((ONt,Fhe)=>{f();"use strict";var rct=ve(),ict=Se();Fhe.exports=rct(t=>{async function e(r,i={}){await(await t.post("files/rm",{timeout:i.timeout,signal:i.signal,searchParams:ict({arg:r,...i}),headers:i.headers})).text()}return e})});var tP=p((kNt,Vhe)=>{f();"use strict";var{CID:jhe}=(Ae(),Ce),nct=eP(),sct=ve(),oct=Se();Vhe.exports=sct(t=>{async function e(r,i={}){r&&!(r instanceof jhe)&&typeof r!="string"&&(i=r||{},r="/"),i=i||{};let s=await(await t.post("files/stat",{timeout:i.timeout,signal:i.signal,searchParams:oct({arg:r,...i}),headers:i.headers})).json();return s.WithLocality=s.WithLocality||!1,act(nct(s))}return e});function act(t){return t.cid=jhe.parse(t.hash),delete t.hash,t}});var Hhe=p((qNt,zhe)=>{f();"use strict";var cct=ve(),uct=Se();zhe.exports=cct(t=>{async function e(r,i={}){await(await t.post("files/touch",{timeout:i.timeout,signal:i.signal,searchParams:uct({arg:r,...i}),headers:i.headers})).text()}return e})});var Ghe=p((BNt,$he)=>{f();"use strict";var lct=eS(),fct=Y8(),hct=ve(),dct=Yo(),pct=Se(),yct=Xo(),{AbortController:gct}=sn();$he.exports=hct(t=>{async function e(r,i,n={}){let s=new gct,o=yct(s.signal,n.signal);await(await t.post("files/write",{timeout:n.timeout,signal:o,searchParams:pct({arg:r,streamChannels:!0,count:n.length,...n}),...await dct({content:i,path:"arg",mode:lct(n.mode),mtime:fct(n.mtime)},s,n.headers)})).text()}return e})});var Yhe=p((NNt,Whe)=>{f();"use strict";Whe.exports=t=>({chmod:Ehe()(t),cp:xhe()(t),flush:Ihe()(t),ls:khe()(t),mkdir:Bhe()(t),mv:Dhe()(t),read:Uhe()(t),rm:Khe()(t),stat:tP()(t),touch:Hhe()(t),write:Ghe()(t)})});var Qhe=p((DNt,Xhe)=>{f();"use strict";var{CID:bct}=(Ae(),Ce),mct=ve(),vct=Se();Xhe.exports=mct(t=>{async function*e(r,i={}){let n={arg:`${r instanceof Uint8Array?bct.decode(r):r}`,...i};n.compressionLevel&&(n["compression-level"]=n.compressionLevel,delete n.compressionLevel),yield*(await t.post("get",{timeout:i.timeout,signal:i.signal,searchParams:vct(n),headers:i.headers})).iterator()}return e})});var Jhe=p((MNt,Zhe)=>{f();"use strict";var wct=ve();Zhe.exports=wct(t=>()=>{let e=new URL(t.opts.base||"");return{host:e.hostname,port:e.port,protocol:e.protocol,pathname:e.pathname,"api-path":e.pathname}})});var rP=p((LNt,ede)=>{f();"use strict";var _ct=Xr(),{Multiaddr:Ect}=tt(),Sct=ve(),xct=Se();ede.exports=Sct(t=>{async function e(r={}){let n=await(await t.post("id",{timeout:r.timeout,signal:r.signal,searchParams:xct({arg:r.peerId?r.peerId.toString():void 0,...r}),headers:r.headers})).json(),s={..._ct(n)};return s.addresses&&(s.addresses=s.addresses.map(o=>new Ect(o))),s}return e})});var rde=p((UNt,tde)=>{f();"use strict";var Act=rP();tde.exports=t=>{let e=Act(t);async function r(i={}){let n=await e(i);return Boolean(n&&n.addresses&&n.addresses.length)}return r}});var nde=p((FNt,ide)=>{f();"use strict";var Ict=Xr(),Tct=ve(),Rct=Se();ide.exports=Tct(t=>{async function e(r,i={type:"rsa",size:2048}){let s=await(await t.post("key/gen",{timeout:i.timeout,signal:i.signal,searchParams:Rct({arg:r,...i}),headers:i.headers})).json();return Ict(s)}return e})});var ode=p((KNt,sde)=>{f();"use strict";var Pct=Xr(),Cct=ve(),Oct=Se();sde.exports=Cct(t=>{async function e(r={}){return((await(await t.post("key/list",{timeout:r.timeout,signal:r.signal,searchParams:Oct(r),headers:r.headers})).json()).Keys||[]).map(s=>Pct(s))}return e})});var cde=p((jNt,ade)=>{f();"use strict";var kct=Xr(),qct=ve(),Bct=Se();ade.exports=qct(t=>{async function e(r,i,n={}){let s=await t.post("key/rename",{timeout:n.timeout,signal:n.signal,searchParams:Bct({arg:[r,i],...n}),headers:n.headers});return kct(await s.json())}return e})});var lde=p((VNt,ude)=>{f();"use strict";var Nct=Xr(),Dct=ve(),Mct=Se();ude.exports=Dct(t=>{async function e(r,i={}){let s=await(await t.post("key/rm",{timeout:i.timeout,signal:i.signal,searchParams:Mct({arg:r,...i}),headers:i.headers})).json();return Nct(s.Keys[0])}return e})});var hde=p((zNt,fde)=>{f();"use strict";var Lct=Xr(),Uct=ve(),Fct=Se();fde.exports=Uct(t=>{async function e(r,i,n,s={}){let a=await(await t.post("key/import",{timeout:s.timeout,signal:s.signal,searchParams:Fct({arg:r,pem:i,password:n,...s}),headers:s.headers})).json();return Lct(a)}return e})});var pde=p((HNt,dde)=>{f();"use strict";var Kct=ve(),jct=ae();dde.exports=Kct(t=>async(r,i,n={})=>{throw jct(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var gde=p(($Nt,yde)=>{f();"use strict";var Vct=ve(),zct=ae();yde.exports=Vct(t=>async(r,i={})=>{throw zct(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var mde=p((GNt,bde)=>{f();"use strict";bde.exports=t=>({gen:nde()(t),list:ode()(t),rename:cde()(t),rm:lde()(t),import:hde()(t),export:pde()(t),info:gde()(t)})});var wde=p((WNt,vde)=>{f();"use strict";var Hct=ve(),$ct=Se();vde.exports=Hct(t=>{async function*e(r={}){yield*(await t.post("log/tail",{timeout:r.timeout,signal:r.signal,searchParams:$ct(r),headers:r.headers})).ndjson()}return e})});var Ede=p((YNt,_de)=>{f();"use strict";var Gct=ve(),Wct=Se();_de.exports=Gct(t=>{async function e(r={}){return(await(await t.post("log/ls",{timeout:r.timeout,signal:r.signal,searchParams:Wct(r),headers:r.headers})).json()).Strings}return e})});var xde=p((XNt,Sde)=>{f();"use strict";var Yct=Xr(),Xct=ve(),Qct=Se();Sde.exports=Xct(t=>{async function e(r,i,n={}){let s=await t.post("log/level",{timeout:n.timeout,signal:n.signal,searchParams:Qct({arg:[r,i],...n}),headers:n.headers});return Yct(await s.json())}return e})});var Ide=p((QNt,Ade)=>{f();"use strict";Ade.exports=t=>({tail:wde()(t),ls:Ede()(t),level:xde()(t)})});var Pde=p((ZNt,Rde)=>{f();"use strict";var{CID:Tde}=(Ae(),Ce),Zct=ve(),Jct=Se(),eut=tP();Rde.exports=Zct((t,e)=>{async function*r(i,n={}){let s=`${i instanceof Uint8Array?Tde.decode(i):i}`;async function o(c){let l=c.Hash;if(l.includes("/")){let h=l.startsWith("/ipfs/")?l:`/ipfs/${l}`;l=(await eut(e)(h)).cid}else l=Tde.parse(l);let u={name:c.Name,path:s+(c.Name?`/${c.Name}`:""),size:c.Size,cid:l,type:tut(c)};return c.Mode&&(u.mode=parseInt(c.Mode,8)),c.Mtime!==void 0&&c.Mtime!==null&&(u.mtime={secs:c.Mtime},c.MtimeNsecs!==void 0&&c.MtimeNsecs!==null&&(u.mtime.nsecs=c.MtimeNsecs)),u}let a=await t.post("ls",{timeout:n.timeout,signal:n.signal,searchParams:Jct({arg:s,...n}),headers:n.headers});for await(let c of a.ndjson()){if(c=c.Objects,!c)throw new Error("expected .Objects in results");if(c=c[0],!c)throw new Error("expected one array in results.Objects");let l=c.Links;if(!Array.isArray(l))throw new Error("expected one array in results.Objects[0].Links");if(!l.length){yield o(c);return}yield*l.map(o)}}return r});function tut(t){switch(t.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}});var Ode=p((JNt,Cde)=>{f();"use strict";var rut=Xr(),iut=ve(),nut=Se();Cde.exports=iut(t=>{async function e(r={}){let i=await t.post("dns",{timeout:r.timeout,signal:r.signal,searchParams:nut(r),headers:r.headers});return rut(await i.json())}return e})});var qde=p((eDt,kde)=>{f();"use strict";var sut=Xr(),out=ve(),aut=Se();kde.exports=out(t=>{async function e(r,i={}){let n=await t.post("name/publish",{timeout:i.timeout,signal:i.signal,searchParams:aut({arg:`${r}`,...i}),headers:i.headers});return sut(await n.json())}return e})});var Nde=p((tDt,Bde)=>{f();"use strict";var cut=ve(),uut=Se();Bde.exports=cut(t=>{async function*e(r,i={}){let n=await t.post("name/resolve",{timeout:i.timeout,signal:i.signal,searchParams:uut({arg:r,stream:!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield s.Path}return e})});var Mde=p((rDt,Dde)=>{f();"use strict";var lut=Xr(),fut=ve(),hut=Se();Dde.exports=fut(t=>{async function e(r,i={}){let n=await t.post("name/pubsub/cancel",{timeout:i.timeout,signal:i.signal,searchParams:hut({arg:r,...i}),headers:i.headers});return lut(await n.json())}return e})});var Ude=p((iDt,Lde)=>{f();"use strict";var dut=Xr(),put=ve(),yut=Se();Lde.exports=put(t=>{async function e(r={}){let i=await t.post("name/pubsub/state",{timeout:r.timeout,signal:r.signal,searchParams:yut(r),headers:r.headers});return dut(await i.json())}return e})});var Kde=p((nDt,Fde)=>{f();"use strict";var gut=ve(),but=Se();Fde.exports=gut(t=>{async function e(r={}){return(await(await t.post("name/pubsub/subs",{timeout:r.timeout,signal:r.signal,searchParams:but(r),headers:r.headers})).json()).Strings||[]}return e})});var Vde=p((sDt,jde)=>{f();"use strict";jde.exports=t=>({cancel:Mde()(t),state:Ude()(t),subs:Kde()(t)})});var Hde=p((oDt,zde)=>{f();"use strict";zde.exports=t=>({publish:qde()(t),resolve:Nde()(t),pubsub:Vde()(t)})});var Gde=p((aDt,$de)=>{f();"use strict";var{CID:mut}=(Ae(),Ce),vut=ve(),wut=Se();$de.exports=vut(t=>{async function e(r,i={}){let s=await(await t.post("object/data",{timeout:i.timeout,signal:i.signal,searchParams:wut({arg:`${r instanceof Uint8Array?mut.decode(r):r}`,...i}),headers:i.headers})).arrayBuffer();return new Uint8Array(s,0,s.byteLength)}return e})});var Xde=p((cDt,Yde)=>{f();"use strict";var{CID:Wde}=(Ae(),Ce),_ut=ve(),Eut=Se(),Sut=ct();Yde.exports=_ut(t=>{async function e(r,i={}){let s=await(await t.post("object/get",{timeout:i.timeout,signal:i.signal,searchParams:Eut({arg:`${r instanceof Uint8Array?Wde.decode(r):r}`,dataEncoding:"base64",...i}),headers:i.headers})).json();return{Data:Sut(s.Data,"base64pad"),Links:(s.Links||[]).map(o=>({Name:o.Name,Hash:Wde.parse(o.Hash),Tsize:o.Size}))}}return e})});var Jde=p((uDt,Zde)=>{f();"use strict";var{CID:Qde}=(Ae(),Ce),xut=ve(),Aut=Se();Zde.exports=xut(t=>{async function e(r,i={}){return((await(await t.post("object/links",{timeout:i.timeout,signal:i.signal,searchParams:Aut({arg:`${r instanceof Uint8Array?Qde.decode(r):r}`,...i}),headers:i.headers})).json()).Links||[]).map(o=>({Name:o.Name,Tsize:o.Size,Hash:Qde.parse(o.Hash)}))}return e})});var tpe=p((lDt,epe)=>{f();"use strict";var{CID:Iut}=(Ae(),Ce),Tut=ve(),Rut=Se();epe.exports=Tut(t=>{async function e(r={}){let i=await t.post("object/new",{timeout:r.timeout,signal:r.signal,searchParams:Rut({arg:r.template,...r}),headers:r.headers}),{Hash:n}=await i.json();return Iut.parse(n)}return e})});var ipe=p((fDt,rpe)=>{f();"use strict";var{CID:Put}=(Ae(),Ce),Cut=ve(),Out=Se();rpe.exports=Cut(t=>{async function e(r,i,n={}){let s=await t.post("object/patch/add-link",{timeout:n.timeout,signal:n.signal,searchParams:Out({arg:[`${r}`,i.Name||i.name||"",(i.Hash||i.cid||"").toString()||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return Put.parse(o)}return e})});var spe=p((hDt,npe)=>{f();"use strict";var{CID:kut}=(Ae(),Ce),qut=Yo(),But=ve(),Nut=Se(),Dut=Xo(),{AbortController:Mut}=sn();npe.exports=But(t=>{async function e(r,i,n={}){let s=new Mut,o=Dut(s.signal,n.signal),a=await t.post("object/patch/append-data",{timeout:n.timeout,signal:o,searchParams:Nut({arg:`${r}`,...n}),...await qut(i,s,n.headers)}),{Hash:c}=await a.json();return kut.parse(c)}return e})});var ape=p((dDt,ope)=>{f();"use strict";var{CID:Lut}=(Ae(),Ce),Uut=ve(),Fut=Se();ope.exports=Uut(t=>{async function e(r,i,n={}){let s=await t.post("object/patch/rm-link",{timeout:n.timeout,signal:n.signal,searchParams:Fut({arg:[`${r}`,i.Name||i.name||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return Lut.parse(o)}return e})});var upe=p((pDt,cpe)=>{f();"use strict";var{CID:Kut}=(Ae(),Ce),jut=Yo(),Vut=ve(),zut=Se(),Hut=Xo(),{AbortController:$ut}=sn();cpe.exports=Vut(t=>{async function e(r,i,n={}){let s=new $ut,o=Hut(s.signal,n.signal),a=await t.post("object/patch/set-data",{timeout:n.timeout,signal:o,searchParams:zut({arg:[`${r}`],...n}),...await jut(i,s,n.headers)}),{Hash:c}=await a.json();return Kut.parse(c)}return e})});var fpe=p((yDt,lpe)=>{f();"use strict";lpe.exports=t=>({addLink:ipe()(t),appendData:spe()(t),rmLink:ape()(t),setData:upe()(t)})});var dpe=p((gDt,hpe)=>{f();"use strict";var Gut=ve();hpe.exports=(t,e)=>Gut(i=>{let n=J8()(t,e);async function s(o,a={}){return n(o,{...a,format:"dag-pb",hashAlg:"sha2-256",version:0})}return s})(e)});var ype=p((bDt,ppe)=>{f();"use strict";var{CID:Wut}=(Ae(),Ce),Yut=ve(),Xut=Se();ppe.exports=Yut(t=>{async function e(r,i={}){let s=await(await t.post("object/stat",{timeout:i.timeout,signal:i.signal,searchParams:Xut({arg:`${r}`,...i}),headers:i.headers})).json();return{...s,Hash:Wut.parse(s.Hash)}}return e})});var bpe=p((mDt,gpe)=>{f();"use strict";gpe.exports=(t,e)=>({data:Gde()(e),get:Xde()(e),links:Jde()(e),new:tpe()(e),patch:fpe()(e),put:dpe()(t,e),stat:ype()(e)})});var vpe=p((vDt,mpe)=>{f();"use strict";var Qut=JE(),iP=Se(),su=class{constructor(e){this.client=new Qut(e)}static encodeEndpoint(e){let r=String(e);if(r==="undefined")throw Error("endpoint is required");return r[r.length-1]==="/"?r.slice(0,-1):r}static decodeRemoteService(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:su.decodeStat(e.Stat)}}}static decodeStat(e){switch(e.Status){case"valid":{let{Pinning:r,Pinned:i,Queued:n,Failed:s}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:r,pinned:i,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}};su.prototype.add=async function(e,r){let{endpoint:i,key:n,headers:s,timeout:o,signal:a}=r;await this.client.post("pin/remote/service/add",{timeout:o,signal:a,searchParams:iP({arg:[e,su.encodeEndpoint(i),n]}),headers:s})};su.prototype.rm=async function(e,r={}){await this.client.post("pin/remote/service/rm",{timeout:r.timeout,signal:r.signal,headers:r.headers,searchParams:iP({arg:e})})};su.prototype.ls=async function(e={}){let{stat:r,headers:i,timeout:n,signal:s}=e,o=await this.client.post("pin/remote/service/ls",{timeout:n,signal:s,headers:i,searchParams:r===!0?iP({stat:r}):void 0}),{RemoteServices:a}=await o.json();return a.map(su.decodeRemoteService)};mpe.exports=su});var Ipe=p((wDt,Ape)=>{f();"use strict";var{CID:wpe}=(Ae(),Ce),Zut=JE(),Jut=vpe(),_pe=Se(),v0=class{constructor(e){this.client=new Zut(e),this.service=new Jut(e)}};v0.prototype.add=async function(e,{timeout:r,signal:i,headers:n,...s}){let o=await this.client.post("pin/remote/add",{timeout:r,signal:i,headers:n,searchParams:elt({cid:e,...s})});return Epe(await o.json())};v0.prototype.ls=async function*({timeout:e,signal:r,headers:i,...n}){let s=await this.client.post("pin/remote/ls",{timeout:e,signal:r,headers:i,searchParams:nP(n)});for await(let o of s.ndjson())yield Epe(o)};v0.prototype.rm=async function({timeout:e,signal:r,headers:i,...n}){await this.client.post("pin/remote/rm",{timeout:e,signal:r,headers:i,searchParams:nP({...n,all:!1})})};v0.prototype.rmAll=async function({timeout:t,signal:e,headers:r,...i}){await this.client.post("pin/remote/rm",{timeout:t,signal:e,headers:r,searchParams:nP({...i,all:!0})})};var Epe=({Name:t,Status:e,Cid:r})=>({cid:wpe.parse(r),name:t,status:e}),Spe=t=>{if(typeof t=="string"&&t!=="")return t;throw new TypeError("service name must be passed")},xpe=t=>{if(t instanceof wpe)return t.toString();throw new TypeError(`CID instance expected instead of ${typeof t}`)},nP=({service:t,cid:e,name:r,status:i,all:n})=>{let s=_pe({service:Spe(t),name:r,force:n?!0:void 0});if(e)for(let o of e)s.append("cid",xpe(o));if(i)for(let o of i)s.append("status",o);return s},elt=({cid:t,service:e,background:r,name:i,origins:n})=>{let s=_pe({arg:xpe(t),service:Spe(e),name:i,background:r?!0:void 0});if(n)for(let o of n)s.append("origin",o.toString());return s};Ape.exports=v0});var sP=p((_Dt,Rpe)=>{f();"use strict";var{CID:Tpe}=(Ae(),Ce),tlt=ve(),{normaliseInput:rlt}=op(),ilt=Se();Rpe.exports=tlt(t=>{async function*e(r,i={}){for await(let{path:n,recursive:s,metadata:o}of rlt(r)){let a=await t.post("pin/add",{timeout:i.timeout,signal:i.signal,searchParams:ilt({...i,arg:n,recursive:s,metadata:o?JSON.stringify(o):void 0,stream:!0}),headers:i.headers});for await(let c of a.ndjson()){if(c.Pins){for(let l of c.Pins)yield Tpe.parse(l);continue}yield Tpe.parse(c)}}}return e})});var Cpe=p((EDt,Ppe)=>{f();"use strict";var nlt=sP(),slt=$n(),olt=ve();Ppe.exports=t=>{let e=nlt(t);return olt(()=>{async function r(i,n={}){return slt(e([{path:i,...n}],n))}return r})(t)}});var qpe=p((SDt,kpe)=>{f();"use strict";var{CID:alt}=(Ae(),Ce),clt=ve(),ult=Se();function Ope(t,e,r){let i={type:t,cid:alt.parse(e)};return r&&(i.metadata=r),i}kpe.exports=clt(t=>{async function*e(r={}){let i=[];r.paths&&(i=Array.isArray(r.paths)?r.paths:[r.paths]);let n=await t.post("pin/ls",{timeout:r.timeout,signal:r.signal,searchParams:ult({...r,arg:i.map(s=>`${s}`),stream:!0}),headers:r.headers});for await(let s of n.ndjson()){if(s.Keys){for(let o of Object.keys(s.Keys))yield Ope(s.Keys[o].Type,o,s.Keys[o].Metadata);return}yield Ope(s.Type,s.Cid,s.Metadata)}}return e})});var oP=p((xDt,Npe)=>{f();"use strict";var{CID:Bpe}=(Ae(),Ce),llt=ve(),{normaliseInput:flt}=op(),hlt=Se();Npe.exports=llt(t=>{async function*e(r,i={}){for await(let{path:n,recursive:s}of flt(r)){let o=new URLSearchParams(i.searchParams);o.append("arg",`${n}`),s!=null&&o.set("recursive",String(s));let a=await t.post("pin/rm",{timeout:i.timeout,signal:i.signal,headers:i.headers,searchParams:hlt({...i,arg:`${n}`,recursive:s})});for await(let c of a.ndjson()){if(c.Pins){yield*c.Pins.map(l=>Bpe.parse(l));continue}yield Bpe.parse(c)}}}return e})});var Mpe=p((ADt,Dpe)=>{f();"use strict";var dlt=oP(),plt=$n(),ylt=ve();Dpe.exports=t=>{let e=dlt(t);return ylt(()=>{async function r(i,n={}){return plt(e([{path:i,...n}],n))}return r})(t)}});var Upe=p((IDt,Lpe)=>{f();"use strict";var glt=Ipe();Lpe.exports=t=>({add:Cpe()(t),addAll:sP()(t),ls:qpe()(t),rm:Mpe()(t),rmAll:oP()(t),remote:new glt(t)})});var Kpe=p((TDt,Fpe)=>{f();"use strict";var blt=Xr(),mlt=ve(),vlt=Se();Fpe.exports=mlt(t=>{async function*e(r,i={}){yield*(await t.post("ping",{timeout:i.timeout,signal:i.signal,searchParams:vlt({arg:`${r}`,...i}),headers:i.headers,transform:blt})).ndjson()}return e})});var zpe=p((RDt,Vpe)=>{f();"use strict";var{AbortController:wlt}=sn(),jpe=class{constructor(){this._subs=new Map}subscribe(e,r,i){let n=this._subs.get(e)||[];if(n.find(o=>o.handler===r))throw new Error(`Already subscribed to ${e} with this handler`);let s=new wlt;return this._subs.set(e,[{handler:r,controller:s}].concat(n)),i&&i.addEventListener("abort",()=>this.unsubscribe(e,r)),s.signal}unsubscribe(e,r){let i=this._subs.get(e)||[],n;r?(this._subs.set(e,i.filter(s=>s.handler!==r)),n=i.filter(s=>s.handler===r)):(this._subs.set(e,[]),n=i),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach(s=>s.controller.abort())}};Vpe.exports=jpe});var $pe=p((PDt,Hpe)=>{f();"use strict";var _lt=ve(),Elt=Se();Hpe.exports=_lt(t=>{async function e(r={}){let{Strings:i}=await(await t.post("pubsub/ls",{timeout:r.timeout,signal:r.signal,searchParams:Elt(r),headers:r.headers})).json();return i||[]}return e})});var Wpe=p((CDt,Gpe)=>{f();"use strict";var Slt=ve(),xlt=Se();Gpe.exports=Slt(t=>{async function e(r,i={}){let n=await t.post("pubsub/peers",{timeout:i.timeout,signal:i.signal,searchParams:xlt({arg:r,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var Xpe=p((ODt,Ype)=>{f();"use strict";var Alt=ve(),Ilt=Se(),Tlt=Yo(),Rlt=Xo(),{AbortController:Plt}=sn();Ype.exports=Alt(t=>{async function e(r,i,n={}){let s=Ilt({arg:r,...n}),o=new Plt,a=Rlt(o.signal,n.signal);await(await t.post("pubsub/pub",{timeout:n.timeout,signal:a,searchParams:s,...await Tlt(i,o,n.headers)})).text()}return e})});var Zpe=p((kDt,Qpe)=>{f();"use strict";var aP=ct(),Clt=Je(),Olt=me()("ipfs-http-client:pubsub:subscribe"),klt=ve(),qlt=Se();Qpe.exports=(t,e)=>klt(r=>{async function i(n,s,o={}){o.signal=e.subscribe(n,s,o.signal);let a,c,l=new Promise((h,d)=>{a=h,c=d}),u=setTimeout(()=>a(),1e3);return r.post("pubsub/sub",{timeout:o.timeout,signal:o.signal,searchParams:qlt({arg:n,...o}),headers:o.headers}).catch(h=>{e.unsubscribe(n,s),c(h)}).then(h=>{clearTimeout(u),!!h&&(Blt(h,{onMessage:s,onEnd:()=>e.unsubscribe(n,s),onError:o.onError}),a())}),l}return i})(t);async function Blt(t,{onMessage:e,onEnd:r,onError:i}){i=i||Olt;try{for await(let n of t.ndjson())try{if(!n.from)continue;e({from:Clt(aP(n.from,"base64pad"),"base58btc"),data:aP(n.data,"base64pad"),seqno:aP(n.seqno,"base64pad"),topicIDs:n.topicIDs})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,i(s,!1,n)}}catch(n){Nlt(n)||i(n,!0)}finally{r()}}var Nlt=t=>{switch(t.type){case"aborted":return!0;case"abort":return!0;default:return t.name==="AbortError"}}});var e0e=p((qDt,Jpe)=>{f();"use strict";Jpe.exports=(t,e)=>{async function r(i,n){e.unsubscribe(i,n)}return r}});var r0e=p((BDt,t0e)=>{f();"use strict";var Dlt=zpe();t0e.exports=t=>{let e=new Dlt;return{ls:$pe()(t),peers:Wpe()(t),publish:Xpe()(t),subscribe:Zpe()(t,e),unsubscribe:e0e()(t,e)}}});var n0e=p((NDt,i0e)=>{f();"use strict";var Mlt=Xr(),Llt=ve(),Ult=Se();i0e.exports=Llt(t=>{async function*e(r={}){yield*(await t.post("refs/local",{timeout:r.timeout,signal:r.signal,transform:Mlt,searchParams:Ult(r),headers:r.headers})).ndjson()}return e})});var o0e=p((DDt,s0e)=>{f();"use strict";var{CID:Flt}=(Ae(),Ce),Klt=Xr(),jlt=ve(),Vlt=Se();s0e.exports=jlt((t,e)=>Object.assign(async function*(i,n={}){let s=Array.isArray(i)?i:[i];yield*(await t.post("refs",{timeout:n.timeout,signal:n.signal,searchParams:Vlt({arg:s.map(a=>`${a instanceof Uint8Array?Flt.decode(a):a}`),...n}),headers:n.headers,transform:Klt})).ndjson()},{local:n0e()(e)}))});var c0e=p((MDt,a0e)=>{f();"use strict";var{CID:zlt}=(Ae(),Ce),Hlt=ve(),$lt=Se();a0e.exports=Hlt(t=>{async function*e(r={}){yield*(await t.post("repo/gc",{timeout:r.timeout,signal:r.signal,searchParams:$lt(r),headers:r.headers,transform:n=>({err:n.Error?new Error(n.Error):null,cid:(n.Key||{})["/"]?zlt.parse(n.Key["/"]):null})})).ndjson()}return e})});var cP=p((LDt,u0e)=>{f();"use strict";var Glt=ve(),Wlt=Se();u0e.exports=Glt(t=>{async function e(r={}){let n=await(await t.post("repo/stat",{timeout:r.timeout,signal:r.signal,searchParams:Wlt(r),headers:r.headers})).json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}}return e})});var f0e=p((UDt,l0e)=>{f();"use strict";var Ylt=ve(),Xlt=Se();l0e.exports=Ylt(t=>{async function e(r={}){return(await(await t.post("repo/version",{timeout:r.timeout,signal:r.signal,searchParams:Xlt(r),headers:r.headers})).json()).Version}return e})});var d0e=p((FDt,h0e)=>{f();"use strict";h0e.exports=t=>({gc:c0e()(t),stat:cP()(t),version:f0e()(t)})});var y0e=p((KDt,p0e)=>{f();"use strict";var Qlt=ve(),Zlt=Se();p0e.exports=Qlt(t=>{async function e(r,i={}){let n=await t.post("resolve",{timeout:i.timeout,signal:i.signal,searchParams:Zlt({arg:r,...i}),headers:i.headers}),{Path:s}=await n.json();return s}return e})});var b0e=p((jDt,g0e)=>{f();"use strict";var Jlt=ve(),eft=ae();g0e.exports=Jlt(t=>async(r={})=>{throw eft(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var v0e=p((VDt,m0e)=>{f();"use strict";var tft=ve(),rft=Se();m0e.exports=tft(t=>{async function*e(r={}){yield*(await t.post("stats/bw",{timeout:r.timeout,signal:r.signal,searchParams:rft(r),headers:r.headers,transform:n=>({totalIn:BigInt(n.TotalIn),totalOut:BigInt(n.TotalOut),rateIn:parseFloat(n.RateIn),rateOut:parseFloat(n.RateOut)})})).ndjson()}return e})});var _0e=p((zDt,w0e)=>{f();"use strict";w0e.exports=t=>({bitswap:Q8()(t),bw:v0e()(t),repo:cP()(t)})});var S0e=p((HDt,E0e)=>{f();"use strict";var ift=ve(),nft=Se();E0e.exports=ift(t=>{async function e(r={}){await(await t.post("shutdown",{timeout:r.timeout,signal:r.signal,searchParams:nft(r),headers:r.headers})).text()}return e})});var A0e=p(($Dt,x0e)=>{f();"use strict";var{Multiaddr:sft}=tt(),oft=ve(),aft=Se();x0e.exports=oft(t=>{async function e(r={}){let i=await t.post("swarm/addrs",{timeout:r.timeout,signal:r.signal,searchParams:aft(r),headers:r.headers}),{Addrs:n}=await i.json();return Object.keys(n).map(s=>({id:s,addrs:(n[s]||[]).map(o=>new sft(o))}))}return e})});var T0e=p((GDt,I0e)=>{f();"use strict";var cft=ve(),uft=Se();I0e.exports=cft(t=>{async function e(r,i={}){let n=await t.post("swarm/connect",{timeout:i.timeout,signal:i.signal,searchParams:uft({arg:r,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var P0e=p((WDt,R0e)=>{f();"use strict";var lft=ve(),fft=Se();R0e.exports=lft(t=>{async function e(r,i={}){let n=await t.post("swarm/disconnect",{timeout:i.timeout,signal:i.signal,searchParams:fft({arg:r,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var O0e=p((YDt,C0e)=>{f();"use strict";var{Multiaddr:hft}=tt(),dft=ve(),pft=Se();C0e.exports=dft(t=>{async function e(r={}){let i=await t.post("swarm/addrs/local",{timeout:r.timeout,signal:r.signal,searchParams:pft(r),headers:r.headers}),{Strings:n}=await i.json();return(n||[]).map(s=>new hft(s))}return e})});var q0e=p((XDt,k0e)=>{f();"use strict";var{Multiaddr:yft}=tt(),gft=ve(),bft=Se();k0e.exports=gft(t=>{async function e(r={}){let i=await t.post("swarm/peers",{timeout:r.timeout,signal:r.signal,searchParams:bft(r),headers:r.headers}),{Peers:n}=await i.json();return(n||[]).map(s=>({addr:new yft(s.Addr),peer:s.Peer,muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}return e})});var N0e=p((QDt,B0e)=>{f();"use strict";B0e.exports=t=>({addrs:A0e()(t),connect:T0e()(t),disconnect:P0e()(t),localAddrs:O0e()(t),peers:q0e()(t)})});var M0e=p((ZDt,D0e)=>{f();"use strict";var mft=Xr(),vft=ve(),wft=Se();D0e.exports=vft(t=>{async function e(r={}){let i=await t.post("version",{timeout:r.timeout,signal:r.signal,searchParams:wft(r),headers:r.headers});return mft(await i.json())}return e})});var F0e=p((JDt,U0e)=>{f();"use strict";var{CID:_ft}=(Ae(),Ce),{multiaddr:Eft}=tt(),Sft=T6(),xft=L6(),Aft=V8(),Ift=z8(),Tft=H8(),Rft=(At(),xt),Pft=(Uc(),Af),{identity:L0e}=(Pc(),Ea),{bases:Cft,hashes:Oft,codecs:kft}=(Dv(),Nv);function qft(t={}){let e={name:L0e.name,code:L0e.code,encode:l=>l,decode:l=>l},r=Object.values(Cft);(t.ipld&&t.ipld.bases?t.ipld.bases:[]).forEach(l=>r.push(l));let i=new Tft({bases:r,loadBase:t.ipld&&t.ipld.loadBase}),n=Object.values(kft);[Rft,Pft,e].concat(t.ipld&&t.ipld.codecs||[]).forEach(l=>n.push(l));let s=new Aft({codecs:n,loadCodec:t.ipld&&t.ipld.loadCodec}),o=Object.values(Oft);(t.ipld&&t.ipld.hashers?t.ipld.hashers:[]).forEach(l=>o.push(l));let a=new Ift({hashers:o,loadHasher:t.ipld&&t.ipld.loadHasher});return{add:Dle()(t),addAll:X8()(t),bitswap:Hle()(t),block:efe()(t),bootstrap:hfe()(t),cat:pfe()(t),commands:gfe()(t),config:kfe()(t),dag:Yfe()(s,t),dht:lhe()(t),diag:mhe()(t),dns:whe()(t),files:Yhe()(t),get:Qhe()(t),getEndpointConfig:Jhe()(t),id:rP()(t),isOnline:rde()(t),key:mde()(t),log:Ide()(t),ls:Pde()(t),mount:Ode()(t),name:Hde()(t),object:bpe()(s,t),pin:Upe()(t),ping:Kpe()(t),pubsub:r0e()(t),refs:o0e()(t),repo:d0e()(t),resolve:y0e()(t),start:b0e()(t),stats:_0e()(t),stop:S0e()(t),swarm:N0e()(t),version:M0e()(t),bases:i,codecs:s,hashers:a}}U0e.exports={create:qft,CID:_ft,multiaddr:Eft,globSource:Sft,urlSource:xft}});var uP=p((e7t,K0e)=>{f();"use strict";var Bft=ae(),Nft=ja(),Dft=ko(),Mft=ip();function Lft(t,e){return Dft(t,r=>(e.addressBook.add(r.id,r.multiaddrs),r))}function Uft(t){let e=new Set;return Nft(t,r=>e.has(r.id.toString())?!1:(e.add(r.id.toString()),!0))}async function*Fft(t,e=1){let r=0;for await(let i of t)r++,yield i;if(r<e)throw Bft(new Error("not found"),"NOT_FOUND")}function Kft(t,e){return e?Mft(t,e):t}K0e.exports={storeAddresses:Lft,uniquePeers:Uft,requirePeers:Fft,maybeLimitSource:Kft}});var lP=p((t7t,j0e)=>{f();"use strict";var w0=new Map,jft=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function Vft(t,e,r){for(;w0.get(r);){try{await t()}catch(i){setTimeout(()=>{throw i},1);break}if(!w0.get(r))break;await new Promise(i=>{let n=setTimeout(i,e);w0.set(r,n)})}}function zft(t,e,r){r=r||e;let i=jft(),n=setTimeout(()=>{Vft(t,e,i)},r);return w0.set(i,n),i}function Hft(t){let e=w0.get(t);e&&(clearTimeout(e),w0.delete(t))}j0e.exports={setDelayedInterval:zft,clearDelayedInterval:Hft}});var Y0e=p((r7t,W0e)=>{f();"use strict";var V0e=me(),$ft=Object.assign(V0e("libp2p:peer-routing"),{error:V0e("libp2p:peer-routing:err")}),rS=ae(),{storeAddresses:z0e,uniquePeers:Gft,requirePeers:Wft}=uP(),H0e=pp(),{pipe:$0e}=Pr(),Yft=lp(),Xft=Ka(),Qft=ja(),{setDelayedInterval:Zft,clearDelayedInterval:Jft}=lP(),G0e=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(e._dht),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=Zft(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await Xft(this.getClosestPeers(this._peerId.id))}catch(e){$ft.error(e)}}stop(){Jft(this._timeoutId)}async findPeer(e,r){if(!this._routers.length)throw rS(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");if(e.toB58String()===this._peerId.toB58String())throw rS(new Error("Should not try to find self"),"ERR_FIND_SELF");let i=await $0e(H0e(...this._routers.map(n=>[n.findPeer(e,r)])),n=>Qft(n,Boolean),n=>z0e(n,this._peerStore),n=>Yft(n));if(i)return i;throw rS(new Error("not found"),"NOT_FOUND")}async*getClosestPeers(e,r={timeout:3e4}){if(!this._routers.length)throw rS(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");yield*$0e(H0e(...this._routers.map(i=>i.getClosestPeers(e,r))),i=>z0e(i,this._peerStore),i=>Gft(i),i=>Wft(i))}};W0e.exports=G0e});var Z0e=p((i7t,Q0e)=>{f();"use strict";var O1=ae(),{messages:fP,codes:hP}=bi(),{storeAddresses:eht,uniquePeers:tht,requirePeers:rht,maybeLimitSource:iht}=uP(),nht=pp(),{pipe:sht}=Pr(),X0e=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(this.dht)}async*findProviders(e,r={}){if(!this.routers.length)throw O1(new Error("No content this.routers available"),"NO_ROUTERS_AVAILABLE");yield*sht(nht(...this.routers.map(i=>i.findProviders(e,r))),i=>eht(i,this.libp2p.peerStore),i=>tht(i),i=>iht(i,r.maxNumProviders),i=>rht(i))}async provide(e){if(!this.routers.length)throw O1(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE");await Promise.all(this.routers.map(r=>r.provide(e)))}put(e,r,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw O1(new Error(fP.NOT_STARTED_YET),hP.DHT_NOT_STARTED);return this.dht.put(e,r,i)}get(e,r){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw O1(new Error(fP.NOT_STARTED_YET),hP.DHT_NOT_STARTED);return this.dht.get(e,r)}async getMany(e,r,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw O1(new Error(fP.NOT_STARTED_YET),hP.DHT_NOT_STARTED);return this.dht.getMany(e,r,i)}};Q0e.exports=X0e});var dP=p((n7t,rye)=>{f();"use strict";var oht=et(),{Multiaddr:J0e}=tt(),eye=ae(),{codes:tye}=bi();function aht(t){typeof t=="string"&&(t=new J0e(t));let e;if(J0e.isMultiaddr(t)){e=t;let r=t.getPeerId();if(!r)throw eye(new Error(`${t} does not have a valid peer type`),tye.ERR_INVALID_MULTIADDR);try{t=oht.createFromB58String(r)}catch(i){throw eye(new Error(`${t} is not a valid peer type`),tye.ERR_INVALID_MULTIADDR)}}return{id:t,multiaddrs:e?[e]:void 0}}rye.exports=aht});var nye=p((s7t,iye)=>{f();var _0=1e3,E0=_0*60,S0=E0*60,wh=S0*24,cht=wh*7,uht=wh*365.25;iye.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return lht(t);if(r==="number"&&isFinite(t))return e.long?hht(t):fht(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function lht(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*uht;case"weeks":case"week":case"w":return r*cht;case"days":case"day":case"d":return r*wh;case"hours":case"hour":case"hrs":case"hr":case"h":return r*S0;case"minutes":case"minute":case"mins":case"min":case"m":return r*E0;case"seconds":case"second":case"secs":case"sec":case"s":return r*_0;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function fht(t){var e=Math.abs(t);return e>=wh?Math.round(t/wh)+"d":e>=S0?Math.round(t/S0)+"h":e>=E0?Math.round(t/E0)+"m":e>=_0?Math.round(t/_0)+"s":t+"ms"}function hht(t){var e=Math.abs(t);return e>=wh?iS(t,e,wh,"day"):e>=S0?iS(t,e,S0,"hour"):e>=E0?iS(t,e,E0,"minute"):e>=_0?iS(t,e,_0,"second"):t+" ms"}function iS(t,e,r,i){var n=e>=r*1.5;return Math.round(t/r)+" "+i+(n?"s":"")}});var aye=p((o7t,oye)=>{f();"use strict";oye.exports=sye;var dht=nye(),kl=sye.prototype,pht=new Date%1e9;function yht(){return(Math.random()*1e9>>>0)+pht++}function sye(t){t=t||{},this.id=t.id||yht(),this.max=t.max||1/0,this.items=t.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(t.lastModified||new Date);for(var e,r,i=this.items.length;i--;)e=this.items[i],r=new Date(e.expires)-new Date,this._lookup[e.key]=e,r>0?this.expire(e.key,r):r<=0&&this.delete(e.key)}kl.has=function(t){return t in this._lookup};kl.get=function(t){if(!this.has(t))return null;var e=this._lookup[t];return e.refresh&&this.expire(t,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};kl.meta=function(t){if(!this.has(t))return null;var e=this._lookup[t];return"meta"in e?e.meta:null};kl.set=function(t,e,r){var i=this._lookup[t],n=this._lookup[t]={key:t,value:e};return this.lastModified=new Date,i?(clearTimeout(i.timeout),this.items.splice(this.items.indexOf(i),1,n)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(n),this.size++),r&&("ttl"in r&&this.expire(t,r.ttl),"meta"in r&&(n.meta=r.meta),r.refresh&&(n.refresh=r.ttl)),this};kl.delete=function(t){var e=this._lookup[t];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[t],this.size--,this):!1};kl.expire=function(t,e){var r=e||0,i=this._lookup[t];if(!i)return this;if(typeof r=="string"&&(r=dht(e)),typeof r!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),r),i.expires=Number(new Date)+r,this};kl.clear=function(){for(var t=this.items.length;t--;)this.delete(this.items[t].key);return this};kl.toJSON=function(){for(var t=new Array(this.items.length),e,r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}});var uye=p((a7t,cye)=>{f();"use strict";var{default:ght,Headers:bht}=O6();function mht({serverResolver:t,hostname:e,recordType:r}){return`${t}?name=${e}&type=${r}`}function vht(t){return ght(t,{headers:new bht({accept:"application/dns-json"})})}function wht(t,e){return`${e}_${t}`}cye.exports={buildResource:mht,fetch:vht,getCacheKey:wht}});var hye=p((c7t,fye)=>{f();"use strict";var lye=me(),nS=lye("dns-over-http-resolver");nS.error=lye("dns-over-http-resolver:error");var _ht=aye(),Qs=uye(),sS=class{constructor({maxCache:e=100}={}){this._cache=new _ht({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let r=e.length-1;r>0;r--){let i=Math.floor(Math.random()*r),n=e[r];e[r]=e[i],e[i]=n}return e}setServers(e){this._servers=e}resolve(e,r="A"){switch(r){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${r} is not supported`)}}async resolve4(e){let r="A",i=this._cache.get(Qs.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Qs.fetch(Qs.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),a=o.Answer.map(l=>l.data),c=Math.min(o.Answer.map(l=>l.TTL));return this._cache.set(Qs.getCacheKey(e,r),a,{ttl:c}),a}catch(s){nS.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolve6(e){let r="AAAA",i=this._cache.get(Qs.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Qs.fetch(Qs.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),a=o.Answer.map(l=>l.data),c=Math.min(o.Answer.map(l=>l.TTL));return this._cache.set(Qs.getCacheKey(e,r),a,{ttl:c}),a}catch(s){nS.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolveTxt(e){let r="TXT",i=this._cache.get(Qs.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Qs.fetch(Qs.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),a=o.Answer.map(l=>[l.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(l=>l.TTL));return this._cache.set(Qs.getCacheKey(e,r),a,{ttl:c}),a}catch(s){nS.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}};sS.Resolver=sS;fye.exports=sS});var pye=p((u7t,dye)=>{f();"use strict";var Eht=hye();dye.exports=Eht});var gye=p((l7t,yye)=>{f();"use strict";var Sht=Ig(),{code:xht}=Sht("dnsaddr");async function Aht(t){let e=pye(),r=new e,i=t.getPeerId(),[,n]=t.stringTuples().find(([a])=>a===xht)||[],o=(await r.resolveTxt(`_dnsaddr.${n}`)).flat().map(a=>a.split("=")[1]);return i&&(o=o.filter(a=>a.includes(i))),o}yye.exports={dnsaddrResolver:Aht}});var oS=p((f7t,bye)=>{f();"use strict";bye.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var pP=p((h7t,Iht)=>{Iht.exports={_from:"libp2p@^0.32.0",_id:"libp2p@0.32.1",_inBundle:!1,_integrity:"sha512-2kRyCPBgEAhBIjoOgboOiAmhtfDNXti+63DwVQ3WdakznZj+zn101SPV7EmLLatBq3IJkVh+tdCI0S1W46Wvyw==",_location:"/libp2p",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"libp2p@^0.32.0",name:"libp2p",escapedName:"libp2p",rawSpec:"^0.32.0",saveSpec:null,fetchSpec:"^0.32.0"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/libp2p/-/libp2p-0.32.1.tgz",_shasum:"76efbcdb6a44aceb21632186ffd5964437592487",_spec:"libp2p@^0.32.0",_where:"/Users/alex/Documents/Workspaces/ipfs/js-ipfs",browser:{"@motrix/nat-api":!1},bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},bundleDependencies:!1,contributors:[{name:"Vasco Santos",email:"vasco.santos@moxy.studio"},{name:"David Dias",email:"daviddias.p@gmail.com"},{name:"Jacob Heun",email:"jacobheun@gmail.com"},{name:"Alex Potsides",email:"alex@achingbrain.net"},{name:"Alan Shaw",email:"alan@tableflip.io"},{name:"Cayman",email:"caymannava@gmail.com"},{name:"Pedro Teixeira",email:"i@pgte.me"},{name:"Friedel Ziegelmayer",email:"dignifiedquire@gmail.com"},{name:"Maciej Kr\xFCger",email:"mkg20001@gmail.com"},{name:"Hugo Dias",email:"mail@hugodias.me"},{name:"Volker Mische",email:"volker.mische@gmail.com"},{name:"Chris Dostert",email:"chrisdostert@users.noreply.github.com"},{name:"dirkmc",email:"dirkmdev@gmail.com"},{name:"zeim839",email:"50573884+zeim839@users.noreply.github.com"},{name:"Richard Littauer",email:"richard.littauer@gmail.com"},{name:"Ryan Bell",email:"ryan@piing.net"},{name:"a1300",email:"matthias-knopp@gmx.net"},{name:"\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D",email:"victorbjelkholm@gmail.com"},{name:"Samlior",email:"samlior@foxmail.com"},{name:"Franck Royer",email:"franck@royer.one"},{name:"Thomas Eizinger",email:"thomas@eizinger.io"},{name:"Giovanni T. Parra",email:"fiatjaf@gmail.com"},{name:"acolytec3",email:"17355484+acolytec3@users.noreply.github.com"},{name:"Elven",email:"mon.samuel@qq.com"},{name:"Andrew Nesbitt",email:"andrewnez@gmail.com"},{name:"Didrik Nordstr\xF6m",email:"didrik.nordstrom@gmail.com"},{name:"RasmusErik Voel Jensen",email:"github@solsort.com"},{name:"Robert Kiel",email:"robert.kiel@hoprnet.org"},{name:"Aditya Bose",email:"13054902+adbose@users.noreply.github.com"},{name:"Smite Chow",email:"xiaopengyou@live.com"},{name:"Soeren",email:"nikorpoulsen@gmail.com"},{name:"S\xF6nke Hahn",email:"soenkehahn@gmail.com"},{name:"TJKoury",email:"TJKoury@gmail.com"},{name:"Tiago Alves",email:"alvesjtiago@gmail.com"},{name:"Yusef Napora",email:"yusef@napora.org"},{name:"Zane Starr",email:"zcstarr@gmail.com"},{name:"ebinks",email:"elizabethjbinks@gmail.com"},{name:"isan_rivkin",email:"isanrivkin@gmail.com"},{name:"mayerwin",email:"mayerwin@users.noreply.github.com"},{name:"mcclure",email:"andi.m.mcclure@gmail.com"},{name:"phillmac",email:"phillmac@users.noreply.github.com"},{name:"robertkiel",email:"robert.kiel@validitylabs.org"},{name:"shresthagrawal",email:"34920931+shresthagrawal@users.noreply.github.com"},{name:"swedneck",email:"40505480+swedneck@users.noreply.github.com"},{name:"Aleksei",email:"vozhdb@gmail.com"},{name:"Bernd Strehl",email:"bernd.strehl@gmail.com"},{name:"Chris Bratlien",email:"chrisbratlien@gmail.com"},{name:"Cindy Wu",email:"ciindy.wu@gmail.com"},{name:"Daijiro Wachi",email:"daijiro.wachi@gmail.com"},{name:"Diogo Silva",email:"fsdiogo@gmail.com"},{name:"Dmitriy Ryajov",email:"dryajov@gmail.com"},{name:"Ethan Lam",email:"elmemphis2000@gmail.com"},{name:"Fei Liu",email:"liu.feiwood@gmail.com"},{name:"Felipe Martins",email:"felipebrasil93@gmail.com"},{name:"Florian-Merle",email:"florian.david.merle@gmail.com"},{name:"Francis Gulotta",email:"wizard@roborooter.com"},{name:"Guy Sviry",email:"32539816+guysv@users.noreply.github.com"},{name:"Henrique Dias",email:"hacdias@gmail.com"},{name:"Irakli Gozalishvili",email:"rfobic@gmail.com"},{name:"Joel Gustafson",email:"joelg@mit.edu"},{name:"John Rees",email:"johnrees@users.noreply.github.com"},{name:"Jo\xE3o Santos",email:"joaosantos15@users.noreply.github.com"},{name:"Julien Bouquillon",email:"contact@revolunet.com"},{name:"Kevin Kwok",email:"antimatter15@gmail.com"},{name:"Kevin Lacker",email:"lacker@gmail.com"},{name:"Lars Gierth",email:"lgierth@users.noreply.github.com"},{name:"Marcin Tojek",email:"mtojek@users.noreply.github.com"},{name:"Michael Burns",email:"5170+mburns@users.noreply.github.com"},{name:"Miguel Mota",email:"miguelmota2@gmail.com"},{name:"Nuno Nogueira",email:"nunofmn@gmail.com"},{name:"Philipp Muens",email:"raute1337@gmx.de"}],dependencies:{"@motrix/nat-api":"^0.3.1","@vascosantos/moving-average":"^1.1.0","abort-controller":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^2.1.1","bignumber.js":"^9.0.1","class-is":"^1.1.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^6.1.1",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^5.1.1","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-take":"^1.0.0","libp2p-crypto":"^0.19.4","libp2p-interfaces":"^1.0.0","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^2.0.0","mutable-proxy":"^1.0.0","node-forge":"^0.10.0","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.15.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^1.1.1",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},deprecated:!1,description:"JavaScript implementation of libp2p, a modular peer to peer network stack",devDependencies:{"@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^0.10.1","@types/varint":"^6.0.0","abortable-iterator":"^3.0.0",aegir:"^33.1.1",buffer:"^6.0.3",delay:"^5.0.0","interop-libp2p":"^0.4.0","into-stream":"^6.0.0","ipfs-http-client":"^50.1.1","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.13.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.10.0","libp2p-floodsub":"^0.27.0","libp2p-gossipsub":"^0.10.0","libp2p-interfaces-compliance-tests":"^1.0.0","libp2p-kad-dht":"^0.23.0","libp2p-mdns":"^0.17.0","libp2p-mplex":"^0.10.1","libp2p-noise":"^4.0.0","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.23.0","libp2p-websockets":"^0.16.0",multihashes:"^4.0.2",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^11.1.1",uint8arrays:"^2.1.3",util:"^0.12.3"},engines:{node:">=14.0.0"},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use"]},files:["dist","src"],homepage:"https://libp2p.io",keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",license:"MIT",main:"src/index.js",name:"libp2p",repository:{type:"git",url:"git+https://github.com/libp2p/js-libp2p.git"},scripts:{build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:address-book":"pbts -o src/peer-store/persistent/pb/address-book.d.ts src/peer-store/persistent/pb/address-book.js","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:proto-book":"pbts -o src/peer-store/persistent/pb/proto-book.d.ts src/peer-store/persistent/pb/proto-book.js","build:proto:address-book":"pbjs -t static-module -w commonjs -r libp2p-address-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/address-book.js ./src/peer-store/persistent/pb/address-book.proto","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:proto-book":"pbjs -t static-module -w commonjs -r libp2p-proto-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/proto-book.js ./src/peer-store/persistent/pb/proto-book.proto",coverage:"nyc --reporter=text --reporter=lcov npm run test:node",lint:"aegir lint",prepare:"aegir build --no-bundle",release:"aegir release -t node -t browser","release-major":"aegir release --type major -t node -t browser","release-minor":"aegir release --type minor -t node -t browser",test:"aegir test","test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use"},types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},version:"0.32.1"}});var yP=p((d7t,k1)=>{f();"use strict";var Tht=pP().version;k1.exports.PROTOCOL_VERSION="ipfs/0.1.0";k1.exports.AGENT_VERSION=`js-libp2p/${Tht}`;k1.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";k1.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0"});var aS=p((p7t,vye)=>{f();"use strict";var mye=60*1e3;vye.exports={ADVERTISE_BOOT_DELAY:15*mye,ADVERTISE_TTL:30*mye,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var wye=p(q1=>{f();(function(){var t,e,r,i,n,s,o,a;a=function(c){var l,u,h,d;return l=(c&255<<24)>>>24,u=(c&255<<16)>>>16,h=(c&255<<8)>>>8,d=c&255,[l,u,h,d].join(".")},o=function(c){var l,u,h,d,y,g;for(l=[],h=d=0;d<=3&&c.length!==0;h=++d){if(h>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}g=e(c),y=g[0],u=g[1],c=c.substring(u),l.push(y)}if(c.length!==0)throw new Error("Invalid IP");switch(l.length){case 1:if(l[0]>4294967295)throw new Error("Invalid IP");return l[0]>>>0;case 2:if(l[0]>255||l[1]>16777215)throw new Error("Invalid IP");return(l[0]<<24|l[1])>>>0;case 3:if(l[0]>255||l[1]>255||l[2]>65535)throw new Error("Invalid IP");return(l[0]<<24|l[1]<<16|l[2])>>>0;case 4:if(l[0]>255||l[1]>255||l[2]>255||l[3]>255)throw new Error("Invalid IP");return(l[0]<<24|l[1]<<16|l[2]<<8|l[3])>>>0;default:throw new Error("Invalid IP")}},r=function(c){return c.charCodeAt(0)},i=r("0"),s=r("a"),n=r("A"),e=function(c){var l,u,h,d,y;for(d=0,l=10,u="9",h=0,c.length>1&&c[h]==="0"&&(c[h+1]==="x"||c[h+1]==="X"?(h+=2,l=16):"0"<=c[h+1]&&c[h+1]<="9"&&(h++,l=8,u="7")),y=h;h<c.length;){if("0"<=c[h]&&c[h]<=u)d=d*l+(r(c[h])-i)>>>0;else if(l===16)if("a"<=c[h]&&c[h]<="f")d=d*l+(10+r(c[h])-s)>>>0;else if("A"<=c[h]&&c[h]<="F")d=d*l+(10+r(c[h])-n)>>>0;else break;else break;if(d>4294967295)throw new Error("too large");h++}if(h===y)throw new Error("empty octet");return[d,h]},t=function(){function c(l,u){var h,d,y,g;if(typeof l!="string")throw new Error("Missing `net' parameter");if(u||(g=l.split("/",2),l=g[0],u=g[1]),u||(u=32),typeof u=="string"&&u.indexOf(".")>-1){try{this.maskLong=o(u)}catch(m){throw h=m,new Error("Invalid mask: "+u)}for(d=y=32;y>=0;d=--y)if(this.maskLong===4294967295<<32-d>>>0){this.bitmask=d;break}}else if(u||u===0)this.bitmask=parseInt(u,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(l)&this.maskLong)>>>0}catch(m){throw h=m,new Error("Invalid net address: "+l)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+u);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(l){return typeof l=="string"&&(l.indexOf("/")>0||l.split(".").length!==4)&&(l=new c(l)),l instanceof c?this.contains(l.base)&&this.contains(l.broadcast||l.last):(o(l)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(l){return l==null&&(l=1),new c(a(this.netLong+this.size*l),this.mask)},c.prototype.forEach=function(l){var u,h,d;for(d=o(this.first),h=o(this.last),u=0;d<=h;)l(a(d),d,u),u++,d++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),q1.ip2long=o,q1.long2ip=a,q1.Netmask=t}).call(q1)});var Sye=p((g7t,Eye)=>{f();var Rht=wye().Netmask,_ye=PA(),Pht=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],Cht=Pht.map(t=>new Rht(t));function Oht(t){for(let e of Cht)if(e.contains(t))return!0;return!1}function kht(t){return/^::$/.test(t)||/^::1$/.test(t)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(t)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(t)||/^ff([0-9a-fA-F]{2,2}):/i.test(t)}Eye.exports=t=>_ye.v6().test(t)?kht(t):_ye().test(t)||t.startsWith("0")?Oht(t):!1});var gP=p((b7t,xye)=>{f();"use strict";xye.exports=Sye()});var Iye=p((m7t,Aye)=>{f();"use strict";var qht=gP();function Bht(t){let{address:e}=t.nodeAddress();return qht(e)}Aye.exports=Bht});var bP=p((v7t,Rye)=>{f();"use strict";var Tye=Iye();function Nht(t,e){let r=Tye(t.multiaddr),i=Tye(e.multiaddr);return r&&!i?1:!r&&i||t.isCertified&&!e.isCertified?-1:!t.isCertified&&e.isCertified?1:0}function Dht(t){return[...t].sort(Nht)}Rye.exports.publicAddressesFirst=Dht});var Cye=p((w7t,mP)=>{f();"use strict";var Pye=async t=>{try{let e=await t;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};mP.exports=Pye;mP.exports.default=Pye});var kye=p((_7t,vP)=>{f();"use strict";var Oye=(t,...e)=>new Promise(r=>{r(t(...e))});vP.exports=Oye;vP.exports.default=Oye});var Bye=p((E7t,wP)=>{f();"use strict";var Mht=kye(),qye=t=>{if(!((Number.isInteger(t)||t===1/0)&&t>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],r=0,i=()=>{r--,e.length>0&&e.shift()()},n=(a,c,...l)=>{r++;let u=Mht(a,...l);c(u),u.then(i,i)},s=(a,c,...l)=>{r<t?n(a,c,...l):e.push(n.bind(null,a,c,...l))},o=(a,...c)=>new Promise(l=>s(a,l,...c));return Object.defineProperties(o,{activeCount:{get:()=>r},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};wP.exports=qye;wP.exports.default=qye});var Dye=p((S7t,Nye)=>{f();"use strict";var _P=Cye(),Lht=Bye();Nye.exports=async(t,e={})=>{let{concurrency:r=1/0}=e,i=Lht(r);return Promise.all(t.map(n=>n&&typeof n.then=="function"?_P(n):typeof n=="function"?_P(i(()=>n())):_P(Promise.resolve(n))))}});var Lye=p((x7t,Mye)=>{f();"use strict";function Uht(t,e){return t.length===e.length&&e.sort()&&t.sort().every((r,i)=>e[i].equals(r))}Mye.exports=Uht});var Kye=p((A7t,Fye)=>{f();"use strict";var _h=Bi(),cS=_h.Reader,Uye=_h.Writer,Qr=_h.util,Zs=_h.roots["libp2p-peer-record"]||(_h.roots["libp2p-peer-record"]={});Zs.PeerRecord=function(){function t(e){if(this.addresses=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.peerId=Qr.newBuffer([]),t.prototype.seq=Qr.Long?Qr.Long.fromBits(0,0,!0):0,t.prototype.addresses=Qr.emptyArray,t.encode=function(r,i){if(i||(i=Uye.create()),r.peerId!=null&&Object.hasOwnProperty.call(r,"peerId")&&i.uint32(10).bytes(r.peerId),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&i.uint32(16).uint64(r.seq),r.addresses!=null&&r.addresses.length)for(var n=0;n<r.addresses.length;++n)Zs.PeerRecord.AddressInfo.encode(r.addresses[n],i.uint32(26).fork()).ldelim();return i},t.decode=function(r,i){r instanceof cS||(r=cS.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Zs.PeerRecord;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.peerId=r.bytes();break;case 2:s.seq=r.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(Zs.PeerRecord.AddressInfo.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Zs.PeerRecord)return r;var i=new Zs.PeerRecord;if(r.peerId!=null&&(typeof r.peerId=="string"?Qr.base64.decode(r.peerId,i.peerId=Qr.newBuffer(Qr.base64.length(r.peerId)),0):r.peerId.length&&(i.peerId=r.peerId)),r.seq!=null&&(Qr.Long?(i.seq=Qr.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?i.seq=parseInt(r.seq,10):typeof r.seq=="number"?i.seq=r.seq:typeof r.seq=="object"&&(i.seq=new Qr.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var n=0;n<r.addresses.length;++n){if(typeof r.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[n]=Zs.PeerRecord.AddressInfo.fromObject(r.addresses[n])}}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addresses=[]),i.defaults)if(i.bytes===String?n.peerId="":(n.peerId=[],i.bytes!==Array&&(n.peerId=Qr.newBuffer(n.peerId))),Qr.Long){var s=new Qr.Long(0,0,!0);n.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.seq=i.longs===String?"0":0;if(r.peerId!=null&&r.hasOwnProperty("peerId")&&(n.peerId=i.bytes===String?Qr.base64.encode(r.peerId,0,r.peerId.length):i.bytes===Array?Array.prototype.slice.call(r.peerId):r.peerId),r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?n.seq=i.longs===String?String(r.seq):r.seq:n.seq=i.longs===String?Qr.Long.prototype.toString.call(r.seq):i.longs===Number?new Qr.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.addresses&&r.addresses.length){n.addresses=[];for(var o=0;o<r.addresses.length;++o)n.addresses[o]=Zs.PeerRecord.AddressInfo.toObject(r.addresses[o],i)}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,_h.util.toJSONOptions)},t.AddressInfo=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.multiaddr=Qr.newBuffer([]),e.encode=function(i,n){return n||(n=Uye.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),n},e.decode=function(i,n){i instanceof cS||(i=cS.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Zs.PeerRecord.AddressInfo;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Zs.PeerRecord.AddressInfo)return i;var n=new Zs.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?Qr.base64.decode(i.multiaddr,n.multiaddr=Qr.newBuffer(Qr.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=Qr.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?Qr.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,_h.util.toJSONOptions)},e}(),t}();Fye.exports=Zs});var Vye=p((I7t,jye)=>{f();"use strict";var Fht="libp2p-peer-record",Kht=Uint8Array.from([3,1]);jye.exports={ENVELOPE_DOMAIN_PEER_RECORD:Fht,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:Kht}});var uS=p((T7t,$ye)=>{f();"use strict";var{Multiaddr:jht}=tt(),Vht=et(),zht=Lye(),{PeerRecord:zye}=Kye(),{ENVELOPE_DOMAIN_PEER_RECORD:Hye,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:Hht}=Vye(),Eh=class{constructor({peerId:e,multiaddrs:r=[],seqNumber:i=Date.now()}){this.domain=Hye,this.codec=Hht,this.peerId=e,this.multiaddrs=r,this.seqNumber=i,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=zye.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof Eh)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!zht(this.multiaddrs,e.multiaddrs))}};Eh.createFromProtobuf=t=>{let e=zye.decode(t),r=Vht.createFromBytes(e.peerId),i=(e.addresses||[]).map(s=>new jht(s.multiaddr)),n=Number(e.seq);return new Eh({peerId:r,multiaddrs:i,seqNumber:n})};Eh.DOMAIN=Hye;$ye.exports=Eh});var EP=p((R7t,Gye)=>{f();"use strict";var $ht=P1(),Ght=uS();async function Wht(t){let e=new Ght({peerId:t.peerId,multiaddrs:t.multiaddrs}),r=await $ht.seal(e,t.peerId);t.peerStore.addressBook.consumePeerRecord(r)}Gye.exports.updateSelfPeerRecord=Wht});var xP=p((P7t,Xye)=>{f();"use strict";var Wye=me(),Sh=Object.assign(Wye("libp2p:transports"),{error:Wye("libp2p:transports:err")}),Yht=Dye(),{codes:x0}=bi(),B1=ae(),{updateSelfPeerRecord:Yye}=EP(),SP=class{constructor({libp2p:e,upgrader:r,faultTolerance:i=lS.FATAL_ALL}){this.libp2p=e,this.upgrader=r,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=i}add(e,r,i={}){if(Sh("adding %s",e),!e)throw B1(new Error(`Transport must have a valid key, was given '${e}'`),x0.ERR_INVALID_KEY);if(this._transports.has(e))throw B1(new Error("There is already a transport with this key"),x0.ERR_DUPLICATE_TRANSPORT);let n=new r({...i,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,n),this._listenerOptions.set(e,i.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[r,i]of this._listeners)for(Sh("closing listeners for %s",r);i.length;){let n=i.pop();n.removeAllListeners("listening"),n.removeAllListeners("close"),e.push(n.close())}await Promise.all(e),Sh("all listeners closed");for(let r of this._listeners.keys())this._listeners.set(r,[])}async dial(e,r){let i=this.transportForMultiaddr(e);if(!i)throw B1(new Error(`No transport available for address ${String(e)}`),x0.ERR_TRANSPORT_UNAVAILABLE);try{return await i.dial(e,r)}catch(n){throw n.code||(n.code=x0.ERR_TRANSPORT_DIAL_FAILED),n}}getAddrs(){let e=[];for(let r of this._listeners.values())for(let i of r)e=[...e,...i.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let r of this._transports.values())if(r.filter([e]).length)return r;return null}async listen(e){if(!e||e.length===0){Sh("no addresses were provided for listening, this node is dial only");return}let r=[];for(let[i,n]of this._transports.entries()){let s=n.filter(e),o=[];for(let l of s){Sh("creating listener for %s on %s",i,l);let u=n.createListener(this._listenerOptions.get(i));this._listeners.get(i).push(u),u.on("listening",()=>Yye(this.libp2p)),u.on("close",()=>Yye(this.libp2p)),o.push(u.listen(l))}if(o.length===0){r.push(i);continue}if(!(await Yht(o)).find(l=>l.isFulfilled===!0)&&this.faultTolerance!==lS.NO_FATAL)throw B1(new Error(`Transport (${i}) could not listen on any available address`),x0.ERR_NO_VALID_ADDRESSES)}if(r.length===this._transports.size){let i=`no valid addresses were provided for transports [${r}]`;if(this.faultTolerance===lS.FATAL_ALL)throw B1(new Error(i),x0.ERR_NO_VALID_ADDRESSES);Sh(`libp2p in dial mode only: ${i}`)}}async remove(e){if(Sh("removing %s",e),this._listeners.has(e))for(let r of this._listeners.get(e))r.removeAllListeners("listening"),r.removeAllListeners("close"),await r.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let r of this._transports.keys())e.push(this.remove(r));await Promise.all(e)}},lS={FATAL_ALL:0,NO_FATAL:1};SP.FaultTolerance=lS;Xye.exports=SP});var Jye=p((C7t,Zye)=>{f();"use strict";var Xht=wr(),{dnsaddrResolver:Qht}=gye(),AP=oS(),{AGENT_VERSION:Zht}=yP(),Qye=aS(),{publicAddressesFirst:Jht}=bP(),{FaultTolerance:edt}=xP(),tdt={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:t=>t},connectionManager:{minConnections:25},transportManager:{faultTolerance:edt.FATAL_ALL},dialer:{maxParallelDials:AP.MAX_PARALLEL_DIALS,maxDialsPerPeer:AP.MAX_PER_PEER_DIALS,dialTimeout:AP.DIAL_TIMEOUT,resolvers:{dnsaddr:Qht},addressSorter:Jht},host:{agentVersion:Zht},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{dht:{enabled:!1,kBucketSize:20,randomWalk:{enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:Qye.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:Qye.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};Zye.exports.validate=t=>{let e=Xht(tdt,t);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var rge=p((O7t,tge)=>{f();"use strict";var{EventEmitter:rdt}=vr(),{Multiaddr:N1}=tt(),idt=et(),ege=class extends rdt{constructor(e,{listen:r=[],announce:i=[]}={}){super();this.peerId=e,this.listen=new Set(r.map(n=>n.toString())),this.announce=new Set(i.map(n=>n.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new N1(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new N1(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new N1(e))}addObservedAddr(e){let r=new N1(e),i=r.getPeerId();i&&idt.createFromB58String(i).equals(this.peerId)&&(r=r.decapsulate(new N1(`/p2p/${this.peerId}`)));let n=r.toString();this.observed.has(n)||(this.observed.add(n),this.emit("change:addresses"))}};tge.exports=ege});var sge=p((k7t,nge)=>{f();"use strict";var{EventEmitter:ndt}=vr(),IP=me()("latency-monitor:VisibilityChangeEmitter"),ige=class extends ndt{constructor(){super();if(typeof document=="undefined"){IP('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,r;typeof document.hidden!="undefined"?(e="hidden",r="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",r="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",r="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",r="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=r}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?IP("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];IP(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};nge.exports=ige});var cge=p((q7t,age)=>{f();"use strict";var{EventEmitter:sdt}=vr(),odt=sge(),ou=me()("latency-monitor:LatencyMonitor"),oge=class extends sdt{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:r,asyncTestFn:i,latencyRandomPercentage:n}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=n||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=r===null||r===0?void 0:r||5*1e3,ou("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?ou("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):ou("Not emitting summaries"),s.asyncTestFn=i}start(){globalThis.process&&globalThis.process.hrtime?(ou("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let r=this.now(e);return r[0]*1e3+r[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(ou("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(ou("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),adt()&&(this._visibilityChangeEmitter=new odt,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),ou("Summary: %O",e),e}_checkLatency(){let e=this,r=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,i={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+r),startTime:e.now()},n=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(i.startTime)-i.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,ou("MS: %s Data: %O",s,e._latencyData)};ou("localData: %O",i),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(i.deltaOffset=0,i.startTime=e.now(),e.asyncTestFn(n)):(i.deltaOffset-=1,n())},i.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function adt(){return typeof window!="undefined"}age.exports=oge});var lge=p((B7t,uge)=>{f();"use strict";uge.exports=function(){return Date.now()}});var TP=p((N7t,hge)=>{f();"use strict";var fS=lge(),fge=class{constructor(e,r,i){let n=this;this._started=fS(),this._rescheduled=0,this._scheduled=r,this._args=i,this._triggered=!1,this._timerWrapper=()=>{n._rescheduled>0?(n._scheduled=n._rescheduled-(fS()-n._started),n._schedule(n._scheduled)):(n._triggered=!0,e.apply(null,n._args))},this._timer=setTimeout(this._timerWrapper,r)}reschedule(e){e||(e=this._scheduled);let r=fS();r+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=r,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=fS(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function cdt(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new fge(arguments[0],arguments[1],t)}hge.exports=cdt});var mge=p((D7t,bge)=>{f();"use strict";var dge=me(),Qo=Object.assign(dge("libp2p:connection-manager"),{error:dge("libp2p:connection-manager:err")}),pge=ae(),udt=wr(),ldt=cge(),hS=TP(),{EventEmitter:fdt}=vr(),hdt=et(),{codes:{ERR_INVALID_PARAMETERS:yge}}=bi(),ddt={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},gge=class extends fdt{constructor(e,r={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=udt.call({ignoreUndefined:!0},ddt,r),this._options.maxConnections<this._options.minConnections)throw pge(new Error("Connection Manager maxConnections must be greater than minConnections"),yge);Qo("options: %j",this._options),this._peerValues=new Map,this.connections=new Map,this._started=!1,this._timer=null,this._autoDialTimeout=null,this._checkMetrics=this._checkMetrics.bind(this),this._autoDial=this._autoDial.bind(this),this._latencyMonitor=new ldt({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval})}get size(){return Array.from(this.connections.values()).reduce((e,r)=>e+r.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||hS(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,Qo("started"),this._options.autoDial&&this._autoDial()}async stop(){this._autoDialTimeout&&this._autoDialTimeout.clear(),this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),Qo("stopped")}async _close(){let e=[];for(let r of this.connections.values())for(let i of r)e.push(i.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,r){if(r<0||r>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),r)}_checkMetrics(){if(this._libp2p.metrics){let e=this._libp2p.metrics.global.movingAverages,r=e.dataReceived[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxReceivedData",r);let i=e.dataSent[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxSentData",i);let n=r+i;this._checkMaxLimit("maxData",n),Qo("metrics update",n),this._timer=hS(this._checkMetrics,this._options.pollInterval)}}onConnect(e){let r=e.remotePeer,i=r.toB58String(),n=this.connections.get(i);this.emit("peer:connect",e),n?n.push(e):this.connections.set(i,[e]),this._libp2p.peerStore.keyBook.set(r,r.pubKey),this._peerValues.has(i)||this._peerValues.set(i,this._options.defaultPeerValue),this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){let r=e.remotePeer.toB58String(),i=this.connections.get(r);i&&i.length>1?(i=i.filter(n=>n.id!==e.id),this.connections.set(r,i)):i&&(this.connections.delete(r),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e))}get(e){let r=this.getAll(e);return r.length?r[0]:null}getAll(e){if(!hdt.isPeerId(e))throw pge(new Error("peerId must be an instance of peer-id"),yge);let r=e.toB58String(),i=this.connections.get(r);return i?i.filter(n=>n.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs)}_checkMaxLimit(e,r){let i=this._options[e];Qo("checking limit of %s. current value: %d of %d",e,r,i),r>i&&(Qo("%s: limit exceeded: %s, %d",this._peerId,e,r),this._maybeDisconnectOne())}async _autoDial(){let e=this._options.minConnections;if(this.size>=e){this._autoDialTimeout=hS(this._autoDial,this._options.autoDialInterval);return}let r=Array.from(this._libp2p.peerStore.peers.values()).sort((i,n)=>n.protocols&&n.protocols.length&&(!i.protocols||!i.protocols.length)||n.id.pubKey&&!i.id.pubKey?1:-1);for(let i=0;i<r.length&&this.size<e;i++)if(!this.get(r[i].id)){Qo("connecting to a peerStore stored peer %s",r[i].id.toB58String());try{if(await this._libp2p.dialer.connectToPeer(r[i].id),!this._started)return}catch(n){Qo.error("could not connect to peerStore stored peer",n)}}this._autoDialTimeout=hS(this._autoDial,this._options.autoDialInterval)}_maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((i,n)=>i[1]-n[1])));Qo("%s: sorted peer values: %j",this._peerId,e);let r=e[0];if(r){let i=r[0];Qo("%s: lowest value peer is %s",this._peerId,i),Qo("%s: closing a connection to %j",this._peerId,i);for(let n of this.connections.values())if(n[0].remotePeer.toB58String()===i){n[0].close();break}}}}};bge.exports=gge});var A0=p((M7t,wge)=>{f();"use strict";var xh=Bi(),dS=xh.Reader,vge=xh.Writer,Js=xh.util,$i=xh.roots["libp2p-circuit"]||(xh.roots["libp2p-circuit"]={});$i.CircuitRelay=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.type=1,t.prototype.srcPeer=null,t.prototype.dstPeer=null,t.prototype.code=100,t.encode=function(r,i){return i||(i=vge.create()),r.type!=null&&Object.hasOwnProperty.call(r,"type")&&i.uint32(8).int32(r.type),r.srcPeer!=null&&Object.hasOwnProperty.call(r,"srcPeer")&&$i.CircuitRelay.Peer.encode(r.srcPeer,i.uint32(18).fork()).ldelim(),r.dstPeer!=null&&Object.hasOwnProperty.call(r,"dstPeer")&&$i.CircuitRelay.Peer.encode(r.dstPeer,i.uint32(26).fork()).ldelim(),r.code!=null&&Object.hasOwnProperty.call(r,"code")&&i.uint32(32).int32(r.code),i},t.decode=function(r,i){r instanceof dS||(r=dS.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new $i.CircuitRelay;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.type=r.int32();break;case 2:s.srcPeer=$i.CircuitRelay.Peer.decode(r,r.uint32());break;case 3:s.dstPeer=$i.CircuitRelay.Peer.decode(r,r.uint32());break;case 4:s.code=r.int32();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof $i.CircuitRelay)return r;var i=new $i.CircuitRelay;switch(r.type){case"HOP":case 1:i.type=1;break;case"STOP":case 2:i.type=2;break;case"STATUS":case 3:i.type=3;break;case"CAN_HOP":case 4:i.type=4;break}if(r.srcPeer!=null){if(typeof r.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");i.srcPeer=$i.CircuitRelay.Peer.fromObject(r.srcPeer)}if(r.dstPeer!=null){if(typeof r.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");i.dstPeer=$i.CircuitRelay.Peer.fromObject(r.dstPeer)}switch(r.code){case"SUCCESS":case 100:i.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:i.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:i.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:i.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:i.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:i.code=260;break;case"HOP_CANT_DIAL_DST":case 261:i.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:i.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:i.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:i.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:i.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:i.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:i.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:i.code=351;break;case"STOP_RELAY_REFUSED":case 390:i.code=390;break;case"MALFORMED_MESSAGE":case 400:i.code=400;break}return i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.type=i.enums===String?"HOP":1,n.srcPeer=null,n.dstPeer=null,n.code=i.enums===String?"SUCCESS":100),r.type!=null&&r.hasOwnProperty("type")&&(n.type=i.enums===String?$i.CircuitRelay.Type[r.type]:r.type),r.srcPeer!=null&&r.hasOwnProperty("srcPeer")&&(n.srcPeer=$i.CircuitRelay.Peer.toObject(r.srcPeer,i)),r.dstPeer!=null&&r.hasOwnProperty("dstPeer")&&(n.dstPeer=$i.CircuitRelay.Peer.toObject(r.dstPeer,i)),r.code!=null&&r.hasOwnProperty("code")&&(n.code=i.enums===String?$i.CircuitRelay.Status[r.code]:r.code),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,xh.util.toJSONOptions)},t.Status=function(){var e={},r=Object.create(e);return r[e[100]="SUCCESS"]=100,r[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,r[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,r[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,r[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,r[e[260]="HOP_NO_CONN_TO_DST"]=260,r[e[261]="HOP_CANT_DIAL_DST"]=261,r[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,r[e[270]="HOP_CANT_SPEAK_RELAY"]=270,r[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,r[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,r[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,r[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,r[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,r[e[390]="STOP_RELAY_REFUSED"]=390,r[e[400]="MALFORMED_MESSAGE"]=400,r}(),t.Type=function(){var e={},r=Object.create(e);return r[e[1]="HOP"]=1,r[e[2]="STOP"]=2,r[e[3]="STATUS"]=3,r[e[4]="CAN_HOP"]=4,r}(),t.Peer=function(){function e(r){if(this.addrs=[],r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.id=Js.newBuffer([]),e.prototype.addrs=Js.emptyArray,e.encode=function(i,n){if(n||(n=vge.create()),n.uint32(10).bytes(i.id),i.addrs!=null&&i.addrs.length)for(var s=0;s<i.addrs.length;++s)n.uint32(18).bytes(i.addrs[s]);return n},e.decode=function(i,n){i instanceof dS||(i=dS.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new $i.CircuitRelay.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.id=i.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(i.bytes());break;default:i.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw Js.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(i){if(i instanceof $i.CircuitRelay.Peer)return i;var n=new $i.CircuitRelay.Peer;if(i.id!=null&&(typeof i.id=="string"?Js.base64.decode(i.id,n.id=Js.newBuffer(Js.base64.length(i.id)),0):i.id.length&&(n.id=i.id)),i.addrs){if(!Array.isArray(i.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");n.addrs=[];for(var s=0;s<i.addrs.length;++s)typeof i.addrs[s]=="string"?Js.base64.decode(i.addrs[s],n.addrs[s]=Js.newBuffer(Js.base64.length(i.addrs[s])),0):i.addrs[s].length&&(n.addrs[s]=i.addrs[s])}return n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addrs=[]),n.defaults&&(n.bytes===String?s.id="":(s.id=[],n.bytes!==Array&&(s.id=Js.newBuffer(s.id)))),i.id!=null&&i.hasOwnProperty("id")&&(s.id=n.bytes===String?Js.base64.encode(i.id,0,i.id.length):n.bytes===Array?Array.prototype.slice.call(i.id):i.id),i.addrs&&i.addrs.length){s.addrs=[];for(var o=0;o<i.addrs.length;++o)s.addrs[o]=n.bytes===String?Js.base64.encode(i.addrs[o],0,i.addrs[o].length):n.bytes===Array?Array.prototype.slice.call(i.addrs[o]):i.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,xh.util.toJSONOptions)},e}(),t}();wge.exports=$i});var Sge=p((L7t,Ege)=>{f();"use strict";var{source:_ge}=ic(),pdt=me(),ydt=pdt("libp2p:stream:converter");function gdt({stream:t,remoteAddr:e,localAddr:r},i={}){let{sink:n,source:s}=t,o={async sink(c){i.signal&&(c=_ge(c,i.signal));try{await n(c)}catch(l){l.type!=="aborted"&&ydt(l)}a()},source:i.signal?_ge(s,i.signal):s,conn:t,localAddr:r,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return n(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}Ege.exports=gdt});var D1=p((U7t,xge)=>{f();"use strict";xge.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var Ige=p((F7t,Age)=>{f();"use strict";var{EventEmitter:bdt}=vr(),{Multiaddr:mdt}=tt();Age.exports=t=>{let e=new Map;async function r(s){let o=String(s).split("/p2p-circuit").find(l=>l!==""),a=await t.dial(new mdt(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),n.emit("listening")}function i(){let s=[];for(let o of e.values())s.push(o);return s}let n=Object.assign(new bdt,{close:()=>Promise.resolve(),listen:r,getAddrs:i});return t.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&n.emit("close")}),n}});var RP=p((K7t,Pge)=>{f();"use strict";var{Multiaddr:Tge}=tt(),{CircuitRelay:Ah}=A0();function Rge(t,e){t.write({type:Ah.Type.STATUS,code:e})}function vdt(t,e){try{t.dstPeer&&t.dstPeer.addrs&&t.dstPeer.addrs.forEach(r=>new Tge(r))}catch(r){throw Rge(e,t.type===Ah.Type.HOP?Ah.Status.HOP_DST_MULTIADDR_INVALID:Ah.Status.STOP_DST_MULTIADDR_INVALID),r}try{t.srcPeer&&t.srcPeer.addrs&&t.srcPeer.addrs.forEach(r=>new Tge(r))}catch(r){throw Rge(e,t.type===Ah.Type.HOP?Ah.Status.HOP_SRC_MULTIADDR_INVALID:Ah.Status.STOP_SRC_MULTIADDR_INVALID),r}}Pge.exports={validateAddrs:vdt}});var I0=p((j7t,Cge)=>{f();"use strict";var wdt=G_(),_dt=za(),Edt=nl();Cge.exports=t=>{let e=_dt(),r=wdt(t.source),i=Edt(),n,s=t.sink(async function*(){yield*e,yield*await i.promise}());return s.catch(a=>{n=a}),{reader:r,writer:e,stream:{sink:a=>n?Promise.reject(n):(i.resolve(a),s),source:r},rest:()=>e.end(),write:e.push,read:async()=>(await r.next()).value}}});var yS=p((V7t,Nge)=>{f();"use strict";var Oge=me(),pS=Object.assign(Oge("libp2p:circuit:stream-handler"),{error:Oge("libp2p:circuit:stream-handler:err")}),kge=$o(),Sdt=I0(),{CircuitRelay:qge}=A0(),Bge=class{constructor({stream:e,maxLength:r=4096}){this.stream=e,this.shake=Sdt(this.stream),this.decoder=kge.decode.fromReader(this.shake.reader,{maxDataLength:r})}async read(){let e=await this.decoder.next();if(e.value){let r=qge.decode(e.value.slice());return pS("read message type",r.type),r}pS("read received no value, closing stream"),this.close()}write(e){pS("write message type %s",e.type),this.shake.write(kge.encode.single(qge.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){pS("closing the stream"),this.rest().sink([])}};Nge.exports=Bge});var OP=p((z7t,CP)=>{f();"use strict";var Dge=me(),M1=Object.assign(Dge("libp2p:circuit:stop"),{error:Dge("libp2p:circuit:stop:err")}),{CircuitRelay:PP}=A0(),xdt=D1(),Adt=yS(),{validateAddrs:Idt}=RP();CP.exports.handleStop=function({connection:e,request:r,streamHandler:i}){try{Idt(r,i)}catch(n){return M1.error("invalid stop request via peer %s",e.remotePeer.toB58String(),n)}return M1("stop request is valid"),i.write({type:PP.Type.STATUS,code:PP.Status.SUCCESS}),i.rest()};CP.exports.stop=async function({connection:e,request:r}){let{stream:i}=await e.newStream([xdt.relay]);M1("starting stop request to %s",e.remotePeer.toB58String());let n=new Adt({stream:i});n.write(r);let s=await n.read();if(!s)return n.close();if(s.code===PP.Status.SUCCESS)return M1("stop request to %s was successful",e.remotePeer.toB58String()),n.rest();M1("stop request failed with code %d",s.code),n.close()}});var kP=p((H7t,jge)=>{f();"use strict";var Mge=me(),au=Object.assign(Mge("libp2p:circuit:hop"),{error:Mge("libp2p:circuit:hop:err")}),Lge=ae(),Tdt=et(),{validateAddrs:Rdt}=RP(),Uge=yS(),{CircuitRelay:gs}=A0(),{pipe:Pdt}=Pr(),{codes:Fge}=bi(),{stop:Cdt}=OP(),Kge=D1();async function Odt({connection:t,request:e,streamHandler:r,circuit:i}){if(!i._options.hop.enabled)return au("HOP request received but we are not acting as a relay"),r.end({type:gs.Type.STATUS,code:gs.Status.HOP_CANT_SPEAK_RELAY});try{Rdt(e,r)}catch(l){return au.error("invalid hop request via peer %s",t.remotePeer.toB58String(),l)}if(!e.dstPeer){au("HOP request received but we do not receive a dstPeer");return}let n=new Tdt(e.dstPeer.id),s=i._connectionManager.get(n);if(!s&&!i._options.hop.active)return au("HOP request received but we are not connected to the destination peer"),r.end({type:gs.Type.STATUS,code:gs.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:gs.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await Cdt({connection:s,request:o})}catch(l){return au.error(l)}au("hop request from %s is valid",t.remotePeer.toB58String()),r.write({type:gs.Type.STATUS,code:gs.Status.SUCCESS});let c=r.rest();return Pdt(c,a,c)}async function kdt({connection:t,request:e}){let{stream:r}=await t.newStream([Kge.relay]),i=new Uge({stream:r});i.write(e);let n=await i.read();if(!n)throw Lge(new Error("HOP request had no response"),Fge.ERR_HOP_REQUEST_FAILED);if(n.code===gs.Status.SUCCESS)return au("hop request was successful"),i.rest();throw au("hop request failed with code %d, closing stream",n.code),i.close(),Lge(new Error(`HOP request failed with code ${n.code}`),Fge.ERR_HOP_REQUEST_FAILED)}async function qdt({connection:t}){let{stream:e}=await t.newStream([Kge.relay]),r=new Uge({stream:e});r.write({type:gs.Type.CAN_HOP});let i=await r.read();return await r.close(),!(!i||i.code!==gs.Status.SUCCESS)}function Bdt({connection:t,streamHandler:e,circuit:r}){let i=r._options.hop.enabled;au("can hop (%s) request from %s",i,t.remotePeer.toB58String()),e.end({type:gs.Type.STATUS,code:i?gs.Status.SUCCESS:gs.Status.HOP_CANT_SPEAK_RELAY})}jge.exports={handleHop:Odt,hop:kdt,canHop:qdt,handleCanHop:Bdt}});var Wge=p(($7t,Gge)=>{f();"use strict";var Vge=me(),cu=Object.assign(Vge("libp2p:circuit"),{error:Vge("libp2p:circuit:err")}),Ndt=ae(),Ddt=Sf(),{Multiaddr:L1}=tt(),zge=et(),{CircuitRelay:U1}=A0(),{codes:Mdt}=bi(),Hge=Sge(),{relay:Ldt}=D1(),Udt=Ige(),{handleCanHop:Fdt,handleHop:Kdt,hop:jdt}=kP(),{handleStop:Vdt}=OP(),zdt=yS(),Hdt=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),$ge=class{constructor({libp2p:e,upgrader:r}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=r,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(Ldt,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:r}){let i=new zdt({stream:r}),n=await i.read();if(!n)return;let s=this,o;switch(n.type){case U1.Type.CAN_HOP:{cu("received CAN_HOP request from %s",e.remotePeer.toB58String()),await Fdt({circuit:s,connection:e,streamHandler:i});break}case U1.Type.HOP:{cu("received HOP request from %s",e.remotePeer.toB58String()),o=await Kdt({connection:e,request:n,streamHandler:i,circuit:s});break}case U1.Type.STOP:{cu("received STOP request from %s",e.remotePeer.toB58String()),o=await Vdt({connection:e,request:n,streamHandler:i});break}default:cu("Request of type %s not supported",n.type)}if(o){let a=new L1(n.dstPeer.addrs[0]),c=new L1(n.srcPeer.addrs[0]),l=Hge({stream:o,remoteAddr:a,localAddr:c}),u=n.type===U1.Type.HOP?"relay":"inbound";cu("new %s connection %s",u,l.remoteAddr);let h=await this._upgrader.upgradeInbound(l);cu("%s connection %s upgraded",u,l.remoteAddr),this.handler&&this.handler(h)}}async dial(e,r){let i=e.toString().split("/p2p-circuit"),n=new L1(i[0]),s=new L1(i[i.length-1]),o=n.getPeerId(),a=s.getPeerId();if(!o||!a){let d="Circuit relay dial failed as addresses did not have peer id";throw cu.error(d),Ndt(new Error(d),Mdt.ERR_RELAYED_DIAL)}let c=zge.createFromB58String(o),l=zge.createFromB58String(a),u=!1,h=this._connectionManager.get(c);h||(h=await this._dialer.connectToPeer(n,r),u=!0);try{let d=await jdt({connection:h,request:{type:U1.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(m=>m.bytes)},dstPeer:{id:l.toBytes(),addrs:[new L1(s).bytes]}}}),y=n.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),g=Hge({stream:d,remoteAddr:e,localAddr:y});return cu("new outbound connection %s",g.remoteAddr),this._upgrader.upgradeOutbound(g)}catch(d){throw cu.error("Circuit relay dial failed",d),u&&await h.close(),d}}createListener(e,r){return typeof e=="function"&&(r=e,e={}),this.handler=r,Udt(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>Ddt.Circuit.matches(r))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[Hdt])}};Gge.exports=$ge});var qP=p((G7t,Yge)=>{f();"use strict";var{CID:$dt}=(Ae(),Ce),{sha256:Gdt}=(ai(),$r);Yge.exports.namespaceToCid=async t=>{let e=new TextEncoder().encode(t),r=await Gdt.digest(e);return $dt.createV0(r)}});var rbe=p((W7t,tbe)=>{f();"use strict";var Xge=me(),Qge=Object.assign(Xge("libp2p:auto-relay"),{error:Xge("libp2p:auto-relay:err")}),Wdt=ct(),Ydt=Je(),{Multiaddr:Xdt}=tt(),Qdt=et(),{relay:Zdt}=D1(),{canHop:Jdt}=kP(),{namespaceToCid:ept}=qP(),{CIRCUIT_PROTO_CODE:tpt,HOP_METADATA_KEY:Zge,HOP_METADATA_VALUE:Jge,RELAY_RENDEZVOUS_NS:rpt}=aS(),ebe=class{constructor({libp2p:e,maxListeners:r=1,onError:i}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=r,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(n,s)=>{Qge.error(s||n),i&&i(n,s)}}async _onProtocolChange({peerId:e,protocols:r}){let i=e.toB58String(),n=r.find(s=>s===Zdt);if(!n&&this._listenRelays.has(i)){this._removeListenRelay(i);return}else if(!n||this._listenRelays.has(i))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(tpt)){Qge(`relayed connection to ${i} will not be used to hop on`);return}await Jdt({connection:s})&&(this._peerStore.metadataBook.set(e,Zge,Wdt(Jge)),await this._addListenRelay(s,i))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let i=e.remotePeer.toB58String();!this._listenRelays.has(i)||this._removeListenRelay(i)}async _addListenRelay(e,r){if(this._listenRelays.size>=this.maxListeners)return;let i=this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);if(!i||!i.length)return;let n=`${i[0].toString()}/p2p-circuit`;this._listenRelays.add(r);try{await this._transportManager.listen([new Xdt(n)])}catch(s){this._onError(s),this._listenRelays.delete(r)}}_removeListenRelay(e){this._listenRelays.delete(e)&&this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let r=[];for(let[i,n]of this._peerStore.metadataBook.data.entries()){if(this._listenRelays.has(i)||e.includes(i))continue;let s=n.get(Zge);if(!s||Ydt(s)!==Jge)continue;let o=Qdt.createFromB58String(i),a=this._connectionManager.get(o);if(!a){r.push(o);continue}if(await this._addListenRelay(a,i),this._listenRelays.size>=this.maxListeners)return}for(let i of r)if(await this._tryToListenOnRelay(i),this._listenRelays.size>=this.maxListeners)return;try{let i=await ept(rpt);for await(let n of this._libp2p.contentRouting.findProviders(i)){if(!n.multiaddrs.length)continue;let s=n.id;if(this._peerStore.addressBook.add(s,n.multiaddrs),await this._tryToListenOnRelay(s),this._listenRelays.size>=this.maxListeners)return}}catch(i){this._onError(i)}}async _tryToListenOnRelay(e){try{let r=await this._libp2p.dial(e);await this._addListenRelay(r,e.toB58String())}catch(r){this._onError(r,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};tbe.exports=ebe});var abe=p((Y7t,obe)=>{f();"use strict";var ibe=me(),nbe=Object.assign(ibe("libp2p:relay"),{error:ibe("libp2p:relay:err")}),{setDelayedInterval:ipt,clearDelayedInterval:npt}=lP(),spt=rbe(),{namespaceToCid:opt}=qP(),{RELAY_RENDEZVOUS_NS:apt}=aS(),sbe=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new spt({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=ipt(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){npt(this._timeout)}async _advertiseService(){try{let e=await opt(apt);await this._libp2p.contentRouting.provide(e)}catch(e){e.code==="NO_ROUTERS_AVAILABLE"?(nbe.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):nbe.error(e)}}};obe.exports=sbe});var fbe=p((Q7t,lbe)=>{f();var cbe=y4(),ube=nl();lbe.exports=class{constructor(){this._buffer=new cbe,this._waitingConsumers=new cbe}push(e){let{promise:r,resolve:i}=ube();return this._buffer.push({chunk:e,resolve:i}),this._consume(),r}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),r=this._buffer.shift();e.resolve(r.chunk),r.resolve()}}shift(){let{promise:e,resolve:r}=ube();return this._waitingConsumers.push({resolve:r}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var dbe=p((Z7t,hbe)=>{f();"use strict";hbe.exports=(t,e=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof r.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(e===0)return t;let i=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(i,r.indent.repeat(e))}});var pbe=p(()=>{f()});var mbe=p((tMt,bbe)=>{f();"use strict";var ybe=pbe(),gbe=/\s+at.*(?:\(|\s)(.*)\)?/,cpt=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,upt=typeof ybe.homedir=="undefined"?"":ybe.homedir();bbe.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split(`
`).filter(r=>{let i=r.match(gbe);if(i===null||!i[1])return!0;let n=i[1];return n.includes(".app/Contents/Resources/electron.asar")||n.includes(".app/Contents/Resources/default_app.asar")?!1:!cpt.test(n)}).filter(r=>r.trim()!=="").map(r=>e.pretty?r.replace(gbe,(i,n)=>i.replace(n,n.replace(upt,"~"))):r).join(`
`))});var BP=p((rMt,wbe)=>{f();"use strict";var lpt=dbe(),fpt=mbe(),hpt=t=>t.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),vbe=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(i=>i instanceof Error?i:i!==null&&typeof i=="object"?Object.assign(new Error(i.message),i):new Error(i));let r=e.map(i=>typeof i.stack=="string"?hpt(fpt(i.stack)):String(i)).join(`
`);r=`
`+lpt(r,4);super(r);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};wbe.exports=vbe});var _be=p((iMt,DP)=>{f();"use strict";var NP=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},F1=class{static fn(e){return(...r)=>new F1((i,n,s)=>{r.push(s),e(...r).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new NP(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(F1.prototype,Promise.prototype);DP.exports=F1;DP.exports.CancelError=NP});var Sbe=p((nMt,gS)=>{f();"use strict";var Ebe=BP(),dpt=_be(),MP=class extends Error{},ppt=(t,e)=>new dpt((r,i,n)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){i(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],l=0,u=!1,h=new Set,d=()=>(a.length===s&&(r(a),u=!0),l-c.length<s&&(i(new Ebe(c)),u=!0),u),y=()=>{for(let g of t)!h.has(g)&&typeof g.cancel=="function"&&g.cancel()};n(y);for(let g of t)l++,(async()=>{try{let m=await g;if(u)return;if(!o(m))throw new MP("Value does not satisfy filter");a.push(m)}catch(m){c.push(m)}finally{h.add(g),!u&&d()&&y()}})();s>l&&(i(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${l} items`)),y())});gS.exports=ppt;gS.exports.AggregateError=Ebe;gS.exports.FilterError=MP});var xbe=p((sMt,UP)=>{f();"use strict";var LP=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},K1=class{static fn(e){return(...r)=>new K1((i,n,s)=>{r.push(s),e(...r).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new LP(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(K1.prototype,Promise.prototype);UP.exports=K1;UP.exports.CancelError=LP});var Ibe=p((oMt,FP)=>{f();"use strict";var Abe=Sbe(),ypt=xbe();FP.exports=(t,e)=>{let r=Abe(t,{...e,count:1});return ypt.fn(async i=>{i(()=>{r.cancel()});let[n]=await r;return n})()};FP.exports.AggregateError=Abe.AggregateError});var Pbe=p((aMt,Rbe)=>{f();"use strict";var gpt=ae(),bpt=Ql().default,{anySignal:mpt}=Zl(),vpt=fbe(),wpt=Ibe(),Tbe=class{constructor({addrs:e,dialAction:r,dialer:i}){this.addrs=e,this.dialer=i,this.dialAction=r}async run(e={}){let r=this.dialer.getTokens(this.addrs.length);if(r.length<1)throw gpt(new Error("No dial tokens available"),"ERR_NO_DIAL_TOKENS");let i=new vpt;r.forEach(o=>i.push(o));let n=this.addrs.map(()=>new bpt),s=0;try{return await wpt(this.addrs.map(async(o,a)=>{let c=await i.shift(),l;try{let u=n[a].signal;l=await this.dialAction(o,{...e,signal:e.signal?mpt([u,e.signal]):u}),n.splice(a,1)}finally{s++,this.addrs.length-s>=r.length?i.push(c):this.dialer.releaseToken(r.splice(r.indexOf(c),1)[0])}return l}))}finally{n.map(o=>o.abort()),r.forEach(o=>this.dialer.releaseToken(o))}}};Rbe.exports=Tbe});var qbe=p((cMt,kbe)=>{f();"use strict";var Cbe=me(),T0=Object.assign(Cbe("libp2p:dialer"),{error:Cbe("libp2p:dialer:err")}),KP=ae(),{Multiaddr:jP}=tt(),_pt=PI(),{AbortError:Ept}=ic(),{anySignal:Spt}=Zl(),xpt=Pbe(),{publicAddressesFirst:Apt}=bP(),Ipt=dP(),{codes:bS}=bi(),{DIAL_TIMEOUT:Tpt,MAX_PARALLEL_DIALS:Rpt,MAX_PER_PEER_DIALS:Ppt,MAX_ADDRS_TO_DIAL:Cpt}=oS(),Obe=class{constructor({transportManager:e,peerStore:r,addressSorter:i=Apt,maxParallelDials:n=Rpt,maxAddrsToDial:s=Cpt,dialTimeout:o=Tpt,maxDialsPerPeer:a=Ppt,resolvers:c={}}){this.transportManager=e,this.peerStore=r,this.addressSorter=i,this.maxParallelDials=n,this.maxAddrsToDial=s,this.timeout=o,this.maxDialsPerPeer=a,this.tokens=[...new Array(n)].map((l,u)=>u),this._pendingDials=new Map,this._pendingDialTargets=new Map;for(let[l,u]of Object.entries(c))jP.resolvers.set(l,u)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(r){T0.error(r)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new Ept("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,r={}){let i=await this._createCancellableDialTarget(e);if(!i.addrs.length)throw KP(new Error("The dial request has no valid addresses"),bS.ERR_NO_VALID_ADDRESSES);let n=this._pendingDials.get(i.id)||this._createPendingDial(i,r);try{let s=await n.promise;return T0("dial succeeded to %s",i.id),s}catch(s){throw n.controller.signal.aborted&&(s.code=bS.ERR_TIMEOUT),T0.error(s),s}finally{n.destroy()}}async _createCancellableDialTarget(e){let r=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,i=new Promise((s,o)=>{this._pendingDialTargets.set(r,{resolve:s,reject:o})}),n=await Promise.race([this._createDialTarget(e),i]);return this._pendingDialTargets.delete(r),n}async _createDialTarget(e){let{id:r,multiaddrs:i}=Ipt(e);i&&this.peerStore.addressBook.add(r,i);let n=this.peerStore.addressBook.getMultiaddrsForPeer(r,this.addressSorter)||[];jP.isMultiaddr(e)&&(n=n.filter(a=>!e.equals(a)),n.unshift(e));let s=[];for(let a of n)(await this._resolve(a)).forEach(l=>s.push(l));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));if(o.length>this.maxAddrsToDial)throw this.peerStore.delete(r),KP(new Error("dial with more addresses than allowed"),bS.ERR_TOO_MANY_ADDRESSES);return{id:r.toB58String(),addrs:o}}_createPendingDial(e,r={}){let i=(l,u)=>{if(u.signal.aborted)throw KP(new Error("already aborted"),bS.ERR_ALREADY_ABORTED);return this.transportManager.dial(l,u)},n=new xpt({addrs:e.addrs,dialAction:i,dialer:this}),s=new _pt(this.timeout),o=[s.signal];r.signal&&o.push(r.signal);let a=Spt(o),c={dialRequest:n,controller:s,promise:n.run({...r,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let r=Math.min(e,this.maxDialsPerPeer,this.tokens.length),i=this.tokens.splice(0,r);return T0("%d tokens request, returning %d, %d remaining",e,r,this.tokens.length),i}releaseToken(e){this.tokens.indexOf(e)>-1||(T0("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let i=await this._resolveRecord(e);return(await Promise.all(i.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new jP(e.toString()),await e.resolve()}catch(r){return T0.error(`multiaddr ${e} could not be resolved`),[]}}};kbe.exports=Obe});var Nbe=p((uMt,Bbe)=>{f();"use strict";function Opt(t){return t>=55296&&t<=56319}function kpt(t){return t>=56320&&t<=57343}Bbe.exports=function(e,r,i){if(typeof r!="string")throw new Error("Input must be string");for(var n=r.length,s=0,o,a,c=0;c<n;c+=1){if(o=r.charCodeAt(c),a=r[c],Opt(o)&&kpt(r.charCodeAt(c+1))&&(c+=1,a+=r[c]),s+=e(a),s===i)return r.slice(0,c+1);if(s>i)return r.slice(0,c-a.length+1)}return r}});var Mbe=p((lMt,Dbe)=>{f();"use strict";function qpt(t){return t>=55296&&t<=56319}function Bpt(t){return t>=56320&&t<=57343}Dbe.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,i=0,n=null,s=null,o=0;o<r;o++)n=e.charCodeAt(o),Bpt(n)?s!=null&&qpt(s)?i+=1:i+=3:n<=127?i+=1:n>=128&&n<=2047?i+=2:n>=2048&&n<=65535&&(i+=3),s=n;return i}});var Ube=p((fMt,Lbe)=>{f();"use strict";var Npt=Nbe(),Dpt=Mbe();Lbe.exports=Npt.bind(null,Dpt)});var jbe=p((hMt,Kbe)=>{f();"use strict";var Mpt=Ube(),Lpt=/[\/\?<>\\:\*\|"]/g,Upt=/[\x00-\x1f\x80-\x9f]/g,Fpt=/^\.+$/,Kpt=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,jpt=/[\. ]+$/;function Fbe(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(Lpt,e).replace(Upt,e).replace(Fpt,e).replace(Kpt,e).replace(jpt,e);return Mpt(r,255)}Kbe.exports=function(t,e){var r=e&&e.replacement||"",i=Fbe(t,r);return r===""?i:Fbe(i,"")}});var $be=p((dMt,Hbe)=>{f();var R0=lt();Ac();Wt();var Me=R0.asn1,P0=Hbe.exports=R0.pkcs7asn1=R0.pkcs7asn1||{};R0.pkcs7=R0.pkcs7||{};R0.pkcs7.asn1=P0;var Vbe={name:"ContentInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};P0.contentInfoValidator=Vbe;var zbe={name:"EncryptedContentInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Me.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};P0.envelopedDataValidator={name:"EnvelopedData",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(zbe)};P0.encryptedDataValidator={name:"EncryptedData",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"}].concat(zbe)};var Vpt={name:"SignerInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Me.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Me.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};P0.signedDataValidator={name:"SignedData",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},Vbe,{name:"SignedData.Certificates",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Me.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SET,capture:"signerInfos",optional:!0,value:[Vpt]}]};P0.recipientInfoValidator={name:"RecipientInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Me.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var Wbe=p((pMt,Gbe)=>{f();var Ih=lt();Wt();Ih.mgf=Ih.mgf||{};var zpt=Gbe.exports=Ih.mgf.mgf1=Ih.mgf1=Ih.mgf1||{};zpt.create=function(t){var e={generate:function(r,i){for(var n=new Ih.util.ByteBuffer,s=Math.ceil(i/t.digestLength),o=0;o<s;o++){var a=new Ih.util.ByteBuffer;a.putInt32(o),t.start(),t.update(r+a.getBytes()),n.putBuffer(t.digest())}return n.truncate(n.length()-i),n.getBytes()}};return e}});var Xbe=p((yMt,Ybe)=>{f();var mS=lt();Wbe();Ybe.exports=mS.mgf=mS.mgf||{};mS.mgf.mgf1=mS.mgf1});var Zbe=p((gMt,Qbe)=>{f();var Th=lt();Ou();Wt();var Hpt=Qbe.exports=Th.pss=Th.pss||{};Hpt.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,i=e.digestLength,n=t.salt||null;typeof n=="string"&&(n=Th.util.createBuffer(n));var s;if("saltLength"in t)s=t.saltLength;else if(n!==null)s=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=t.prng||Th.random,a={};return a.encode=function(c,l){var u,h=l-1,d=Math.ceil(h/8),y=c.digest().getBytes();if(d<i+s+2)throw new Error("Message is too long to encrypt.");var g;n===null?g=o.getBytesSync(s):g=n.bytes();var m=new Th.util.ByteBuffer;m.fillWithByte(0,8),m.putBytes(y),m.putBytes(g),e.start(),e.update(m.getBytes());var E=e.digest().getBytes(),v=new Th.util.ByteBuffer;v.fillWithByte(0,d-s-i-2),v.putByte(1),v.putBytes(g);var A=v.getBytes(),R=d-i-1,F=r.generate(E,R),q="";for(u=0;u<R;u++)q+=String.fromCharCode(A.charCodeAt(u)^F.charCodeAt(u));var B=65280>>8*d-h&255;return q=String.fromCharCode(q.charCodeAt(0)&~B)+q.substr(1),q+E+String.fromCharCode(188)},a.verify=function(c,l,u){var h,d=u-1,y=Math.ceil(d/8);if(l=l.substr(-y),y<i+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(l.charCodeAt(y-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=y-i-1,m=l.substr(0,g),E=l.substr(g,i),v=65280>>8*y-d&255;if((m.charCodeAt(0)&v)!=0)throw new Error("Bits beyond keysize not zero as expected.");var A=r.generate(E,g),R="";for(h=0;h<g;h++)R+=String.fromCharCode(m.charCodeAt(h)^A.charCodeAt(h));R=String.fromCharCode(R.charCodeAt(0)&~v)+R.substr(1);var F=y-i-s-2;for(h=0;h<F;h++)if(R.charCodeAt(h)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(F)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var q=R.substr(-s),B=new Th.util.ByteBuffer;B.fillWithByte(0,8),B.putBytes(c),B.putBytes(q),e.start(),e.update(B.getBytes());var z=e.digest().getBytes();return E===z},a}});var zP=p((bMt,r1e)=>{f();var ke=lt();cd();Ac();Sv();Cu();Xbe();sd();Tv();Zbe();og();Wt();var O=ke.asn1,Ie=r1e.exports=ke.pki=ke.pki||{},nt=Ie.oids,Zr={};Zr.CN=nt.commonName;Zr.commonName="CN";Zr.C=nt.countryName;Zr.countryName="C";Zr.L=nt.localityName;Zr.localityName="L";Zr.ST=nt.stateOrProvinceName;Zr.stateOrProvinceName="ST";Zr.O=nt.organizationName;Zr.organizationName="O";Zr.OU=nt.organizationalUnitName;Zr.organizationalUnitName="OU";Zr.E=nt.emailAddress;Zr.emailAddress="E";var Jbe=ke.pki.rsa.publicKeyValidator,$pt={name:"Certificate",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:O.Class.UNIVERSAL,type:O.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:O.Class.UNIVERSAL,type:O.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:O.Class.UNIVERSAL,type:O.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:O.Class.UNIVERSAL,type:O.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},Jbe,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:O.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:O.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:O.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},Gpt={name:"rsapss",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:O.Class.UNIVERSAL,type:O.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:O.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:O.Class.UNIVERSAL,type:O.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:O.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:O.Class.UNIVERSAL,type:O.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:O.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:O.Class.UNIVERSAL,type:O.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},Wpt={name:"CertificationRequestInfo",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},Jbe,{name:"CertificationRequestInfo.attributes",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:O.Class.UNIVERSAL,type:O.Type.SET,constructed:!0}]}]}]},Ypt={name:"CertificationRequest",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[Wpt,{name:"CertificationRequest.signatureAlgorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};Ie.RDNAttributesAsArray=function(t,e){for(var r=[],i,n,s,o=0;o<t.value.length;++o){i=t.value[o];for(var a=0;a<i.value.length;++a)s={},n=i.value[a],s.type=O.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in nt&&(s.name=nt[s.type],s.name in Zr&&(s.shortName=Zr[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};Ie.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var i=t[r],n=O.derToOid(i.value[0].value),s=i.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=n,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in nt&&(a.name=nt[a.type],a.name in Zr&&(a.shortName=Zr[a.name])),a.type===nt.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(Ie.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function ql(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,i,n=0;r===null&&n<t.attributes.length;++n)i=t.attributes[n],(e.type&&e.type===i.type||e.name&&e.name===i.name||e.shortName&&e.shortName===i.shortName)&&(r=i);return r}var vS=function(t,e,r){var i={};if(t!==nt["RSASSA-PSS"])return i;r&&(i={hash:{algorithmOid:nt.sha1},mgf:{algorithmOid:nt.mgf1,hash:{algorithmOid:nt.sha1}},saltLength:20});var n={},s=[];if(!O.validate(e,Gpt,n,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return n.hashOid!==void 0&&(i.hash=i.hash||{},i.hash.algorithmOid=O.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(i.mgf=i.mgf||{},i.mgf.algorithmOid=O.derToOid(n.maskGenOid),i.mgf.hash=i.mgf.hash||{},i.mgf.hash.algorithmOid=O.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(i.saltLength=n.saltLength.charCodeAt(0)),i};Ie.certificateFromPem=function(t,e,r){var i=ke.pem.decode(t)[0];if(i.type!=="CERTIFICATE"&&i.type!=="X509 CERTIFICATE"&&i.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=O.fromDer(i.body,r);return Ie.certificateFromAsn1(s,e)};Ie.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:O.toDer(Ie.certificateToAsn1(t)).getBytes()};return ke.pem.encode(r,{maxline:e})};Ie.publicKeyFromPem=function(t){var e=ke.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var i=O.fromDer(e.body);return Ie.publicKeyFromAsn1(i)};Ie.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:O.toDer(Ie.publicKeyToAsn1(t)).getBytes()};return ke.pem.encode(r,{maxline:e})};Ie.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:O.toDer(Ie.publicKeyToRSAPublicKey(t)).getBytes()};return ke.pem.encode(r,{maxline:e})};Ie.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||ke.md.sha1.create(),i=e.type||"RSAPublicKey",n;switch(i){case"RSAPublicKey":n=O.toDer(Ie.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":n=O.toDer(Ie.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(n);var s=r.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};Ie.certificationRequestFromPem=function(t,e,r){var i=ke.pem.decode(t)[0];if(i.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=O.fromDer(i.body,r);return Ie.certificationRequestFromAsn1(s,e)};Ie.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:O.toDer(Ie.certificationRequestToAsn1(t)).getBytes()};return ke.pem.encode(r,{maxline:e})};Ie.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return ql(t.issuer,e)},t.issuer.addField=function(e){eo([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return ql(t.subject,e)},t.subject.addField=function(e){eo([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){eo(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){eo(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)e1e(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,i,n=0;r===null&&n<t.extensions.length;++n)i=t.extensions[n],(e.id&&i.id===e.id||e.name&&i.name===e.name)&&(r=i);return r},t.sign=function(e,r){t.md=r||ke.md.sha1.create();var i=nt[t.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=t.md.algorithm,n}t.signatureOid=t.siginfo.algorithmOid=i,t.tbsCertificate=Ie.getTBSCertificate(t);var s=O.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var i=e.issuer,n=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=n.attributes,s}var o=e.md;if(o===null){if(e.signatureOid in nt){var a=nt[e.signatureOid];switch(a){case"sha1WithRSAEncryption":o=ke.md.sha1.create();break;case"md5WithRSAEncryption":o=ke.md.md5.create();break;case"sha256WithRSAEncryption":o=ke.md.sha256.create();break;case"sha384WithRSAEncryption":o=ke.md.sha384.create();break;case"sha512WithRSAEncryption":o=ke.md.sha512.create();break;case"RSASSA-PSS":o=ke.md.sha256.create();break}}if(o===null){var s=new Error("Could not compute certificate digest. Unknown signature OID.");throw s.signatureOid=e.signatureOid,s}var c=e.tbsCertificate||Ie.getTBSCertificate(e),l=O.toDer(c);o.update(l.getBytes())}if(o!==null){var u;switch(e.signatureOid){case nt.sha1WithRSAEncryption:u=void 0;break;case nt["RSASSA-PSS"]:var h,d;if(h=nt[e.signatureParameters.mgf.hash.algorithmOid],h===void 0||ke.md[h]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=h,s}if(d=nt[e.signatureParameters.mgf.algorithmOid],d===void 0||ke.mgf[d]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=d,s}if(d=ke.mgf[d].create(ke.md[h].create()),h=nt[e.signatureParameters.hash.algorithmOid],h===void 0||ke.md[h]===void 0)throw{message:"Unsupported RSASSA-PSS hash function.",oid:e.signatureParameters.hash.algorithmOid,name:h};u=ke.pss.create(ke.md[h].create(),d,e.signatureParameters.saltLength);break}r=t.publicKey.verify(o.digest().getBytes(),e.signature,u)}return r},t.isIssuer=function(e){var r=!1,i=t.issuer,n=e.subject;if(i.hash&&n.hash)r=i.hash===n.hash;else if(i.attributes.length===n.attributes.length){r=!0;for(var s,o,a=0;r&&a<i.attributes.length;++a)s=i.attributes[a],o=n.attributes[a],(s.type!==o.type||s.value!==o.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return Ie.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=nt.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var i=t.extensions[r];if(i.id===e){var n=t.generateSubjectKeyIdentifier().getBytes();return ke.util.hexToBytes(i.subjectKeyIdentifier)===n}}return!1},t};Ie.certificateFromAsn1=function(t,e){var r={},i=[];if(!O.validate(t,$pt,r,i)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=i,n}var s=O.derToOid(r.publicKeyOid);if(s!==Ie.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Ie.createCertificate();o.version=r.certVersion?r.certVersion.charCodeAt(0):0;var a=ke.util.createBuffer(r.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=ke.asn1.derToOid(r.certSignatureOid),o.signatureParameters=vS(o.signatureOid,r.certSignatureParams,!0),o.siginfo.algorithmOid=ke.asn1.derToOid(r.certinfoSignatureOid),o.siginfo.parameters=vS(o.siginfo.algorithmOid,r.certinfoSignatureParams,!1),o.signature=r.certSignature;var c=[];if(r.certValidity1UTCTime!==void 0&&c.push(O.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&c.push(O.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&c.push(O.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&c.push(O.generalizedTimeToDate(r.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=r.tbsCertificate,e){if(o.md=null,o.signatureOid in nt){var s=nt[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=ke.md.sha1.create();break;case"md5WithRSAEncryption":o.md=ke.md.md5.create();break;case"sha256WithRSAEncryption":o.md=ke.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=ke.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=ke.md.sha512.create();break;case"RSASSA-PSS":o.md=ke.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certificate digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var l=O.toDer(o.tbsCertificate);o.md.update(l.getBytes())}var u=ke.md.sha1.create();o.issuer.getField=function(d){return ql(o.issuer,d)},o.issuer.addField=function(d){eo([d]),o.issuer.attributes.push(d)},o.issuer.attributes=Ie.RDNAttributesAsArray(r.certIssuer,u),r.certIssuerUniqueId&&(o.issuer.uniqueId=r.certIssuerUniqueId),o.issuer.hash=u.digest().toHex();var h=ke.md.sha1.create();return o.subject.getField=function(d){return ql(o.subject,d)},o.subject.addField=function(d){eo([d]),o.subject.attributes.push(d)},o.subject.attributes=Ie.RDNAttributesAsArray(r.certSubject,h),r.certSubjectUniqueId&&(o.subject.uniqueId=r.certSubjectUniqueId),o.subject.hash=h.digest().toHex(),r.certExtensions?o.extensions=Ie.certificateExtensionsFromAsn1(r.certExtensions):o.extensions=[],o.publicKey=Ie.publicKeyFromAsn1(r.subjectPublicKeyInfo),o};Ie.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var i=t.value[r],n=0;n<i.value.length;++n)e.push(Ie.certificateExtensionFromAsn1(i.value[n]));return e};Ie.certificateExtensionFromAsn1=function(t){var e={};if(e.id=O.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===O.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in nt){if(e.name=nt[e.id],e.name==="keyUsage"){var r=O.fromDer(e.value),i=0,n=0;r.value.length>1&&(i=r.value.charCodeAt(1),n=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(i&128)==128,e.nonRepudiation=(i&64)==64,e.keyEncipherment=(i&32)==32,e.dataEncipherment=(i&16)==16,e.keyAgreement=(i&8)==8,e.keyCertSign=(i&4)==4,e.cRLSign=(i&2)==2,e.encipherOnly=(i&1)==1,e.decipherOnly=(n&128)==128}else if(e.name==="basicConstraints"){var r=O.fromDer(e.value);r.value.length>0&&r.value[0].type===O.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===O.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=O.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=O.fromDer(e.value),o=0;o<r.value.length;++o){var a=O.derToOid(r.value[o].value);a in nt?e[nt[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var r=O.fromDer(e.value),i=0;r.value.length>1&&(i=r.value.charCodeAt(1)),e.client=(i&128)==128,e.server=(i&64)==64,e.email=(i&32)==32,e.objsign=(i&16)==16,e.reserved=(i&8)==8,e.sslCA=(i&4)==4,e.emailCA=(i&2)==2,e.objCA=(i&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,r=O.fromDer(e.value),l=0;l<r.value.length;++l){c=r.value[l];var u={type:c.type,value:c.value};switch(e.altNames.push(u),c.type){case 1:case 2:case 6:break;case 7:u.ip=ke.util.bytesToIP(c.value);break;case 8:u.oid=O.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=O.fromDer(e.value);e.subjectKeyIdentifier=ke.util.bytesToHex(r.value)}}return e};Ie.certificationRequestFromAsn1=function(t,e){var r={},i=[];if(!O.validate(t,Ypt,r,i)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=i,n}var s=O.derToOid(r.publicKeyOid);if(s!==Ie.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Ie.createCertificationRequest();if(o.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,o.signatureOid=ke.asn1.derToOid(r.csrSignatureOid),o.signatureParameters=vS(o.signatureOid,r.csrSignatureParams,!0),o.siginfo.algorithmOid=ke.asn1.derToOid(r.csrSignatureOid),o.siginfo.parameters=vS(o.siginfo.algorithmOid,r.csrSignatureParams,!1),o.signature=r.csrSignature,o.certificationRequestInfo=r.certificationRequestInfo,e){if(o.md=null,o.signatureOid in nt){var s=nt[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=ke.md.sha1.create();break;case"md5WithRSAEncryption":o.md=ke.md.md5.create();break;case"sha256WithRSAEncryption":o.md=ke.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=ke.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=ke.md.sha512.create();break;case"RSASSA-PSS":o.md=ke.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var a=O.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=ke.md.sha1.create();return o.subject.getField=function(l){return ql(o.subject,l)},o.subject.addField=function(l){eo([l]),o.subject.attributes.push(l)},o.subject.attributes=Ie.RDNAttributesAsArray(r.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=Ie.publicKeyFromAsn1(r.subjectPublicKeyInfo),o.getAttribute=function(l){return ql(o,l)},o.addAttribute=function(l){eo([l]),o.attributes.push(l)},o.attributes=Ie.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),o};Ie.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return ql(t.subject,e)},t.subject.addField=function(e){eo([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return ql(t,e)},t.addAttribute=function(e){eo([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){eo(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){eo(e),t.attributes=e},t.sign=function(e,r){t.md=r||ke.md.sha1.create();var i=nt[t.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=t.md.algorithm,n}t.signatureOid=t.siginfo.algorithmOid=i,t.certificationRequestInfo=Ie.getCertificationRequestInfo(t);var s=O.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){if(t.signatureOid in nt){var i=nt[t.signatureOid];switch(i){case"sha1WithRSAEncryption":r=ke.md.sha1.create();break;case"md5WithRSAEncryption":r=ke.md.md5.create();break;case"sha256WithRSAEncryption":r=ke.md.sha256.create();break;case"sha384WithRSAEncryption":r=ke.md.sha384.create();break;case"sha512WithRSAEncryption":r=ke.md.sha512.create();break;case"RSASSA-PSS":r=ke.md.sha256.create();break}}if(r===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=t.signatureOid,n}var s=t.certificationRequestInfo||Ie.getCertificationRequestInfo(t),o=O.toDer(s);r.update(o.getBytes())}if(r!==null){var a;switch(t.signatureOid){case nt.sha1WithRSAEncryption:break;case nt["RSASSA-PSS"]:var c,l;if(c=nt[t.signatureParameters.mgf.hash.algorithmOid],c===void 0||ke.md[c]===void 0){var n=new Error("Unsupported MGF hash function.");throw n.oid=t.signatureParameters.mgf.hash.algorithmOid,n.name=c,n}if(l=nt[t.signatureParameters.mgf.algorithmOid],l===void 0||ke.mgf[l]===void 0){var n=new Error("Unsupported MGF function.");throw n.oid=t.signatureParameters.mgf.algorithmOid,n.name=l,n}if(l=ke.mgf[l].create(ke.md[c].create()),c=nt[t.signatureParameters.hash.algorithmOid],c===void 0||ke.md[c]===void 0){var n=new Error("Unsupported RSASSA-PSS hash function.");throw n.oid=t.signatureParameters.hash.algorithmOid,n.name=c,n}a=ke.pss.create(ke.md[c].create(),l,t.signatureParameters.saltLength);break}e=t.publicKey.verify(r.digest().getBytes(),t.signature,a)}return e},t};function C0(t){for(var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),r,i,n=t.attributes,s=0;s<n.length;++s){r=n[s];var o=r.value,a=O.Type.PRINTABLESTRING;"valueTagClass"in r&&(a=r.valueTagClass,a===O.Type.UTF8&&(o=ke.util.encodeUtf8(o))),i=O.create(O.Class.UNIVERSAL,O.Type.SET,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(r.type).getBytes()),O.create(O.Class.UNIVERSAL,a,!1,o)])]),e.value.push(i)}return e}function eo(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name=="undefined"&&(e.type&&e.type in Ie.oids?e.name=Ie.oids[e.type]:e.shortName&&e.shortName in Zr&&(e.name=Ie.oids[Zr[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in Ie.oids)e.type=Ie.oids[e.name];else{var i=new Error("Attribute type not specified.");throw i.attribute=e,i}if(typeof e.shortName=="undefined"&&e.name&&e.name in Zr&&(e.shortName=Zr[e.name]),e.type===nt.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=O.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var n=0;n<e.extensions.length;++n)e.value.push(Ie.certificateExtensionToAsn1(e1e(e.extensions[n])))}if(typeof e.value=="undefined"){var i=new Error("Attribute value not specified.");throw i.attribute=e,i}}}function e1e(t,e){if(e=e||{},typeof t.name=="undefined"&&t.id&&t.id in Ie.oids&&(t.name=Ie.oids[t.id]),typeof t.id=="undefined")if(t.name&&t.name in Ie.oids)t.id=Ie.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value!="undefined")return t;if(t.name==="keyUsage"){var i=0,n=0,s=0;t.digitalSignature&&(n|=128,i=7),t.nonRepudiation&&(n|=64,i=6),t.keyEncipherment&&(n|=32,i=5),t.dataEncipherment&&(n|=16,i=4),t.keyAgreement&&(n|=8,i=3),t.keyCertSign&&(n|=4,i=2),t.cRLSign&&(n|=2,i=1),t.encipherOnly&&(n|=1,i=0),t.decipherOnly&&(s|=128,i=7);var o=String.fromCharCode(i);s!==0?o+=String.fromCharCode(n)+String.fromCharCode(s):n!==0&&(o+=String.fromCharCode(n)),t.value=O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,o)}else if(t.name==="basicConstraints")t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(O.create(O.Class.UNIVERSAL,O.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);var a=t.value.value;for(var c in t)t[c]===!0&&(c in nt?a.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(nt[c]).getBytes())):c.indexOf(".")!==-1&&a.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(c).getBytes())))}else if(t.name==="nsCertType"){var i=0,n=0;t.client&&(n|=128,i=7),t.server&&(n|=64,i=6),t.email&&(n|=32,i=5),t.objsign&&(n|=16,i=4),t.reserved&&(n|=8,i=3),t.sslCA&&(n|=4,i=2),t.emailCA&&(n|=2,i=1),t.objCA&&(n|=1,i=0);var o=String.fromCharCode(i);n!==0&&(o+=String.fromCharCode(n)),t.value=O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,o)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);for(var l,u=0;u<t.altNames.length;++u){l=t.altNames[u];var o=l.value;if(l.type===7&&l.ip){if(o=ke.util.bytesFromIP(l.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else l.type===8&&(l.oid?o=O.oidToDer(O.oidToDer(l.oid)):o=O.oidToDer(o));t.value.value.push(O.create(O.Class.CONTEXT_SPECIFIC,l.type,!1,o))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=O.create(O.Class.UNIVERSAL,O.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var h=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=h.toHex(),t.value=O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,h.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);var a=t.value.value;if(t.keyIdentifier){var d=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;a.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!1,d))}if(t.authorityCertIssuer){var y=[O.create(O.Class.CONTEXT_SPECIFIC,4,!0,[C0(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];a.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,y))}if(t.serialNumber){var g=ke.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);a.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if(t.name==="cRLDistributionPoints"){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);for(var a=t.value.value,m=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),E=O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[]),l,u=0;u<t.altNames.length;++u){l=t.altNames[u];var o=l.value;if(l.type===7&&l.ip){if(o=ke.util.bytesFromIP(l.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else l.type===8&&(l.oid?o=O.oidToDer(O.oidToDer(l.oid)):o=O.oidToDer(o));E.value.push(O.create(O.Class.CONTEXT_SPECIFIC,l.type,!1,o))}m.value.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[E])),a.push(m)}if(typeof t.value=="undefined"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function VP(t,e){switch(t){case nt["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.hash.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.mgf.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.mgf.hash.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(e.saltLength).getBytes())])),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,r);default:return O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")}}function Xpt(t){var e=O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,i=0;i<r.length;++i){var n=r[i],s=n.value,o=O.Type.UTF8;"valueTagClass"in n&&(o=n.valueTagClass),o===O.Type.UTF8&&(s=ke.util.encodeUtf8(s));var a=!1;"valueConstructed"in n&&(a=n.valueConstructed);var c=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(n.type).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SET,!0,[O.create(O.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var Qpt=new Date("1950-01-01T00:00:00Z"),Zpt=new Date("2050-01-01T00:00:00Z");function t1e(t){return t>=Qpt&&t<Zpt?O.create(O.Class.UNIVERSAL,O.Type.UTCTIME,!1,O.dateToUtcTime(t)):O.create(O.Class.UNIVERSAL,O.Type.GENERALIZEDTIME,!1,O.dateToGeneralizedTime(t))}Ie.getTBSCertificate=function(t){var e=t1e(t.validity.notBefore),r=t1e(t.validity.notAfter),i=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(t.version).getBytes())]),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,ke.util.hexToBytes(t.serialNumber)),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.siginfo.algorithmOid).getBytes()),VP(t.siginfo.algorithmOid,t.siginfo.parameters)]),C0(t.issuer),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,r]),C0(t.subject),Ie.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&i.value.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,[O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&i.value.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!0,[O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&i.value.push(Ie.certificateExtensionsToAsn1(t.extensions)),i};Ie.getCertificationRequestInfo=function(t){var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(t.version).getBytes()),C0(t.subject),Ie.publicKeyToAsn1(t.publicKey),Xpt(t)]);return e};Ie.distinguishedNameToAsn1=function(t){return C0(t)};Ie.certificateToAsn1=function(t){var e=t.tbsCertificate||Ie.getTBSCertificate(t);return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.signatureOid).getBytes()),VP(t.signatureOid,t.signatureParameters)]),O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};Ie.certificateExtensionsToAsn1=function(t){var e=O.create(O.Class.CONTEXT_SPECIFIC,3,!0,[]),r=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);e.value.push(r);for(var i=0;i<t.length;++i)r.value.push(Ie.certificateExtensionToAsn1(t[i]));return e};Ie.certificateExtensionToAsn1=function(t){var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);e.value.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.id).getBytes())),t.critical&&e.value.push(O.create(O.Class.UNIVERSAL,O.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=t.value;return typeof t.value!="string"&&(r=O.toDer(r).getBytes()),e.value.push(O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,r)),e};Ie.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||Ie.getCertificationRequestInfo(t);return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.signatureOid).getBytes()),VP(t.signatureOid,t.signatureParameters)]),O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};Ie.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(o){var a=r(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=ke.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];ke.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=ke.pki.certificateFromPem(o));var a=r(o.subject);if(!a)return!1;ke.util.isArray(a)||(a=[a]);for(var c=O.toDer(Ie.certificateToAsn1(o)).getBytes(),l=0;l<a.length;++l){var u=O.toDer(Ie.certificateToAsn1(a[l])).getBytes();if(c===u)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!ke.util.isArray(c))o.push(c);else for(var l=0;l<c.length;++l)o.push(c[l])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=ke.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))return null;var c=r(o.subject);if(!ke.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var l=O.toDer(Ie.certificateToAsn1(o)).getBytes(),u=0;u<c.length;++u){var h=O.toDer(Ie.certificateToAsn1(c[u])).getBytes();l===h&&(a=c[u],c.splice(u,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function r(o){return i(o),e.certs[o.hash]||null}function i(o){if(!o.hash){var a=ke.md.sha1.create();o.attributes=Ie.RDNAttributesAsArray(C0(o),a),o.hash=a.digest().toHex()}}if(t)for(var n=0;n<t.length;++n){var s=t[n];e.addCertificate(s)}return e};Ie.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};Ie.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var i=e.slice(0),n=r.validityCheckDate;typeof n=="undefined"&&(n=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),l=null,u=!1;if(n&&(n<c.validity.notBefore||n>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:Ie.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:n}),o===null){if(l=e[0]||t.getIssuer(c),l===null&&c.isIssuer(c)&&(u=!0,l=c),l){var h=l;ke.util.isArray(h)||(h=[h]);for(var d=!1;!d&&h.length>0;){l=h.shift();try{d=l.verify(c)}catch(q){}}d||(o={message:"Certificate signature is invalid.",error:Ie.certificateError.bad_certificate})}o===null&&(!l||u)&&!t.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:Ie.certificateError.unknown_ca})}if(o===null&&l&&!c.isIssuer(l)&&(o={message:"Certificate issuer is invalid.",error:Ie.certificateError.bad_certificate}),o===null)for(var y={keyUsage:!0,basicConstraints:!0},g=0;o===null&&g<c.extensions.length;++g){var m=c.extensions[g];m.critical&&!(m.name in y)&&(o={message:"Certificate has an unsupported critical extension.",error:Ie.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!l||u))){var E=c.getExtension("basicConstraints"),v=c.getExtension("keyUsage");if(v!==null&&(!v.keyCertSign||E===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:Ie.certificateError.bad_certificate}),o===null&&E!==null&&!E.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:Ie.certificateError.bad_certificate}),o===null&&v!==null&&"pathLenConstraint"in E){var A=a-1;A>E.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:Ie.certificateError.bad_certificate})}}var R=o===null?!0:o.error,F=r.verify?r.verify(R,a,i):R;if(F===!0)o=null;else throw R===!0&&(o={message:"The application rejected the certificate.",error:Ie.certificateError.bad_certificate}),(F||F===0)&&(typeof F=="object"&&!ke.util.isArray(F)?(F.message&&(o.message=F.message),F.error&&(o.error=F.error)):typeof F=="string"&&(o.error=F)),o;s=!1,++a}while(e.length>0);return!0}});var s1e=p((mMt,n1e)=>{f();var Be=lt();cd();Ac();Sv();sd();Tv();$be();Ou();Wt();zP();var te=Be.asn1,Bn=n1e.exports=Be.pkcs7=Be.pkcs7||{};Bn.messageFromPem=function(t){var e=Be.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var i=te.fromDer(e.body);return Bn.messageFromAsn1(i)};Bn.messageToPem=function(t,e){var r={type:"PKCS7",body:te.toDer(t.toAsn1()).getBytes()};return Be.pem.encode(r,{maxline:e})};Bn.messageFromAsn1=function(t){var e={},r=[];if(!te.validate(t,Bn.asn1.contentInfoValidator,e,r)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw i.errors=r,i}var n=te.derToOid(e.contentType),s;switch(n){case Be.pki.oids.envelopedData:s=Bn.createEnvelopedData();break;case Be.pki.oids.encryptedData:s=Bn.createEncryptedData();break;case Be.pki.oids.signedData:s=Bn.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};Bn.createSignedData=function(){var t=null;return t={type:Be.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(i){if($P(t,i,Bn.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var n=t.rawCapture.certificates.value,s=0;s<n.length;++s)t.certificates.push(Be.pki.certificateFromAsn1(n[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var i=[],n=0;n<t.certificates.length;++n)i.push(Be.pki.certificateToAsn1(t.certificates[n]));var s=[],o=te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return i.length>0&&o.value[0].value.push(te.create(te.Class.CONTEXT_SPECIFIC,0,!0,i)),s.length>0&&o.value[0].value.push(te.create(te.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(te.create(te.Class.UNIVERSAL,te.Type.SET,!0,t.signerInfos)),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.type).getBytes()),o])},addSigner:function(i){var n=i.issuer,s=i.serialNumber;if(i.certificate){var o=i.certificate;typeof o=="string"&&(o=Be.pki.certificateFromPem(o)),n=o.issuer.attributes,s=o.serialNumber}var a=i.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=Be.pki.privateKeyFromPem(a));var c=i.digestAlgorithm||Be.pki.oids.sha1;switch(c){case Be.pki.oids.sha1:case Be.pki.oids.sha256:case Be.pki.oids.sha384:case Be.pki.oids.sha512:case Be.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var l=i.authenticatedAttributes||[];if(l.length>0){for(var u=!1,h=!1,d=0;d<l.length;++d){var y=l[d];if(!u&&y.type===Be.pki.oids.contentType){if(u=!0,h)break;continue}if(!h&&y.type===Be.pki.oids.messageDigest){if(h=!0,u)break;continue}}if(!u||!h)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:a,version:1,issuer:n,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:Be.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:l,unauthenticatedAttributes:[]})},sign:function(i){if(i=i||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(Be.pki.oids.data).getBytes())]),"content"in t)){var n;t.content instanceof Be.util.ByteBuffer?n=t.content.bytes():typeof t.content=="string"&&(n=Be.util.encodeUtf8(t.content)),i.detached?t.detachedContent=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,n):t.contentInfo.value.push(te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,n)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(i){typeof i=="string"&&(i=Be.pki.certificateFromPem(i)),t.certificates.push(i)},addCertificateRevokationList:function(i){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var i={},n=0;n<t.signers.length;++n){var s=t.signers[n],o=s.digestAlgorithm;o in i||(i[o]=Be.md[Be.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=i[o]:s.md=Be.md[Be.pki.oids[o]].create()}t.digestAlgorithmIdentifiers=[];for(var o in i)t.digestAlgorithmIdentifiers.push(te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(o).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]));return i}function r(i){var n;if(t.detachedContent?n=t.detachedContent:(n=t.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=te.derToOid(t.contentInfo.value[0].value),o=te.toDer(n);o.getByte(),te.getBerValueLength(o),o=o.getBytes();for(var a in i)i[a].start().update(o);for(var c=new Date,l=0;l<t.signers.length;++l){var u=t.signers[l];if(u.authenticatedAttributes.length===0){if(s!==Be.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{u.authenticatedAttributesAsn1=te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var h=te.create(te.Class.UNIVERSAL,te.Type.SET,!0,[]),d=0;d<u.authenticatedAttributes.length;++d){var y=u.authenticatedAttributes[d];y.type===Be.pki.oids.messageDigest?y.value=i[u.digestAlgorithm].digest():y.type===Be.pki.oids.signingTime&&(y.value||(y.value=c)),h.value.push(HP(y)),u.authenticatedAttributesAsn1.value.push(HP(y))}o=te.toDer(h).getBytes(),u.md.start().update(o)}u.signature=u.key.sign(u.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=n0t(t.signers)}};Bn.createEncryptedData=function(){var t=null;return t={type:Be.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:Be.pki.oids["aes256-CBC"]},fromAsn1:function(e){$P(t,e,Bn.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),i1e(t)}},t};Bn.createEnvelopedData=function(){var t=null;return t={type:Be.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:Be.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=$P(t,e,Bn.asn1.envelopedDataValidator);t.recipients=t0t(r.recipientInfos.value)},toAsn1:function(){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.type).getBytes()),te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,r0t(t.recipients)),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,s0t(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,i=0;i<t.recipients.length;++i){var n=t.recipients[i],s=n.issuer;if(n.serialNumber===e.serialNumber&&s.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(s[a].type!==r[a].type||s[a].value!==r[a].value){o=!1;break}if(o)return n}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case Be.pki.oids.rsaEncryption:case Be.pki.oids.desCBC:var i=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=Be.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}i1e(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:Be.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var i,n,s;switch(r){case Be.pki.oids["aes128-CBC"]:i=16,n=16,s=Be.aes.createEncryptionCipher;break;case Be.pki.oids["aes192-CBC"]:i=24,n=16,s=Be.aes.createEncryptionCipher;break;case Be.pki.oids["aes256-CBC"]:i=32,n=16,s=Be.aes.createEncryptionCipher;break;case Be.pki.oids["des-EDE3-CBC"]:i=24,n=8,s=Be.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=Be.util.createBuffer(Be.random.getBytes(i));else if(e.length()!=i)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+i+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=Be.util.createBuffer(Be.random.getBytes(n));var o=s(e);if(o.start(t.encryptedContent.parameter.copy()),o.update(t.content),!o.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=o.output}for(var a=0;a<t.recipients.length;++a){var c=t.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case Be.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},t};function Jpt(t){var e={},r=[];if(!te.validate(t,Bn.asn1.recipientInfoValidator,e,r)){var i=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw i.errors=r,i}return{version:e.version.charCodeAt(0),issuer:Be.pki.RDNAttributesAsArray(e.issuer),serialNumber:Be.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:te.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}}}function e0t(t){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[Be.pki.distinguishedNameToAsn1({attributes:t.issuer}),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Be.util.hexToBytes(t.serialNumber))]),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.encryptedContent.algorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function t0t(t){for(var e=[],r=0;r<t.length;++r)e.push(Jpt(t[r]));return e}function r0t(t){for(var e=[],r=0;r<t.length;++r)e.push(e0t(t[r]));return e}function i0t(t){var e=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[Be.pki.distinguishedNameToAsn1({attributes:t.issuer}),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Be.util.hexToBytes(t.serialNumber))]),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.digestAlgorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.signatureAlgorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")])),e.value.push(te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=te.create(te.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<t.unauthenticatedAttributes.length;++i){var n=t.unauthenticatedAttributes[i];r.values.push(HP(n))}e.value.push(r)}return e}function n0t(t){for(var e=[],r=0;r<t.length;++r)e.push(i0t(t[r]));return e}function HP(t){var e;if(t.type===Be.pki.oids.contentType)e=te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.value).getBytes());else if(t.type===Be.pki.oids.messageDigest)e=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===Be.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),n=t.value;if(typeof n=="string"){var s=Date.parse(n);isNaN(s)?n.length===13?n=te.utcTimeToDate(n):n=te.generalizedTimeToDate(n):n=new Date(s)}n>=r&&n<i?e=te.create(te.Class.UNIVERSAL,te.Type.UTCTIME,!1,te.dateToUtcTime(n)):e=te.create(te.Class.UNIVERSAL,te.Type.GENERALIZEDTIME,!1,te.dateToGeneralizedTime(n))}return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.type).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,[e])])}function s0t(t){return[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(Be.pki.oids.data).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.algorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.parameter.getBytes())]),te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.content.getBytes())])]}function $P(t,e,r){var i={},n=[];if(!te.validate(e,r,i,n)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=te.derToOid(i.contentType);if(o!==Be.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var a="";if(Be.util.isArray(i.encryptedContent))for(var c=0;c<i.encryptedContent.length;++c){if(i.encryptedContent[c].type!==te.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=i.encryptedContent[c].value}else a=i.encryptedContent;t.encryptedContent={algorithm:te.derToOid(i.encAlgorithm),parameter:Be.util.createBuffer(i.encParameter.value),content:Be.util.createBuffer(a)}}if(i.content){var a="";if(Be.util.isArray(i.content))for(var c=0;c<i.content.length;++c){if(i.content[c].type!==te.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=i.content[c].value}else a=i.content;t.content=Be.util.createBuffer(a)}return t.version=i.version.charCodeAt(0),t.rawCapture=i,i}function i1e(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case Be.pki.oids["aes128-CBC"]:case Be.pki.oids["aes192-CBC"]:case Be.pki.oids["aes256-CBC"]:e=Be.aes.createDecryptionCipher(t.encryptedContent.key);break;case Be.pki.oids.desCBC:case Be.pki.oids["des-EDE3-CBC"]:e=Be.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var c1e=p((vMt,a1e)=>{f();"use strict";zP();var o0t=lt(),o1e=o0t.pki,a0t=(t,e)=>{let r=o1e.setRsaPublicKey(e.n,e.e),i=o1e.createCertificate();i.publicKey=r,i.serialNumber="01",i.validity.notBefore=new Date,i.validity.notAfter=new Date,i.validity.notAfter.setFullYear(i.validity.notBefore.getFullYear()+10);let n=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:t.id}];return i.setSubject(n),i.setIssuer(n),i.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),i.sign(e),i};async function c0t(t,e){let r=t.map(e),n=(await Promise.all(r)).findIndex(s=>s);return t[n]}a1e.exports={certificateForKey:a0t,findAsync:c0t}});var h1e=p((wMt,f1e)=>{f();"use strict";s1e();Tx();var Bl=lt(),{certificateForKey:u0t,findAsync:l0t}=c1e(),O0=ae(),u1e=ct(),f0t=Je(),GP=new WeakMap,l1e=class{constructor(e,r){if(!e)throw O0(new Error("keychain is required"),"ERR_KEYCHAIN_REQUIRED");this.keychain=e,GP.set(this,{dek:r})}async encrypt(e,r){if(!(r instanceof Uint8Array))throw O0(new Error("Plain data must be a Uint8Array"),"ERR_INVALID_PARAMS");let i=await this.keychain.findKeyByName(e),n=await this.keychain._getPrivateKey(e),s=GP.get(this).dek,o=Bl.pki.decryptRsaPrivateKey(n,s),a=await u0t(i,o),c=Bl.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=Bl.util.createBuffer(r),c.encrypt();let l=Bl.asn1.toDer(c.toAsn1()).getBytes();return u1e(l,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw O0(new Error("CMS data is required"),"ERR_INVALID_PARAMS");let r;try{let l=Bl.util.createBuffer(f0t(e,"ascii")),u=Bl.asn1.fromDer(l);r=Bl.pkcs7.messageFromAsn1(u)}catch(l){throw O0(new Error("Invalid CMS: "+l.message),"ERR_INVALID_CMS")}let i=r.recipients.filter(l=>l.issuer.find(u=>u.shortName==="O"&&u.value==="ipfs")).filter(l=>l.issuer.find(u=>u.shortName==="CN")).map(l=>({recipient:l,keyId:l.issuer.find(u=>u.shortName==="CN").value})),n=await l0t(i,async l=>{try{if(await this.keychain.findKeyById(l.keyId))return!0}catch(u){return!1}return!1});if(!n){let l=i.map(u=>u.keyId);throw O0(new Error("Decryption needs one of the key(s): "+l.join(", ")),"ERR_MISSING_KEYS",{missingKeys:l})}let s=await this.keychain.findKeyById(n.keyId);if(!s)throw O0(new Error("No key available to decrypto"),"ERR_NO_KEY");let o=await this.keychain._getPrivateKey(s.name),a=GP.get(this).dek,c=Bl.pki.decryptRsaPrivateKey(o,a);return r.decrypt(n.recipient,c),u1e(r.content.getBytes(),"ascii")}};f1e.exports=l1e});var v1e=p((_Mt,m1e)=>{f();"use strict";var d1e=me(),p1e=Object.assign(d1e("libp2p:keychain"),{error:d1e("libp2p:keychain:err")}),h0t=jbe(),d0t=wr(),Rh=Ma(),{Key:y1e}=Ft(),p0t=h1e(),Ir=ae(),Ph=Je(),uu=ct();Mv();var y0t="/pkcs8/",g1e="/info/",Nl=new WeakMap,Ch={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},WP={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function lu(t){return!t||typeof t!="string"?!1:t===h0t(t.trim())}async function Vt(t){let e=200,r=1e3,i=Math.random()*(r-e)+e;throw await new Promise(n=>setTimeout(n,i)),t}function oc(t){return new y1e(y0t+t)}function Dl(t){return new y1e(g1e+t)}var b1e=class{constructor(e,r){if(!e)throw new Error("store is required");if(this.store=e,this.opts=d0t(WP,r),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<Ch.minKeyLength)throw new Error(`dek.keyLength must be least ${Ch.minKeyLength} bytes`);if(this.opts.dek.salt.length<Ch.minSaltLength)throw new Error(`dek.saltLength must be least ${Ch.minSaltLength} bytes`);if(this.opts.dek.iterationCount<Ch.minIterationCount)throw new Error(`dek.iterationCount must be least ${Ch.minIterationCount}`);let i=this.opts.pass?Rh.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Nl.set(this,{dek:i})}get cms(){return new p0t(this,Nl.get(this).dek)}static generateOptions(){let e=Object.assign({},WP),r=Math.ceil(Ch.minSaltLength/3)*3;return e.dek.salt=Ph(Rh.randomBytes(r),"base64"),e}static get options(){return WP}async createKey(e,r,i=2048){let n=this;if(!lu(e)||e==="self")return Vt(Ir(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(typeof r!="string")return Vt(Ir(new Error(`Invalid key type '${r}'`),"ERR_INVALID_KEY_TYPE"));let s=oc(e);if(await n.store.has(s))return Vt(Ir(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(i)||i<2048)return Vt(Ir(new Error(`Invalid RSA key size ${i}`),"ERR_INVALID_KEY_SIZE"));break;default:break}let a;try{let c=await Rh.keys.generateKeyPair(r,i),l=await c.id(),u=Nl.get(this).dek,h=await c.export(u);a={name:e,id:l};let d=n.store.batch();d.put(s,uu(h)),d.put(Dl(e),uu(JSON.stringify(a))),await d.commit()}catch(c){return Vt(c)}return a}async listKeys(){let e=this,r={prefix:g1e},i=[];for await(let n of e.store.query(r))i.push(JSON.parse(Ph(n.value)));return i}async findKeyById(e){try{return(await this.listKeys()).find(i=>i.id===e)}catch(r){return Vt(r)}}async findKeyByName(e){if(!lu(e))return Vt(Ir(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let r=Dl(e);try{let i=await this.store.get(r);return JSON.parse(Ph(i))}catch(i){return Vt(Ir(new Error(`Key '${e}' does not exist. ${i.message}`),"ERR_KEY_NOT_FOUND"))}}async removeKey(e){let r=this;if(!lu(e)||e==="self")return Vt(Ir(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let i=oc(e),n=await r.findKeyByName(e),s=r.store.batch();return s.delete(i),s.delete(Dl(e)),await s.commit(),n}async renameKey(e,r){let i=this;if(!lu(e)||e==="self")return Vt(Ir(new Error(`Invalid old key name '${e}'`),"ERR_OLD_KEY_NAME_INVALID"));if(!lu(r)||r==="self")return Vt(Ir(new Error(`Invalid new key name '${r}'`),"ERR_NEW_KEY_NAME_INVALID"));let n=oc(e),s=oc(r),o=Dl(e),a=Dl(r);if(await i.store.has(s))return Vt(Ir(new Error(`Key '${r}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let l=await i.store.get(n),u=await i.store.get(o),h=JSON.parse(Ph(u));h.name=r;let d=i.store.batch();return d.put(s,l),d.put(a,uu(JSON.stringify(h))),d.delete(n),d.delete(o),await d.commit(),h}catch(l){return Vt(l)}}async exportKey(e,r){if(!lu(e))return Vt(Ir(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r)return Vt(Ir(new Error("Password is required"),"ERR_PASSWORD_REQUIRED"));let i=oc(e);try{let n=await this.store.get(i),s=Ph(n),o=Nl.get(this).dek;return(await Rh.keys.import(s,o)).export(r)}catch(n){return Vt(n)}}async importKey(e,r,i){let n=this;if(!lu(e)||e==="self")return Vt(Ir(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r)return Vt(Ir(new Error("PEM encoded key is required"),"ERR_PEM_REQUIRED"));let s=oc(e);if(await n.store.has(s))return Vt(Ir(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));let a;try{a=await Rh.keys.import(r,i)}catch(h){return Vt(Ir(new Error("Cannot read the key, most likely the password is wrong"),"ERR_CANNOT_READ_KEY"))}let c;try{c=await a.id();let h=Nl.get(this).dek;r=await a.export(h)}catch(h){return Vt(h)}let l={name:e,id:c},u=n.store.batch();return u.put(s,uu(r)),u.put(Dl(e),uu(JSON.stringify(l))),await u.commit(),l}async importPeer(e,r){let i=this;if(!lu(e))return Vt(Ir(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r||!r.privKey)return Vt(Ir(new Error("Peer.privKey is required"),"ERR_MISSING_PRIVATE_KEY"));let n=r.privKey,s=oc(e);if(await i.store.has(s))return Vt(Ir(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let a=await n.id(),c=Nl.get(this).dek,l=await n.export(c),u={name:e,id:a},h=i.store.batch();return h.put(s,uu(l)),h.put(Dl(e),uu(JSON.stringify(u))),await h.commit(),u}catch(a){return Vt(a)}}async _getPrivateKey(e){if(!lu(e))return Vt(Ir(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));try{let r=oc(e),i=await this.store.get(r);return Ph(i)}catch(r){return Vt(Ir(new Error(`Key '${e}' does not exist. ${r.message}`),"ERR_KEY_NOT_FOUND"))}}async rotateKeychainPass(e,r){if(typeof e!="string")return Vt(Ir(new Error(`Invalid old pass type '${typeof e}'`),"ERR_INVALID_OLD_PASS_TYPE"));if(typeof r!="string")return Vt(Ir(new Error(`Invalid new pass type '${typeof r}'`),"ERR_INVALID_NEW_PASS_TYPE"));if(r.length<20)return Vt(Ir(new Error(`Invalid pass length ${r.length}`),"ERR_INVALID_PASS_LENGTH"));p1e("recreating keychain");let i=Nl.get(this).dek;this.opts.pass=r;let n=r?Rh.pbkdf2(r,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Nl.set(this,{dek:n});let s=await this.listKeys();for(let o of s){let a=await this.store.get(oc(o.name)),c=Ph(a),l=await Rh.keys.import(c,i),u=n.toString(),h=await l.export(u),d=this.store.batch(),y={name:o.name,id:o.id};d.put(oc(o.name),uu(h)),d.put(Dl(o.name),uu(JSON.stringify(y))),await d.commit()}p1e("keychain reconstructed")}};m1e.exports=b1e});var _1e=p((EMt,w1e)=>{f();"use strict";var g0t=eb();w1e.exports=t=>{let e=g0t(t);return e.delete=e.remove,e}});var S1e=p((E1e,wS)=>{f();(function(t){"use strict";var e,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,n=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,l=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,d=1e9;function y(q){var B,z,G,Y=X.prototype={constructor:X,toString:null,valueOf:null},P=new X(1),b=20,w=4,S=-7,C=21,D=-1e7,W=1e7,j=!1,M=1,_=0,L={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},ce="0123456789abcdefghijklmnopqrstuvwxyz";function X(k,K){var $,Z,I,U,V,N,Q,ee,J=this;if(!(J instanceof X))return new X(k,K);if(K==null){if(k&&k._isBigNumber===!0){J.s=k.s,!k.c||k.e>W?J.c=J.e=null:k.e<D?J.c=[J.e=0]:(J.e=k.e,J.c=k.c.slice());return}if((N=typeof k=="number")&&k*0==0){if(J.s=1/k<0?(k=-k,-1):1,k===~~k){for(U=0,V=k;V>=10;V/=10,U++);U>W?J.c=J.e=null:(J.e=U,J.c=[k]);return}ee=String(k)}else{if(!r.test(ee=String(k)))return G(J,ee,N);J.s=ee.charCodeAt(0)==45?(ee=ee.slice(1),-1):1}(U=ee.indexOf("."))>-1&&(ee=ee.replace(".","")),(V=ee.search(/e/i))>0?(U<0&&(U=V),U+=+ee.slice(V+1),ee=ee.substring(0,V)):U<0&&(U=ee.length)}else{if(v(K,2,ce.length,"Base"),K==10)return J=new X(k),pe(J,b+J.e+1,w);if(ee=String(k),N=typeof k=="number"){if(k*0!=0)return G(J,ee,N,K);if(J.s=1/k<0?(ee=ee.slice(1),-1):1,X.DEBUG&&ee.replace(/^0\.0*|\./,"").length>15)throw Error(o+k)}else J.s=ee.charCodeAt(0)===45?(ee=ee.slice(1),-1):1;for($=ce.slice(0,K),U=V=0,Q=ee.length;V<Q;V++)if($.indexOf(Z=ee.charAt(V))<0){if(Z=="."){if(V>U){U=Q;continue}}else if(!I&&(ee==ee.toUpperCase()&&(ee=ee.toLowerCase())||ee==ee.toLowerCase()&&(ee=ee.toUpperCase()))){I=!0,V=-1,U=0;continue}return G(J,String(k),N,K)}N=!1,ee=z(ee,K,10,J.s),(U=ee.indexOf("."))>-1?ee=ee.replace(".",""):U=ee.length}for(V=0;ee.charCodeAt(V)===48;V++);for(Q=ee.length;ee.charCodeAt(--Q)===48;);if(ee=ee.slice(V,++Q)){if(Q-=V,N&&X.DEBUG&&Q>15&&(k>l||k!==n(k)))throw Error(o+J.s*k);if((U=U-V-1)>W)J.c=J.e=null;else if(U<D)J.c=[J.e=0];else{if(J.e=U,J.c=[],V=(U+1)%c,U<0&&(V+=c),V<Q){for(V&&J.c.push(+ee.slice(0,V)),Q-=c;V<Q;)J.c.push(+ee.slice(V,V+=c));V=c-(ee=ee.slice(V)).length}else V-=Q;for(;V--;ee+="0");J.c.push(+ee)}}else J.c=[J.e=0]}X.clone=y,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(k){var K,$;if(k!=null)if(typeof k=="object"){if(k.hasOwnProperty(K="DECIMAL_PLACES")&&($=k[K],v($,0,d,K),b=$),k.hasOwnProperty(K="ROUNDING_MODE")&&($=k[K],v($,0,8,K),w=$),k.hasOwnProperty(K="EXPONENTIAL_AT")&&($=k[K],$&&$.pop?(v($[0],-d,0,K),v($[1],0,d,K),S=$[0],C=$[1]):(v($,-d,d,K),S=-(C=$<0?-$:$))),k.hasOwnProperty(K="RANGE"))if($=k[K],$&&$.pop)v($[0],-d,-1,K),v($[1],1,d,K),D=$[0],W=$[1];else if(v($,-d,d,K),$)D=-(W=$<0?-$:$);else throw Error(s+K+" cannot be zero: "+$);if(k.hasOwnProperty(K="CRYPTO"))if($=k[K],$===!!$)if($)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))j=$;else throw j=!$,Error(s+"crypto unavailable");else j=$;else throw Error(s+K+" not true or false: "+$);if(k.hasOwnProperty(K="MODULO_MODE")&&($=k[K],v($,0,9,K),M=$),k.hasOwnProperty(K="POW_PRECISION")&&($=k[K],v($,0,d,K),_=$),k.hasOwnProperty(K="FORMAT"))if($=k[K],typeof $=="object")L=$;else throw Error(s+K+" not an object: "+$);if(k.hasOwnProperty(K="ALPHABET"))if($=k[K],typeof $=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test($))ce=$;else throw Error(s+K+" invalid: "+$)}else throw Error(s+"Object expected: "+k);return{DECIMAL_PLACES:b,ROUNDING_MODE:w,EXPONENTIAL_AT:[S,C],RANGE:[D,W],CRYPTO:j,MODULO_MODE:M,POW_PRECISION:_,FORMAT:L,ALPHABET:ce}},X.isBigNumber=function(k){if(!k||k._isBigNumber!==!0)return!1;if(!X.DEBUG)return!0;var K,$,Z=k.c,I=k.e,U=k.s;e:if({}.toString.call(Z)=="[object Array]"){if((U===1||U===-1)&&I>=-d&&I<=d&&I===n(I)){if(Z[0]===0){if(I===0&&Z.length===1)return!0;break e}if(K=(I+1)%c,K<1&&(K+=c),String(Z[0]).length==K){for(K=0;K<Z.length;K++)if($=Z[K],$<0||$>=a||$!==n($))break e;if($!==0)return!0}}}else if(Z===null&&I===null&&(U===null||U===1||U===-1))return!0;throw Error(s+"Invalid BigNumber: "+k)},X.maximum=X.max=function(){return oe(arguments,Y.lt)},X.minimum=X.min=function(){return oe(arguments,Y.gt)},X.random=function(){var k=9007199254740992,K=Math.random()*k&2097151?function(){return n(Math.random()*k)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function($){var Z,I,U,V,N,Q=0,ee=[],J=new X(P);if($==null?$=b:v($,0,d),V=i($/c),j)if(crypto.getRandomValues){for(Z=crypto.getRandomValues(new Uint32Array(V*=2));Q<V;)N=Z[Q]*131072+(Z[Q+1]>>>11),N>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),Z[Q]=I[0],Z[Q+1]=I[1]):(ee.push(N%1e14),Q+=2);Q=V/2}else if(crypto.randomBytes){for(Z=crypto.randomBytes(V*=7);Q<V;)N=(Z[Q]&31)*281474976710656+Z[Q+1]*1099511627776+Z[Q+2]*4294967296+Z[Q+3]*16777216+(Z[Q+4]<<16)+(Z[Q+5]<<8)+Z[Q+6],N>=9e15?crypto.randomBytes(7).copy(Z,Q):(ee.push(N%1e14),Q+=7);Q=V/7}else throw j=!1,Error(s+"crypto unavailable");if(!j)for(;Q<V;)N=K(),N<9e15&&(ee[Q++]=N%1e14);for(V=ee[--Q],$%=c,V&&$&&(N=u[c-$],ee[Q]=n(V/N)*N);ee[Q]===0;ee.pop(),Q--);if(Q<0)ee=[U=0];else{for(U=-1;ee[0]===0;ee.splice(0,1),U-=c);for(Q=1,N=ee[0];N>=10;N/=10,Q++);Q<c&&(U-=c-Q)}return J.e=U,J.c=ee,J}}(),X.sum=function(){for(var k=1,K=arguments,$=new X(K[0]);k<K.length;)$=$.plus(K[k++]);return $},z=function(){var k="0123456789";function K($,Z,I,U){for(var V,N=[0],Q,ee=0,J=$.length;ee<J;){for(Q=N.length;Q--;N[Q]*=Z);for(N[0]+=U.indexOf($.charAt(ee++)),V=0;V<N.length;V++)N[V]>I-1&&(N[V+1]==null&&(N[V+1]=0),N[V+1]+=N[V]/I|0,N[V]%=I)}return N.reverse()}return function($,Z,I,U,V){var N,Q,ee,J,ue,ge,be,Ke,Te=$.indexOf("."),je=b,Ze=w;for(Te>=0&&(J=_,_=0,$=$.replace(".",""),Ke=new X(Z),ge=Ke.pow($.length-Te),_=J,Ke.c=K(F(m(ge.c),ge.e,"0"),10,I,k),Ke.e=Ke.c.length),be=K($,Z,I,V?(N=ce,k):(N=k,ce)),ee=J=be.length;be[--J]==0;be.pop());if(!be[0])return N.charAt(0);if(Te<0?--ee:(ge.c=be,ge.e=ee,ge.s=U,ge=B(ge,Ke,je,Ze,I),be=ge.c,ue=ge.r,ee=ge.e),Q=ee+je+1,Te=be[Q],J=I/2,ue=ue||Q<0||be[Q+1]!=null,ue=Ze<4?(Te!=null||ue)&&(Ze==0||Ze==(ge.s<0?3:2)):Te>J||Te==J&&(Ze==4||ue||Ze==6&&be[Q-1]&1||Ze==(ge.s<0?8:7)),Q<1||!be[0])$=ue?F(N.charAt(1),-je,N.charAt(0)):N.charAt(0);else{if(be.length=Q,ue)for(--I;++be[--Q]>I;)be[Q]=0,Q||(++ee,be=[1].concat(be));for(J=be.length;!be[--J];);for(Te=0,$="";Te<=J;$+=N.charAt(be[Te++]));$=F($,ee,N.charAt(0))}return $}}(),B=function(){function k(Z,I,U){var V,N,Q,ee,J=0,ue=Z.length,ge=I%h,be=I/h|0;for(Z=Z.slice();ue--;)Q=Z[ue]%h,ee=Z[ue]/h|0,V=be*Q+ee*ge,N=ge*Q+V%h*h+J,J=(N/U|0)+(V/h|0)+be*ee,Z[ue]=N%U;return J&&(Z=[J].concat(Z)),Z}function K(Z,I,U,V){var N,Q;if(U!=V)Q=U>V?1:-1;else for(N=Q=0;N<U;N++)if(Z[N]!=I[N]){Q=Z[N]>I[N]?1:-1;break}return Q}function $(Z,I,U,V){for(var N=0;U--;)Z[U]-=N,N=Z[U]<I[U]?1:0,Z[U]=N*V+Z[U]-I[U];for(;!Z[0]&&Z.length>1;Z.splice(0,1));}return function(Z,I,U,V,N){var Q,ee,J,ue,ge,be,Ke,Te,je,Ze,ze,Ve,pt,Ht,er,En,Kt,Et=Z.s==I.s?1:-1,ri=Z.c,it=I.c;if(!ri||!ri[0]||!it||!it[0])return new X(!Z.s||!I.s||(ri?it&&ri[0]==it[0]:!it)?NaN:ri&&ri[0]==0||!it?Et*0:Et/0);for(Te=new X(Et),je=Te.c=[],ee=Z.e-I.e,Et=U+ee+1,N||(N=a,ee=g(Z.e/c)-g(I.e/c),Et=Et/c|0),J=0;it[J]==(ri[J]||0);J++);if(it[J]>(ri[J]||0)&&ee--,Et<0)je.push(1),ue=!0;else{for(Ht=ri.length,En=it.length,J=0,Et+=2,ge=n(N/(it[0]+1)),ge>1&&(it=k(it,ge,N),ri=k(ri,ge,N),En=it.length,Ht=ri.length),pt=En,Ze=ri.slice(0,En),ze=Ze.length;ze<En;Ze[ze++]=0);Kt=it.slice(),Kt=[0].concat(Kt),er=it[0],it[1]>=N/2&&er++;do{if(ge=0,Q=K(it,Ze,En,ze),Q<0){if(Ve=Ze[0],En!=ze&&(Ve=Ve*N+(Ze[1]||0)),ge=n(Ve/er),ge>1)for(ge>=N&&(ge=N-1),be=k(it,ge,N),Ke=be.length,ze=Ze.length;K(be,Ze,Ke,ze)==1;)ge--,$(be,En<Ke?Kt:it,Ke,N),Ke=be.length,Q=1;else ge==0&&(Q=ge=1),be=it.slice(),Ke=be.length;if(Ke<ze&&(be=[0].concat(be)),$(Ze,be,ze,N),ze=Ze.length,Q==-1)for(;K(it,Ze,En,ze)<1;)ge++,$(Ze,En<ze?Kt:it,ze,N),ze=Ze.length}else Q===0&&(ge++,Ze=[0]);je[J++]=ge,Ze[0]?Ze[ze++]=ri[pt]||0:(Ze=[ri[pt]],ze=1)}while((pt++<Ht||Ze[0]!=null)&&Et--);ue=Ze[0]!=null,je[0]||je.splice(0,1)}if(N==a){for(J=1,Et=je[0];Et>=10;Et/=10,J++);pe(Te,U+(Te.e=J+ee*c-1)+1,V,ue)}else Te.e=ee,Te.r=+ue;return Te}}();function ne(k,K,$,Z){var I,U,V,N,Q;if($==null?$=w:v($,0,8),!k.c)return k.toString();if(I=k.c[0],V=k.e,K==null)Q=m(k.c),Q=Z==1||Z==2&&(V<=S||V>=C)?R(Q,V):F(Q,V,"0");else if(k=pe(new X(k),K,$),U=k.e,Q=m(k.c),N=Q.length,Z==1||Z==2&&(K<=U||U<=S)){for(;N<K;Q+="0",N++);Q=R(Q,U)}else if(K-=V,Q=F(Q,U,"0"),U+1>N){if(--K>0)for(Q+=".";K--;Q+="0");}else if(K+=U-N,K>0)for(U+1==N&&(Q+=".");K--;Q+="0");return k.s<0&&I?"-"+Q:Q}function oe(k,K){for(var $,Z=1,I=new X(k[0]);Z<k.length;Z++)if($=new X(k[Z]),$.s)K.call(I,$)&&(I=$);else{I=$;break}return I}function de(k,K,$){for(var Z=1,I=K.length;!K[--I];K.pop());for(I=K[0];I>=10;I/=10,Z++);return($=Z+$*c-1)>W?k.c=k.e=null:$<D?k.c=[k.e=0]:(k.e=$,k.c=K),k}G=function(){var k=/^(-?)0([xbo])(?=\w[\w.]*$)/i,K=/^([^.]+)\.$/,$=/^\.([^.]+)$/,Z=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(U,V,N,Q){var ee,J=N?V:V.replace(I,"");if(Z.test(J))U.s=isNaN(J)?null:J<0?-1:1;else{if(!N&&(J=J.replace(k,function(ue,ge,be){return ee=(be=be.toLowerCase())=="x"?16:be=="b"?2:8,!Q||Q==ee?ge:ue}),Q&&(ee=Q,J=J.replace(K,"$1").replace($,"0.$1")),V!=J))return new X(J,ee);if(X.DEBUG)throw Error(s+"Not a"+(Q?" base "+Q:"")+" number: "+V);U.s=null}U.c=U.e=null}}();function pe(k,K,$,Z){var I,U,V,N,Q,ee,J,ue=k.c,ge=u;if(ue){e:{for(I=1,N=ue[0];N>=10;N/=10,I++);if(U=K-I,U<0)U+=c,V=K,Q=ue[ee=0],J=Q/ge[I-V-1]%10|0;else if(ee=i((U+1)/c),ee>=ue.length)if(Z){for(;ue.length<=ee;ue.push(0));Q=J=0,I=1,U%=c,V=U-c+1}else break e;else{for(Q=N=ue[ee],I=1;N>=10;N/=10,I++);U%=c,V=U-c+I,J=V<0?0:Q/ge[I-V-1]%10|0}if(Z=Z||K<0||ue[ee+1]!=null||(V<0?Q:Q%ge[I-V-1]),Z=$<4?(J||Z)&&($==0||$==(k.s<0?3:2)):J>5||J==5&&($==4||Z||$==6&&(U>0?V>0?Q/ge[I-V]:0:ue[ee-1])%10&1||$==(k.s<0?8:7)),K<1||!ue[0])return ue.length=0,Z?(K-=k.e+1,ue[0]=ge[(c-K%c)%c],k.e=-K||0):ue[0]=k.e=0,k;if(U==0?(ue.length=ee,N=1,ee--):(ue.length=ee+1,N=ge[c-U],ue[ee]=V>0?n(Q/ge[I-V]%ge[V])*N:0),Z)for(;;)if(ee==0){for(U=1,V=ue[0];V>=10;V/=10,U++);for(V=ue[0]+=N,N=1;V>=10;V/=10,N++);U!=N&&(k.e++,ue[0]==a&&(ue[0]=1));break}else{if(ue[ee]+=N,ue[ee]!=a)break;ue[ee--]=0,N=1}for(U=ue.length;ue[--U]===0;ue.pop());}k.e>W?k.c=k.e=null:k.e<D&&(k.c=[k.e=0])}return k}function _e(k){var K,$=k.e;return $===null?k.toString():(K=m(k.c),K=$<=S||$>=C?R(K,$):F(K,$,"0"),k.s<0?"-"+K:K)}return Y.absoluteValue=Y.abs=function(){var k=new X(this);return k.s<0&&(k.s=1),k},Y.comparedTo=function(k,K){return E(this,new X(k,K))},Y.decimalPlaces=Y.dp=function(k,K){var $,Z,I,U=this;if(k!=null)return v(k,0,d),K==null?K=w:v(K,0,8),pe(new X(U),k+U.e+1,K);if(!($=U.c))return null;if(Z=((I=$.length-1)-g(this.e/c))*c,I=$[I])for(;I%10==0;I/=10,Z--);return Z<0&&(Z=0),Z},Y.dividedBy=Y.div=function(k,K){return B(this,new X(k,K),b,w)},Y.dividedToIntegerBy=Y.idiv=function(k,K){return B(this,new X(k,K),0,1)},Y.exponentiatedBy=Y.pow=function(k,K){var $,Z,I,U,V,N,Q,ee,J,ue=this;if(k=new X(k),k.c&&!k.isInteger())throw Error(s+"Exponent not an integer: "+_e(k));if(K!=null&&(K=new X(K)),N=k.e>14,!ue.c||!ue.c[0]||ue.c[0]==1&&!ue.e&&ue.c.length==1||!k.c||!k.c[0])return J=new X(Math.pow(+_e(ue),N?2-A(k):+_e(k))),K?J.mod(K):J;if(Q=k.s<0,K){if(K.c?!K.c[0]:!K.s)return new X(NaN);Z=!Q&&ue.isInteger()&&K.isInteger(),Z&&(ue=ue.mod(K))}else{if(k.e>9&&(ue.e>0||ue.e<-1||(ue.e==0?ue.c[0]>1||N&&ue.c[1]>=24e7:ue.c[0]<8e13||N&&ue.c[0]<=9999975e7)))return U=ue.s<0&&A(k)?-0:0,ue.e>-1&&(U=1/U),new X(Q?1/U:U);_&&(U=i(_/c+2))}for(N?($=new X(.5),Q&&(k.s=1),ee=A(k)):(I=Math.abs(+_e(k)),ee=I%2),J=new X(P);;){if(ee){if(J=J.times(ue),!J.c)break;U?J.c.length>U&&(J.c.length=U):Z&&(J=J.mod(K))}if(I){if(I=n(I/2),I===0)break;ee=I%2}else if(k=k.times($),pe(k,k.e+1,1),k.e>14)ee=A(k);else{if(I=+_e(k),I===0)break;ee=I%2}ue=ue.times(ue),U?ue.c&&ue.c.length>U&&(ue.c.length=U):Z&&(ue=ue.mod(K))}return Z?J:(Q&&(J=P.div(J)),K?J.mod(K):U?pe(J,_,w,V):J)},Y.integerValue=function(k){var K=new X(this);return k==null?k=w:v(k,0,8),pe(K,K.e+1,k)},Y.isEqualTo=Y.eq=function(k,K){return E(this,new X(k,K))===0},Y.isFinite=function(){return!!this.c},Y.isGreaterThan=Y.gt=function(k,K){return E(this,new X(k,K))>0},Y.isGreaterThanOrEqualTo=Y.gte=function(k,K){return(K=E(this,new X(k,K)))===1||K===0},Y.isInteger=function(){return!!this.c&&g(this.e/c)>this.c.length-2},Y.isLessThan=Y.lt=function(k,K){return E(this,new X(k,K))<0},Y.isLessThanOrEqualTo=Y.lte=function(k,K){return(K=E(this,new X(k,K)))===-1||K===0},Y.isNaN=function(){return!this.s},Y.isNegative=function(){return this.s<0},Y.isPositive=function(){return this.s>0},Y.isZero=function(){return!!this.c&&this.c[0]==0},Y.minus=function(k,K){var $,Z,I,U,V=this,N=V.s;if(k=new X(k,K),K=k.s,!N||!K)return new X(NaN);if(N!=K)return k.s=-K,V.plus(k);var Q=V.e/c,ee=k.e/c,J=V.c,ue=k.c;if(!Q||!ee){if(!J||!ue)return J?(k.s=-K,k):new X(ue?V:NaN);if(!J[0]||!ue[0])return ue[0]?(k.s=-K,k):new X(J[0]?V:w==3?-0:0)}if(Q=g(Q),ee=g(ee),J=J.slice(),N=Q-ee){for((U=N<0)?(N=-N,I=J):(ee=Q,I=ue),I.reverse(),K=N;K--;I.push(0));I.reverse()}else for(Z=(U=(N=J.length)<(K=ue.length))?N:K,N=K=0;K<Z;K++)if(J[K]!=ue[K]){U=J[K]<ue[K];break}if(U&&(I=J,J=ue,ue=I,k.s=-k.s),K=(Z=ue.length)-($=J.length),K>0)for(;K--;J[$++]=0);for(K=a-1;Z>N;){if(J[--Z]<ue[Z]){for($=Z;$&&!J[--$];J[$]=K);--J[$],J[Z]+=a}J[Z]-=ue[Z]}for(;J[0]==0;J.splice(0,1),--ee);return J[0]?de(k,J,ee):(k.s=w==3?-1:1,k.c=[k.e=0],k)},Y.modulo=Y.mod=function(k,K){var $,Z,I=this;return k=new X(k,K),!I.c||!k.s||k.c&&!k.c[0]?new X(NaN):!k.c||I.c&&!I.c[0]?new X(I):(M==9?(Z=k.s,k.s=1,$=B(I,k,0,3),k.s=Z,$.s*=Z):$=B(I,k,0,M),k=I.minus($.times(k)),!k.c[0]&&M==1&&(k.s=I.s),k)},Y.multipliedBy=Y.times=function(k,K){var $,Z,I,U,V,N,Q,ee,J,ue,ge,be,Ke,Te,je,Ze=this,ze=Ze.c,Ve=(k=new X(k,K)).c;if(!ze||!Ve||!ze[0]||!Ve[0])return!Ze.s||!k.s||ze&&!ze[0]&&!Ve||Ve&&!Ve[0]&&!ze?k.c=k.e=k.s=null:(k.s*=Ze.s,!ze||!Ve?k.c=k.e=null:(k.c=[0],k.e=0)),k;for(Z=g(Ze.e/c)+g(k.e/c),k.s*=Ze.s,Q=ze.length,ue=Ve.length,Q<ue&&(Ke=ze,ze=Ve,Ve=Ke,I=Q,Q=ue,ue=I),I=Q+ue,Ke=[];I--;Ke.push(0));for(Te=a,je=h,I=ue;--I>=0;){for($=0,ge=Ve[I]%je,be=Ve[I]/je|0,V=Q,U=I+V;U>I;)ee=ze[--V]%je,J=ze[V]/je|0,N=be*ee+J*ge,ee=ge*ee+N%je*je+Ke[U]+$,$=(ee/Te|0)+(N/je|0)+be*J,Ke[U--]=ee%Te;Ke[U]=$}return $?++Z:Ke.splice(0,1),de(k,Ke,Z)},Y.negated=function(){var k=new X(this);return k.s=-k.s||null,k},Y.plus=function(k,K){var $,Z=this,I=Z.s;if(k=new X(k,K),K=k.s,!I||!K)return new X(NaN);if(I!=K)return k.s=-K,Z.minus(k);var U=Z.e/c,V=k.e/c,N=Z.c,Q=k.c;if(!U||!V){if(!N||!Q)return new X(I/0);if(!N[0]||!Q[0])return Q[0]?k:new X(N[0]?Z:I*0)}if(U=g(U),V=g(V),N=N.slice(),I=U-V){for(I>0?(V=U,$=Q):(I=-I,$=N),$.reverse();I--;$.push(0));$.reverse()}for(I=N.length,K=Q.length,I-K<0&&($=Q,Q=N,N=$,K=I),I=0;K;)I=(N[--K]=N[K]+Q[K]+I)/a|0,N[K]=a===N[K]?0:N[K]%a;return I&&(N=[I].concat(N),++V),de(k,N,V)},Y.precision=Y.sd=function(k,K){var $,Z,I,U=this;if(k!=null&&k!==!!k)return v(k,1,d),K==null?K=w:v(K,0,8),pe(new X(U),k,K);if(!($=U.c))return null;if(I=$.length-1,Z=I*c+1,I=$[I]){for(;I%10==0;I/=10,Z--);for(I=$[0];I>=10;I/=10,Z++);}return k&&U.e+1>Z&&(Z=U.e+1),Z},Y.shiftedBy=function(k){return v(k,-l,l),this.times("1e"+k)},Y.squareRoot=Y.sqrt=function(){var k,K,$,Z,I,U=this,V=U.c,N=U.s,Q=U.e,ee=b+4,J=new X("0.5");if(N!==1||!V||!V[0])return new X(!N||N<0&&(!V||V[0])?NaN:V?U:1/0);if(N=Math.sqrt(+_e(U)),N==0||N==1/0?(K=m(V),(K.length+Q)%2==0&&(K+="0"),N=Math.sqrt(+K),Q=g((Q+1)/2)-(Q<0||Q%2),N==1/0?K="5e"+Q:(K=N.toExponential(),K=K.slice(0,K.indexOf("e")+1)+Q),$=new X(K)):$=new X(N+""),$.c[0]){for(Q=$.e,N=Q+ee,N<3&&(N=0);;)if(I=$,$=J.times(I.plus(B(U,I,ee,1))),m(I.c).slice(0,N)===(K=m($.c)).slice(0,N))if($.e<Q&&--N,K=K.slice(N-3,N+1),K=="9999"||!Z&&K=="4999"){if(!Z&&(pe(I,I.e+b+2,0),I.times(I).eq(U))){$=I;break}ee+=4,N+=4,Z=1}else{(!+K||!+K.slice(1)&&K.charAt(0)=="5")&&(pe($,$.e+b+2,1),k=!$.times($).eq(U));break}}return pe($,$.e+b+1,w,k)},Y.toExponential=function(k,K){return k!=null&&(v(k,0,d),k++),ne(this,k,K,1)},Y.toFixed=function(k,K){return k!=null&&(v(k,0,d),k=k+this.e+1),ne(this,k,K)},Y.toFormat=function(k,K,$){var Z,I=this;if($==null)k!=null&&K&&typeof K=="object"?($=K,K=null):k&&typeof k=="object"?($=k,k=K=null):$=L;else if(typeof $!="object")throw Error(s+"Argument not an object: "+$);if(Z=I.toFixed(k,K),I.c){var U,V=Z.split("."),N=+$.groupSize,Q=+$.secondaryGroupSize,ee=$.groupSeparator||"",J=V[0],ue=V[1],ge=I.s<0,be=ge?J.slice(1):J,Ke=be.length;if(Q&&(U=N,N=Q,Q=U,Ke-=U),N>0&&Ke>0){for(U=Ke%N||N,J=be.substr(0,U);U<Ke;U+=N)J+=ee+be.substr(U,N);Q>0&&(J+=ee+be.slice(U)),ge&&(J="-"+J)}Z=ue?J+($.decimalSeparator||"")+((Q=+$.fractionGroupSize)?ue.replace(new RegExp("\\d{"+Q+"}\\B","g"),"$&"+($.fractionGroupSeparator||"")):ue):J}return($.prefix||"")+Z+($.suffix||"")},Y.toFraction=function(k){var K,$,Z,I,U,V,N,Q,ee,J,ue,ge,be=this,Ke=be.c;if(k!=null&&(N=new X(k),!N.isInteger()&&(N.c||N.s!==1)||N.lt(P)))throw Error(s+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+_e(N));if(!Ke)return new X(be);for(K=new X(P),ee=$=new X(P),Z=Q=new X(P),ge=m(Ke),U=K.e=ge.length-be.e-1,K.c[0]=u[(V=U%c)<0?c+V:V],k=!k||N.comparedTo(K)>0?U>0?K:ee:N,V=W,W=1/0,N=new X(ge),Q.c[0]=0;J=B(N,K,0,1),I=$.plus(J.times(Z)),I.comparedTo(k)!=1;)$=Z,Z=I,ee=Q.plus(J.times(I=ee)),Q=I,K=N.minus(J.times(I=K)),N=I;return I=B(k.minus($),Z,0,1),Q=Q.plus(I.times(ee)),$=$.plus(I.times(Z)),Q.s=ee.s=be.s,U=U*2,ue=B(ee,Z,U,w).minus(be).abs().comparedTo(B(Q,$,U,w).minus(be).abs())<1?[ee,Z]:[Q,$],W=V,ue},Y.toNumber=function(){return+_e(this)},Y.toPrecision=function(k,K){return k!=null&&v(k,1,d),ne(this,k,K,2)},Y.toString=function(k){var K,$=this,Z=$.s,I=$.e;return I===null?Z?(K="Infinity",Z<0&&(K="-"+K)):K="NaN":(k==null?K=I<=S||I>=C?R(m($.c),I):F(m($.c),I,"0"):k===10?($=pe(new X($),b+I+1,w),K=F(m($.c),$.e,"0")):(v(k,2,ce.length,"Base"),K=z(F(m($.c),I,"0"),10,k,Z,!0)),Z<0&&$.c[0]&&(K="-"+K)),K},Y.valueOf=Y.toJSON=function(){return _e(this)},Y._isBigNumber=!0,q!=null&&X.set(q),X}function g(q){var B=q|0;return q>0||q===B?B:B-1}function m(q){for(var B,z,G=1,Y=q.length,P=q[0]+"";G<Y;){for(B=q[G++]+"",z=c-B.length;z--;B="0"+B);P+=B}for(Y=P.length;P.charCodeAt(--Y)===48;);return P.slice(0,Y+1||1)}function E(q,B){var z,G,Y=q.c,P=B.c,b=q.s,w=B.s,S=q.e,C=B.e;if(!b||!w)return null;if(z=Y&&!Y[0],G=P&&!P[0],z||G)return z?G?0:-w:b;if(b!=w)return b;if(z=b<0,G=S==C,!Y||!P)return G?0:!Y^z?1:-1;if(!G)return S>C^z?1:-1;for(w=(S=Y.length)<(C=P.length)?S:C,b=0;b<w;b++)if(Y[b]!=P[b])return Y[b]>P[b]^z?1:-1;return S==C?0:S>C^z?1:-1}function v(q,B,z,G){if(q<B||q>z||q!==n(q))throw Error(s+(G||"Argument")+(typeof q=="number"?q<B||q>z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(q))}function A(q){var B=q.c.length-1;return g(q.e/c)==B&&q.c[B]%2!=0}function R(q,B){return(q.length>1?q.charAt(0)+"."+q.slice(1):q)+(B<0?"e":"e+")+B}function F(q,B,z){var G,Y;if(B<0){for(Y=z+".";++B;Y+=z);q=Y+q}else if(G=q.length,++B>G){for(Y=z,B-=G;--B;Y+=z);q+=Y}else B<G&&(q=q.slice(0,B)+"."+q.slice(B));return q}e=y(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof wS!="undefined"&&wS.exports?wS.exports=e:(t||(t=typeof self!="undefined"&&self?self:window),t.BigNumber=e)})(E1e)});var YP=p((x1e,A1e)=>{f();"use strict";var b0t=Math.exp;x1e=A1e.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let r,i=0,n=0,s=0,o,a={};function c(l,u){return 1-b0t(-(l-u)/e)}return a.push=function(u,h){if(o){let d=c(u,o),y=h-r,g=d*y;r=d*h+(1-d)*r,i=(1-d)*(i+y*g),n=Math.sqrt(i),s=r+d*y}else r=h;o=u},a.movingAverage=function(){return r},a.variance=function(){return i},a.deviation=function(){return n},a.forecast=function(){return s},a}});var P1e=p((SMt,R1e)=>{f();"use strict";var{EventEmitter:m0t}=vr(),{BigNumber:_S}=S1e(),I1e=YP(),v0t=TP(),T1e=class extends m0t{constructor(e,r){super();this._options=r,this._queue=[],this._stats={dataReceived:_S(0),dataSent:_S(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let i=this._options.movingAverageIntervals;for(let n=0;n<e.length;n++){let s=e[n];this._stats[s]=_S(0),this._movingAverages[s]={};for(let o=0;o<i.length;o++){let a=i[o];(this._movingAverages[s][a]=I1e(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,r=this.movingAverages,i={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},n=Object.keys(r);for(let s of n){i.movingAverages[s]={};for(let o of Object.keys(r[s]))i.movingAverages[s][o]=r[s][o].movingAverage()}return i}push(e,r){this._queue.push([e,r,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=v0t(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=n/(r||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let l=0;l<c.length;l++){let u=c[l],h=a[u];h||(h=a[u]=I1e(u)),h.push(i,o)}}_applyOp(e){let r=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);let n;Object.prototype.hasOwnProperty.call(this._stats,r)?n=this._stats[r]:n=this._stats[r]=_S(0),this._stats[r]=n.plus(i),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=i}};R1e.exports=T1e});var k1e=p((xMt,O1e)=>{f();"use strict";var w0t=wr(),{pipe:_0t}=Pr(),{tap:C1e}=Tp(),E0t=_1e(),{METRICS:S0t}=oS(),XP=P1e(),QP=["dataReceived","dataSent"],x0t={in:"dataReceived",out:"dataSent"},ES=class{constructor(e){this._options=w0t(S0t,e),this._globalStats=new XP(QP,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=E0t(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._connectionManager=e.connectionManager,this._connectionManager.on("peer:disconnect",r=>{this.onPeerDisconnected(r.remotePeer)})}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}forPeer(e){let r=e.toB58String();return this._peerStats.get(r)||this._oldPeers.get(r)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let r=e.toB58String(),i=this._peerStats.get(r);i&&(i.stop(),this._peerStats.delete(r),this._oldPeers.set(r,i))}_onMessage({remotePeer:e,protocol:r,direction:i,dataLength:n}){if(!this._running)return;let s=x0t[i],o=this.forPeer(e);if(o||(o=new XP(QP,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,n),this._globalStats.push(s,n),r){let a=this.forProtocol(r);a||(a=new XP(QP,this._options),this._protocolStats.set(r,a)),a.push(s,n)}}updatePlaceholder(e,r){if(!this._running)return;let i=this.forPeer(e),n=r.toB58String(),s=this.forPeer(r),o=i;s&&(o=ES.mergeStats(s,o),this._oldPeers.delete(n)),this._peerStats.delete(e.toB58String()),this._peerStats.set(n,o),o.start()}trackStream({stream:e,remotePeer:r,protocol:i}){let n=this,s=e.source;e.source=C1e(a=>n._onMessage({remotePeer:r,protocol:i,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>_0t(a,C1e(c=>n._onMessage({remotePeer:r,protocol:i,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,r){return e.stop(),r.stop(),e._queue=[...e._queue,...r._queue],e}};O1e.exports=ES});var ZP=p((AMt,B1e)=>{f();"use strict";var{Buffer:Zo}=ft(),q1e=Symbol.for("BufferList");function hr(t){if(!(this instanceof hr))return new hr(t);hr._init.call(this,t)}hr._init=function(e){Object.defineProperty(this,q1e,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};hr.prototype._new=function(e){return new hr(e)};hr.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};hr.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};hr.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};hr.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};hr.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Zo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,l=s&&r||0,u=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Zo.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,l),l+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-u)return s?this._bufs[o[0]].copy(e,r,u,u+c):this._bufs[o[0]].slice(u,u+c);s||(e=Zo.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-u;if(c>d)this._bufs[h].copy(e,l,u),l+=d;else{this._bufs[h].copy(e,l,u,u+c),l+=d;break}c-=d,u&&(u=0)}return e.length>l?e.slice(0,l):e};hr.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};hr.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};hr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};hr.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};hr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Zo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Zo.from(e));return this};hr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};hr.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Zo.from([t]):typeof t=="string"?t=Zo.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Zo.from(t.buffer,t.byteOffset,t.byteLength):Zo.isBuffer(t)||(t=Zo.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,t))return c;s++}s=0}return-1};hr.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?hr.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:hr.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();hr.prototype._isBufferList=function(e){return e instanceof hr||hr.isBufferList(e)};hr.isBufferList=function(e){return e!=null&&e[q1e]};B1e.exports=hr});var SS=p(Oh=>{f();"use strict";var N1e=ZP(),D1e=$o(),A0t=Pr(),I0t=ae(),T0t=ct(),R0t=lp(),M1e=T0t(`
`);Oh.encode=t=>D1e.encode.single(new N1e([t,M1e]));Oh.write=(t,e)=>t.push(Oh.encode(e));Oh.writeAll=(t,e)=>{t.push(e.reduce((r,i)=>r.append(Oh.encode(i)),new N1e))};Oh.read=async t=>{let e=1,r={[Symbol.asyncIterator](){return this},next:()=>t.next(e)},i=s=>{e=s},n=await A0t(r,D1e.decode({onLength:i}),R0t);if(n.get(n.length-1)!==M1e[0])throw I0t(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return n.shallowSlice(0,-1)}});var U1e=p((TMt,L1e)=>{f();"use strict";var k0=me()("mss:select"),P0t=ae(),q0=SS(),C0t=I0();L1e.exports=async(t,e,r)=>{e=Array.isArray(e)?[...e]:[e];let{reader:i,writer:n,rest:s,stream:o}=C0t(t),a=e.shift();r?(k0('select: write ["%s", "%s"]',r,a),q0.writeAll(n,[r,a])):(k0('select: write "%s"',a),q0.write(n,a));let c=(await q0.read(i)).toString();if(k0('select: read "%s"',c),c===r&&(c=(await q0.read(i)).toString(),k0('select: read "%s"',c)),c===a)return s(),{stream:o,protocol:a};for(let l of e){k0('select: write "%s"',l),q0.write(n,l);let u=(await q0.read(i)).toString();if(k0('select: read "%s" for "%s"',u,l),u===l)return s(),{stream:o,protocol:l}}throw s(),P0t(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var JP=p(F1e=>{f();"use strict";F1e.PROTOCOL_ID="/multistream/1.0.0"});var j1e=p((PMt,K1e)=>{f();"use strict";var j1=me()("mss:handle"),O0t=ZP(),B0=SS(),k0t=I0(),{PROTOCOL_ID:eC}=JP();K1e.exports=async(t,e)=>{e=Array.isArray(e)?e:[e];let{writer:r,reader:i,rest:n,stream:s}=k0t(t);for(;;){let o=(await B0.read(i)).toString();if(j1('read "%s"',o),o===eC){j1('respond with "%s" for "%s"',eC,o),B0.write(r,eC);continue}if(e.includes(o))return B0.write(r,o),j1('respond with "%s" for "%s"',o,o),n(),{stream:s,protocol:o};if(o==="ls"){B0.write(r,new O0t(e.map(a=>B0.encode(a)))),j1('respond with "%s" for %s',e,o);continue}B0.write(r,"na"),j1('respond with "na" for "%s"',o)}}});var H1e=p((CMt,z1e)=>{f();"use strict";var q0t=G_(),B0t=me()("it-multistream-select:ls"),V1e=SS(),N0t=I0(),D0t=$o(),M0t=Pr();z1e.exports=async t=>{let{reader:e,writer:r,rest:i,stream:n}=N0t(t);B0t('write "ls"'),V1e.write(r,"ls"),i();let s=await V1e.read(e),o=q0t([s]),a=[];return await M0t(o,D0t.decode(),async c=>{for await(let l of c)a.push(l.shallowSlice(0,-1).toString())}),{stream:n,protocols:a}}});var Y1e=p(xS=>{f();"use strict";var $1e=U1e(),L0t=j1e(),U0t=H1e(),{PROTOCOL_ID:tC}=JP();xS.PROTOCOL_ID=tC;var rC=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(){if(this._shaken)return;let{stream:e}=await $1e(this._stream,tC);this._stream=e,this._shaken=!0}},G1e=class extends rC{select(e){return $1e(this._stream,e,this._shaken?null:tC)}async ls(){await this._handshake();let{stream:e,protocols:r}=await U0t(this._stream);return this._stream=e,r}};xS.Dialer=G1e;var W1e=class extends rC{handle(e){return L0t(this._stream,e)}};xS.Listener=W1e});var Q1e=p((kMt,X1e)=>{f();"use strict";var F0t={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};X1e.exports=F0t});var ime=p((qMt,rme)=>{f();"use strict";var Z1e=et(),{Multiaddr:K0t}=tt(),bs=ae(),{OPEN:j0t,CLOSING:J1e,CLOSED:iC}=Q1e(),eme=Symbol.for("@libp2p/interface-connection/connection"),tme=class{constructor({localAddr:e,remoteAddr:r,localPeer:i,remotePeer:n,newStream:s,close:o,getStreams:a,stat:c}){V0t(e,i,n,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=r,this.localPeer=i,this.remotePeer=n,this._stat={...c,status:j0t},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[eme](){return!0}static isConnection(e){return Boolean(e&&e[eme])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===J1e)throw bs(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===iC)throw bs(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:r,protocol:i}=await this._newStream(e);return this.addStream(r,{protocol:i}),{stream:r,protocol:i}}addStream(e,{protocol:r,metadata:i={}}){this.registry.set(e.id,{protocol:r,...i})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==iC){if(this._closing)return this._closing;this.stat.status=J1e,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=iC}}};rme.exports=tme;function V0t(t,e,r,i,n,s,o){if(t&&!K0t.isMultiaddr(t))throw bs(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!Z1e.isPeerId(e))throw bs(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!Z1e.isPeerId(r))throw bs(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw bs(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw bs(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw bs(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw bs(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw bs(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw bs(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw bs(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw bs(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var sme=p(nme=>{f();"use strict";nme.Connection=ime()});var ame=p((NMt,ome)=>{f();"use strict";function z0t(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}else return Array.from(t)}ome.exports=function(e){var r=void 0,i=void 0;function n(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');i=a}function s(a){Object.keys(a).forEach(function(c){var l=a[c];if(typeof l!="function")throw new Error('Trap "'+c+": "+l+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+l+'" is not a valid trap')}),r=a}n(function(){}),e&&n(e),s(Reflect);var o=new Proxy({},{get:function(c,l){return function(){for(var u=arguments.length,h=Array(u),d=0;d<u;d++)h[d]=arguments[d];return r[l].apply(null,[i].concat(z0t(h.slice(1))))}}});return{setTarget:n,setHandler:s,getTarget:function(){return i},getHandler:function(){return r},proxy:new Proxy(i,o)}}});var hme=p((DMt,fme)=>{f();"use strict";var cme=me(),Ti=Object.assign(cme("libp2p:upgrader"),{error:cme("libp2p:upgrader:err")}),kh=ae(),N0=Y1e(),{Connection:H0t}=sme(),$0t=et(),{pipe:G0t}=Pr(),ume=ame(),{codes:D0}=bi(),lme=class{constructor({localPeer:e,metrics:r,cryptos:i=new Map,muxers:n=new Map,onConnectionEnd:s=()=>{},onConnection:o=()=>{}}){this.localPeer=e,this.metrics=r,this.cryptos=i,this.muxers=n,this.protector=null,this.protocols=new Map,this.onConnection=o,this.onConnectionEnd=s}async upgradeInbound(e){let r,i,n,s,o,a,c;if(this.metrics){({setTarget:a,proxy:c}=ume());let u=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>u}),e=this.metrics.trackStream({stream:e,remotePeer:c})}Ti("Starting the inbound connection upgrade");let l=e;this.protector&&(l=await this.protector.protect(e));try{({conn:r,remotePeer:i,protocol:o}=await this._encryptInbound(this.localPeer,l,this.cryptos)),this.muxers.size?{stream:n,Muxer:s}=await this._multiplexInbound(r,this.muxers):n=r}catch(u){throw Ti.error("Failed to upgrade inbound connection",u),await e.close(u),u}return this.metrics&&(this.metrics.updatePlaceholder(c,i),a(i)),Ti("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:n,Muxer:s,remotePeer:i})}async upgradeOutbound(e){let r=e.remoteAddr.getPeerId();if(!r)throw kh(new Error("outbound connection must have a peer id"),D0.ERR_INVALID_MULTIADDR);let i=$0t.createFromB58String(r),n,s,o,a,c,l,u;if(this.metrics){({setTarget:l,proxy:u}=ume());let d=(Math.random()*1e9).toString(36)+Date.now();l({toB58String:()=>d}),e=this.metrics.trackStream({stream:e,remotePeer:u})}Ti("Starting the outbound connection upgrade");let h=e;this.protector&&(h=await this.protector.protect(e));try{({conn:n,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,h,i,this.cryptos)),this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(n,this.muxers):o=n}catch(d){throw Ti.error("Failed to upgrade outbound connection",d),await e.close(d),d}return this.metrics&&(this.metrics.updatePlaceholder(u,s),l(s)),Ti("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:r,maConn:i,upgradedConn:n,Muxer:s,remotePeer:o}){let a,c,l;s&&(a=new s({onStream:async d=>{if(!l)return;let y=new N0.Listener(d);try{let{stream:g,protocol:m}=await y.handle(Array.from(this.protocols.keys()));Ti("%s: incoming stream opened on %s",r,m),this.metrics&&this.metrics.trackStream({stream:g,remotePeer:o,protocol:m}),l.addStream(d,{protocol:m}),this._onStream({connection:l,stream:{...d,...g},protocol:m})}catch(g){Ti.error(g)}},onStreamEnd:d=>{l.removeStream(d.id)}}),c=async d=>{Ti("%s: starting new stream on %s",r,d);let y=a.newStream(),g=new N0.Dialer(y);try{let{stream:m,protocol:E}=await g.select(d);return this.metrics&&this.metrics.trackStream({stream:m,remotePeer:o,protocol:E}),{stream:{...y,...m},protocol:E}}catch(m){throw Ti.error("could not create new stream",m),kh(m,D0.ERR_UNSUPPORTED_PROTOCOL)}},G0t(n,a,n).catch(Ti.error));let u=i.timeline;i.timeline=new Proxy(u,{set:(...d)=>(l&&d[1]==="close"&&d[2]&&!u.close&&(async()=>{try{l.stat.status==="open"&&await l.close()}catch(y){Ti.error(y)}finally{this.onConnectionEnd(l)}})(),Reflect.set(...d))}),i.timeline.upgraded=Date.now();let h=()=>{throw kh(new Error("connection is not multiplexed"),"ERR_CONNECTION_NOT_MULTIPLEXED")};return l=new H0t({localAddr:i.localAddr,remoteAddr:i.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:r,timeline:i.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||h,getStreams:()=>a?a.streams:h(),close:async()=>{await i.close(),a&&a.streams.map(d=>d.abort())}}),this.onConnection(l),l}_onStream({connection:e,stream:r,protocol:i}){this.protocols.get(i)({connection:e,stream:r,protocol:i})}async _encryptInbound(e,r,i){let n=new N0.Listener(r),s=Array.from(i.keys());Ti("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await n.handle(s),c=i.get(a);if(Ti("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw kh(o,D0.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,r,i,n){let s=new N0.Dialer(r),o=Array.from(n.keys());Ti("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),l=n.get(c);if(Ti("encrypting outbound connection to %j",i),!l)throw new Error(`no crypto module found for ${c}`);return{...await l.secureOutbound(e,a,i),protocol:c}}catch(a){throw kh(a,D0.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,r){let i=new N0.Dialer(e),n=Array.from(r.keys());Ti("outbound selecting muxer %s",n);try{let{stream:s,protocol:o}=await i.select(n);Ti("%s selected as muxer protocol",o);let a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw kh(s,D0.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,r){let i=new N0.Listener(e),n=Array.from(r.keys());Ti("inbound handling muxers %s",n);try{let{stream:s,protocol:o}=await i.handle(n),a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw kh(s,D0.ERR_MUXER_UNAVAILABLE)}}};fme.exports=lme});var V1=p((MMt,gme)=>{f();"use strict";var nC=ae(),dme=et(),{codes:{ERR_INVALID_PARAMETERS:pme}}=bi(),W0t=t=>t,yme=class{constructor({peerStore:e,eventName:r,eventProperty:i,eventTransformer:n=W0t}){this._ps=e,this.eventName=r,this.eventProperty=i,this.eventTransformer=n,this.data=new Map}set(e,r){throw nC(new Error("set must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}_setData(e,r,{emit:i=!0}={}){let n=e.toB58String();this.data.set(n,r),i&&this._emit(e,r)}_emit(e,r){this._ps.emit(this.eventName,{peerId:e,[this.eventProperty]:this.eventTransformer(r)})}get(e){if(!dme.isPeerId(e))throw nC(new Error("peerId must be an instance of peer-id"),pme);let r=this.data.get(e.toB58String());return r?[...r]:void 0}delete(e){if(!dme.isPeerId(e))throw nC(new Error("peerId must be an instance of peer-id"),pme);return this.data.delete(e.toB58String())?(this._emit(e,[]),!0):!1}};gme.exports=yme});var wme=p((LMt,vme)=>{f();"use strict";var bme=me(),Jo=Object.assign(bme("libp2p:peer-store:address-book"),{error:bme("libp2p:peer-store:address-book:err")}),M0=ae(),{Multiaddr:Y0t}=tt(),AS=et(),X0t=V1(),Q0t=uS(),{codes:{ERR_INVALID_PARAMETERS:L0}}=bi(),Z0t=P1(),mme=class extends X0t{constructor(e){super({peerStore:e,eventName:"change:multiaddrs",eventProperty:"multiaddrs",eventTransformer:r=>r.addresses?r.addresses.map(i=>i.multiaddr):[]});this.data=new Map}consumePeerRecord(e){let r;try{r=Q0t.createFromProtobuf(e.payload)}catch(c){return Jo.error("invalid peer record received"),!1}if(!r.peerId.equals(e.peerId))return Jo("signing key does not match PeerId in the PeerRecord"),!1;if(!r.multiaddrs||!r.multiaddrs.length)return!1;let i=r.peerId,n=i.toB58String(),o=(this.data.get(n)||{record:void 0}).record;if(o&&o.seqNumber>=r.seqNumber)return!1;let a=this._toAddresses(r.multiaddrs,!0);return this._setData(i,{addresses:a,record:{raw:e.marshal(),seqNumber:r.seqNumber}}),Jo(`stored provided peer record for ${n}`),!0}getRawEnvelope(e){let r=this.data.get(e.toB58String());if(!(!r||!r.record||!r.record.raw))return r.record.raw}getPeerRecord(e){let r=this.getRawEnvelope(e);if(!!r)return Z0t.createFromProtobuf(r)}set(e,r){if(!AS.isPeerId(e))throw Jo.error("peerId must be an instance of peer-id to store data"),M0(new Error("peerId must be an instance of peer-id"),L0);let i=this._toAddresses(r);if(!i.length)return this;let n=e.toB58String(),s=this.data.get(n);return s&&s.addresses&&s.addresses.length===i.length&&s.addresses.filter(a=>i.some(c=>a.multiaddr.equals(c.multiaddr))).length===s.addresses.length?(Jo(`the addresses provided to store are equal to the already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),Jo(`stored provided multiaddrs for ${n}`),s||this._ps.emit("peer",e),this)}add(e,r){if(!AS.isPeerId(e))throw Jo.error("peerId must be an instance of peer-id to store data"),M0(new Error("peerId must be an instance of peer-id"),L0);let i=this._toAddresses(r),n=e.toB58String();if(!i.length)return this;let s=this.data.get(n);return s&&s.addresses&&(s.addresses.forEach(o=>{i.find(a=>a.multiaddr.equals(o.multiaddr))||i.push(o)}),s.addresses.length===i.length)?(Jo(`the addresses provided to store are already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),Jo(`added provided multiaddrs for ${n}`),s&&s.addresses||this._ps.emit("peer",e),this)}get(e){if(!AS.isPeerId(e))throw M0(new Error("peerId must be an instance of peer-id"),L0);let r=this.data.get(e.toB58String());return r&&r.addresses?[...r.addresses]:void 0}_toAddresses(e,r=!1){if(!e)throw Jo.error("multiaddrs must be provided to store data"),M0(new Error("multiaddrs must be provided"),L0);let i=[];return e.forEach(n=>{if(!Y0t.isMultiaddr(n))throw Jo.error(`multiaddr ${n} must be an instance of multiaddr`),M0(new Error(`multiaddr ${n} must be an instance of multiaddr`),L0);i.find(s=>s.multiaddr.equals(n))||i.push({multiaddr:n,isCertified:r})}),i}getMultiaddrsForPeer(e,r=i=>i){if(!AS.isPeerId(e))throw M0(new Error("peerId must be an instance of peer-id"),L0);let i=this.data.get(e.toB58String());if(!(!i||!i.addresses))return r(i.addresses||[]).map(n=>{let s=n.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};vme.exports=mme});var Rme=p((UMt,Tme)=>{f();"use strict";var _me=me(),Eme=Object.assign(_me("libp2p:peer-store:key-book"),{error:_me("libp2p:peer-store:key-book:err")}),Sme=ae(),xme=et(),J0t=V1(),{codes:{ERR_INVALID_PARAMETERS:Ame}}=bi(),Ime=class extends J0t{constructor(e){super({peerStore:e,eventName:"change:pubkey",eventProperty:"pubkey",eventTransformer:r=>r.pubKey});this.data=new Map}set(e,r){if(!xme.isPeerId(e))throw Eme.error("peerId must be an instance of peer-id to store data"),Sme(new Error("peerId must be an instance of peer-id"),Ame);let i=e.toB58String();return!this.data.get(i)&&r&&(e.pubKey=r,this._setData(e,e),Eme(`stored provided public key for ${i}`)),this}get(e){if(!xme.isPeerId(e))throw Sme(new Error("peerId must be an instance of peer-id"),Ame);let r=this.data.get(e.toB58String());return r?r.pubKey:void 0}};Tme.exports=Ime});var kme=p((FMt,Ome)=>{f();"use strict";var Pme=me(),sC=Object.assign(Pme("libp2p:peer-store:proto-book"),{error:Pme("libp2p:peer-store:proto-book:err")}),U0=ae(),eyt=yi(),z1=et(),tyt=V1(),{codes:{ERR_INVALID_PARAMETERS:F0}}=bi(),Cme=class extends tyt{constructor(e){super({peerStore:e,eventName:"change:metadata",eventProperty:"metadata"});this.data=new Map}set(e,r,i){if(!z1.isPeerId(e))throw sC.error("peerId must be an instance of peer-id to store data"),U0(new Error("peerId must be an instance of peer-id"),F0);if(typeof r!="string"||!(i instanceof Uint8Array))throw sC.error("valid key and value must be provided to store data"),U0(new Error("valid key and value must be provided"),F0);return this._setValue(e,r,i),this}_setValue(e,r,i,{emit:n=!0}={}){let s=e.toB58String(),o=this.data.get(s)||new Map,a=o.get(r);if(a&&eyt(i,a)){sC(`the metadata provided to store is equal to the already stored for ${s} on ${r}`);return}o.set(r,i),this.data.set(s,o),n&&this._emit(e,r)}get(e){if(!z1.isPeerId(e))throw U0(new Error("peerId must be an instance of peer-id"),F0);return this.data.get(e.toB58String())}getValue(e,r){if(!z1.isPeerId(e))throw U0(new Error("peerId must be an instance of peer-id"),F0);let i=this.data.get(e.toB58String());return i&&i.get(r)}delete(e){if(!z1.isPeerId(e))throw U0(new Error("peerId must be an instance of peer-id"),F0);return this.data.delete(e.toB58String())?(this._emit(e),!0):!1}deleteValue(e,r){if(!z1.isPeerId(e))throw U0(new Error("peerId must be an instance of peer-id"),F0);let i=this.data.get(e.toB58String());return!i||!i.delete(r)?!1:(this._emit(e,r),!0)}};Ome.exports=Cme});var Dme=p((KMt,Nme)=>{f();"use strict";var qme=me(),ea=Object.assign(qme("libp2p:peer-store:proto-book"),{error:qme("libp2p:peer-store:proto-book:err")}),K0=ae(),oC=et(),ryt=V1(),{codes:{ERR_INVALID_PARAMETERS:j0}}=bi(),Bme=class extends ryt{constructor(e){super({peerStore:e,eventName:"change:protocols",eventProperty:"protocols",eventTransformer:r=>Array.from(r)});this.data=new Map}set(e,r){if(!oC.isPeerId(e))throw ea.error("peerId must be an instance of peer-id to store data"),K0(new Error("peerId must be an instance of peer-id"),j0);if(!r)throw ea.error("protocols must be provided to store data"),K0(new Error("protocols must be provided"),j0);let i=e.toB58String(),n=this.data.get(i),s=new Set(r);return n&&((a,c)=>a.size===c.size&&[...a].every(l=>c.has(l)))(n,s)?(ea(`the protocols provided to store are equal to the already stored for ${i}`),this):(this._setData(e,s),ea(`stored provided protocols for ${i}`),this)}add(e,r){if(!oC.isPeerId(e))throw ea.error("peerId must be an instance of peer-id to store data"),K0(new Error("peerId must be an instance of peer-id"),j0);if(!r)throw ea.error("protocols must be provided to store data"),K0(new Error("protocols must be provided"),j0);let i=e.toB58String(),n=this.data.get(i)||new Set,s=new Set([...n,...r]);return n.size===s.size?(ea(`the protocols provided to store are already stored for ${i}`),this):(this._setData(e,s),ea(`added provided protocols for ${i}`),this)}remove(e,r){if(!oC.isPeerId(e))throw ea.error("peerId must be an instance of peer-id to store data"),K0(new Error("peerId must be an instance of peer-id"),j0);if(!r)throw ea.error("protocols must be provided to store data"),K0(new Error("protocols must be provided"),j0);let i=e.toB58String(),n=this.data.get(i);if(n){let s=new Set([...n].filter(o=>!r.includes(o)));if(n.size===s.size)return this;this._setData(e,s),ea(`removed provided protocols for ${i}`)}return this}};Nme.exports=Bme});var aC=p((jMt,Ume)=>{f();"use strict";var iyt=ae(),{EventEmitter:nyt}=vr(),Mme=et(),syt=wme(),oyt=Rme(),ayt=kme(),cyt=Dme(),{codes:{ERR_INVALID_PARAMETERS:uyt}}=bi(),Lme=class extends nyt{constructor({peerId:e}){super();this._peerId=e,this.addressBook=new syt(this),this.keyBook=new oyt(this),this.metadataBook=new ayt(this),this.protoBook=new cyt(this)}start(){}stop(){}get peers(){let e=new Set([...this.addressBook.data.keys(),...this.keyBook.data.keys(),...this.protoBook.data.keys(),...this.metadataBook.data.keys()]);this._peerId&&e.delete(this._peerId.toB58String());let r=new Map;return e.forEach(i=>{r.set(i,this.get(Mme.createFromB58String(i)))}),r}delete(e){let r=this.addressBook.delete(e),i=this.keyBook.delete(e),n=this.protoBook.delete(e),s=this.metadataBook.delete(e);return r||i||n||s}get(e){if(!Mme.isPeerId(e))throw iyt(new Error("peerId must be an instance of peer-id"),uyt);let r=this.keyBook.data.get(e.toB58String()),i=this.addressBook.get(e),n=this.metadataBook.get(e),s=this.protoBook.get(e);if(!(!r&&!i&&!n&&!s))return{id:r||e,addresses:i||[],protocols:s||[],metadata:n}}};Ume.exports=Lme});var Kme=p((VMt,Fme)=>{f();"use strict";function lyt(t,e,r){let i=new t(e,r);i._subscribeAdapter=i.subscribe,i._unsubscribeAdapter=i.unsubscribe;function n(o,a){a&&i.on(o,a),i._subscribeAdapter(o)}function s(o,a){a?i.removeListener(o,a):i.removeAllListeners(o),i.listenerCount(o)===0&&i._unsubscribeAdapter(o)}return i.subscribe=n,i.unsubscribe=s,i}Fme.exports=lyt});var jme=p((zMt,V0)=>{f();"use strict";V0.exports.NAMESPACE_COMMON="/peers/";V0.exports.NAMESPACE_ADDRESS="/peers/addrs/";V0.exports.NAMESPACE_KEYS="/peers/keys/";V0.exports.NAMESPACE_METADATA="/peers/metadata/";V0.exports.NAMESPACE_PROTOCOL="/peers/protos/"});var zme=p((HMt,Vme)=>{f();"use strict";var Ml=Bi(),z0=Ml.Reader,cC=Ml.Writer,Jr=Ml.util,Ri=Ml.roots["libp2p-address-book"]||(Ml.roots["libp2p-address-book"]={});Ri.Addresses=function(){function t(e){if(this.addrs=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.addrs=Jr.emptyArray,t.prototype.certifiedRecord=null,t.encode=function(r,i){if(i||(i=cC.create()),r.addrs!=null&&r.addrs.length)for(var n=0;n<r.addrs.length;++n)Ri.Addresses.Address.encode(r.addrs[n],i.uint32(10).fork()).ldelim();return r.certifiedRecord!=null&&Object.hasOwnProperty.call(r,"certifiedRecord")&&Ri.Addresses.CertifiedRecord.encode(r.certifiedRecord,i.uint32(18).fork()).ldelim(),i},t.decode=function(r,i){r instanceof z0||(r=z0.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Ri.Addresses;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(Ri.Addresses.Address.decode(r,r.uint32()));break;case 2:s.certifiedRecord=Ri.Addresses.CertifiedRecord.decode(r,r.uint32());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Ri.Addresses)return r;var i=new Ri.Addresses;if(r.addrs){if(!Array.isArray(r.addrs))throw TypeError(".Addresses.addrs: array expected");i.addrs=[];for(var n=0;n<r.addrs.length;++n){if(typeof r.addrs[n]!="object")throw TypeError(".Addresses.addrs: object expected");i.addrs[n]=Ri.Addresses.Address.fromObject(r.addrs[n])}}if(r.certifiedRecord!=null){if(typeof r.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");i.certifiedRecord=Ri.Addresses.CertifiedRecord.fromObject(r.certifiedRecord)}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addrs=[]),i.defaults&&(n.certifiedRecord=null),r.addrs&&r.addrs.length){n.addrs=[];for(var s=0;s<r.addrs.length;++s)n.addrs[s]=Ri.Addresses.Address.toObject(r.addrs[s],i)}return r.certifiedRecord!=null&&r.hasOwnProperty("certifiedRecord")&&(n.certifiedRecord=Ri.Addresses.CertifiedRecord.toObject(r.certifiedRecord,i)),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ml.util.toJSONOptions)},t.Address=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.multiaddr=Jr.newBuffer([]),e.prototype.isCertified=!1,e.encode=function(i,n){return n||(n=cC.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&n.uint32(16).bool(i.isCertified),n},e.decode=function(i,n){i instanceof z0||(i=z0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ri.Addresses.Address;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;case 2:o.isCertified=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ri.Addresses.Address)return i;var n=new Ri.Addresses.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?Jr.base64.decode(i.multiaddr,n.multiaddr=Jr.newBuffer(Jr.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),i.isCertified!=null&&(n.isCertified=Boolean(i.isCertified)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=Jr.newBuffer(s.multiaddr))),s.isCertified=!1),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?Jr.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ml.util.toJSONOptions)},e}(),t.CertifiedRecord=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.seq=Jr.Long?Jr.Long.fromBits(0,0,!0):0,e.prototype.raw=Jr.newBuffer([]),e.encode=function(i,n){return n||(n=cC.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&n.uint32(8).uint64(i.seq),i.raw!=null&&Object.hasOwnProperty.call(i,"raw")&&n.uint32(18).bytes(i.raw),n},e.decode=function(i,n){i instanceof z0||(i=z0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ri.Addresses.CertifiedRecord;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.seq=i.uint64();break;case 2:o.raw=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ri.Addresses.CertifiedRecord)return i;var n=new Ri.Addresses.CertifiedRecord;return i.seq!=null&&(Jr.Long?(n.seq=Jr.Long.fromValue(i.seq)).unsigned=!0:typeof i.seq=="string"?n.seq=parseInt(i.seq,10):typeof i.seq=="number"?n.seq=i.seq:typeof i.seq=="object"&&(n.seq=new Jr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0))),i.raw!=null&&(typeof i.raw=="string"?Jr.base64.decode(i.raw,n.raw=Jr.newBuffer(Jr.base64.length(i.raw)),0):i.raw.length&&(n.raw=i.raw)),n},e.toObject=function(i,n){n||(n={});var s={};if(n.defaults){if(Jr.Long){var o=new Jr.Long(0,0,!0);s.seq=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else s.seq=n.longs===String?"0":0;n.bytes===String?s.raw="":(s.raw=[],n.bytes!==Array&&(s.raw=Jr.newBuffer(s.raw)))}return i.seq!=null&&i.hasOwnProperty("seq")&&(typeof i.seq=="number"?s.seq=n.longs===String?String(i.seq):i.seq:s.seq=n.longs===String?Jr.Long.prototype.toString.call(i.seq):n.longs===Number?new Jr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0):i.seq),i.raw!=null&&i.hasOwnProperty("raw")&&(s.raw=n.bytes===String?Jr.base64.encode(i.raw,0,i.raw.length):n.bytes===Array?Array.prototype.slice.call(i.raw):i.raw),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ml.util.toJSONOptions)},e}(),t}();Vme.exports=Ri});var Gme=p(($Mt,$me)=>{f();"use strict";var H0=Bi(),Hme=H0.Reader,fyt=H0.Writer,hyt=H0.util,H1=H0.roots["libp2p-proto-book"]||(H0.roots["libp2p-proto-book"]={});H1.Protocols=function(){function t(e){if(this.protocols=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.protocols=hyt.emptyArray,t.encode=function(r,i){if(i||(i=fyt.create()),r.protocols!=null&&r.protocols.length)for(var n=0;n<r.protocols.length;++n)i.uint32(10).string(r.protocols[n]);return i},t.decode=function(r,i){r instanceof Hme||(r=Hme.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new H1.Protocols;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof H1.Protocols)return r;var i=new H1.Protocols;if(r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Protocols.protocols: array expected");i.protocols=[];for(var n=0;n<r.protocols.length;++n)i.protocols[n]=String(r.protocols[n])}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.protocols=[]),r.protocols&&r.protocols.length){n.protocols=[];for(var s=0;s<r.protocols.length;++s)n.protocols[s]=r.protocols[s]}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,H0.util.toJSONOptions)},t}();$me.exports=H1});var Jme=p((GMt,Zme)=>{f();"use strict";var Wme=me(),Gi=Object.assign(Wme("libp2p:persistent-peer-store"),{error:Wme("libp2p:persistent-peer-store:err")}),{Key:IS}=Ft(),{Multiaddr:dyt}=tt(),uC=et(),{base32:pyt}=(an(),on),yyt=aC(),{NAMESPACE_ADDRESS:gyt,NAMESPACE_COMMON:byt,NAMESPACE_KEYS:myt,NAMESPACE_METADATA:vyt,NAMESPACE_PROTOCOL:wyt}=jme(),{Addresses:Yme}=zme(),{Protocols:Xme}=Gme(),Qme=class extends yyt{constructor({peerId:e,datastore:r,threshold:i=5}){super({peerId:e});this._datastore=r,this._dirtyPeers=new Set,this._dirtyMetadata=new Map,this.threshold=i,this._addDirtyPeer=this._addDirtyPeer.bind(this)}async start(){Gi("PeerStore is starting"),this.on("change:protocols",this._addDirtyPeer),this.on("change:multiaddrs",this._addDirtyPeer),this.on("change:pubkey",this._addDirtyPeerKey),this.on("change:metadata",this._addDirtyPeerMetadata);for await(let e of this._datastore.query({prefix:byt}))await this._processDatastoreEntry(e);Gi("PeerStore started")}async stop(){Gi("PeerStore is stopping"),this.removeAllListeners(),await this._commitData(),Gi("PeerStore stopped")}_addDirtyPeer({peerId:e}){let r=e.toB58String();Gi("add dirty peer",r),this._dirtyPeers.add(r),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{Gi.error("error committing data",i)})}_addDirtyPeerKey({peerId:e}){if(e.hasInlinePublicKey())return;let r=e.toB58String();Gi("add dirty peer key",r),this._dirtyPeers.add(r),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{Gi.error("error committing data",i)})}_addDirtyPeerMetadata({peerId:e,metadata:r}){let i=e.toB58String();Gi("add dirty metadata peer",i),this._dirtyPeers.add(i);let n=this._dirtyMetadata.get(i)||new Set;n.add(r),this._dirtyMetadata.set(i,n),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(s=>{Gi.error("error committing data",s)})}async _commitData(){let e=Array.from(this._dirtyPeers);if(!e.length)return;this._dirtyPeers.clear(),Gi("create batch commit");let r=this._datastore.batch();for(let i of e){let n=this.keyBook.data.get(i)||uC.createFromB58String(i);this._batchAddressBook(n,r),!n.hasInlinePublicKey()&&this._batchKeyBook(n,r),this._batchMetadataBook(n,r),this._batchProtoBook(n,r)}await r.commit(),Gi("batch committed")}_batchAddressBook(e,r){let i=e.toString(),n=new IS(`${gyt}${i}`),s=this.addressBook.data.get(e.toB58String());try{if(!s){r.delete(n);return}let o=Yme.encode({addrs:s.addresses.map(a=>({multiaddr:a.multiaddr.bytes,isCertified:a.isCertified})),certifiedRecord:s.record?{seq:s.record.seqNumber,raw:s.record.raw}:void 0}).finish();r.put(n,o)}catch(o){Gi.error(o)}}_batchKeyBook(e,r){let i=e.toString(),n=new IS(`${myt}${i}`);try{if(!e.pubKey){r.delete(n);return}let s=e.marshalPubKey();r.put(n,s)}catch(s){Gi.error(s)}}_batchMetadataBook(e,r){let i=e.toString(),n=this._dirtyMetadata.get(e.toB58String())||[];try{n.forEach(s=>{let o=new IS(`${vyt}${i}/${s}`),a=this.metadataBook.getValue(e,s);a?r.put(o,a):r.delete(o)})}catch(s){Gi.error(s)}}_batchProtoBook(e,r){let i=e.toString(),n=new IS(`${wyt}${i}`),s=this.protoBook.get(e);try{if(!s){r.delete(n);return}let o=Xme.encode({protocols:s}).finish();r.put(n,o)}catch(o){Gi.error(o)}}async _processDatastoreEntry({key:e,value:r}){try{let i=e.toString().split("/"),n=uC.createFromBytes(pyt.decode(i[3])),s;switch(i[2]){case"addrs":s=Yme.decode(r),this.addressBook._setData(n,{addresses:s.addrs.map(o=>({multiaddr:new dyt(o.multiaddr),isCertified:Boolean(o.isCertified)})),record:s.certifiedRecord?{raw:s.certifiedRecord.raw,seqNumber:s.certifiedRecord.seq}:void 0},{emit:!1});break;case"keys":s=await uC.createFromPubKey(r),this.keyBook._setData(s,s,{emit:!1});break;case"metadata":this.metadataBook._setValue(n,i[4],r,{emit:!1});break;case"protos":s=Xme.decode(r),this.protoBook._setData(n,new Set(s.protocols),{emit:!1});break;default:Gi("invalid data persisted for: ",e.toString())}}catch(i){Gi.error(i)}}};Zme.exports=Qme});var ive=p((WMt,rve)=>{f();"use strict";var eve=me(),_yt=Object.assign(eve("libp2p:registrar"),{error:eve("libp2p:registrar:err")}),Eyt=ae(),{codes:{ERR_INVALID_PARAMETERS:Syt}}=bi(),xyt=h8(),tve=class{constructor({peerStore:e,connectionManager:r}){this.peerStore=e,this.connectionManager=r,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}register(e){if(!xyt.isTopology(e))throw _yt.error("topology must be an instance of interfaces/topology"),Eyt(new Error("topology must be an instance of interfaces/topology"),Syt);let r=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(r,e),e.registrar=this,r}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,r]of this.topologies)r.disconnect(e.remotePeer)}};rve.exports=tve});var ove=p((YMt,sve)=>{f();"use strict";var{Buffer:ta}=ft(),nve=Symbol.for("BufferList");function dr(t){if(!(this instanceof dr))return new dr(t);dr._init.call(this,t)}dr._init=function(e){Object.defineProperty(this,nve,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};dr.prototype._new=function(e){return new dr(e)};dr.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};dr.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};dr.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};dr.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};dr.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||ta.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,l=s&&r||0,u=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:ta.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,l),l+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-u)return s?this._bufs[o[0]].copy(e,r,u,u+c):this._bufs[o[0]].slice(u,u+c);s||(e=ta.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-u;if(c>d)this._bufs[h].copy(e,l,u),l+=d;else{this._bufs[h].copy(e,l,u,u+c),l+=d;break}c-=d,u&&(u=0)}return e.length>l?e.slice(0,l):e};dr.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};dr.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};dr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};dr.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};dr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(ta.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(ta.from(e));return this};dr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};dr.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=ta.from([t]):typeof t=="string"?t=ta.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=ta.from(t.buffer,t.byteOffset,t.byteLength):ta.isBuffer(t)||(t=ta.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,t))return c;s++}s=0}return-1};dr.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?dr.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:dr.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();dr.prototype._isBufferList=function(e){return e instanceof dr||dr.isBufferList(e)};dr.isBufferList=function(e){return e!=null&&e[nve]};sve.exports=dr});var PS=p((XMt,$1)=>{f();"use strict";var{Buffer:TS}=ft(),RS=ove();$1.exports=async function*(t){for await(let e of t)TS.isBuffer(e)?yield e:RS.isBufferList(e)?yield e.slice():yield TS.from(e)};$1.exports.toBuffer=$1.exports;$1.exports.toList=async function*(t){for await(let e of t)TS.isBuffer(e)?yield new RS().append(e):RS.isBufferList(e)?yield e:yield new RS().append(TS.from(e))}});var cve=p((QMt,ave)=>{f();"use strict";ave.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32}});var hve=p((OS,fve)=>{f();"use strict";var uve=me(),Ayt=Object.assign(uve("libp2p:ping"),{error:uve("libp2p:ping:err")}),Iyt=ae(),Tyt=Ma(),{pipe:lve}=Pr(),{toBuffer:Ryt}=PS(),{collect:Pyt,take:Cyt}=Tp(),Oyt=yi(),{PROTOCOL:CS,PING_LENGTH:kyt}=cve();async function qyt(t,e){Ayt("dialing %s to %s",CS,e.toB58String?e.toB58String():e);let r=await t.dial(e),{stream:i}=await r.newStream(CS),n=Date.now(),s=Tyt.randomBytes(kyt),[o]=await lve([s],i,c=>Cyt(1,c),Ryt,Pyt),a=Date.now();if(!Oyt(s,o))throw Iyt(new Error("Received wrong ping ack"),"ERR_WRONG_PING_ACK");return a-n}function Byt(t){t.handle(CS,({stream:e})=>lve(e,e))}function Nyt(t){t.unhandle(CS)}OS=fve.exports=qyt;OS.mount=Byt;OS.unmount=Nyt});var yve=p((ZMt,pve)=>{f();"use strict";var $0=Bi(),dve=$0.Reader,Dyt=$0.Writer,Tr=$0.util,G1=$0.roots["libp2p-identify"]||($0.roots["libp2p-identify"]={});G1.Identify=function(){function t(e){if(this.listenAddrs=[],this.protocols=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.protocolVersion="",t.prototype.agentVersion="",t.prototype.publicKey=Tr.newBuffer([]),t.prototype.listenAddrs=Tr.emptyArray,t.prototype.observedAddr=Tr.newBuffer([]),t.prototype.protocols=Tr.emptyArray,t.prototype.signedPeerRecord=Tr.newBuffer([]),t.encode=function(r,i){if(i||(i=Dyt.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&i.uint32(10).bytes(r.publicKey),r.listenAddrs!=null&&r.listenAddrs.length)for(var n=0;n<r.listenAddrs.length;++n)i.uint32(18).bytes(r.listenAddrs[n]);if(r.protocols!=null&&r.protocols.length)for(var n=0;n<r.protocols.length;++n)i.uint32(26).string(r.protocols[n]);return r.observedAddr!=null&&Object.hasOwnProperty.call(r,"observedAddr")&&i.uint32(34).bytes(r.observedAddr),r.protocolVersion!=null&&Object.hasOwnProperty.call(r,"protocolVersion")&&i.uint32(42).string(r.protocolVersion),r.agentVersion!=null&&Object.hasOwnProperty.call(r,"agentVersion")&&i.uint32(50).string(r.agentVersion),r.signedPeerRecord!=null&&Object.hasOwnProperty.call(r,"signedPeerRecord")&&i.uint32(66).bytes(r.signedPeerRecord),i},t.decode=function(r,i){r instanceof dve||(r=dve.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new G1.Identify;r.pos<n;){var o=r.uint32();switch(o>>>3){case 5:s.protocolVersion=r.string();break;case 6:s.agentVersion=r.string();break;case 1:s.publicKey=r.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(r.bytes());break;case 4:s.observedAddr=r.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;case 8:s.signedPeerRecord=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof G1.Identify)return r;var i=new G1.Identify;if(r.protocolVersion!=null&&(i.protocolVersion=String(r.protocolVersion)),r.agentVersion!=null&&(i.agentVersion=String(r.agentVersion)),r.publicKey!=null&&(typeof r.publicKey=="string"?Tr.base64.decode(r.publicKey,i.publicKey=Tr.newBuffer(Tr.base64.length(r.publicKey)),0):r.publicKey.length&&(i.publicKey=r.publicKey)),r.listenAddrs){if(!Array.isArray(r.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");i.listenAddrs=[];for(var n=0;n<r.listenAddrs.length;++n)typeof r.listenAddrs[n]=="string"?Tr.base64.decode(r.listenAddrs[n],i.listenAddrs[n]=Tr.newBuffer(Tr.base64.length(r.listenAddrs[n])),0):r.listenAddrs[n].length&&(i.listenAddrs[n]=r.listenAddrs[n])}if(r.observedAddr!=null&&(typeof r.observedAddr=="string"?Tr.base64.decode(r.observedAddr,i.observedAddr=Tr.newBuffer(Tr.base64.length(r.observedAddr)),0):r.observedAddr.length&&(i.observedAddr=r.observedAddr)),r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Identify.protocols: array expected");i.protocols=[];for(var n=0;n<r.protocols.length;++n)i.protocols[n]=String(r.protocols[n])}return r.signedPeerRecord!=null&&(typeof r.signedPeerRecord=="string"?Tr.base64.decode(r.signedPeerRecord,i.signedPeerRecord=Tr.newBuffer(Tr.base64.length(r.signedPeerRecord)),0):r.signedPeerRecord.length&&(i.signedPeerRecord=r.signedPeerRecord)),i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.listenAddrs=[],n.protocols=[]),i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Tr.newBuffer(n.publicKey))),i.bytes===String?n.observedAddr="":(n.observedAddr=[],i.bytes!==Array&&(n.observedAddr=Tr.newBuffer(n.observedAddr))),n.protocolVersion="",n.agentVersion="",i.bytes===String?n.signedPeerRecord="":(n.signedPeerRecord=[],i.bytes!==Array&&(n.signedPeerRecord=Tr.newBuffer(n.signedPeerRecord)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Tr.base64.encode(r.publicKey,0,r.publicKey.length):i.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.listenAddrs&&r.listenAddrs.length){n.listenAddrs=[];for(var s=0;s<r.listenAddrs.length;++s)n.listenAddrs[s]=i.bytes===String?Tr.base64.encode(r.listenAddrs[s],0,r.listenAddrs[s].length):i.bytes===Array?Array.prototype.slice.call(r.listenAddrs[s]):r.listenAddrs[s]}if(r.protocols&&r.protocols.length){n.protocols=[];for(var s=0;s<r.protocols.length;++s)n.protocols[s]=r.protocols[s]}return r.observedAddr!=null&&r.hasOwnProperty("observedAddr")&&(n.observedAddr=i.bytes===String?Tr.base64.encode(r.observedAddr,0,r.observedAddr.length):i.bytes===Array?Array.prototype.slice.call(r.observedAddr):r.observedAddr),r.protocolVersion!=null&&r.hasOwnProperty("protocolVersion")&&(n.protocolVersion=r.protocolVersion),r.agentVersion!=null&&r.hasOwnProperty("agentVersion")&&(n.agentVersion=r.agentVersion),r.signedPeerRecord!=null&&r.hasOwnProperty("signedPeerRecord")&&(n.signedPeerRecord=i.bytes===String?Tr.base64.encode(r.signedPeerRecord,0,r.signedPeerRecord.length):i.bytes===Array?Array.prototype.slice.call(r.signedPeerRecord):r.signedPeerRecord),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,$0.util.toJSONOptions)},t}();pve.exports=G1});var xve=p((JMt,Sve)=>{f();"use strict";var gve=me(),ac=Object.assign(gve("libp2p:identify"),{error:gve("libp2p:identify:err")}),lC=ae(),kS=$o(),{pipe:qS}=Pr(),{collect:bve,take:mve,consume:vve}=Tp(),G0=ct(),Myt=et(),{Multiaddr:fC}=tt(),{toBuffer:wve}=PS(),W1=yve(),_ve=P1(),Eve=uS(),{MULTICODEC_IDENTIFY:hC,MULTICODEC_IDENTIFY_PUSH:BS,PROTOCOL_VERSION:Lyt}=yP(),{codes:dC}=bi(),W0=class{constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this),this._host={protocolVersion:Lyt,...e._options.host},this.peerStore.metadataBook.set(this.peerId,"AgentVersion",G0(this._host.agentVersion)),this.peerStore.metadataBook.set(this.peerId,"ProtocolVersion",G0(this._host.protocolVersion)),this.connectionManager.on("peer:connect",r=>{this.identify(r).catch(ac.error)}),this.peerStore.on("change:multiaddrs",({peerId:r})=>{r.toString()===this.peerId.toString()&&this.pushToPeerStore()}),this.peerStore.on("change:protocols",({peerId:r})=>{r.toString()===this.peerId.toString()&&this.pushToPeerStore()})}async push(e){let r=await this.peerStore.addressBook.getRawEnvelope(this.peerId),i=this._libp2p.multiaddrs.map(o=>o.bytes),n=this.peerStore.protoBook.get(this.peerId)||[],s=e.map(async o=>{try{let{stream:a}=await o.newStream(BS);await qS([W1.Identify.encode({listenAddrs:i,signedPeerRecord:r,protocols:n}).finish()],kS.encode(),a,vve)}catch(a){ac.error("could not push identify update to peer",a)}});return Promise.all(s)}pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],r;for(let i of this.peerStore.peers.values())i.protocols.includes(BS)&&(r=this.connectionManager.get(i.id))&&e.push(r);this.push(e)}async identify(e){let{stream:r}=await e.newStream(hC),[i]=await qS([],r,kS.decode(),mve(1),wve,bve);if(!i)throw lC(new Error("No data could be retrieved"),dC.ERR_CONNECTION_ENDED);let n;try{n=W1.Identify.decode(i)}catch(d){throw lC(d,dC.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:l}=n,u=await Myt.createFromPubKey(s);if(e.remotePeer.toB58String()!==u.toB58String())throw lC(new Error("identified peer does not match the expected peer"),dC.ERR_INVALID_PEER);let h=W0.getCleanMultiaddr(c);try{let d=await _ve.openAndCertify(l,Eve.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(d)){this.peerStore.protoBook.set(u,a),this.peerStore.metadataBook.set(u,"AgentVersion",G0(n.agentVersion)),this.peerStore.metadataBook.set(u,"ProtocolVersion",G0(n.protocolVersion));return}}catch(d){ac("received invalid envelope, discard it and fallback to listenAddrs is available",d)}try{this.peerStore.addressBook.set(u,o.map(d=>new fC(d)))}catch(d){ac.error("received invalid addrs",d)}this.peerStore.protoBook.set(u,a),this.peerStore.metadataBook.set(u,"AgentVersion",G0(n.agentVersion)),this.peerStore.metadataBook.set(u,"ProtocolVersion",G0(n.protocolVersion)),ac("received observed address of %s",h)}handleMessage({connection:e,stream:r,protocol:i}){switch(i){case hC:return this._handleIdentify({connection:e,stream:r});case BS:return this._handlePush({connection:e,stream:r});default:ac.error("cannot handle unknown protocol %s",i)}}async _handleIdentify({connection:e,stream:r}){let i=new Uint8Array(0);this.peerId.pubKey&&(i=this.peerId.pubKey.bytes);let n=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=this.peerStore.protoBook.get(this.peerId)||[],o=W1.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:i,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:n,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();try{await qS([o],kS.encode(),r,vve)}catch(a){ac.error("could not respond to identify request",a)}}async _handlePush({connection:e,stream:r}){let i;try{let[s]=await qS([],r,kS.decode(),mve(1),wve,bve);i=W1.Identify.decode(s)}catch(s){return ac.error("received invalid message",s)}let n=e.remotePeer;try{let s=await _ve.openAndCertify(i.signedPeerRecord,Eve.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(s)){this.peerStore.protoBook.set(n,i.protocols);return}}catch(s){ac("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{this.peerStore.addressBook.set(n,i.listenAddrs.map(s=>new fC(s)))}catch(s){ac.error("received invalid addrs",s)}this.peerStore.protoBook.set(n,i.protocols)}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new fC(e)}catch(r){return null}return null}},Uyt={IDENTIFY:hC,IDENTIFY_PUSH:BS};W0.multicodecs=Uyt;W0.Messsage=W1;Sve.exports=W0});var Ave=p(()=>{f()});var Tve=p(pC=>{f();"use strict";Object.defineProperty(pC,"__esModule",{value:!0});pC.promisify=NS;var Ive="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function NS(t){if(typeof t!="function")throw new TypeError("Argument to promisify must be a function");var e=t[Ive],r=NS.Promise||Promise;if(typeof r!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var i=this,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return new r(function(a,c){s.push(function(u){if(u)return c(u);for(var h=arguments.length,d=new Array(h>1?h-1:0),y=1;y<h;y++)d[y-1]=arguments[y];if(d.length===1||!e)return a(d[0]);var g={};d.forEach(function(m,E){var v=e[E];v&&(g[v]=m)}),a(g)}),t.apply(i,s)})}}NS.argumentNames=Ive;NS.Promise=void 0});var Pve=p((iLt,Rve)=>{f();"use strict";var Fyt=P6(),DS=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Y1=Fyt(),Kyt=DS&&!Y1,jyt=Y1&&!DS,Vyt=Y1&&DS,zyt=typeof aa=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!Y1,Hyt=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,$yt=typeof process!="undefined"&&typeof process.env!="undefined"&&!1;Rve.exports={isTest:$yt,isElectron:Y1,isElectronMain:jyt,isElectronRenderer:Vyt,isNode:zyt,isBrowser:Kyt,isWebWorker:Hyt,isEnvWithDom:DS}});var Ove=p((nLt,Cve)=>{f();function to(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}Cve.exports=to;to.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};to.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};to.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var i=this;return this._timer=setTimeout(function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout(function(){i._operationTimeoutCb(i._attempts)},i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)},r),this._options.unref&&this._timer.unref(),!0};to.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};to.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};to.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};to.prototype.start=to.prototype.try;to.prototype.errors=function(){return this._errors};to.prototype.attempts=function(){return this._attempts};to.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,i=0;i<this._errors.length;i++){var n=this._errors[i],s=n.message,o=(t[s]||0)+1;t[s]=o,o>=r&&(e=n,r=o)}return e}});var kve=p(qh=>{f();var Gyt=Ove();qh.operation=function(t){var e=qh.timeouts(t);return new Gyt(e,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};qh.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],n=0;n<e.retries;n++)i.push(this.createTimeout(n,e));return t&&t.forever&&!i.length&&i.push(this.createTimeout(n,e)),i.sort(function(s,o){return s-o}),i};qh.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,i=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return i=Math.min(i,e.maxTimeout),i};qh.wrap=function(t,e,r){if(e instanceof Array&&(r=e,e=null),!r){r=[];for(var i in t)typeof t[i]=="function"&&r.push(i)}for(var n=0;n<r.length;n++){var s=r[n],o=t[s];t[s]=function(c){var l=qh.operation(e),u=Array.prototype.slice.call(arguments,1),h=u.pop();u.push(function(d){l.retry(d)||(d&&(arguments[0]=l.mainError()),h.apply(this,arguments))}),l.attempt(function(){c.apply(t,u)})}.bind(t,o),t[s].options=e}}});var Bve=p((oLt,qve)=>{f();qve.exports=kve()});var Dve=p((aLt,MS)=>{f();"use strict";var Wyt=Bve(),Yyt=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],yC=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},Xyt=(t,e,r)=>{let i=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=i,t},Qyt=t=>Yyt.includes(t),Nve=(t,e)=>new Promise((r,i)=>{e={onFailedAttempt:()=>{},retries:10,...e};let n=Wyt.operation(e);n.attempt(async s=>{try{r(await t(s))}catch(o){if(!(o instanceof Error)){i(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof yC)n.stop(),i(o.originalError);else if(o instanceof TypeError&&!Qyt(o.message))n.stop(),i(o);else{Xyt(o,s,e);try{await e.onFailedAttempt(o)}catch(a){i(a);return}n.retry(o)||i(n.mainError())}}})});MS.exports=Nve;MS.exports.default=Nve;MS.exports.AbortError=yC});var Lve=p((cLt,Mve)=>{f();"use strict";function Zyt(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^::1$/.test(t)}Mve.exports=Zyt});var Fve=p((uLt,Uve)=>{f();"use strict";var Jyt=Lve();function egt(t){let{address:e}=t.nodeAddress();return Jyt(e)}Uve.exports=egt});var $ve=p((lLt,Hve)=>{f();"use strict";var tgt=Ave(),Kve=me(),{promisify:gC}=Tve(),{Multiaddr:rgt}=tt(),Y0=Object.assign(Kve("libp2p:nat"),{error:Kve("libp2p:nat:err")}),{isBrowser:jve}=Pve(),bC=Dve(),igt=gP(),Vve=pP(),ngt=ae(),{codes:{ERR_INVALID_PARAMETERS:sgt}}=bi(),ogt=Fve(),mC=7200;function agt(t=1024,e=65535){return Math.floor(Math.random()*(e-t+1)+t)}var zve=class{constructor({peerId:e,addressManager:r,transportManager:i,...n}){if(this._peerId=e,this._addressManager=r,this._transportManager=i,this._enabled=n.enabled,this._externalIp=n.externalIp,this._options={description:n.description||`${Vve.name}@${Vve.version} ${this._peerId}`,ttl:n.ttl||mC,autoUpdate:n.keepAlive||!0,gateway:n.gateway,enablePMP:Boolean(n.pmp&&n.pmp.enabled)},this._options.ttl<mC)throw ngt(new Error(`NatManager ttl should be at least ${mC} seconds`),sgt)}start(){jve||!this._enabled||this._start().catch(e=>{Y0.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let r of e){let{family:i,host:n,port:s,transport:o}=r.toOptions();if(!r.isThinWaistAddress()||o!=="tcp"||ogt(r)||i!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(igt(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let l=agt();Y0(`opening uPnP connection from ${c}:${l} to ${n}:${s}`),await a.map({publicPort:l,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(rgt.fromNodeAddress({family:4,address:c,port:l},o))}}_getClient(){if(this._client)return this._client;let e=new tgt(this._options),r=gC(e.map.bind(e)),i=gC(e.destroy.bind(e)),n=gC(e.externalIp.bind(e));return this._client={map:(...s)=>bC(()=>r(...s),{onFailedAttempt:Y0.error,unref:!0}),destroy:(...s)=>bC(()=>i(...s),{onFailedAttempt:Y0.error,unref:!0}),externalIp:(...s)=>bC(()=>n(...s),{onFailedAttempt:Y0.error,unref:!0})},this._client}async stop(){if(!(jve||!this._client))try{await this._client.destroy(),this._client=null}catch(e){Y0.error(e)}}};Hve.exports=zve});var Zve=p((fLt,Qve)=>{f();"use strict";var Gve=me(),ms=Object.assign(Gve("libp2p"),{error:Gve("libp2p:err")}),{EventEmitter:cgt}=vr(),vC=ae(),ugt=et(),{Multiaddr:lgt}=tt(),fgt=Y0e(),hgt=Z0e(),wC=dP(),{validate:dgt}=Jye(),{codes:LS,messages:pgt}=bi(),ygt=rge(),ggt=mge(),Wve=Wge(),bgt=abe(),mgt=qbe(),Yve=v1e(),vgt=k1e(),wgt=xP(),_gt=hme(),Egt=aC(),Sgt=Kme(),xgt=Jme(),Agt=ive(),US=hve(),Xve=xve(),Igt=Xve.multicodecs,Tgt=$ve(),{updateSelfPeerRecord:Rgt}=EP(),X1=class extends cgt{static async create(e){if(e.peerId)return new X1(e);let r=await ugt.create();return e.peerId=r,new X1(e)}constructor(e){super();if(this._options=dgt(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this.peerStore=this.datastore&&this._options.peerStore.persistence?new xgt({peerId:this.peerId,datastore:this.datastore,...this._options.peerStore}):new Egt({peerId:this.peerId}),this.addresses=this._options.addresses,this.addressManager=new ygt(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{Rgt(this).catch(i=>{ms.error("Error updating self peer record",i)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new ggt(this,{autoDial:this._config.peerDiscovery.autoDial,...this._options.connectionManager}),this._options.metrics.enabled&&(this.metrics=new vgt({...this._options.metrics,connectionManager:this.connectionManager})),this._options.keychain&&this._options.keychain.datastore){ms("creating keychain");let i=Yve.generateOptions();this.keychain=new Yve(this._options.keychain.datastore,{...i,...this._options.keychain}),ms("keychain constructed")}if(this.upgrader=new _gt({localPeer:this.peerId,metrics:this.metrics,onConnection:i=>this.connectionManager.onConnect(i),onConnectionEnd:i=>this.connectionManager.onDisconnect(i)}),this.transportManager=new wgt({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new Tgt({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new Agt({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw vC(new Error(pgt.CONN_ENCRYPTION_REQUIRED),LS.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(i=>{this.upgrader.cryptos.set(i.protocol,i)}),this.dialer=new mgt({transportManager:this.transportManager,peerStore:this.peerStore,...this._options.dialer}),this._modules.transport.forEach(i=>{let n=i.prototype[Symbol.toStringTag],s=this._config.transport[n];this.transportManager.add(n,i,s)}),this._config.relay.enabled&&(this.transportManager.add(Wve.prototype[Symbol.toStringTag],Wve),this.relay=new bgt(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(n=>{this.upgrader.muxers.set(n.multicodec,n)}),this.identifyService=new Xve({libp2p:this}),this.handle(Object.values(Igt),this.identifyService.handleMessage)),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let i=this._modules.dht;this._dht=new i({libp2p:this,dialer:this.dialer,peerId:this.peerId,peerStore:this.peerStore,registrar:this.registrar,datastore:this.datastore,...this._config.dht})}if(this._modules.pubsub){let i=this._modules.pubsub;this.pubsub=Sgt(i,this,this._config.pubsub)}this.peerRouting=new fgt(this),this.contentRouting=new hgt(this),US.mount(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this)}emit(e,...r){return e==="error"&&!this._events.error?(ms.error(r),!1):super.emit(e,...r)}async start(){ms("libp2p is starting");try{await this._onStarting(),await this._onDidStart(),ms("libp2p has started")}catch(e){throw this.emit("error",e),ms.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){ms("libp2p is stopping");try{this._isStarted=!1,this.relay&&this.relay.stop(),this.peerRouting.stop();for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.peerStore.stop(),await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this._dht&&this._dht.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),US.unmount(this),this.dialer.destroy()}catch(e){e&&(ms.error(e),this.emit("error",e))}ms("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,r){return this._dial(e,r)}async dialProtocol(e,r,i){if(!r||!r.length)throw vC(new Error("no protocols were provided to open a stream"),LS.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,i)).newStream(r)}async _dial(e,r){let{id:i,multiaddrs:n}=wC(e);if(i.equals(this.peerId))throw vC(new Error("Cannot dial self"),LS.ERR_DIALED_SELF);let s=this.connectionManager.get(i);return s?n&&this.peerStore.addressBook.add(i,n):s=await this.dialer.connectToPeer(e,r),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(n=>n.toString());e.length||(e=this.transportManager.getAddrs().map(n=>n.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(n=>n.toString()));let r=this._options.addresses.announceFilter,i=new Set(e);return r(Array.from(i).map(n=>new lgt(n)))}async hangUp(e){let{id:r}=wC(e),i=this.connectionManager.connections.get(r.toB58String());!i||await Promise.all(i.map(n=>n.close()))}ping(e){let{id:r,multiaddrs:i}=wC(e);return i?US(this,i[0]):US(this,r)}handle(e,r){e=Array.isArray(e)?e:[e],e.forEach(i=>{this.upgrader.protocols.set(i,r)}),this.peerStore.protoBook.add(this.peerId,e)}unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(r=>{this.upgrader.protocols.delete(r)}),this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),await this.peerStore.start(),this._config.pubsub.enabled&&this.pubsub&&this.pubsub.start(),this._config.dht.enabled&&(this._dht&&this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e)});for(let e of this.peerStore.peers.values())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){ms.error(new Error(LS.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols)}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){ms("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(i){ms.error(`could not connect to discovered peer ${e.toB58String()} with ${i}`)}}}async _setupPeerDiscovery(){let e=r=>{let i={enabled:!0};if(r.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[r.tag]&&(i={...i,...this._config.peerDiscovery[r.tag]}),i.enabled&&!this._discovery.has(r.tag)){let n;typeof r=="function"?n=new r(Object.assign({},i,{peerId:this.peerId,libp2p:this})):n=r,n.on("peer",this._onDiscoveryPeer),this._discovery.set(r.tag,n)}};for(let r of this._modules.peerDiscovery||[])e(r);for(let r of this.transportManager.getTransports())r.discovery&&e(r.discovery);await Promise.all(Array.from(this._discovery.values(),r=>r.start()))}};Qve.exports=X1});var Jve=p(()=>{f()});var twe=p((pLt,ewe)=>{f();ewe.exports=typeof WebSocket=="undefined"?Jve():WebSocket});var iwe=p(FS=>{f();"use strict";Object.defineProperty(FS,"__esModule",{value:!0});var rwe=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;let r={value:e,done:!1};if(this.pullQueue.length){let i=this.pullQueue.shift();i&&i.resolve(r)}else this.pushQueue.push(Promise.resolve(r)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let r of this.pullQueue)r.reject(e);this.pullQueue.length=0}else{let r=Promise.reject(e);r.catch(()=>{}),this.pushQueue.push(r)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:e=>{let r=this.pushQueue.shift();return r?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),r):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((i,n)=>{this.pullQueue.push({resolve:i,reject:n})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},_C=class{constructor(e,{highWaterMark:r=100,lowWaterMark:i=1}={}){let n=new rwe;n.highWaterMark=r,n.lowWaterMark=i,n.removeCallback=e({push:s=>n.push(s),stop:()=>n.stop(),fail:s=>n.fail(s),on:(s,o)=>{n.eventHandlers[s]=o}})||(()=>{}),this[Symbol.asyncIterator]=()=>n[Symbol.asyncIterator](),Object.freeze(this)}};FS.EventIterator=_C;FS.default=_C});var nwe=p(Q1=>{f();"use strict";Object.defineProperty(Q1,"__esModule",{value:!0});var EC=iwe();Q1.EventIterator=EC.EventIterator;function Pgt(t,e,r){return new EC.EventIterator(({push:i})=>(this.addEventListener(t,i,e),()=>this.removeEventListener(t,i,e)),r)}Q1.subscribe=Pgt;Q1.default=EC.EventIterator});var owe=p((bLt,swe)=>{f();var{Buffer:Cgt}=ft(),{EventIterator:Ogt}=nwe();function kgt(t){return t instanceof ArrayBuffer||t!=null&&t.constructor!=null&&t.constructor.name==="ArrayBuffer"&&typeof t.byteLength=="number"}swe.exports=t=>{let e=t.removeEventListener||t.removeListener,r=async function*(){let s=new Ogt(({push:o,stop:a,fail:c})=>(t.addEventListener("message",o),t.addEventListener("error",c),t.addEventListener("close",a),()=>{e.call(t,"message",o),e.call(t,"error",c),e.call(t,"close",a)}),{highWaterMark:1/0});for await(let{data:o}of s)yield kgt(o)?Cgt.from(o):o}(),i=t.readyState===1,n;return t.addEventListener("open",()=>{i=!0,n=null}),t.addEventListener("close",()=>{i=!1,n=null}),t.addEventListener("error",s=>{i||(n=s)}),r.connected=()=>new Promise((s,o)=>{if(i)return s();if(n)return o(n);let a=u=>{e.call(t,"open",c),e.call(t,"error",l),u()},c=()=>a(s),l=u=>a(()=>o(u));t.addEventListener("open",c),t.addEventListener("error",l)}),r}});var cwe=p((mLt,awe)=>{f();awe.exports=async t=>{if(t.readyState>=2)throw new Error("socket closed");if(t.readyState!==1)return new Promise((e,r)=>{let i=t&&(t.removeEventListener||t.removeListener);function n(){typeof i=="function"&&(i.call(t,"open",s),i.call(t,"error",o))}function s(){n(),e()}function o(a){n(),r(a)}t.addEventListener("open",s),t.addEventListener("error",o)})}});var lwe=p((vLt,uwe)=>{f();var qgt=cwe();uwe.exports=(t,e)=>(e=e||{},e.closeOnEnd=e.closeOnEnd!==!1,async r=>{for await(let i of r){try{await qgt(t)}catch(n){if(n.message==="socket closed")break;throw n}t.send(i)}if(e.closeOnEnd&&t.readyState<=1)return new Promise((i,n)=>{t.addEventListener("close",s=>{if(s.wasClean||s.code===1006)i();else{let o=Object.assign(new Error("ws error"),{event:s});n(o)}}),setTimeout(()=>t.close())})})});var hwe=p((wLt,fwe)=>{f();var Bgt=owe(),Ngt=lwe();fwe.exports=(t,e)=>{e=e||{},e.binaryType?t.binaryType=e.binaryType:e.binary&&(t.binaryType="arraybuffer");let r={sink:Ngt(t,e),source:Bgt(t,e),connected:()=>r.source.connected()};return r}});var pwe=p((_Lt,dwe)=>{f();var{relative:Dgt}=ev(),Mgt={http:"ws",https:"wss"},Lgt="ws";dwe.exports=(t,e)=>Dgt(t,e,Mgt,Lgt)});var ywe=p((ELt,KS)=>{f();"use strict";var Ugt=twe(),Fgt=hwe(),Kgt=pwe();KS.exports=function(t,e={}){let r=typeof window=="undefined"?{}:window.location,i=Kgt(t,r),n=new Ugt(i,e.websocket),s=Fgt(n,e);return s.remoteAddress=i,s.close=()=>new Promise((o,a)=>{n.addEventListener("close",o),n.close()}),s.destroy=()=>{n.terminate?n.terminate():n.close()},s.socket=n,s};KS.exports.connect=KS.exports});var bwe=p((SLt,gwe)=>{f();"use strict";gwe.exports=function(){throw new Error("WebSocket Servers can not be created in the browser!")}});var SC=p(Bh=>{f();"use strict";Bh.CODE_P2P=421;Bh.CODE_CIRCUIT=290;Bh.CODE_TCP=6;Bh.CODE_WS=477;Bh.CODE_WSS=478;Bh.CLOSE_TIMEOUT=2e3});var xC=p(X0=>{f();"use strict";Object.defineProperty(X0,"__esModule",{value:!0});X0.isCorrect=X0.isInSubnet=void 0;function jgt(t){return this.subnetMask<t.subnetMask?!1:this.mask(t.subnetMask)===t.mask()}X0.isInSubnet=jgt;function Vgt(t){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===t&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}X0.isCorrect=Vgt});var AC=p(cc=>{f();"use strict";Object.defineProperty(cc,"__esModule",{value:!0});cc.RE_SUBNET_STRING=cc.RE_ADDRESS=cc.GROUPS=cc.BITS=void 0;cc.BITS=32;cc.GROUPS=4;cc.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;cc.RE_SUBNET_STRING=/\/\d{1,2}$/});var jS=p(Q0=>{f();"use strict";var zgt=Q0&&Q0.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(Q0,"__esModule",{value:!0});Q0.AddressError=void 0;var Hgt=function(t){zgt(e,t);function e(r,i){var n=t.call(this,r)||this;return n.name="AddressError",i!==null&&(n.parseMessage=i),n}return e}(Error);Q0.AddressError=Hgt});var IC=p((VS,mwe)=>{f();(function(){var t,e=244837814094590,r=(e&16777215)==15715070;function i(x,T,H){x!=null&&(typeof x=="number"?this.fromNumber(x,T,H):T==null&&typeof x!="string"?this.fromString(x,256):this.fromString(x,T))}function n(){return new i(null)}function s(x,T,H,ie,ye,Ee){for(;--Ee>=0;){var Ne=T*this[x++]+H[ie]+ye;ye=Math.floor(Ne/67108864),H[ie++]=Ne&67108863}return ye}function o(x,T,H,ie,ye,Ee){for(var Ne=T&32767,Fe=T>>15;--Ee>=0;){var br=this[x]&32767,Oi=this[x++]>>15,Es=Fe*br+Oi*Ne;br=Ne*br+((Es&32767)<<15)+H[ie]+(ye&1073741823),ye=(br>>>30)+(Es>>>15)+Fe*Oi+(ye>>>30),H[ie++]=br&1073741823}return ye}function a(x,T,H,ie,ye,Ee){for(var Ne=T&16383,Fe=T>>14;--Ee>=0;){var br=this[x]&16383,Oi=this[x++]>>14,Es=Fe*br+Oi*Ne;br=Ne*br+((Es&16383)<<14)+H[ie]+ye,ye=(br>>28)+(Es>>14)+Fe*Oi,H[ie++]=br&268435455}return ye}var c=typeof navigator!="undefined";c&&r&&navigator.appName=="Microsoft Internet Explorer"?(i.prototype.am=o,t=30):c&&r&&navigator.appName!="Netscape"?(i.prototype.am=s,t=26):(i.prototype.am=a,t=28),i.prototype.DB=t,i.prototype.DM=(1<<t)-1,i.prototype.DV=1<<t;var l=52;i.prototype.FV=Math.pow(2,l),i.prototype.F1=l-t,i.prototype.F2=2*t-l;var u="0123456789abcdefghijklmnopqrstuvwxyz",h=new Array,d,y;for(d="0".charCodeAt(0),y=0;y<=9;++y)h[d++]=y;for(d="a".charCodeAt(0),y=10;y<36;++y)h[d++]=y;for(d="A".charCodeAt(0),y=10;y<36;++y)h[d++]=y;function g(x){return u.charAt(x)}function m(x,T){var H=h[x.charCodeAt(T)];return H??-1}function E(x){for(var T=this.t-1;T>=0;--T)x[T]=this[T];x.t=this.t,x.s=this.s}function v(x){this.t=1,this.s=x<0?-1:0,x>0?this[0]=x:x<-1?this[0]=x+this.DV:this.t=0}function A(x){var T=n();return T.fromInt(x),T}function R(x,T){var H;if(T==16)H=4;else if(T==8)H=3;else if(T==256)H=8;else if(T==2)H=1;else if(T==32)H=5;else if(T==4)H=2;else{this.fromRadix(x,T);return}this.t=0,this.s=0;for(var ie=x.length,ye=!1,Ee=0;--ie>=0;){var Ne=H==8?x[ie]&255:m(x,ie);if(Ne<0){x.charAt(ie)=="-"&&(ye=!0);continue}ye=!1,Ee==0?this[this.t++]=Ne:Ee+H>this.DB?(this[this.t-1]|=(Ne&(1<<this.DB-Ee)-1)<<Ee,this[this.t++]=Ne>>this.DB-Ee):this[this.t-1]|=Ne<<Ee,Ee+=H,Ee>=this.DB&&(Ee-=this.DB)}H==8&&(x[0]&128)!=0&&(this.s=-1,Ee>0&&(this[this.t-1]|=(1<<this.DB-Ee)-1<<Ee)),this.clamp(),ye&&i.ZERO.subTo(this,this)}function F(){for(var x=this.s&this.DM;this.t>0&&this[this.t-1]==x;)--this.t}function q(x){if(this.s<0)return"-"+this.negate().toString(x);var T;if(x==16)T=4;else if(x==8)T=3;else if(x==2)T=1;else if(x==32)T=5;else if(x==4)T=2;else return this.toRadix(x);var H=(1<<T)-1,ie,ye=!1,Ee="",Ne=this.t,Fe=this.DB-Ne*this.DB%T;if(Ne-- >0)for(Fe<this.DB&&(ie=this[Ne]>>Fe)>0&&(ye=!0,Ee=g(ie));Ne>=0;)Fe<T?(ie=(this[Ne]&(1<<Fe)-1)<<T-Fe,ie|=this[--Ne]>>(Fe+=this.DB-T)):(ie=this[Ne]>>(Fe-=T)&H,Fe<=0&&(Fe+=this.DB,--Ne)),ie>0&&(ye=!0),ye&&(Ee+=g(ie));return ye?Ee:"0"}function B(){var x=n();return i.ZERO.subTo(this,x),x}function z(){return this.s<0?this.negate():this}function G(x){var T=this.s-x.s;if(T!=0)return T;var H=this.t;if(T=H-x.t,T!=0)return this.s<0?-T:T;for(;--H>=0;)if((T=this[H]-x[H])!=0)return T;return 0}function Y(x){var T=1,H;return(H=x>>>16)!=0&&(x=H,T+=16),(H=x>>8)!=0&&(x=H,T+=8),(H=x>>4)!=0&&(x=H,T+=4),(H=x>>2)!=0&&(x=H,T+=2),(H=x>>1)!=0&&(x=H,T+=1),T}function P(){return this.t<=0?0:this.DB*(this.t-1)+Y(this[this.t-1]^this.s&this.DM)}function b(x,T){var H;for(H=this.t-1;H>=0;--H)T[H+x]=this[H];for(H=x-1;H>=0;--H)T[H]=0;T.t=this.t+x,T.s=this.s}function w(x,T){for(var H=x;H<this.t;++H)T[H-x]=this[H];T.t=Math.max(this.t-x,0),T.s=this.s}function S(x,T){var H=x%this.DB,ie=this.DB-H,ye=(1<<ie)-1,Ee=Math.floor(x/this.DB),Ne=this.s<<H&this.DM,Fe;for(Fe=this.t-1;Fe>=0;--Fe)T[Fe+Ee+1]=this[Fe]>>ie|Ne,Ne=(this[Fe]&ye)<<H;for(Fe=Ee-1;Fe>=0;--Fe)T[Fe]=0;T[Ee]=Ne,T.t=this.t+Ee+1,T.s=this.s,T.clamp()}function C(x,T){T.s=this.s;var H=Math.floor(x/this.DB);if(H>=this.t){T.t=0;return}var ie=x%this.DB,ye=this.DB-ie,Ee=(1<<ie)-1;T[0]=this[H]>>ie;for(var Ne=H+1;Ne<this.t;++Ne)T[Ne-H-1]|=(this[Ne]&Ee)<<ye,T[Ne-H]=this[Ne]>>ie;ie>0&&(T[this.t-H-1]|=(this.s&Ee)<<ye),T.t=this.t-H,T.clamp()}function D(x,T){for(var H=0,ie=0,ye=Math.min(x.t,this.t);H<ye;)ie+=this[H]-x[H],T[H++]=ie&this.DM,ie>>=this.DB;if(x.t<this.t){for(ie-=x.s;H<this.t;)ie+=this[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=this.s}else{for(ie+=this.s;H<x.t;)ie-=x[H],T[H++]=ie&this.DM,ie>>=this.DB;ie-=x.s}T.s=ie<0?-1:0,ie<-1?T[H++]=this.DV+ie:ie>0&&(T[H++]=ie),T.t=H,T.clamp()}function W(x,T){var H=this.abs(),ie=x.abs(),ye=H.t;for(T.t=ye+ie.t;--ye>=0;)T[ye]=0;for(ye=0;ye<ie.t;++ye)T[ye+H.t]=H.am(0,ie[ye],T,ye,0,H.t);T.s=0,T.clamp(),this.s!=x.s&&i.ZERO.subTo(T,T)}function j(x){for(var T=this.abs(),H=x.t=2*T.t;--H>=0;)x[H]=0;for(H=0;H<T.t-1;++H){var ie=T.am(H,T[H],x,2*H,0,1);(x[H+T.t]+=T.am(H+1,2*T[H],x,2*H+1,ie,T.t-H-1))>=T.DV&&(x[H+T.t]-=T.DV,x[H+T.t+1]=1)}x.t>0&&(x[x.t-1]+=T.am(H,T[H],x,2*H,0,1)),x.s=0,x.clamp()}function M(x,T,H){var ie=x.abs();if(!(ie.t<=0)){var ye=this.abs();if(ye.t<ie.t){T!=null&&T.fromInt(0),H!=null&&this.copyTo(H);return}H==null&&(H=n());var Ee=n(),Ne=this.s,Fe=x.s,br=this.DB-Y(ie[ie.t-1]);br>0?(ie.lShiftTo(br,Ee),ye.lShiftTo(br,H)):(ie.copyTo(Ee),ye.copyTo(H));var Oi=Ee.t,Es=Ee[Oi-1];if(Es!=0){var is=Es*(1<<this.F1)+(Oi>1?Ee[Oi-2]>>this.F2:0),wc=this.FV/is,Vm=(1<<this.F1)/is,fo=1<<this.F2,ho=H.t,zm=ho-Oi,_u=T??n();for(Ee.dlShiftTo(zm,_u),H.compareTo(_u)>=0&&(H[H.t++]=1,H.subTo(_u,H)),i.ONE.dlShiftTo(Oi,_u),_u.subTo(Ee,Ee);Ee.t<Oi;)Ee[Ee.t++]=0;for(;--zm>=0;){var p6=H[--ho]==Es?this.DM:Math.floor(H[ho]*wc+(H[ho-1]+fo)*Vm);if((H[ho]+=Ee.am(0,p6,H,zm,0,Oi))<p6)for(Ee.dlShiftTo(zm,_u),H.subTo(_u,H);H[ho]<--p6;)H.subTo(_u,H)}T!=null&&(H.drShiftTo(Oi,T),Ne!=Fe&&i.ZERO.subTo(T,T)),H.t=Oi,H.clamp(),br>0&&H.rShiftTo(br,H),Ne<0&&i.ZERO.subTo(H,H)}}}function _(x){var T=n();return this.abs().divRemTo(x,null,T),this.s<0&&T.compareTo(i.ZERO)>0&&x.subTo(T,T),T}function L(x){this.m=x}function ce(x){return x.s<0||x.compareTo(this.m)>=0?x.mod(this.m):x}function X(x){return x}function ne(x){x.divRemTo(this.m,null,x)}function oe(x,T,H){x.multiplyTo(T,H),this.reduce(H)}function de(x,T){x.squareTo(T),this.reduce(T)}L.prototype.convert=ce,L.prototype.revert=X,L.prototype.reduce=ne,L.prototype.mulTo=oe,L.prototype.sqrTo=de;function pe(){if(this.t<1)return 0;var x=this[0];if((x&1)==0)return 0;var T=x&3;return T=T*(2-(x&15)*T)&15,T=T*(2-(x&255)*T)&255,T=T*(2-((x&65535)*T&65535))&65535,T=T*(2-x*T%this.DV)%this.DV,T>0?this.DV-T:-T}function _e(x){this.m=x,this.mp=x.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<x.DB-15)-1,this.mt2=2*x.t}function k(x){var T=n();return x.abs().dlShiftTo(this.m.t,T),T.divRemTo(this.m,null,T),x.s<0&&T.compareTo(i.ZERO)>0&&this.m.subTo(T,T),T}function K(x){var T=n();return x.copyTo(T),this.reduce(T),T}function $(x){for(;x.t<=this.mt2;)x[x.t++]=0;for(var T=0;T<this.m.t;++T){var H=x[T]&32767,ie=H*this.mpl+((H*this.mph+(x[T]>>15)*this.mpl&this.um)<<15)&x.DM;for(H=T+this.m.t,x[H]+=this.m.am(0,ie,x,T,0,this.m.t);x[H]>=x.DV;)x[H]-=x.DV,x[++H]++}x.clamp(),x.drShiftTo(this.m.t,x),x.compareTo(this.m)>=0&&x.subTo(this.m,x)}function Z(x,T){x.squareTo(T),this.reduce(T)}function I(x,T,H){x.multiplyTo(T,H),this.reduce(H)}_e.prototype.convert=k,_e.prototype.revert=K,_e.prototype.reduce=$,_e.prototype.mulTo=I,_e.prototype.sqrTo=Z;function U(){return(this.t>0?this[0]&1:this.s)==0}function V(x,T){if(x>4294967295||x<1)return i.ONE;var H=n(),ie=n(),ye=T.convert(this),Ee=Y(x)-1;for(ye.copyTo(H);--Ee>=0;)if(T.sqrTo(H,ie),(x&1<<Ee)>0)T.mulTo(ie,ye,H);else{var Ne=H;H=ie,ie=Ne}return T.revert(H)}function N(x,T){var H;return x<256||T.isEven()?H=new L(T):H=new _e(T),this.exp(x,H)}i.prototype.copyTo=E,i.prototype.fromInt=v,i.prototype.fromString=R,i.prototype.clamp=F,i.prototype.dlShiftTo=b,i.prototype.drShiftTo=w,i.prototype.lShiftTo=S,i.prototype.rShiftTo=C,i.prototype.subTo=D,i.prototype.multiplyTo=W,i.prototype.squareTo=j,i.prototype.divRemTo=M,i.prototype.invDigit=pe,i.prototype.isEven=U,i.prototype.exp=V,i.prototype.toString=q,i.prototype.negate=B,i.prototype.abs=z,i.prototype.compareTo=G,i.prototype.bitLength=P,i.prototype.mod=_,i.prototype.modPowInt=N,i.ZERO=A(0),i.ONE=A(1);function Q(){var x=n();return this.copyTo(x),x}function ee(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function J(){return this.t==0?this.s:this[0]<<24>>24}function ue(){return this.t==0?this.s:this[0]<<16>>16}function ge(x){return Math.floor(Math.LN2*this.DB/Math.log(x))}function be(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Ke(x){if(x==null&&(x=10),this.signum()==0||x<2||x>36)return"0";var T=this.chunkSize(x),H=Math.pow(x,T),ie=A(H),ye=n(),Ee=n(),Ne="";for(this.divRemTo(ie,ye,Ee);ye.signum()>0;)Ne=(H+Ee.intValue()).toString(x).substr(1)+Ne,ye.divRemTo(ie,ye,Ee);return Ee.intValue().toString(x)+Ne}function Te(x,T){this.fromInt(0),T==null&&(T=10);for(var H=this.chunkSize(T),ie=Math.pow(T,H),ye=!1,Ee=0,Ne=0,Fe=0;Fe<x.length;++Fe){var br=m(x,Fe);if(br<0){x.charAt(Fe)=="-"&&this.signum()==0&&(ye=!0);continue}Ne=T*Ne+br,++Ee>=H&&(this.dMultiply(ie),this.dAddOffset(Ne,0),Ee=0,Ne=0)}Ee>0&&(this.dMultiply(Math.pow(T,Ee)),this.dAddOffset(Ne,0)),ye&&i.ZERO.subTo(this,this)}function je(x,T,H){if(typeof T=="number")if(x<2)this.fromInt(1);else for(this.fromNumber(x,H),this.testBit(x-1)||this.bitwiseTo(i.ONE.shiftLeft(x-1),Kt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(T);)this.dAddOffset(2,0),this.bitLength()>x&&this.subTo(i.ONE.shiftLeft(x-1),this);else{var ie=new Array,ye=x&7;ie.length=(x>>3)+1,T.nextBytes(ie),ye>0?ie[0]&=(1<<ye)-1:ie[0]=0,this.fromString(ie,256)}}function Ze(){var x=this.t,T=new Array;T[0]=this.s;var H=this.DB-x*this.DB%8,ie,ye=0;if(x-- >0)for(H<this.DB&&(ie=this[x]>>H)!=(this.s&this.DM)>>H&&(T[ye++]=ie|this.s<<this.DB-H);x>=0;)H<8?(ie=(this[x]&(1<<H)-1)<<8-H,ie|=this[--x]>>(H+=this.DB-8)):(ie=this[x]>>(H-=8)&255,H<=0&&(H+=this.DB,--x)),(ie&128)!=0&&(ie|=-256),ye==0&&(this.s&128)!=(ie&128)&&++ye,(ye>0||ie!=this.s)&&(T[ye++]=ie);return T}function ze(x){return this.compareTo(x)==0}function Ve(x){return this.compareTo(x)<0?this:x}function pt(x){return this.compareTo(x)>0?this:x}function Ht(x,T,H){var ie,ye,Ee=Math.min(x.t,this.t);for(ie=0;ie<Ee;++ie)H[ie]=T(this[ie],x[ie]);if(x.t<this.t){for(ye=x.s&this.DM,ie=Ee;ie<this.t;++ie)H[ie]=T(this[ie],ye);H.t=this.t}else{for(ye=this.s&this.DM,ie=Ee;ie<x.t;++ie)H[ie]=T(ye,x[ie]);H.t=x.t}H.s=T(this.s,x.s),H.clamp()}function er(x,T){return x&T}function En(x){var T=n();return this.bitwiseTo(x,er,T),T}function Kt(x,T){return x|T}function Et(x){var T=n();return this.bitwiseTo(x,Kt,T),T}function ri(x,T){return x^T}function it(x){var T=n();return this.bitwiseTo(x,ri,T),T}function Rr(x,T){return x&~T}function Bm(x){var T=n();return this.bitwiseTo(x,Rr,T),T}function Cr(){for(var x=n(),T=0;T<this.t;++T)x[T]=this.DM&~this[T];return x.t=this.t,x.s=~this.s,x}function Or(x){var T=n();return x<0?this.rShiftTo(-x,T):this.lShiftTo(x,T),T}function Nm(x){var T=n();return x<0?this.lShiftTo(-x,T):this.rShiftTo(x,T),T}function kr(x){if(x==0)return-1;var T=0;return(x&65535)==0&&(x>>=16,T+=16),(x&255)==0&&(x>>=8,T+=8),(x&15)==0&&(x>>=4,T+=4),(x&3)==0&&(x>>=2,T+=2),(x&1)==0&&++T,T}function qr(){for(var x=0;x<this.t;++x)if(this[x]!=0)return x*this.DB+kr(this[x]);return this.s<0?this.t*this.DB:-1}function Dm(x){for(var T=0;x!=0;)x&=x-1,++T;return T}function Br(){for(var x=0,T=this.s&this.DM,H=0;H<this.t;++H)x+=Dm(this[H]^T);return x}function Nr(x){var T=Math.floor(x/this.DB);return T>=this.t?this.s!=0:(this[T]&1<<x%this.DB)!=0}function Mm(x,T){var H=i.ONE.shiftLeft(x);return this.bitwiseTo(H,T,H),H}function Dr(x){return this.changeBit(x,Kt)}function Mr(x){return this.changeBit(x,Rr)}function Lm(x){return this.changeBit(x,ri)}function Lr(x,T){for(var H=0,ie=0,ye=Math.min(x.t,this.t);H<ye;)ie+=this[H]+x[H],T[H++]=ie&this.DM,ie>>=this.DB;if(x.t<this.t){for(ie+=x.s;H<this.t;)ie+=this[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=this.s}else{for(ie+=this.s;H<x.t;)ie+=x[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=x.s}T.s=ie<0?-1:0,ie>0?T[H++]=ie:ie<-1&&(T[H++]=this.DV+ie),T.t=H,T.clamp()}function Ur(x){var T=n();return this.addTo(x,T),T}function Um(x){var T=n();return this.subTo(x,T),T}function Fr(x){var T=n();return this.multiplyTo(x,T),T}function Kr(){var x=n();return this.squareTo(x),x}function Fm(x){var T=n();return this.divRemTo(x,T,null),T}function jr(x){var T=n();return this.divRemTo(x,null,T),T}function Vr(x){var T=n(),H=n();return this.divRemTo(x,T,H),new Array(T,H)}function Km(x){this[this.t]=this.am(0,x-1,this,0,0,this.t),++this.t,this.clamp()}function zr(x,T){if(x!=0){for(;this.t<=T;)this[this.t++]=0;for(this[T]+=x;this[T]>=this.DV;)this[T]-=this.DV,++T>=this.t&&(this[this.t++]=0),++this[T]}}function tr(){}function zh(x){return x}function Ay(x,T,H){x.multiplyTo(T,H)}function Iy(x,T){x.squareTo(T)}tr.prototype.convert=zh,tr.prototype.revert=zh,tr.prototype.mulTo=Ay,tr.prototype.sqrTo=Iy;function Ty(x){return this.exp(x,new tr)}function Ry(x,T,H){var ie=Math.min(this.t+x.t,T);for(H.s=0,H.t=ie;ie>0;)H[--ie]=0;var ye;for(ye=H.t-this.t;ie<ye;++ie)H[ie+this.t]=this.am(0,x[ie],H,ie,0,this.t);for(ye=Math.min(x.t,T);ie<ye;++ie)this.am(0,x[ie],H,ie,0,T-ie);H.clamp()}function Py(x,T,H){--T;var ie=H.t=this.t+x.t-T;for(H.s=0;--ie>=0;)H[ie]=0;for(ie=Math.max(T-this.t,0);ie<x.t;++ie)H[this.t+ie-T]=this.am(T-ie,x[ie],H,0,0,this.t+ie-T);H.clamp(),H.drShiftTo(1,H)}function uo(x){this.r2=n(),this.q3=n(),i.ONE.dlShiftTo(2*x.t,this.r2),this.mu=this.r2.divide(x),this.m=x}function Cy(x){if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);if(x.compareTo(this.m)<0)return x;var T=n();return x.copyTo(T),this.reduce(T),T}function Oy(x){return x}function ky(x){for(x.drShiftTo(this.m.t-1,this.r2),x.t>this.m.t+1&&(x.t=this.m.t+1,x.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);x.compareTo(this.r2)<0;)x.dAddOffset(1,this.m.t+1);for(x.subTo(this.r2,x);x.compareTo(this.m)>=0;)x.subTo(this.m,x)}function qy(x,T){x.squareTo(T),this.reduce(T)}function By(x,T,H){x.multiplyTo(T,H),this.reduce(H)}uo.prototype.convert=Cy,uo.prototype.revert=Oy,uo.prototype.reduce=ky,uo.prototype.mulTo=By,uo.prototype.sqrTo=qy;function Ny(x,T){var H=x.bitLength(),ie,ye=A(1),Ee;if(H<=0)return ye;H<18?ie=1:H<48?ie=3:H<144?ie=4:H<768?ie=5:ie=6,H<8?Ee=new L(T):T.isEven()?Ee=new uo(T):Ee=new _e(T);var Ne=new Array,Fe=3,br=ie-1,Oi=(1<<ie)-1;if(Ne[1]=Ee.convert(this),ie>1){var Es=n();for(Ee.sqrTo(Ne[1],Es);Fe<=Oi;)Ne[Fe]=n(),Ee.mulTo(Es,Ne[Fe-2],Ne[Fe]),Fe+=2}var is=x.t-1,wc,Vm=!0,fo=n(),ho;for(H=Y(x[is])-1;is>=0;){for(H>=br?wc=x[is]>>H-br&Oi:(wc=(x[is]&(1<<H+1)-1)<<br-H,is>0&&(wc|=x[is-1]>>this.DB+H-br)),Fe=ie;(wc&1)==0;)wc>>=1,--Fe;if((H-=Fe)<0&&(H+=this.DB,--is),Vm)Ne[wc].copyTo(ye),Vm=!1;else{for(;Fe>1;)Ee.sqrTo(ye,fo),Ee.sqrTo(fo,ye),Fe-=2;Fe>0?Ee.sqrTo(ye,fo):(ho=ye,ye=fo,fo=ho),Ee.mulTo(fo,Ne[wc],ye)}for(;is>=0&&(x[is]&1<<H)==0;)Ee.sqrTo(ye,fo),ho=ye,ye=fo,fo=ho,--H<0&&(H=this.DB-1,--is)}return Ee.revert(ye)}function Dy(x){var T=this.s<0?this.negate():this.clone(),H=x.s<0?x.negate():x.clone();if(T.compareTo(H)<0){var ie=T;T=H,H=ie}var ye=T.getLowestSetBit(),Ee=H.getLowestSetBit();if(Ee<0)return T;for(ye<Ee&&(Ee=ye),Ee>0&&(T.rShiftTo(Ee,T),H.rShiftTo(Ee,H));T.signum()>0;)(ye=T.getLowestSetBit())>0&&T.rShiftTo(ye,T),(ye=H.getLowestSetBit())>0&&H.rShiftTo(ye,H),T.compareTo(H)>=0?(T.subTo(H,T),T.rShiftTo(1,T)):(H.subTo(T,H),H.rShiftTo(1,H));return Ee>0&&H.lShiftTo(Ee,H),H}function My(x){if(x<=0)return 0;var T=this.DV%x,H=this.s<0?x-1:0;if(this.t>0)if(T==0)H=this[0]%x;else for(var ie=this.t-1;ie>=0;--ie)H=(T*H+this[ie])%x;return H}function Ly(x){var T=x.isEven();if(this.isEven()&&T||x.signum()==0)return i.ZERO;for(var H=x.clone(),ie=this.clone(),ye=A(1),Ee=A(0),Ne=A(0),Fe=A(1);H.signum()!=0;){for(;H.isEven();)H.rShiftTo(1,H),T?((!ye.isEven()||!Ee.isEven())&&(ye.addTo(this,ye),Ee.subTo(x,Ee)),ye.rShiftTo(1,ye)):Ee.isEven()||Ee.subTo(x,Ee),Ee.rShiftTo(1,Ee);for(;ie.isEven();)ie.rShiftTo(1,ie),T?((!Ne.isEven()||!Fe.isEven())&&(Ne.addTo(this,Ne),Fe.subTo(x,Fe)),Ne.rShiftTo(1,Ne)):Fe.isEven()||Fe.subTo(x,Fe),Fe.rShiftTo(1,Fe);H.compareTo(ie)>=0?(H.subTo(ie,H),T&&ye.subTo(Ne,ye),Ee.subTo(Fe,Ee)):(ie.subTo(H,ie),T&&Ne.subTo(ye,Ne),Fe.subTo(Ee,Fe))}if(ie.compareTo(i.ONE)!=0)return i.ZERO;if(Fe.compareTo(x)>=0)return Fe.subtract(x);if(Fe.signum()<0)Fe.addTo(x,Fe);else return Fe;return Fe.signum()<0?Fe.add(x):Fe}var wi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Uy=(1<<26)/wi[wi.length-1];function Fy(x){var T,H=this.abs();if(H.t==1&&H[0]<=wi[wi.length-1]){for(T=0;T<wi.length;++T)if(H[0]==wi[T])return!0;return!1}if(H.isEven())return!1;for(T=1;T<wi.length;){for(var ie=wi[T],ye=T+1;ye<wi.length&&ie<Uy;)ie*=wi[ye++];for(ie=H.modInt(ie);T<ye;)if(ie%wi[T++]==0)return!1}return H.millerRabin(x)}function HAe(x){var T=this.subtract(i.ONE),H=T.getLowestSetBit();if(H<=0)return!1;var ie=T.shiftRight(H);x=x+1>>1,x>wi.length&&(x=wi.length);for(var ye=n(),Ee=0;Ee<x;++Ee){ye.fromInt(wi[Math.floor(Math.random()*wi.length)]);var Ne=ye.modPow(ie,this);if(Ne.compareTo(i.ONE)!=0&&Ne.compareTo(T)!=0){for(var Fe=1;Fe++<H&&Ne.compareTo(T)!=0;)if(Ne=Ne.modPowInt(2,this),Ne.compareTo(i.ONE)==0)return!1;if(Ne.compareTo(T)!=0)return!1}}return!0}i.prototype.chunkSize=ge,i.prototype.toRadix=Ke,i.prototype.fromRadix=Te,i.prototype.fromNumber=je,i.prototype.bitwiseTo=Ht,i.prototype.changeBit=Mm,i.prototype.addTo=Lr,i.prototype.dMultiply=Km,i.prototype.dAddOffset=zr,i.prototype.multiplyLowerTo=Ry,i.prototype.multiplyUpperTo=Py,i.prototype.modInt=My,i.prototype.millerRabin=HAe,i.prototype.clone=Q,i.prototype.intValue=ee,i.prototype.byteValue=J,i.prototype.shortValue=ue,i.prototype.signum=be,i.prototype.toByteArray=Ze,i.prototype.equals=ze,i.prototype.min=Ve,i.prototype.max=pt,i.prototype.and=En,i.prototype.or=Et,i.prototype.xor=it,i.prototype.andNot=Bm,i.prototype.not=Cr,i.prototype.shiftLeft=Or,i.prototype.shiftRight=Nm,i.prototype.getLowestSetBit=qr,i.prototype.bitCount=Br,i.prototype.testBit=Nr,i.prototype.setBit=Dr,i.prototype.clearBit=Mr,i.prototype.flipBit=Lm,i.prototype.add=Ur,i.prototype.subtract=Um,i.prototype.multiply=Fr,i.prototype.divide=Fm,i.prototype.remainder=jr,i.prototype.divideAndRemainder=Vr,i.prototype.modPow=Ny,i.prototype.modInverse=Ly,i.prototype.pow=Ty,i.prototype.gcd=Dy,i.prototype.isProbablePrime=Fy,i.prototype.square=Kr,i.prototype.Barrett=uo;var jm,rs,Ci;function $Ae(x){rs[Ci++]^=x&255,rs[Ci++]^=x>>8&255,rs[Ci++]^=x>>16&255,rs[Ci++]^=x>>24&255,Ci>=d6&&(Ci-=d6)}function Lk(){$Ae(new Date().getTime())}if(rs==null){rs=new Array,Ci=0;var lo;if(typeof window!="undefined"&&window.crypto){if(window.crypto.getRandomValues){var Uk=new Uint8Array(32);for(window.crypto.getRandomValues(Uk),lo=0;lo<32;++lo)rs[Ci++]=Uk[lo]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var Fk=window.crypto.random(32);for(lo=0;lo<Fk.length;++lo)rs[Ci++]=Fk.charCodeAt(lo)&255}}for(;Ci<d6;)lo=Math.floor(65536*Math.random()),rs[Ci++]=lo>>>8,rs[Ci++]=lo&255;Ci=0,Lk()}function GAe(){if(jm==null){for(Lk(),jm=QAe(),jm.init(rs),Ci=0;Ci<rs.length;++Ci)rs[Ci]=0;Ci=0}return jm.next()}function WAe(x){var T;for(T=0;T<x.length;++T)x[T]=GAe()}function f6(){}f6.prototype.nextBytes=WAe;function h6(){this.i=0,this.j=0,this.S=new Array}function YAe(x){var T,H,ie;for(T=0;T<256;++T)this.S[T]=T;for(H=0,T=0;T<256;++T)H=H+this.S[T]+x[T%x.length]&255,ie=this.S[T],this.S[T]=this.S[H],this.S[H]=ie;this.i=0,this.j=0}function XAe(){var x;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,x=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=x,this.S[x+this.S[this.i]&255]}h6.prototype.init=YAe,h6.prototype.next=XAe;function QAe(){return new h6}var d6=256;typeof VS!="undefined"?VS=mwe.exports={default:i,BigInteger:i,SecureRandom:f6}:this.jsbn={BigInteger:i,SecureRandom:f6}}).call(VS)});var Z1=p(zS=>{f();(function(){"use strict";var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function e(o){return i(s(o),arguments)}function r(o,a){return e.apply(null,[o].concat(a||[]))}function i(o,a){var c=1,l=o.length,u,h="",d,y,g,m,E,v,A,R;for(d=0;d<l;d++)if(typeof o[d]=="string")h+=o[d];else if(typeof o[d]=="object"){if(g=o[d],g.keys)for(u=a[c],y=0;y<g.keys.length;y++){if(u==null)throw new Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',g.keys[y],g.keys[y-1]));u=u[g.keys[y]]}else g.param_no?u=a[g.param_no]:u=a[c++];if(t.not_type.test(g.type)&&t.not_primitive.test(g.type)&&u instanceof Function&&(u=u()),t.numeric_arg.test(g.type)&&typeof u!="number"&&isNaN(u))throw new TypeError(e("[sprintf] expecting number but found %T",u));switch(t.number.test(g.type)&&(A=u>=0),g.type){case"b":u=parseInt(u,10).toString(2);break;case"c":u=String.fromCharCode(parseInt(u,10));break;case"d":case"i":u=parseInt(u,10);break;case"j":u=JSON.stringify(u,null,g.width?parseInt(g.width):0);break;case"e":u=g.precision?parseFloat(u).toExponential(g.precision):parseFloat(u).toExponential();break;case"f":u=g.precision?parseFloat(u).toFixed(g.precision):parseFloat(u);break;case"g":u=g.precision?String(Number(u.toPrecision(g.precision))):parseFloat(u);break;case"o":u=(parseInt(u,10)>>>0).toString(8);break;case"s":u=String(u),u=g.precision?u.substring(0,g.precision):u;break;case"t":u=String(!!u),u=g.precision?u.substring(0,g.precision):u;break;case"T":u=Object.prototype.toString.call(u).slice(8,-1).toLowerCase(),u=g.precision?u.substring(0,g.precision):u;break;case"u":u=parseInt(u,10)>>>0;break;case"v":u=u.valueOf(),u=g.precision?u.substring(0,g.precision):u;break;case"x":u=(parseInt(u,10)>>>0).toString(16);break;case"X":u=(parseInt(u,10)>>>0).toString(16).toUpperCase();break}t.json.test(g.type)?h+=u:(t.number.test(g.type)&&(!A||g.sign)?(R=A?"+":"-",u=u.toString().replace(t.sign,"")):R="",E=g.pad_char?g.pad_char==="0"?"0":g.pad_char.charAt(1):" ",v=g.width-(R+u).length,m=g.width&&v>0?E.repeat(v):"",h+=g.align?R+u+m:E==="0"?R+m+u:m+R+u)}return h}var n=Object.create(null);function s(o){if(n[o])return n[o];for(var a=o,c,l=[],u=0;a;){if((c=t.text.exec(a))!==null)l.push(c[0]);else if((c=t.modulo.exec(a))!==null)l.push("%");else if((c=t.placeholder.exec(a))!==null){if(c[2]){u|=1;var h=[],d=c[2],y=[];if((y=t.key.exec(d))!==null)for(h.push(y[1]);(d=d.substring(y[0].length))!=="";)if((y=t.key_access.exec(d))!==null)h.push(y[1]);else if((y=t.index_access.exec(d))!==null)h.push(y[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");c[2]=h}else u|=2;if(u===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");l.push({placeholder:c[0],param_no:c[1],keys:c[2],sign:c[3],pad_char:c[4],align:c[5],width:c[6],precision:c[7],type:c[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(c[0].length)}return n[o]=l}typeof zS!="undefined"&&(zS.sprintf=e,zS.vsprintf=r),typeof window!="undefined"&&(window.sprintf=e,window.vsprintf=r,typeof define=="function"&&define.amd&&define(function(){return{sprintf:e,vsprintf:r}}))})()});var TC=p(uc=>{f();"use strict";var $gt=uc&&uc.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Ggt=uc&&uc.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),vwe=uc&&uc.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&$gt(e,t,r);return Ggt(e,t),e};Object.defineProperty(uc,"__esModule",{value:!0});uc.Address4=void 0;var wwe=vwe(xC()),ra=vwe(AC()),_we=jS(),J1=IC(),Z0=Z1(),Wgt=function(){function t(e){this.groups=ra.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=wwe.isCorrect(ra.BITS),this.isInSubnet=wwe.isInSubnet,this.address=e;var r=ra.RE_SUBNET_STRING.exec(e);if(r){if(this.parsedSubnet=r[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>ra.BITS)throw new _we.AddressError("Invalid subnet mask.");e=e.replace(ra.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}return t.isValid=function(e){try{return new t(e),!0}catch(r){return!1}},t.prototype.parse=function(e){var r=e.split(".");if(!e.match(ra.RE_ADDRESS))throw new _we.AddressError("Invalid IPv4 address.");return r},t.prototype.correctForm=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)}).join(".")},t.fromHex=function(e){var r=e.replace(/:/g,"").padStart(8,"0"),i=[],n;for(n=0;n<8;n+=2){var s=r.slice(n,n+2);i.push(parseInt(s,16))}return new t(i.join("."))},t.fromInteger=function(e){return t.fromHex(e.toString(16))},t.fromArpa=function(e){var r=e.replace(/(\.in-addr\.arpa)?\.$/,""),i=r.split(".").reverse().join(".");return new t(i)},t.prototype.toHex=function(){return this.parsedAddress.map(function(e){return Z0.sprintf("%02x",parseInt(e,10))}).join(":")},t.prototype.toArray=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)})},t.prototype.toGroup6=function(){var e=[],r;for(r=0;r<ra.GROUPS;r+=2){var i=Z0.sprintf("%02x%02x",parseInt(this.parsedAddress[r],10),parseInt(this.parsedAddress[r+1],10));e.push(Z0.sprintf("%x",parseInt(i,16)))}return e.join(":")},t.prototype.bigInteger=function(){return new J1.BigInteger(this.parsedAddress.map(function(e){return Z0.sprintf("%02x",parseInt(e,10))}).join(""),16)},t.prototype._startAddress=function(){return new J1.BigInteger(this.mask()+"0".repeat(ra.BITS-this.subnetMask),2)},t.prototype.startAddress=function(){return t.fromBigInteger(this._startAddress())},t.prototype.startAddressExclusive=function(){var e=new J1.BigInteger("1");return t.fromBigInteger(this._startAddress().add(e))},t.prototype._endAddress=function(){return new J1.BigInteger(this.mask()+"1".repeat(ra.BITS-this.subnetMask),2)},t.prototype.endAddress=function(){return t.fromBigInteger(this._endAddress())},t.prototype.endAddressExclusive=function(){var e=new J1.BigInteger("1");return t.fromBigInteger(this._endAddress().subtract(e))},t.fromBigInteger=function(e){return t.fromInteger(parseInt(e.toString(),10))},t.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},t.prototype.getBitsBase2=function(e,r){return this.binaryZeroPad().slice(e,r)},t.prototype.reverseForm=function(e){e||(e={});var r=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?r:Z0.sprintf("%s.in-addr.arpa.",r)},t.prototype.isMulticast=function(){return this.isInSubnet(new t("224.0.0.0/4"))},t.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(ra.BITS,"0")},t.prototype.groupForV6=function(){var e=this.parsedAddress;return this.address.replace(ra.RE_ADDRESS,Z0.sprintf('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))},t}();uc.Address4=Wgt});var RC=p(ei=>{f();"use strict";Object.defineProperty(ei,"__esModule",{value:!0});ei.RE_URL_WITH_PORT=ei.RE_URL=ei.RE_ZONE_STRING=ei.RE_SUBNET_STRING=ei.RE_BAD_ADDRESS=ei.RE_BAD_CHARACTERS=ei.TYPES=ei.SCOPES=ei.GROUPS=ei.BITS=void 0;ei.BITS=128;ei.GROUPS=8;ei.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};ei.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};ei.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;ei.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;ei.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;ei.RE_ZONE_STRING=/%.*$/;ei.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/);ei.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)});var PC=p(lc=>{f();"use strict";Object.defineProperty(lc,"__esModule",{value:!0});lc.simpleGroup=lc.spanLeadingZeroes=lc.spanAll=lc.spanAllZeroes=void 0;var Ewe=Z1();function Swe(t){return t.replace(/(0+)/g,'<span class="zero">$1</span>')}lc.spanAllZeroes=Swe;function Ygt(t,e){e===void 0&&(e=0);var r=t.split("");return r.map(function(i,n){return Ewe.sprintf('<span class="digit value-%s position-%d">%s</span>',i,n+e,Swe(i))}).join("")}lc.spanAll=Ygt;function xwe(t){return t.replace(/^(0+)/,'<span class="zero">$1</span>')}function Xgt(t){var e=t.split(":");return e.map(function(r){return xwe(r)}).join(":")}lc.spanLeadingZeroes=Xgt;function Qgt(t,e){e===void 0&&(e=0);var r=t.split(":");return r.map(function(i,n){return/group-v4/.test(i)?i:Ewe.sprintf('<span class="hover-group group-%d">%s</span>',n+e,xwe(i))})}lc.simpleGroup=Qgt});var Awe=p(Wi=>{f();"use strict";var Zgt=Wi&&Wi.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Jgt=Wi&&Wi.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ebt=Wi&&Wi.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Zgt(e,t,r);return Jgt(e,t),e};Object.defineProperty(Wi,"__esModule",{value:!0});Wi.possibleElisions=Wi.simpleRegularExpression=Wi.ADDRESS_BOUNDARY=Wi.padGroup=Wi.groupPossibilities=void 0;var tbt=ebt(RC()),J0=Z1();function HS(t){return J0.sprintf("(%s)",t.join("|"))}Wi.groupPossibilities=HS;function $S(t){return t.length<4?J0.sprintf("0{0,%d}%s",4-t.length,t):t}Wi.padGroup=$S;Wi.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function rbt(t){var e=[];t.forEach(function(i,n){var s=parseInt(i,16);s===0&&e.push(n)});var r=e.map(function(i){return t.map(function(n,s){if(s===i){var o=s===0||s===tbt.GROUPS-1?":":"";return HS([$S(n),o])}return $S(n)}).join(":")});return r.push(t.map($S).join(":")),HS(r)}Wi.simpleRegularExpression=rbt;function ibt(t,e,r){var i=e?"":":",n=r?"":":",s=[];!e&&!r&&s.push("::"),e&&r&&s.push(""),(r&&!e||!r&&e)&&s.push(":"),s.push(J0.sprintf("%s(:0{1,4}){1,%d}",i,t-1)),s.push(J0.sprintf("(0{1,4}:){1,%d}%s",t-1,n)),s.push(J0.sprintf("(0{1,4}:){%d}0{1,4}",t-1));for(var o=1;o<t-1;o++)for(var a=1;a<t-o;a++)s.push(J0.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",a,t-a-o-1));return HS(s)}Wi.possibleElisions=ibt});var Cwe=p(ro=>{f();"use strict";var nbt=ro&&ro.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),sbt=ro&&ro.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),GS=ro&&ro.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&nbt(e,t,r);return sbt(e,t),e},Iwe=ro&&ro.__spreadArray||function(t,e){for(var r=0,i=e.length,n=t.length;r<i;r++,n++)t[n]=e[r];return t};Object.defineProperty(ro,"__esModule",{value:!0});ro.Address6=void 0;var Twe=GS(xC()),CC=GS(AC()),pr=GS(RC()),OC=GS(PC()),Nh=TC(),Dh=Awe(),fu=jS(),Nn=IC(),Dn=Z1();function WS(t){if(!t)throw new Error("Assertion failed.")}function obt(t){for(var e=/(\d+)(\d{3})/;e.test(t);)t=t.replace(e,"$1,$2");return t}function abt(t){return t=t.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),t=t.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),t}function cbt(t,e){var r=[],i=[],n;for(n=0;n<t.length;n++)n<e[0]?r.push(t[n]):n>e[1]&&i.push(t[n]);return r.concat(["compact"]).concat(i)}function Rwe(t){return Dn.sprintf("%04x",parseInt(t,16))}function Pwe(t){return t&255}var ubt=function(){function t(e,r){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=Twe.isInSubnet,this.isCorrect=Twe.isCorrect(pr.BITS),r===void 0?this.groups=pr.GROUPS:this.groups=r,this.address=e;var i=pr.RE_SUBNET_STRING.exec(e);if(i){if(this.parsedSubnet=i[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>pr.BITS)throw new fu.AddressError("Invalid subnet mask.");e=e.replace(pr.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new fu.AddressError("Invalid subnet mask.");var n=pr.RE_ZONE_STRING.exec(e);n&&(this.zone=n[0],e=e.replace(pr.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}return t.isValid=function(e){try{return new t(e),!0}catch(r){return!1}},t.fromBigInteger=function(e){var r=e.toString(16).padStart(32,"0"),i=[],n;for(n=0;n<pr.GROUPS;n++)i.push(r.slice(n*4,(n+1)*4));return new t(i.join(":"))},t.fromURL=function(e){var r,i=null,n;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if(n=pr.RE_URL_WITH_PORT.exec(e),n===null)return{error:"failed to parse address with port",address:null,port:null};r=n[1],i=n[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),n=pr.RE_URL.exec(e),n===null)return{error:"failed to parse address from URL",address:null,port:null};r=n[1]}else r=e;return i?(i=parseInt(i,10),(i<0||i>65536)&&(i=null)):i=null,{address:new t(r),port:i}},t.fromAddress4=function(e){var r=new Nh.Address4(e),i=pr.BITS-(CC.BITS-r.subnetMask);return new t("::ffff:"+r.correctForm()+"/"+i)},t.fromArpa=function(e){var r=e.replace(/(\.ip6\.arpa)?\.$/,""),i=7;if(r.length!==63)throw new fu.AddressError("Invalid 'ip6.arpa' form.");for(var n=r.split(".").reverse(),s=i;s>0;s--){var o=s*4;n.splice(o,0,":")}return r=n.join(""),new t(r)},t.prototype.microsoftTranscription=function(){return Dn.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))},t.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},t.prototype.possibleSubnets=function(e){e===void 0&&(e=128);var r=pr.BITS-this.subnetMask,i=Math.abs(e-pr.BITS),n=r-i;return n<0?"0":obt(new Nn.BigInteger("2",10).pow(n).toString(10))},t.prototype._startAddress=function(){return new Nn.BigInteger(this.mask()+"0".repeat(pr.BITS-this.subnetMask),2)},t.prototype.startAddress=function(){return t.fromBigInteger(this._startAddress())},t.prototype.startAddressExclusive=function(){var e=new Nn.BigInteger("1");return t.fromBigInteger(this._startAddress().add(e))},t.prototype._endAddress=function(){return new Nn.BigInteger(this.mask()+"1".repeat(pr.BITS-this.subnetMask),2)},t.prototype.endAddress=function(){return t.fromBigInteger(this._endAddress())},t.prototype.endAddressExclusive=function(){var e=new Nn.BigInteger("1");return t.fromBigInteger(this._endAddress().subtract(e))},t.prototype.getScope=function(){var e=pr.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"},t.prototype.getType=function(){for(var e=0,r=Object.keys(pr.TYPES);e<r.length;e++){var i=r[e];if(this.isInSubnet(new t(i)))return pr.TYPES[i]}return"Global unicast"},t.prototype.getBits=function(e,r){return new Nn.BigInteger(this.getBitsBase2(e,r),2)},t.prototype.getBitsBase2=function(e,r){return this.binaryZeroPad().slice(e,r)},t.prototype.getBitsBase16=function(e,r){var i=r-e;if(i%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,r).toString(16).padStart(i/4,"0")},t.prototype.getBitsPastSubnet=function(){return this.getBitsBase2(this.subnetMask,pr.BITS)},t.prototype.reverseForm=function(e){e||(e={});var r=Math.floor(this.subnetMask/4),i=this.canonicalForm().replace(/:/g,"").split("").slice(0,r).reverse().join(".");return r>0?e.omitSuffix?i:Dn.sprintf("%s.ip6.arpa.",i):e.omitSuffix?"":"ip6.arpa."},t.prototype.correctForm=function(){var e,r=[],i=0,n=[];for(e=0;e<this.parsedAddress.length;e++){var s=parseInt(this.parsedAddress[e],16);s===0&&i++,s!==0&&i>0&&(i>1&&n.push([e-i,e-1]),i=0)}i>1&&n.push([this.parsedAddress.length-i,this.parsedAddress.length-1]);var o=n.map(function(l){return l[1]-l[0]+1});if(n.length>0){var a=o.indexOf(Math.max.apply(Math,o));r=cbt(this.parsedAddress,n[a])}else r=this.parsedAddress;for(e=0;e<r.length;e++)r[e]!=="compact"&&(r[e]=parseInt(r[e],16).toString(16));var c=r.join(":");return c=c.replace(/^compact$/,"::"),c=c.replace(/^compact|compact$/,":"),c=c.replace(/compact/,""),c},t.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(pr.BITS,"0")},t.prototype.parse4in6=function(e){var r=e.split(":"),i=r.slice(-1)[0],n=i.match(CC.RE_ADDRESS);if(n){this.parsedAddress4=n[0],this.address4=new Nh.Address4(this.parsedAddress4);for(var s=0;s<this.address4.groups;s++)if(/^0[0-9]+/.test(this.address4.parsedAddress[s]))throw new fu.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(CC.RE_ADDRESS,this.address4.parsedAddress.map(abt).join(".")));this.v4=!0,r[r.length-1]=this.address4.toGroup6(),e=r.join(":")}return e},t.prototype.parse=function(e){e=this.parse4in6(e);var r=e.match(pr.RE_BAD_CHARACTERS);if(r)throw new fu.AddressError(Dn.sprintf("Bad character%s detected in address: %s",r.length>1?"s":"",r.join("")),e.replace(pr.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));var i=e.match(pr.RE_BAD_ADDRESS);if(i)throw new fu.AddressError(Dn.sprintf("Address failed regex: %s",i.join("")),e.replace(pr.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));var n=[],s=e.split("::");if(s.length===2){var o=s[0].split(":"),a=s[1].split(":");o.length===1&&o[0]===""&&(o=[]),a.length===1&&a[0]===""&&(a=[]);var c=this.groups-(o.length+a.length);if(!c)throw new fu.AddressError("Error parsing groups");this.elidedGroups=c,this.elisionBegin=o.length,this.elisionEnd=o.length+this.elidedGroups,n=n.concat(o);for(var l=0;l<c;l++)n.push("0");n=n.concat(a)}else if(s.length===1)n=e.split(":"),this.elidedGroups=0;else throw new fu.AddressError("Too many :: groups found");if(n=n.map(function(u){return Dn.sprintf("%x",parseInt(u,16))}),n.length!==this.groups)throw new fu.AddressError("Incorrect number of groups found");return n},t.prototype.canonicalForm=function(){return this.parsedAddress.map(Rwe).join(":")},t.prototype.decimal=function(){return this.parsedAddress.map(function(e){return Dn.sprintf("%05d",parseInt(e,16))}).join(":")},t.prototype.bigInteger=function(){return new Nn.BigInteger(this.parsedAddress.map(Rwe).join(""),16)},t.prototype.to4=function(){var e=this.binaryZeroPad().split("");return Nh.Address4.fromHex(new Nn.BigInteger(e.slice(96,128).join(""),2).toString(16))},t.prototype.to4in6=function(){var e=this.to4(),r=new t(this.parsedAddress.slice(0,6).join(":"),6),i=r.correctForm(),n="";return/:$/.test(i)||(n=":"),i+n+e.address},t.prototype.inspectTeredo=function(){var e=this.getBitsBase16(0,32),r=this.getBits(80,96).xor(new Nn.BigInteger("ffff",16)).toString(),i=Nh.Address4.fromHex(this.getBitsBase16(32,64)),n=Nh.Address4.fromHex(this.getBits(96,128).xor(new Nn.BigInteger("ffffffff",16)).toString(16)),s=this.getBits(64,80),o=this.getBitsBase2(64,80),a=s.testBit(15),c=s.testBit(14),l=s.testBit(8),u=s.testBit(9),h=new Nn.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:Dn.sprintf("%s:%s",e.slice(0,4),e.slice(4,8)),server4:i.address,client4:n.address,flags:o,coneNat:a,microsoft:{reserved:c,universalLocal:u,groupIndividual:l,nonce:h},udpPort:r}},t.prototype.inspect6to4=function(){var e=this.getBitsBase16(0,16),r=Nh.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:Dn.sprintf("%s",e.slice(0,4)),gateway:r.address}},t.prototype.to6to4=function(){if(!this.is4())return null;var e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new t(e)},t.prototype.toByteArray=function(){var e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e},t.prototype.toUnsignedByteArray=function(){return this.toByteArray().map(Pwe)},t.fromByteArray=function(e){return this.fromUnsignedByteArray(e.map(Pwe))},t.fromUnsignedByteArray=function(e){for(var r=new Nn.BigInteger("256",10),i=new Nn.BigInteger("0",10),n=new Nn.BigInteger("1",10),s=e.length-1;s>=0;s--)i=i.add(n.multiply(new Nn.BigInteger(e[s].toString(10),10))),n=n.multiply(r);return t.fromBigInteger(i)},t.prototype.isCanonical=function(){return this.addressMinusSuffix===this.canonicalForm()},t.prototype.isLinkLocal=function(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"},t.prototype.isMulticast=function(){return this.getType()==="Multicast"},t.prototype.is4=function(){return this.v4},t.prototype.isTeredo=function(){return this.isInSubnet(new t("2001::/32"))},t.prototype.is6to4=function(){return this.isInSubnet(new t("2002::/16"))},t.prototype.isLoopback=function(){return this.getType()==="Loopback"},t.prototype.href=function(e){return e===void 0?e="":e=Dn.sprintf(":%s",e),Dn.sprintf("http://[%s]%s/",this.correctForm(),e)},t.prototype.link=function(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);var r=this.correctForm;return e.v4&&(r=this.to4in6),e.className?Dn.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,r.call(this),e.className):Dn.sprintf('<a href="%1$s%2$s">%2$s</a>',e.prefix,r.call(this))},t.prototype.group=function(){if(this.elidedGroups===0)return OC.simpleGroup(this.address).join(":");WS(typeof this.elidedGroups=="number"),WS(typeof this.elisionBegin=="number");var e=[],r=this.address.split("::"),i=r[0],n=r[1];i.length?e.push.apply(e,OC.simpleGroup(i)):e.push("");for(var s=["hover-group"],o=this.elisionBegin;o<this.elisionBegin+this.elidedGroups;o++)s.push(Dn.sprintf("group-%d",o));return e.push(Dn.sprintf('<span class="%s"></span>',s.join(" "))),n.length?e.push.apply(e,OC.simpleGroup(n,this.elisionEnd)):e.push(""),this.is4()&&(WS(this.address4 instanceof Nh.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")},t.prototype.regularExpressionString=function(e){e===void 0&&(e=!1);var r=[],i=new t(this.correctForm());if(i.elidedGroups===0)r.push(Dh.simpleRegularExpression(i.parsedAddress));else if(i.elidedGroups===pr.GROUPS)r.push(Dh.possibleElisions(pr.GROUPS));else{var n=i.address.split("::");n[0].length&&r.push(Dh.simpleRegularExpression(n[0].split(":"))),WS(typeof i.elidedGroups=="number"),r.push(Dh.possibleElisions(i.elidedGroups,n[0].length!==0,n[1].length!==0)),n[1].length&&r.push(Dh.simpleRegularExpression(n[1].split(":"))),r=[r.join(":")]}return e||(r=Iwe(Iwe(["(?=^|",Dh.ADDRESS_BOUNDARY,"|[^\\w\\:])("],r),[")(?=[^\\w\\:]|",Dh.ADDRESS_BOUNDARY,"|$)"])),r.join("")},t.prototype.regularExpression=function(e){return e===void 0&&(e=!1),new RegExp(this.regularExpressionString(e),"i")},t}();ro.Address6=ubt});var Owe=p(vn=>{f();"use strict";var lbt=vn&&vn.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),fbt=vn&&vn.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hbt=vn&&vn.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&lbt(e,t,r);return fbt(e,t),e};Object.defineProperty(vn,"__esModule",{value:!0});vn.v6=vn.AddressError=vn.Address6=vn.Address4=void 0;var dbt=TC();Object.defineProperty(vn,"Address4",{enumerable:!0,get:function(){return dbt.Address4}});var pbt=Cwe();Object.defineProperty(vn,"Address6",{enumerable:!0,get:function(){return pbt.Address6}});var ybt=jS();Object.defineProperty(vn,"AddressError",{enumerable:!0,get:function(){return ybt.AddressError}});var gbt=hbt(PC());vn.v6={helpers:gbt}});var NC=p((NLt,BC)=>{f();"use strict";var kwe=me(),bbt=Object.assign(kwe("libp2p:ip-port-to-multiaddr"),{error:kwe("libp2p:ip-port-to-multiaddr:err")}),{Multiaddr:kC}=tt(),qC=ae(),{Address4:mbt,Address6:vbt}=Owe(),YS={ERR_INVALID_IP_PARAMETER:"ERR_INVALID_IP_PARAMETER",ERR_INVALID_PORT_PARAMETER:"ERR_INVALID_PORT_PARAMETER",ERR_INVALID_IP:"ERR_INVALID_IP"};function wbt(t,e){if(typeof t!="string")throw qC(new Error(`invalid ip provided: ${t}`),YS.ERR_INVALID_IP_PARAMETER);if(typeof e=="string"&&(e=parseInt(e)),isNaN(e))throw qC(new Error(`invalid port provided: ${e}`),YS.ERR_INVALID_PORT_PARAMETER);try{return new mbt(t),new kC(`/ip4/${t}/tcp/${e}`)}catch{}try{let r=new vbt(t);return r.is4()?new kC(`/ip4/${r.to4().correctForm()}/tcp/${e}`):new kC(`/ip6/${t}/tcp/${e}`)}catch(r){let i=`invalid ip:port for creating a multiaddr: ${t}:${e}`;throw bbt.error(i),qC(new Error(i),YS.ERR_INVALID_IP)}}BC.exports=wbt;BC.exports.Errors=YS});var Bwe=p((DLt,XS)=>{f();"use strict";var DC=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},qwe=(t,e,r,i)=>{let n,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){o(t);return}i={customTimers:{setTimeout,clearTimeout},...i},n=i.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{o(r())}catch(u){a(u)}return}let c=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,l=r instanceof Error?r:new DC(c);typeof t.cancel=="function"&&t.cancel(),a(l)},e),(async()=>{try{o(await t)}catch(c){a(c)}finally{i.customTimers.clearTimeout.call(void 0,n)}})()});return s.clear=()=>{clearTimeout(n),n=void 0},s};XS.exports=qwe;XS.exports.default=qwe;XS.exports.TimeoutError=DC});var Uwe=p((MLt,Lwe)=>{f();"use strict";var Nwe=ic(),{CLOSE_TIMEOUT:_bt}=SC(),Dwe=NC(),Ebt=Bwe(),Mwe=me(),MC=Mwe("libp2p:websockets:socket");MC.error=Mwe("libp2p:websockets:socket:error");Lwe.exports=(t,e={})=>{let r={async sink(i){e.signal&&(i=Nwe(i,e.signal));try{await t.sink(async function*(){for await(let n of i)yield n instanceof Uint8Array?n:n.slice()}())}catch(n){n.type!=="aborted"&&MC.error(n)}},source:e.signal?Nwe(t.source,e.signal):t.source,conn:t,localAddr:e.localAddr||(t.localAddress&&t.localPort?Dwe(t.localAddress,t.localPort):void 0),remoteAddr:e.remoteAddr||Dwe(t.remoteAddress,t.remotePort),timeline:{open:Date.now()},async close(){let i=Date.now();try{await Ebt(t.close(),_bt)}catch(n){let{host:s,port:o}=r.remoteAddr.toOptions();MC("timeout closing stream to %s:%s after %dms, destroying it manually",s,o,Date.now()-i),t.destroy()}finally{r.timeline.close=Date.now()}}};return t.socket.once&&t.socket.once("close",()=>{r.timeline.close||(r.timeline.close=Date.now())}),r}});var jwe=p((LLt,Kwe)=>{f();"use strict";var Ll=Sf(),{CODE_CIRCUIT:LC,CODE_P2P:UC,CODE_TCP:FC,CODE_WS:Sbt,CODE_WSS:Fwe}=SC();Kwe.exports={all:t=>t.filter(e=>{if(e.protoCodes().includes(LC))return!1;let r=e.decapsulateCode(UC);return Ll.WebSockets.matches(r)||Ll.WebSocketsSecure.matches(r)}),dnsWss:t=>t.filter(e=>{if(e.protoCodes().includes(LC))return!1;let r=e.decapsulateCode(UC);return Ll.WebSocketsSecure.matches(r)&&Ll.DNS.matches(r.decapsulateCode(FC).decapsulateCode(Fwe))}),dnsWsOrWss:t=>t.filter(e=>{if(e.protoCodes().includes(LC))return!1;let r=e.decapsulateCode(UC);return Ll.WebSockets.matches(r)?Ll.DNS.matches(r.decapsulateCode(FC).decapsulateCode(Sbt)):Ll.WebSocketsSecure.matches(r)&&Ll.DNS.matches(r.decapsulateCode(FC).decapsulateCode(Fwe))})}});var Ywe=p((ULt,Wwe)=>{f();"use strict";var xbt=ywe(),Abt=hw(),Ibt=w2(),{AbortError:Vwe}=ic(),Tbt=nl(),zwe=me(),Ul=zwe("libp2p:websockets");Ul.error=zwe("libp2p:websockets:error");var Hwe=Vy(),Rbt=bwe(),Pbt=Uwe(),$we=jwe(),Gwe=class{constructor({upgrader:e,filter:r}){if(!e)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e,this._filter=r}async dial(e,r={}){Ul("dialing %s",e);let i=await this._connect(e,r),n=Pbt(i,{remoteAddr:e,signal:r.signal});Ul("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return Ul("outbound connection %s upgraded",n.remoteAddr),s}async _connect(e,r={}){if(r.signal&&r.signal.aborted)throw new Vwe;let i=e.toOptions();Ul("dialing %s:%s",i.host,i.port);let n=Tbt(),s=l=>{let u=`connection error: ${l.message}`;Ul.error(u),n.reject(l)},o=xbt(Ibt(e),Object.assign({binary:!0},r));if(o.socket.on?o.socket.on("error",s):o.socket.onerror=s,!r.signal)return await Promise.race([o.connected(),n.promise]),Ul("connected %s",e),o;let a,c=new Promise((l,u)=>{if(a=()=>{u(new Vwe),setTimeout(()=>{o.close()})},r.signal.aborted)return a();r.signal.addEventListener("abort",a)});try{await Promise.race([c,n.promise,o.connected()])}finally{r.signal.removeEventListener("abort",a)}return Ul("connected %s",e),o}createListener(e={},r){return typeof e=="function"&&(r=e,e={}),Rbt({handler:r,upgrader:this._upgrader},e)}filter(e){return e=Array.isArray(e)?e:[e],this._filter?this._filter(e):Hwe.isBrowser||Hwe.isWebWorker?$we.dnsWss(e):$we.all(e)}};Wwe.exports=Abt(Gwe,{className:"WebSockets",symbolName:"@libp2p/js-libp2p-websockets/websockets"})});var Qwe=p((FLt,Xwe)=>{f();Xwe.exports=function(){if(typeof globalThis=="undefined")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}});var e_e=p((KC,Jwe)=>{f();var QS=ft(),fc=QS.Buffer;function Zwe(t,e){for(var r in t)e[r]=t[r]}fc.from&&fc.alloc&&fc.allocUnsafe&&fc.allocUnsafeSlow?Jwe.exports=QS:(Zwe(QS,KC),KC.Buffer=Mh);function Mh(t,e,r){return fc(t,e,r)}Mh.prototype=Object.create(fc.prototype);Zwe(fc,Mh);Mh.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return fc(t,e,r)};Mh.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var i=fc(t);return e!==void 0?typeof r=="string"?i.fill(e,r):i.fill(e):i.fill(0),i};Mh.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return fc(t)};Mh.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return QS.SlowBuffer(t)}});var zC=p((KLt,VC)=>{f();"use strict";var jC=65536,Cbt=4294967295;function Obt(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var kbt=e_e().Buffer,ZS=globalThis.crypto||globalThis.msCrypto;ZS&&ZS.getRandomValues?VC.exports=qbt:VC.exports=Obt;function qbt(t,e){if(t>Cbt)throw new RangeError("requested too many random bytes");var r=kbt.allocUnsafe(t);if(t>0)if(t>jC)for(var i=0;i<t;i+=jC)ZS.getRandomValues(r.slice(i,i+jC));else ZS.getRandomValues(r);return typeof e=="function"?process.nextTick(function(){e(null,r)}):r}});var i_e=p((jLt,r_e)=>{f();"use strict";function t_e(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function Bbt(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=void 0),e!=null&&(r.code=e);try{return t_e(t,r)}catch(i){r.message=t.message,r.stack=t.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(t)),t_e(new n,r)}}r_e.exports=Bbt});var GC=p((VLt,a_e)=>{f();var Nbt=me()("simple-peer"),n_e=Qwe(),s_e=zC(),Dbt=GR(),HC=iE(),yr=i_e(),$C=64*1024,Mbt=5*1e3,Lbt=5*1e3;function o_e(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function Ubt(t){console.warn(t)}var Fl=class extends Dbt.Duplex{constructor(e){e=Object.assign({allowHalfOpen:!1},e);super(e);if(this._id=s_e(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||s_e(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||Fl.channelConfig,this.negotiated=this.channelConfig.negotiated,this.config=Object.assign({},Fl.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(r=>r),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||Mbt,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:n_e(),!this._wrtc)throw typeof window=="undefined"?yr(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):yr(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=this.negotiated?!1:!this.initiator,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._firstStable=!0,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(r){HC(()=>this.destroy(yr(r,"ERR_PC_CONSTRUCTOR")));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=r=>{this._onIceCandidate(r)},this.initiator||this.negotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=r=>{this._setupData(r)},this.streams&&this.streams.forEach(r=>{this.addStream(r)}),this._pc.ontrack=r=>{this._onTrack(r)},this.initiator&&this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw yr(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if(typeof e=="string")try{e=JSON.parse(e)}catch(r){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(r=>{this._addIceCandidate(r)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(r=>{this.destroy(yr(r,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(yr(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){var r=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(r).catch(i=>{!r.address||r.address.endsWith(".local")?Ubt("Ignoring unsupported ICE candidate."):this.destroy(yr(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,r){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,r),this._needsNegotiation()}catch(i){this.destroy(yr(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:e,init:r}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(r=>{this.addTrack(r,e)})}addTrack(e,r){this._debug("addTrack()");var i=this._senderMap.get(e)||new Map,n=i.get(r);if(!n)n=this._pc.addTrack(e,r),i.set(r,n),this._senderMap.set(e,i),this._needsNegotiation();else throw n.removed?yr(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):yr(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,r,i){this._debug("replaceTrack()");var n=this._senderMap.get(e),s=n?n.get(i):null;if(!s)throw yr(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");r&&this._senderMap.set(r,n),s.replaceTrack!=null?s.replaceTrack(r):this.destroy(yr(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,r){this._debug("removeSender()");var i=this._senderMap.get(e),n=i?i.get(r):null;if(!n)throw yr(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(n):this.destroy(yr(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(r=>{this.removeTrack(r,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,HC(()=>{this._batchedNegotiation=!1,this._debug("starting batched negotiation"),this.negotiate()}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}_destroy(e,r){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(i){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(i){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,r(e)}_setupData(e){if(!e.channel)return this.destroy(yr(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=$C),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{this.destroy(yr(i,"ERR_DATA_CHANNEL"))};var r=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(r&&this._onChannelClose(),r=!0):r=!1},Lbt)}_read(){}_write(e,r,i){if(this.destroyed)return i(yr(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(n){return this.destroy(yr(n,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>$C?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;let e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=o_e(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})}},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},n=s=>{this.destroy(yr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(yr(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=o_e(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()}},i=()=>{this.destroyed||(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},n=s=>{this.destroy(yr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(yr(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(yr(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var e=this._pc.iceConnectionState,r=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,r),this.emit("iceStateChange",e,r),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(yr(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(yr(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(e){let r=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(n=>{Object.assign(i,n)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{var n=[];i.forEach(s=>{n.push(r(s))}),e(null,n)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(!this.destroyed){var n=[];i.result().forEach(s=>{var o={};s.names().forEach(a=>{o[a]=s.stat(a)}),o.id=s.id,o.type=s.type,o.timestamp=s.timestamp,n.push(r(o))}),e(null,n)}},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let e=()=>{this.destroyed||this.getStats((r,i)=>{if(this.destroyed)return;r&&(i=[]);var n={},s={},o={},a=!1;i.forEach(u=>{(u.type==="remotecandidate"||u.type==="remote-candidate")&&(n[u.id]=u),(u.type==="localcandidate"||u.type==="local-candidate")&&(s[u.id]=u),(u.type==="candidatepair"||u.type==="candidate-pair")&&(o[u.id]=u)});let c=u=>{a=!0;var h=s[u.localCandidateId];h&&(h.ip||h.address)?(this.localAddress=h.ip||h.address,this.localPort=Number(h.port)):h&&h.ipAddress?(this.localAddress=h.ipAddress,this.localPort=Number(h.portNumber)):typeof u.googLocalAddress=="string"&&(h=u.googLocalAddress.split(":"),this.localAddress=h[0],this.localPort=Number(h[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var d=n[u.remoteCandidateId];d&&(d.ip||d.address)?(this.remoteAddress=d.ip||d.address,this.remotePort=Number(d.port)):d&&d.ipAddress?(this.remoteAddress=d.ipAddress,this.remotePort=Number(d.portNumber)):typeof u.googRemoteAddress=="string"&&(d=u.googRemoteAddress.split(":"),this.remoteAddress=d[0],this.remotePort=Number(d[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(u=>{u.type==="transport"&&u.selectedCandidatePairId&&c(o[u.selectedCandidatePairId]),(u.type==="googCandidatePair"&&u.googActiveConnection==="true"||(u.type==="candidatepair"||u.type==="candidate-pair")&&u.selected)&&c(u)}),!a&&(!Object.keys(o).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(u){return this.destroy(yr(u,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');var l=this._cb;this._cb=null,l(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>$C||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&!this._firstStable&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation&&(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()),this._debug("negotiate"),this.emit("negotiate")),this._firstStable=!1,this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(!this.destroyed){var r=e.data;r instanceof ArrayBuffer&&(r=new Uint8Array(r)),this.push(r)}}_onChannelBufferedAmountLow(){if(!(this.destroyed||!this._cb)){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(r=>{this._debug("on track"),this.emit("track",e.track,r),this._remoteTracks.push({track:e.track,stream:r}),!this._remoteStreams.some(i=>i.id===r.id)&&(this._remoteStreams.push(r),HC(()=>{this.emit("stream",r)}))})}_debug(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],Nbt.apply(null,e)}};Fl.WEBRTC_SUPPORT=!!n_e();Fl.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};Fl.channelConfig={};a_e.exports=Fl});var u_e=p((zLt,c_e)=>{f();"use strict";c_e.exports={supportsFileReader:typeof self!="undefined"&&"FileReader"in self,supportsWebRTC:"RTCPeerConnection"in globalThis&&typeof navigator!="undefined"&&typeof navigator.mediaDevices!="undefined"&&"getUserMedia"in navigator.mediaDevices,supportsWebRTCDataChannels:"RTCPeerConnection"in globalThis}});var e3=p(JS=>{f();"use strict";JS.CODE_P2P=421;JS.CODE_CIRCUIT=290;JS.CLOSE_TIMEOUT=2e3});var WC=p(($Lt,l_e)=>{f();var Fbt=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Kbt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];l_e.exports=function(e){var r=e,i=e.indexOf("["),n=e.indexOf("]");i!=-1&&n!=-1&&(e=e.substring(0,i)+e.substring(i,n).replace(/:/g,";")+e.substring(n,e.length));for(var s=Fbt.exec(e||""),o={},a=14;a--;)o[Kbt[a]]=s[a]||"";return i!=-1&&n!=-1&&(o.source=r,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=jbt(o,o.path),o.queryKey=Vbt(o,o.query),o};function jbt(t,e){var r=/\/{2,9}/g,i=e.replace(r,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&i.splice(0,1),e.substr(e.length-1,1)=="/"&&i.splice(i.length-1,1),i}function Vbt(t,e){var r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,s){n&&(r[n]=s)}),r}});var h_e=p(t3=>{f();"use strict";Object.defineProperty(t3,"__esModule",{value:!0});t3.url=void 0;var zbt=WC(),f_e=me()("socket.io-client:url");function Hbt(t,e="",r){let i=t;r=r||typeof location!="undefined"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(f_e("protocol-less url %s",t),typeof r!="undefined"?t=r.protocol+"//"+t:t="https://"+t),f_e("parse %s",t),i=zbt(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(r&&r.port===i.port?"":":"+i.port),i}t3.url=Hbt});var d_e=p((WLt,YC)=>{f();try{YC.exports=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(t){YC.exports=!1}});var em=p((YLt,p_e)=>{f();p_e.exports=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())()});var XC=p((XLt,y_e)=>{f();var $bt=d_e(),Gbt=em();y_e.exports=function(t){let e=t.xdomain,r=t.xscheme,i=t.enablesXDR;try{if(typeof XMLHttpRequest!="undefined"&&(!e||$bt))return new XMLHttpRequest}catch(n){}try{if(typeof XDomainRequest!="undefined"&&!r&&i)return new XDomainRequest}catch(n){}if(!e)try{return new Gbt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(n){}}});var QC=p((QLt,b_e)=>{f();var hc=Object.create(null);hc.open="0";hc.close="1";hc.ping="2";hc.pong="3";hc.message="4";hc.upgrade="5";hc.noop="6";var g_e=Object.create(null);Object.keys(hc).forEach(t=>{g_e[hc[t]]=t});var Wbt={type:"error",data:"parser error"};b_e.exports={PACKET_TYPES:hc,PACKET_TYPES_REVERSE:g_e,ERROR_PACKET:Wbt}});var w_e=p((ZLt,v_e)=>{f();var{PACKET_TYPES:Ybt}=QC(),Xbt=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Qbt=typeof ArrayBuffer=="function",Zbt=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Jbt=({type:t,data:e},r,i)=>Xbt&&e instanceof Blob?r?i(e):m_e(e,i):Qbt&&(e instanceof ArrayBuffer||Zbt(e))?r?i(e instanceof ArrayBuffer?e:e.buffer):m_e(new Blob([e]),i):i(Ybt[t]+(e||"")),m_e=(t,e)=>{let r=new FileReader;return r.onload=function(){let i=r.result.split(",")[1];e("b"+i)},r.readAsDataURL(t)};v_e.exports=Jbt});var __e=p(ZC=>{f();(function(t){"use strict";ZC.encode=function(e){var r=new Uint8Array(e),i,n=r.length,s="";for(i=0;i<n;i+=3)s+=t[r[i]>>2],s+=t[(r[i]&3)<<4|r[i+1]>>4],s+=t[(r[i+1]&15)<<2|r[i+2]>>6],s+=t[r[i+2]&63];return n%3==2?s=s.substring(0,s.length-1)+"=":n%3==1&&(s=s.substring(0,s.length-2)+"=="),s},ZC.decode=function(e){var r=e.length*.75,i=e.length,n,s=0,o,a,c,l;e[e.length-1]==="="&&(r--,e[e.length-2]==="="&&r--);var u=new ArrayBuffer(r),h=new Uint8Array(u);for(n=0;n<i;n+=4)o=t.indexOf(e[n]),a=t.indexOf(e[n+1]),c=t.indexOf(e[n+2]),l=t.indexOf(e[n+3]),h[s++]=o<<2|a>>4,h[s++]=(a&15)<<4|c>>2,h[s++]=(c&3)<<6|l&63;return u}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")});var x_e=p((e9t,S_e)=>{f();var{PACKET_TYPES_REVERSE:JC,ERROR_PACKET:e1t}=QC(),t1t=typeof ArrayBuffer=="function",eO;t1t&&(eO=__e());var r1t=(t,e)=>{if(typeof t!="string")return{type:"message",data:E_e(t,e)};let r=t.charAt(0);return r==="b"?{type:"message",data:i1t(t.substring(1),e)}:JC[r]?t.length>1?{type:JC[r],data:t.substring(1)}:{type:JC[r]}:e1t},i1t=(t,e)=>{if(eO){let r=eO.decode(t);return E_e(r,e)}else return{base64:!0,data:t}},E_e=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};S_e.exports=r1t});var ey=p((t9t,R_e)=>{f();var A_e=w_e(),I_e=x_e(),T_e=String.fromCharCode(30),n1t=(t,e)=>{let r=t.length,i=new Array(r),n=0;t.forEach((s,o)=>{A_e(s,!1,a=>{i[o]=a,++n===r&&e(i.join(T_e))})})},s1t=(t,e)=>{let r=t.split(T_e),i=[];for(let n=0;n<r.length;n++){let s=I_e(r[n],e);if(i.push(s),s.type==="error")break}return i};R_e.exports={protocol:4,encodePacket:A_e,encodePayload:n1t,decodePacket:I_e,decodePayload:s1t}});var ty=p((r9t,tO)=>{f();typeof tO!="undefined"&&(tO.exports=vs);function vs(t){if(t)return o1t(t)}function o1t(t){for(var e in vs.prototype)t[e]=vs.prototype[e];return t}vs.prototype.on=vs.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};vs.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};vs.prototype.off=vs.prototype.removeListener=vs.prototype.removeAllListeners=vs.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var i,n=0;n<r.length;n++)if(i=r[n],i===e||i.fn===e){r.splice(n,1);break}return r.length===0&&delete this._callbacks["$"+t],this};vs.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(r){r=r.slice(0);for(var i=0,n=r.length;i<n;++i)r[i].apply(this,e)}return this};vs.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};vs.prototype.hasListeners=function(t){return!!this.listeners(t).length}});var r3=p((i9t,C_e)=>{f();var a1t=ey(),c1t=ty(),u1t=me()("engine.io-client:transport"),P_e=class extends c1t{constructor(e){super();this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,r){let i=new Error(e);return i.type="TransportError",i.description=r,this.emit("error",i),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):u1t("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(e){let r=a1t.decodePacket(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){this.emit("packet",e)}onClose(){this.readyState="closed",this.emit("close")}};C_e.exports=P_e});var i3=p(rO=>{f();rO.encode=function(t){var e="";for(var r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e};rO.decode=function(t){for(var e={},r=t.split("&"),i=0,n=r.length;i<n;i++){var s=r[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}});var sO=p((s9t,N_e)=>{f();"use strict";var O_e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),n3=64,k_e={},q_e=0,Kl=0,B_e;function iO(t){var e="";do e=O_e[t%n3]+e,t=Math.floor(t/n3);while(t>0);return e}function l1t(t){var e=0;for(Kl=0;Kl<t.length;Kl++)e=e*n3+k_e[t.charAt(Kl)];return e}function nO(){var t=iO(+new Date);return t!==B_e?(q_e=0,B_e=t):t+"."+iO(q_e++)}for(;Kl<n3;Kl++)k_e[O_e[Kl]]=Kl;nO.encode=iO;nO.decode=l1t;N_e.exports=nO});var oO=p((o9t,L_e)=>{f();var f1t=r3(),h1t=i3(),D_e=ey(),d1t=sO(),ia=me()("engine.io-client:polling"),M_e=class extends f1t{get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let r=()=>{ia("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let i=0;this.polling&&(ia("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){ia("pre-pause polling complete"),--i||r()})),this.writable||(ia("we are currently writing - waiting to pause"),i++,this.once("drain",function(){ia("pre-pause writing complete"),--i||r()}))}else r()}poll(){ia("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){ia("polling got data %s",e);let r=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose(),!1;this.onPacket(i)};D_e.decodePayload(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"?this.poll():ia('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{ia("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(ia("transport open - closing"),e()):(ia("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,D_e.encodePayload(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emit("drain")})})}uri(){let e=this.query||{},r=this.opts.secure?"https":"http",i="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=d1t()),!this.supportsBinary&&!e.sid&&(e.b64=1),e=h1t.encode(e),this.opts.port&&(r==="https"&&Number(this.opts.port)!==443||r==="http"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}};L_e.exports=M_e});var aO=p((a9t,U_e)=>{f();U_e.exports.pick=(t,...e)=>e.reduce((r,i)=>(t.hasOwnProperty(i)&&(r[i]=t[i]),r),{})});var z_e=p((c9t,uO)=>{f();var F_e=XC(),p1t=oO(),y1t=ty(),{pick:g1t}=aO(),b1t=em(),cO=me()("engine.io-client:polling-xhr");function K_e(){}var m1t=function(){return new F_e({xdomain:!1}).responseType!=null}(),j_e=class extends p1t{constructor(e){super(e);if(typeof location!="undefined"){let i=location.protocol==="https:",n=location.port;n||(n=i?443:80),this.xd=typeof location!="undefined"&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==i}let r=e&&e.forceBase64;this.supportsBinary=m1t&&!r}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new io(this.uri(),e)}doWrite(e,r){let i=this.request({method:"POST",data:e});i.on("success",r),i.on("error",n=>{this.onError("xhr post error",n)})}doPoll(){cO("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",r=>{this.onError("xhr poll error",r)}),this.pollXhr=e}},io=class extends y1t{constructor(e,r){super();this.opts=r,this.method=r.method||"GET",this.uri=e,this.async=r.async!==!1,this.data=r.data!==void 0?r.data:null,this.create()}create(){let e=g1t(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let r=this.xhr=new F_e(e);try{cO("xhr open %s: %s",this.method,this.uri),r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this.opts.extraHeaders[i])}}catch(i){}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{r.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),this.hasXDR()?(r.onload=()=>{this.onLoad()},r.onerror=()=>{this.onError(r.responseText)}):r.onreadystatechange=()=>{r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():setTimeout(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},cO("xhr data %s",this.data),r.send(this.data)}catch(i){setTimeout(()=>{this.onError(i)},0);return}typeof document!="undefined"&&(this.index=io.requestsCount++,io.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=K_e:this.xhr.onreadystatechange=K_e,e)try{this.xhr.abort()}catch(r){}typeof document!="undefined"&&delete io.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&this.onData(e)}hasXDR(){return typeof XDomainRequest!="undefined"&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}};io.requestsCount=0;io.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",V_e);else if(typeof addEventListener=="function"){let t="onpagehide"in b1t?"pagehide":"unload";addEventListener(t,V_e,!1)}}function V_e(){for(let t in io.requests)io.requests.hasOwnProperty(t)&&io.requests[t].abort()}uO.exports=j_e;uO.exports.Request=io});var W_e=p((u9t,G_e)=>{f();var v1t=oO(),H_e=em(),w1t=/\n/g,_1t=/\\n/g,s3,$_e=class extends v1t{constructor(e){super(e);this.query=this.query||{},s3||(s3=H_e.___eio=H_e.___eio||[]),this.index=s3.length,s3.push(this.onData.bind(this)),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){let e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=n=>{this.onError("jsonp poll error",n)};let r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(e,r):(document.head||document.body).appendChild(e),this.script=e,typeof navigator!="undefined"&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){let n=document.createElement("iframe");document.body.appendChild(n),document.body.removeChild(n)},100)}doWrite(e,r){let i;if(!this.form){let o=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),a.name="d",o.appendChild(a),document.body.appendChild(o),this.form=o,this.area=a}this.form.action=this.uri();function n(){s(),r()}let s=()=>{if(this.iframe)try{this.form.removeChild(this.iframe)}catch(o){this.onError("jsonp polling iframe removal error",o)}try{let o='<iframe src="javascript:0" name="'+this.iframeId+'">';i=document.createElement(o)}catch(o){i=document.createElement("iframe"),i.name=this.iframeId,i.src="javascript:0"}i.id=this.iframeId,this.form.appendChild(i),this.iframe=i};s(),e=e.replace(_1t,`\\
`),this.area.value=e.replace(w1t,"\\n");try{this.form.submit()}catch(o){}this.iframe.attachEvent?this.iframe.onreadystatechange=()=>{this.iframe.readyState==="complete"&&n()}:this.iframe.onload=n}};G_e.exports=$_e});var Q_e=p((l9t,X_e)=>{f();var Y_e=em(),E1t=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):e=>setTimeout(e,0))();X_e.exports={WebSocket:Y_e.WebSocket||Y_e.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer",nextTick:E1t}});var t2e=p((f9t,e2e)=>{f();var Z_e=r3(),S1t=ey(),x1t=i3(),A1t=sO(),{pick:I1t}=aO(),{WebSocket:tm,usingBrowserWebSocket:lO,defaultBinaryType:T1t,nextTick:R1t}=Q_e(),P1t=me()("engine.io-client:websocket"),J_e=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",o3=class extends Z_e{constructor(e){super(e);this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),r=this.opts.protocols,i=J_e?{}:I1t(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=lO&&!J_e?r?new tm(e,r):new tm(e):new tm(e,r,i)}catch(n){return this.emit("error",n)}this.ws.binaryType=this.socket.binaryType||T1t,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){let i=e[r],n=r===e.length-1;S1t.encodePacket(i,this.supportsBinary,s=>{let o={};lO||(i.options&&(o.compress=i.options.compress),this.opts.perMessageDeflate&&(typeof s=="string"?Buffer.byteLength(s):s.length)<this.opts.perMessageDeflate.threshold&&(o.compress=!1));try{lO?this.ws.send(s):this.ws.send(s,o)}catch(a){P1t("websocket closed before onclose event")}n&&R1t(()=>{this.writable=!0,this.emit("drain")})})}}onClose(){Z_e.prototype.onClose.call(this)}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},r=this.opts.secure?"wss":"ws",i="";this.opts.port&&(r==="wss"&&Number(this.opts.port)!==443||r==="ws"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=A1t()),this.supportsBinary||(e.b64=1),e=x1t.encode(e),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}check(){return!!tm&&!("__initialize"in tm&&this.name===o3.prototype.name)}};e2e.exports=o3});var hO=p(fO=>{f();var C1t=XC(),O1t=z_e(),k1t=W_e(),q1t=t2e();fO.polling=B1t;fO.websocket=q1t;function B1t(t){let e,r=!1,i=!1,n=t.jsonp!==!1;if(typeof location!="undefined"){let s=location.protocol==="https:",o=location.port;o||(o=s?443:80),r=t.hostname!==location.hostname||o!==t.port,i=t.secure!==s}if(t.xdomain=r,t.xscheme=i,e=new C1t(t),"open"in e&&!t.forceJSONP)return new O1t(t);if(!n)throw new Error("JSONP disabled");return new k1t(t)}});var s2e=p((d9t,n2e)=>{f();var N1t=hO(),D1t=ty(),fi=me()("engine.io-client:socket"),r2e=ey(),i2e=WC(),M1t=i3(),dc=class extends D1t{constructor(e,r={}){super();e&&typeof e=="object"&&(r=e,e=null),e?(e=i2e(e),r.hostname=e.host,r.secure=e.protocol==="https"||e.protocol==="wss",r.port=e.port,e.query&&(r.query=e.query)):r.host&&(r.hostname=i2e(r.host).host),this.secure=r.secure!=null?r.secure:typeof location!="undefined"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=r.port||(typeof location!="undefined"&&location.port?location.port:this.secure?443:80),this.transports=r.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},r),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=M1t.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){fi('creating transport "%s"',e);let r=L1t(this.opts.query);r.EIO=r2e.protocol,r.transport=e,this.id&&(r.sid=this.id);let i=Object.assign({},this.opts.transportOptions[e],this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return fi("options: %j",i),new N1t[e](i)}open(){let e;if(this.opts.rememberUpgrade&&dc.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){setTimeout(()=>{this.emit("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(r){fi("error while creating transport: %s",r),this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){fi("setting transport %s",e.name),this.transport&&(fi("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(e){fi('probing transport "%s"',e);let r=this.createTransport(e,{probe:1}),i=!1;dc.priorWebsocketSuccess=!1;let n=()=>{i||(fi('probe transport "%s" opened',e),r.send([{type:"ping",data:"probe"}]),r.once("packet",h=>{if(!i)if(h.type==="pong"&&h.data==="probe"){if(fi('probe transport "%s" pong',e),this.upgrading=!0,this.emit("upgrading",r),!r)return;dc.priorWebsocketSuccess=r.name==="websocket",fi('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{i||this.readyState!=="closed"&&(fi("changing transport and sending upgrade packet"),u(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emit("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{fi('probe transport "%s" failed',e);let d=new Error("probe error");d.transport=r.name,this.emit("upgradeError",d)}}))};function s(){i||(i=!0,u(),r.close(),r=null)}let o=h=>{let d=new Error("probe error: "+h);d.transport=r.name,s(),fi('probe transport "%s" failed because of error: %s',e,h),this.emit("upgradeError",d)};function a(){o("transport closed")}function c(){o("socket closed")}function l(h){r&&h.name!==r.name&&(fi('"%s" works - aborting "%s"',h.name,r.name),s())}let u=()=>{r.removeListener("open",n),r.removeListener("error",o),r.removeListener("close",a),this.removeListener("close",c),this.removeListener("upgrading",l)};r.once("open",n),r.once("error",o),r.once("close",a),this.once("close",c),this.once("upgrading",l),r.open()}onOpen(){if(fi("socket open"),this.readyState="open",dc.priorWebsocketSuccess=this.transport.name==="websocket",this.emit("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){fi("starting upgrade probes");let e=0,r=this.upgrades.length;for(;e<r;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(fi('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("ping"),this.emit("pong");break;case"error":let r=new Error("server error");r.code=e.data,this.onError(r);break;case"message":this.emit("data",e.data),this.emit("message",e.data);break}else fi('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()}flush(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(fi("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(e,r,i){return this.sendPacket("message",e,r,i),this}send(e,r,i){return this.sendPacket("message",e,r,i),this}sendPacket(e,r,i,n){if(typeof r=="function"&&(n=r,r=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let s={type:e,data:r,options:i};this.emit("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this.onClose("forced close"),fi("socket closing - telling transport to close"),this.transport.close()},r=()=>{this.removeListener("upgrade",r),this.removeListener("upgradeError",r),e()},i=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}onError(e){fi("socket error %j",e),dc.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)}onClose(e,r){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(fi('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",e,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let r=[],i=0,n=e.length;for(;i<n;i++)~this.transports.indexOf(e[i])&&r.push(e[i]);return r}};dc.priorWebsocketSuccess=!1;dc.protocol=r2e.protocol;function L1t(t){let e={};for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}n2e.exports=dc});var o2e=p((p9t,Lh)=>{f();var dO=s2e();Lh.exports=(t,e)=>new dO(t,e);Lh.exports.Socket=dO;Lh.exports.protocol=dO.protocol;Lh.exports.Transport=r3();Lh.exports.transports=hO();Lh.exports.parser=ey()});var pO=p(ry=>{f();"use strict";Object.defineProperty(ry,"__esModule",{value:!0});ry.hasBinary=ry.isBinary=void 0;var U1t=typeof ArrayBuffer=="function",F1t=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,a2e=Object.prototype.toString,K1t=typeof Blob=="function"||typeof Blob!="undefined"&&a2e.call(Blob)==="[object BlobConstructor]",j1t=typeof File=="function"||typeof File!="undefined"&&a2e.call(File)==="[object FileConstructor]";function c2e(t){return U1t&&(t instanceof ArrayBuffer||F1t(t))||K1t&&t instanceof Blob||j1t&&t instanceof File}ry.isBinary=c2e;function a3(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,i=t.length;r<i;r++)if(a3(t[r]))return!0;return!1}if(c2e(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return a3(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&a3(t[r]))return!0;return!1}ry.hasBinary=a3});var u2e=p(iy=>{f();"use strict";Object.defineProperty(iy,"__esModule",{value:!0});iy.reconstructPacket=iy.deconstructPacket=void 0;var V1t=pO();function z1t(t){let e=[],r=t.data,i=t;return i.data=yO(r,e),i.attachments=e.length,{packet:i,buffers:e}}iy.deconstructPacket=z1t;function yO(t,e){if(!t)return t;if(V1t.isBinary(t)){let r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){let r=new Array(t.length);for(let i=0;i<t.length;i++)r[i]=yO(t[i],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){let r={};for(let i in t)t.hasOwnProperty(i)&&(r[i]=yO(t[i],e));return r}return t}function H1t(t,e){return t.data=gO(t.data,e),t.attachments=void 0,t}iy.reconstructPacket=H1t;function gO(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=gO(t[r],e);else if(typeof t=="object")for(let r in t)t.hasOwnProperty(r)&&(t[r]=gO(t[r],e));return t}});var u3=p(na=>{f();"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.Decoder=na.Encoder=na.PacketType=na.protocol=void 0;var $1t=ty(),l2e=u2e(),f2e=pO(),bO=me()("socket.io-parser");na.protocol=5;var mi;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(mi=na.PacketType||(na.PacketType={}));var h2e=class{encode(e){return bO("encoding packet %j",e),(e.type===mi.EVENT||e.type===mi.ACK)&&f2e.hasBinary(e)?(e.type=e.type===mi.EVENT?mi.BINARY_EVENT:mi.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===mi.BINARY_EVENT||e.type===mi.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data)),bO("encoded %j as %s",e,r),r}encodeAsBinary(e){let r=l2e.deconstructPacket(e),i=this.encodeAsString(r.packet),n=r.buffers;return n.unshift(i),n}};na.Encoder=h2e;var c3=class extends $1t{constructor(){super()}add(e){let r;if(typeof e=="string")r=this.decodeString(e),r.type===mi.BINARY_EVENT||r.type===mi.BINARY_ACK?(this.reconstructor=new d2e(r),r.attachments===0&&super.emit("decoded",r)):super.emit("decoded",r);else if(f2e.isBinary(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emit("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0,i={type:Number(e.charAt(0))};if(mi[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===mi.BINARY_EVENT||i.type===mi.BINARY_ACK){let s=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);let o=e.substring(s,r);if(o!=Number(o)||e.charAt(r)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(e.charAt(r+1)==="/"){let s=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););i.nsp=e.substring(s,r)}else i.nsp="/";let n=e.charAt(r+1);if(n!==""&&Number(n)==n){let s=r+1;for(;++r;){let o=e.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===e.length)break}i.id=Number(e.substring(s,r+1))}if(e.charAt(++r)){let s=G1t(e.substr(r));if(c3.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return bO("decoded %s as %j",e,i),i}static isPayloadValid(e,r){switch(e){case mi.CONNECT:return typeof r=="object";case mi.DISCONNECT:return r===void 0;case mi.CONNECT_ERROR:return typeof r=="string"||typeof r=="object";case mi.EVENT:case mi.BINARY_EVENT:return Array.isArray(r)&&r.length>0;case mi.ACK:case mi.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}};na.Decoder=c3;function G1t(t){try{return JSON.parse(t)}catch(e){return!1}}var d2e=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let r=l2e.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}});var mO=p(l3=>{f();"use strict";Object.defineProperty(l3,"__esModule",{value:!0});l3.on=void 0;function W1t(t,e,r){return t.on(e,r),function(){t.off(e,r)}}l3.on=W1t});var vO=p(f3=>{f();"use strict";Object.defineProperty(f3,"__esModule",{value:!0});f3.StrictEventEmitter=void 0;var Y1t=ty(),p2e=class extends Y1t{on(e,r){return super.on(e,r),this}once(e,r){return super.once(e,r),this}emit(e,...r){return super.emit(e,...r),this}emitReserved(e,...r){return super.emit(e,...r),this}listeners(e){return super.listeners(e)}};f3.StrictEventEmitter=p2e});var wO=p(d3=>{f();"use strict";Object.defineProperty(d3,"__esModule",{value:!0});d3.Socket=void 0;var no=u3(),h3=mO(),X1t=vO(),so=me()("socket.io-client:socket"),Q1t=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),y2e=class extends X1t.StrictEventEmitter{constructor(e,r,i){super();this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;let e=this.io;this.subs=[h3.on(e,"open",this.onopen.bind(this)),h3.on(e,"packet",this.onpacket.bind(this)),h3.on(e,"error",this.onerror.bind(this)),h3.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){if(Q1t.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');r.unshift(e);let i={type:no.PacketType.EVENT,data:r};i.options={},i.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"&&(so("emitting packet with ack id %d",this.ids),this.acks[this.ids]=r.pop(),i.id=this.ids++);let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)?so("discard packet as the transport is not currently writable"):this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){so("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this.packet({type:no.PacketType.CONNECT,data:e})}):this.packet({type:no.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e){so("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case no.PacketType.CONNECT:if(e.data&&e.data.sid){let n=e.data.sid;this.onconnect(n)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case no.PacketType.EVENT:this.onevent(e);break;case no.PacketType.BINARY_EVENT:this.onevent(e);break;case no.PacketType.ACK:this.onack(e);break;case no.PacketType.BINARY_ACK:this.onack(e);break;case no.PacketType.DISCONNECT:this.ondisconnect();break;case no.PacketType.CONNECT_ERROR:let i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){let r=e.data||[];so("emitting event %j",r),e.id!=null&&(so("attaching ack callback to event"),r.push(this.ack(e.id))),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let r=this._anyListeners.slice();for(let i of r)i.apply(this,e)}super.emit.apply(this,e)}ack(e){let r=this,i=!1;return function(...n){i||(i=!0,so("sending ack %j",n),r.packet({type:no.PacketType.ACK,id:e,data:n}))}}onack(e){let r=this.acks[e.id];typeof r=="function"?(so("calling ack %s with %j",e.id,e.data),r.apply(this,e.data),delete this.acks[e.id]):so("bad ack %s",e.id)}onconnect(e){so("socket connected with id %s",e),this.id=e,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>this.packet(e)),this.sendBuffer=[]}ondisconnect(){so("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(so("performing disconnect (%s)",this.nsp),this.packet({type:no.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let r=this._anyListeners;for(let i=0;i<r.length;i++)if(e===r[i])return r.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}};d3.Socket=y2e});var b2e=p((_9t,g2e)=>{f();g2e.exports=ny;function ny(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ny.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};ny.prototype.reset=function(){this.attempts=0};ny.prototype.setMin=function(t){this.ms=t};ny.prototype.setMax=function(t){this.max=t};ny.prototype.setJitter=function(t){this.jitter=t}});var _O=p(p3=>{f();"use strict";Object.defineProperty(p3,"__esModule",{value:!0});p3.Manager=void 0;var Z1t=o2e(),J1t=wO(),emt=u3(),Uh=mO(),tmt=b2e(),rmt=vO(),tn=me()("socket.io-client:manager"),m2e=class extends rmt.StrictEventEmitter{constructor(e,r){super();this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor(r.randomizationFactor||.5),this.backoff=new tmt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;let i=r.parser||emt;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(tn("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;tn("opening %s",this.uri),this.engine=Z1t(this.uri,this.opts);let r=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let n=Uh.on(r,"open",function(){i.onopen(),e&&e()}),s=Uh.on(r,"error",o=>{tn("error"),i.cleanup(),i._readyState="closed",this.emitReserved("error",o),e?e(o):i.maybeReconnectOnOpen()});if(this._timeout!==!1){let o=this._timeout;tn("connect attempt will timeout after %d",o),o===0&&n();let a=setTimeout(()=>{tn("connect attempt timed out after %d",o),n(),r.close(),r.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){tn("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(Uh.on(e,"ping",this.onping.bind(this)),Uh.on(e,"data",this.ondata.bind(this)),Uh.on(e,"error",this.onerror.bind(this)),Uh.on(e,"close",this.onclose.bind(this)),Uh.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){tn("error",e),this.emitReserved("error",e)}socket(e,r){let i=this.nsps[e];return i||(i=new J1t.Socket(this,e,r),this.nsps[e]=i),i}_destroy(e){let r=Object.keys(this.nsps);for(let i of r)if(this.nsps[i].active){tn("socket %s is still active, skipping close",i);return}this._close()}_packet(e){tn("writing packet %j",e);let r=this.encoder.encode(e);for(let i=0;i<r.length;i++)this.engine.write(r[i],e.options)}cleanup(){tn("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){tn("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this._readyState==="opening"&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){tn("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)tn("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let r=this.backoff.duration();tn("will wait %dms before reconnect attempt",r),this._reconnecting=!0;let i=setTimeout(()=>{e.skipReconnect||(tn("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(tn("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):(tn("reconnect success"),e.onreconnect())}))},r);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};p3.Manager=m2e});var E2e=p((Jn,_2e)=>{f();"use strict";Object.defineProperty(Jn,"__esModule",{value:!0});Jn.io=Jn.Socket=Jn.Manager=Jn.protocol=void 0;var imt=h_e(),v2e=_O(),w2e=me()("socket.io-client");_2e.exports=Jn=y3;var rm=Jn.managers={};function y3(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};let r=imt.url(t,e.path||"/socket.io"),i=r.source,n=r.id,s=r.path,o=rm[n]&&s in rm[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o,c;return a?(w2e("ignoring socket cache for %s",i),c=new v2e.Manager(i,e)):(rm[n]||(w2e("new io instance for %s",i),rm[n]=new v2e.Manager(i,e)),c=rm[n]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}Jn.io=y3;var nmt=u3();Object.defineProperty(Jn,"protocol",{enumerable:!0,get:function(){return nmt.protocol}});Jn.connect=y3;var smt=_O();Object.defineProperty(Jn,"Manager",{enumerable:!0,get:function(){return smt.Manager}});var omt=wO();Object.defineProperty(Jn,"Socket",{enumerable:!0,get:function(){return omt.Socket}});Jn.default=y3});var EO=p((S9t,S2e)=>{f();var amt=DE();S2e.exports=t=>async e=>{e=amt(e);let r=v=>{typeof v.return=="function"&&v.return()},i=null,n=null,s=v=>{i=v,n&&n(v),r(e)},o=null,a=!1,c=()=>{a=!0,o&&o()},l=null,u=!1,h=()=>{u=!0,l&&l()},d=null,y=()=>{d&&d()},g=()=>new Promise((v,A)=>{o=d=v,n=A,t.once("drain",y)}),m=()=>(r(e),new Promise((v,A)=>{if(a||u||i)return v();l=o=v,n=A})),E=()=>{t.removeListener("error",s),t.removeListener("close",c),t.removeListener("finish",h),t.removeListener("drain",y)};t.once("error",s),t.once("close",c),t.once("finish",h);try{for await(let v of e){if(!t.writable||t.destroyed||i)break;t.write(v)===!1&&await g()}}catch(v){i||t.destroy(),i=v}try{if(t.writable&&t.end(),await m(),i)throw i}finally{E()}}});var SO=p((x9t,x2e)=>{f();var cmt=EO(),umt=C1();x2e.exports=t=>({sink:cmt(t),source:umt(t)})});var I2e=p((A9t,A2e)=>{f();var lmt=SO();A2e.exports=t=>async function*(e){let r=lmt(t),i;if(r.sink(e).catch(n=>{i=n}),yield*r.source,i)throw i}});var T2e=p((I9t,sy)=>{f();sy.exports=C1();sy.exports.source=C1();sy.exports.sink=EO();sy.exports.transform=I2e();sy.exports.duplex=SO()});var xO=p((T9t,k2e)=>{f();"use strict";var R2e=ic(),fmt=T2e(),{CLOSE_TIMEOUT:hmt}=e3(),P2e=NC(),C2e=me(),g3=C2e("libp2p:webrtc-star:socket");g3.error=C2e("libp2p:webrtc-star:socket:error");var O2e=(t,e)=>{if(!(!t||!e))try{return P2e(t,e)}catch(r){return g3.error(r),P2e("0.0.0.0",e)}};k2e.exports=(t,e={})=>{let{sink:r,source:i}=fmt.duplex(t),n=e.remoteAddr||O2e(t.remoteAddress,t.remotePort),s=O2e(t.localAddress,t.localPort),o={async sink(a){e.signal&&(a=R2e(a,e.signal));try{await r(async function*(){for await(let c of a)yield c instanceof Uint8Array?c:c.slice()}())}catch(c){c.type!=="aborted"&&g3.error(c)}},source:e.signal?R2e(i,e.signal):i,conn:t,localAddr:s,remoteAddr:n,timeline:{open:Date.now()},close(){if(!t.destroyed)return new Promise((a,c)=>{let l=Date.now(),u=setTimeout(()=>{if(o.remoteAddr){let{host:h,port:d}=o.remoteAddr.toOptions();g3("timeout closing socket to %s:%s after %dms, destroying it manually",h,d,Date.now()-l)}t.destroyed||t.destroy()},hmt);t.once("close",()=>{a()}),t.end(h=>{if(clearTimeout(u),o.timeline.close=Date.now(),h)return c(h)})})}};return t.once("close",()=>{o.timeline.close||(o.timeline.close=Date.now())}),o}});var AO=p((R9t,B2e)=>{f();"use strict";var{Multiaddr:q2e}=tt();function dmt(t){let e=t.toString().split("/"),r=t.protos()[1].name,i=t.protos()[2].name,n=t.stringTuples()[1][1];if(r!=="tcp"||i!=="ws"&&i!=="wss")throw new Error("invalid multiaddr: "+t.toString());if(!q2e.isName(t))return"http://"+e[2]+":"+e[4];if(i==="ws")return"http://"+e[2]+(n==="80"?"":":"+n);if(i==="wss")return"https://"+e[2]+(n==="443"?"":":"+n)}function pmt(t){let e="/libp2p-webrtc-star";if(t.indexOf(e)!==-1){t=t.substring(e.length,t.length);let r=new q2e(t),i=r.stringTuples().filter(n=>n[0]===421)[0];r=r.decapsulate("p2p"),r=r.encapsulate("/p2p-webrtc-star"),r=r.encapsulate(`/p2p/${i[1]}`),t=r.toString()}return t}B2e.exports={cleanUrlSIO:dmt,cleanMultiaddr:pmt}});var L2e=p((P9t,M2e)=>{f();"use strict";var ymt=vr(),N2e=me(),Fh=N2e("libp2p:webrtc-star:listener");Fh.error=N2e("libp2p:webrtc-star:listener:error");var gmt=ae(),bmt=E2e(),mmt=GC(),vmt=nl(),wmt=xO(),{cleanUrlSIO:_mt}=AO(),{CODE_P2P:D2e}=e3(),Emt={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"};M2e.exports=({handler:t,upgrader:e},r,i={})=>{let n=new ymt,s,o;return n.__connections=[],n.__spChannels=new Map,n.__pendingIntents=new Map,n.listen=a=>{if(s)throw gmt(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let c=vmt();s=a;let l;!a.protoCodes().includes(D2e)&&e.localPeer?l=a.encapsulate(`/p2p/${e.localPeer.toB58String()}`):l=a,n.on("error",()=>c.reject()),o=_mt(a),Fh("Dialing to Signalling Server on: "+o),n.io=bmt.connect(o,Emt);let u=h=>{if(h.answer||h.err||!h.intentId)return;let d=h.intentId,y=n.__pendingIntents.get(d);y||(y=[],n.__pendingIntents.set(d,y));let g=n.__spChannels.get(d);if(g){g.signal(h.signal);return}else if(h.signal.type!=="offer"){y.push(h);return}let m={trickle:!1,...i};r.wrtc&&(m.wrtc=r.wrtc),g=new mmt(m);let E=v=>{Fh.error("incoming connection errored",v)};g.on("error",E),g.once("close",(...v)=>{g.removeListener("error",E)}),g.on("signal",v=>{h.signal=v,h.answer=!0,n.io.emit("ss-handshake",h)}),g.signal(h.signal);for(let v of y)g.signal(v.signal);n.__pendingIntents.set(d,[]),g.once("connect",async()=>{let v=wmt(g);Fh("new inbound connection %s",v.remoteAddr);let A;try{A=await e.upgradeInbound(v)}catch(R){return Fh.error("inbound connection failed to upgrade",R),v.close()}if(!A.remoteAddr)try{A.remoteAddr=a.decapsulateCode(D2e).encapsulate(`/p2p/${A.remotePeer.toB58String()}`)}catch(R){Fh.error("could not determine remote address",R)}Fh("inbound connection %s upgraded",v.remoteAddr),Smt(n,v,d),n.emit("connection",A),t(A)}),n.__spChannels.set(d,g)};return n.io.once("connect_error",h=>c.reject(h)),n.io.once("error",h=>{n.emit("error",h),n.emit("close")}),n.io.on("ws-handshake",u),n.io.on("ws-peer",r._peerDiscovered),n.io.on("connect",()=>{n.io.emit("ss-join",l.toString())}),n.io.once("connect",()=>{n.emit("listening"),c.resolve()}),r.sigReferences.set(o,{listener:n,signallingAddr:l}),c.promise},n.close=async()=>{let a=r.sigReferences.get(o);a&&a.listener.io&&(a.listener.io.emit("ss-leave"),a.listener.io.close()),await Promise.all(n.__connections.map(c=>c.close())),n.emit("close"),n.removeAllListeners(),s=void 0,r.sigReferences.delete(o)},n.getAddrs=()=>[s],n};function Smt(t,e,r){t.__connections.push(e);let i=()=>{t.__connections=t.__connections.filter(n=>n!==e),t.__spChannels.delete(r),t.__pendingIntents.delete(r)};e.conn.once("close",i)}});var V2e=p((C9t,j2e)=>{f();"use strict";var U2e=me(),hu=U2e("libp2p:webrtc-star");hu.error=U2e("libp2p:webrtc-star:error");var{EventEmitter:xmt}=vr(),b3=ae(),Amt=hw(),{AbortError:F2e}=ic(),Imt=GC(),{supportsWebRTCDataChannels:Tmt}=u_e(),{Multiaddr:Rmt}=tt(),Pmt=Sf(),Cmt=et(),{CODE_CIRCUIT:Omt}=e3(),kmt=L2e(),qmt=xO(),{cleanMultiaddr:Bmt,cleanUrlSIO:Nmt}=AO();function Dmt(){}var K2e=class{constructor(e={}){if(!e.upgrader)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e.upgrader,this.sioOptions={transports:["websocket"],"force new connection":!0},e.wrtc&&(this.wrtc=e.wrtc),this.sigReferences=new Map,this.discovery=new xmt,this.discovery.tag="webRTCStar",this.discovery._isStarted=!1,this.discovery.start=()=>{this.discovery._isStarted=!0},this.discovery.stop=()=>{this.discovery._isStarted=!1},this._peerDiscovered=this._peerDiscovered.bind(this)}async dial(e,r={}){let i=await this._connect(e,r),n=qmt(i,{remoteAddr:e,signal:r.signal});hu("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return hu("outbound connection %s upgraded",n.remoteAddr),s}_connect(e,r={}){if(r.signal&&r.signal.aborted)throw new F2e;let i={initiator:!0,trickle:!1,...r.spOptions||{}};this.wrtc&&(i.wrtc=this.wrtc);let n=e.toOptions(),s=(~~(Math.random()*1e9)).toString(36)+Date.now();return new Promise((o,a)=>{let c=this.sigReferences.get(Nmt(e));if(!c||!c.listener)return a(b3(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let l=c.listener.io,u=Date.now(),h;hu("dialing %s:%s",n.host,n.port);let d=new Imt(i),y=A=>{if(!h){let R=`connection error ${n.host}:${n.port}: ${A.message}`;hu.error(R),v(A)}},g=()=>{hu("connnection timeout %s:%s",n.host,n.port);let A=b3(new Error(`connection timeout after ${Date.now()-u}ms`),"ERR_CONNECT_TIMEOUT");d.emit("error",A)},m=()=>{h=!0,hu("connection opened %s:%s",n.host,n.port),v(null)},E=()=>{hu.error("connection aborted %s:%s",n.host,n.port),d.destroy(),v(new F2e)},v=A=>{d.removeListener("timeout",g),d.removeListener("connect",m),r.signal&&r.signal.removeEventListener("abort",E),A?a(A):o(d)};d.on("error",y),d.once("timeout",g),d.once("connect",m),d.on("close",()=>{d.removeListener("error",y)}),r.signal&&r.signal.addEventListener("abort",E),d.on("signal",A=>{l.emit("ss-handshake",{intentId:s,srcMultiaddr:c.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:A})}),l.on("ws-handshake",A=>{A.intentId===s&&A.err&&(d.destroy(),a(b3(A.err instanceof Error?A.err:new Error(A.err),"ERR_SIGNALLING_FAILED"))),!(A.intentId!==s||!A.answer||d.destroyed)&&d.signal(A.signal)})})}createListener(e={},r){if(!Tmt&&!this.wrtc)throw b3(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return typeof e=="function"&&(r=e,e={}),r=r||Dmt,kmt({handler:r,upgrader:this._upgrader},this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>r.protoCodes().includes(Omt)?!1:Pmt.WebRTCStar.matches(r))}_peerDiscovered(e){if(!this.discovery._isStarted)return;hu("Peer Discovered:",e),e=Bmt(e);let r=new Rmt(e),i=Cmt.createFromB58String(r.getPeerId());this.discovery.emit("peer",{id:i,multiaddrs:[r]})}};j2e.exports=Amt(K2e,{className:"WebRTCStar",symbolName:"@libp2p/js-libp2p-webrtc-star/webrtcstar"})});var m3=p((O9t,H2e)=>{f();"use strict";var{Buffer:sa}=ft(),z2e=Symbol.for("BufferList");function gr(t){if(!(this instanceof gr))return new gr(t);gr._init.call(this,t)}gr._init=function(e){Object.defineProperty(this,z2e,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};gr.prototype._new=function(e){return new gr(e)};gr.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};gr.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};gr.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};gr.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};gr.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||sa.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,l=s&&r||0,u=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:sa.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,l),l+=this._bufs[h].length;return e}if(c<=this._bufs[o[0]].length-u)return s?this._bufs[o[0]].copy(e,r,u,u+c):this._bufs[o[0]].slice(u,u+c);s||(e=sa.allocUnsafe(a));for(let h=o[0];h<this._bufs.length;h++){let d=this._bufs[h].length-u;if(c>d)this._bufs[h].copy(e,l,u),l+=d;else{this._bufs[h].copy(e,l,u,u+c),l+=d;break}c-=d,u&&(u=0)}return e.length>l?e.slice(0,l):e};gr.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};gr.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};gr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};gr.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};gr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(sa.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(sa.from(e));return this};gr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};gr.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=sa.from([t]):typeof t=="string"?t=sa.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=sa.from(t.buffer,t.byteOffset,t.byteLength):sa.isBuffer(t)||(t=sa.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,t))return c;s++}s=0}return-1};gr.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?gr.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:gr.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();gr.prototype._isBufferList=function(e){return e instanceof gr||gr.isBufferList(e)};gr.isBufferList=function(e){return e!=null&&e[z2e]};H2e.exports=gr});var X2e=p((k9t,Y2e)=>{f();"use strict";var v3=os(),$2e=m3(),IO=10*1024,G2e=class{constructor(){this._pool=new Uint8Array(IO),this._poolOffset=0}write(e){let r=this._pool,i=this._poolOffset;v3.encode(e.id<<3|e.type,r,i),i+=v3.encode.bytes,v3.encode(e.data?e.data.length:0,r,i),i+=v3.encode.bytes;let n=r.subarray(this._poolOffset,i);return IO-i<100?(this._pool=new Uint8Array(IO),this._poolOffset=0):this._poolOffset=i,e.data?[n,e.data]:n}},W2e=new G2e;Y2e.exports=t=>async function*(){for await(let r of t)Array.isArray(r)?yield new $2e(r.map(i=>W2e.write(i))):yield new $2e(W2e.write(r))}()});var J2e=p((q9t,Z2e)=>{f();"use strict";var w3=os(),Mmt=m3();Z2e.exports=t=>async function*(){let r=new Q2e;for await(let i of t){let n=r.write(i);n.length&&(yield n)}}();var Q2e=class{constructor(){this._buffer=new Mmt,this._bufferProxy=new Proxy({},{get:(e,r)=>r[0]==="l"?this._buffer[r]:this._buffer.get(parseInt(r))}),this._headerInfo=null}write(e){if(!e||!e.length)return[];this._buffer.append(e);let r=[];for(;;){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch(c){break}let{id:i,type:n,length:s,offset:o}=this._headerInfo;if(this._buffer.length-o<s)break;r.push({id:i,type:n,data:this._buffer.shallowSlice(o,o+s)}),this._buffer.consume(o+s),this._headerInfo=null}return r}_decodeHeader(e){let r=w3.decode(e),i=w3.decode.bytes,n=w3.decode(e,i);return i+=w3.decode.bytes,{id:r>>3,type:r&7,offset:i,length:n}}}});var eEe=p(TO=>{f();"use strict";TO.encode=X2e();TO.decode=J2e()});var PO=p((N9t,RO)=>{f();"use strict";var tEe=1<<20;RO.exports=t=>{t=t||tEe;let e=r=>{if(r.data&&r.data.length>t)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return r=>async function*(){for await(let n of r)Array.isArray(n)?n.forEach(e):e(n),yield n}()};RO.exports.MAX_MSG_SIZE=tEe});var CO=p(im=>{f();"use strict";var du=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});im.MessageTypes=du;im.InitiatorMessageTypes=Object.freeze({NEW_STREAM:du.NEW_STREAM,MESSAGE:du.MESSAGE_INITIATOR,CLOSE:du.CLOSE_INITIATOR,RESET:du.RESET_INITIATOR});im.ReceiverMessageTypes=Object.freeze({MESSAGE:du.MESSAGE_RECEIVER,CLOSE:du.CLOSE_RECEIVER,RESET:du.RESET_RECEIVER});im.MessageTypeNames=Object.freeze(Object.entries(du).reduce((t,e)=>(t[e[1]]=e[0],t),{}))});var sEe=p((M9t,nEe)=>{f();"use strict";var Lmt=ic(),rEe=Ql(),nm=me()("libp2p:mplex:stream"),Umt=za(),iEe=m3(),Fmt=ae(),{MAX_MSG_SIZE:Kmt}=PO(),{InitiatorMessageTypes:jmt,ReceiverMessageTypes:Vmt}=CO(),OO="ERR_MPLEX_STREAM_RESET",zmt="ERR_MPLEX_STREAM_ABORT";nEe.exports=({id:t,name:e,send:r,onEnd:i=()=>{},type:n="initiator",maxMsgSize:s=Kmt})=>{let o=new rEe,a=new rEe,c=n==="initiator"?jmt:Vmt,l=n==="initiator"?`i${t}`:`r${t}`;e=String(e??t);let u=!1,h=!1,d,y=E=>{u||(u=!0,nm("%s stream %s source end",n,e,E),E&&!d&&(d=E),h&&(m.timeline.close=Date.now(),i(d)))},g=E=>{h||(h=!0,nm("%s stream %s sink end",n,e,E),E&&!d&&(d=E),u&&(m.timeline.close=Date.now(),i(d)))},m={close:()=>m.source.end(),abort:E=>{nm("%s stream %s abort",n,e,E),m.source.end(E),o.abort(),g(E)},reset:()=>{let E=Fmt(new Error("stream reset"),OO);a.abort(),m.source.end(E),g(E)},sink:async E=>{E=Lmt(E,[{signal:o.signal,options:{abortMessage:"stream aborted",abortCode:zmt}},{signal:a.signal,options:{abortMessage:"stream reset",abortCode:OO}}]),n==="initiator"&&r({id:t,type:c.NEW_STREAM,data:e});try{for await(let v of E)for(;v.length;){if(v.length<=s){r({id:t,type:c.MESSAGE,data:v});break}v=iEe.isBufferList(v)?v:new iEe(v),r({id:t,type:c.MESSAGE,data:v.shallowSlice(0,s)}),v.consume(s)}}catch(v){return v.code===OO?nm("%s stream %s reset",n,e):(nm("%s stream %s error",n,e,v),r({id:t,type:c.RESET})),m.source.end(v),g(v)}r({id:t,type:c.CLOSE}),g()},source:Umt(y),timeline:{open:Date.now(),close:null},id:l};return m}});var uEe=p((L9t,cEe)=>{f();"use strict";var Hmt=Pr(),$mt=za(),pu=me()("libp2p:mplex"),Gmt=ic(),oEe=eEe(),Wmt=PO(),{MessageTypes:Kh,MessageTypeNames:aEe}=CO(),Ymt=sEe(),kO=class{constructor(e){e=e||{},e=typeof e=="function"?{onStream:e}:e,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=e,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=e.onStream,this.onStreamEnd=e.onStreamEnd}get streams(){let e=[];return this._streams.initiators.forEach(r=>{e.push(r)}),this._streams.receivers.forEach(r=>{e.push(r)}),e}newStream(e){let r=this._streamId++;e=e==null?r.toString():String(e);let i=this._streams.initiators;return this._newStream({id:r,name:e,type:"initiator",registry:i})}_newReceiverStream({id:e,name:r}){let i=this._streams.receivers;return this._newStream({id:e,name:r,type:"receiver",registry:i})}_newStream({id:e,name:r,type:i,registry:n}){if(n.has(e))throw new Error(`${i} stream ${e} already exists!`);pu("new %s stream %s %s",i,e,r);let a=Ymt({id:e,name:r,send:c=>(pu.enabled&&pu("%s stream %s %s send",i,e,r,{...c,type:aEe[c.type],data:c.data&&c.data.slice()}),this.source.push(c)),type:i,onEnd:()=>{pu("%s stream %s %s ended",i,e,r),n.delete(e),this.onStreamEnd&&this.onStreamEnd(a)},maxMsgSize:this._options.maxMsgSize});return n.set(e,a),a}_createSink(){return async e=>{this._options.signal&&(e=Gmt(e,this._options.signal));try{await Hmt(e,oEe.decode,Wmt(this._options.maxMsgSize),async r=>{for await(let i of r)for(let n of i)this._handleIncoming(n)})}catch(r){return pu("error in sink",r),this.source.end(r)}this.source.end()}}_createSource(){let r=$mt({onEnd:i=>{let{initiators:n,receivers:s}=this._streams;for(let o of n.values())o.abort(i);for(let o of s.values())o.abort(i)},writev:!0});return Object.assign(oEe.encode(r),{push:r.push,end:r.end,return:r.return})}_handleIncoming({id:e,type:r,data:i}){if(pu.enabled&&pu("incoming message",{id:e,type:aEe[r],data:i.slice()}),r===Kh.NEW_STREAM&&this.onStream){let o=this._newReceiverStream({id:e,name:i.toString()});return this.onStream(o)}let s=(r&1?this._streams.initiators:this._streams.receivers).get(e);if(!s)return pu("missing stream %s",e);switch(r){case Kh.MESSAGE_INITIATOR:case Kh.MESSAGE_RECEIVER:s.source.push(i);break;case Kh.CLOSE_INITIATOR:case Kh.CLOSE_RECEIVER:s.close();break;case Kh.RESET_INITIATOR:case Kh.RESET_RECEIVER:s.reset();break;default:pu("unknown message type %s",r)}}};kO.multicodec="/mplex/6.7.0";cEe.exports=kO});var fEe=p((U9t,lEe)=>{f();"use strict";lEe.exports=uEe()});var dEe=p(qO=>{f();"use strict";Object.defineProperty(qO,"__esModule",{value:!0});var hEe=65536,Xmt=function(){function t(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self!="undefined"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var r=new Uint8Array(e),i=0;i<r.length;i+=hEe)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,hEe)));return r},t}();qO.BrowserRandomSource=Xmt});var pc=p(BO=>{f();"use strict";Object.defineProperty(BO,"__esModule",{value:!0});function Qmt(t){for(var e=0;e<t.length;e++)t[e]=0;return t}BO.wipe=Qmt});var pEe=p(NO=>{f();"use strict";Object.defineProperty(NO,"__esModule",{value:!0});var Zmt=pc(),Jmt=function(){function t(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof aa!="undefined"){var e=ud();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var i=new Uint8Array(e),n=0;n<i.length;n++)i[n]=r[n];return Zmt.wipe(r),i},t}();NO.NodeRandomSource=Jmt});var yEe=p(DO=>{f();"use strict";Object.defineProperty(DO,"__esModule",{value:!0});var evt=dEe(),tvt=pEe(),rvt=function(){function t(){if(this.isAvailable=!1,this.name="",this._source=new evt.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new tvt.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return t.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},t}();DO.SystemRandomSource=rvt});var gEe=p(ws=>{f();"use strict";Object.defineProperty(ws,"__esModule",{value:!0});function ivt(t,e){var r=t>>>16&65535,i=t&65535,n=e>>>16&65535,s=e&65535;return i*s+(r*s+i*n<<16>>>0)|0}ws.mul=Math.imul||ivt;function nvt(t,e){return t+e|0}ws.add=nvt;function svt(t,e){return t-e|0}ws.sub=svt;function ovt(t,e){return t<<e|t>>>32-e}ws.rotl=ovt;function avt(t,e){return t<<32-e|t>>>e}ws.rotr=avt;function cvt(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}ws.isInteger=Number.isInteger||cvt;ws.MAX_SAFE_INTEGER=9007199254740991;ws.isSafeInteger=function(t){return ws.isInteger(t)&&t>=-ws.MAX_SAFE_INTEGER&&t<=ws.MAX_SAFE_INTEGER}});var sm=p(gt=>{f();"use strict";Object.defineProperty(gt,"__esModule",{value:!0});var bEe=gEe();function uvt(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}gt.readInt16BE=uvt;function lvt(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}gt.readUint16BE=lvt;function fvt(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}gt.readInt16LE=fvt;function hvt(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}gt.readUint16LE=hvt;function mEe(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}gt.writeUint16BE=mEe;gt.writeInt16BE=mEe;function vEe(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}gt.writeUint16LE=vEe;gt.writeInt16LE=vEe;function MO(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}gt.readInt32BE=MO;function LO(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}gt.readUint32BE=LO;function UO(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}gt.readInt32LE=UO;function FO(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}gt.readUint32LE=FO;function _3(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}gt.writeUint32BE=_3;gt.writeInt32BE=_3;function E3(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}gt.writeUint32LE=E3;gt.writeInt32LE=E3;function dvt(t,e){e===void 0&&(e=0);var r=MO(t,e),i=MO(t,e+4);return r*4294967296+i-(i>>31)*4294967296}gt.readInt64BE=dvt;function pvt(t,e){e===void 0&&(e=0);var r=LO(t,e),i=LO(t,e+4);return r*4294967296+i}gt.readUint64BE=pvt;function yvt(t,e){e===void 0&&(e=0);var r=UO(t,e),i=UO(t,e+4);return i*4294967296+r-(r>>31)*4294967296}gt.readInt64LE=yvt;function gvt(t,e){e===void 0&&(e=0);var r=FO(t,e),i=FO(t,e+4);return i*4294967296+r}gt.readUint64LE=gvt;function wEe(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),_3(t/4294967296>>>0,e,r),_3(t>>>0,e,r+4),e}gt.writeUint64BE=wEe;gt.writeInt64BE=wEe;function _Ee(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),E3(t>>>0,e,r),E3(t/4294967296>>>0,e,r+4),e}gt.writeUint64LE=_Ee;gt.writeInt64LE=_Ee;function bvt(t,e,r){if(r===void 0&&(r=0),t%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}gt.readUintBE=bvt;function mvt(t,e,r){if(r===void 0&&(r=0),t%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}gt.readUintLE=mvt;function vvt(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!bEe.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}gt.writeUintBE=vvt;function wvt(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!bEe.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}gt.writeUintLE=wvt;function _vt(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}gt.readFloat32BE=_vt;function Evt(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}gt.readFloat32LE=Evt;function Svt(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}gt.readFloat64BE=Svt;function xvt(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}gt.readFloat64LE=xvt;function Avt(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}gt.writeFloat32BE=Avt;function Ivt(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}gt.writeFloat32LE=Ivt;function Tvt(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}gt.writeFloat64BE=Tvt;function Rvt(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}gt.writeFloat64LE=Rvt});var AEe=p(oa=>{f();"use strict";Object.defineProperty(oa,"__esModule",{value:!0});var Pvt=yEe(),Cvt=sm(),EEe=pc();oa.defaultRandomSource=new Pvt.SystemRandomSource;function KO(t,e){return e===void 0&&(e=oa.defaultRandomSource),e.randomBytes(t)}oa.randomBytes=KO;function Ovt(t){t===void 0&&(t=oa.defaultRandomSource);var e=KO(4,t),r=Cvt.readUint32LE(e);return EEe.wipe(e),r}oa.randomUint32=Ovt;var SEe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function xEe(t,e,r){if(e===void 0&&(e=SEe),r===void 0&&(r=oa.defaultRandomSource),e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");for(var i="",n=e.length,s=256-256%n;t>0;){for(var o=KO(Math.ceil(t*256/s),r),a=0;a<o.length&&t>0;a++){var c=o[a];c<s&&(i+=e.charAt(c%n),t--)}EEe.wipe(o)}return i}oa.randomString=xEe;function kvt(t,e,r){e===void 0&&(e=SEe),r===void 0&&(r=oa.defaultRandomSource);var i=Math.ceil(t/(Math.log(e.length)/Math.LN2));return xEe(i,e,r)}oa.randomStringForEntropy=kvt});var A3=p(es=>{f();"use strict";Object.defineProperty(es,"__esModule",{value:!0});var qvt=AEe(),Bvt=pc();es.PUBLIC_KEY_LENGTH=32;es.SECRET_KEY_LENGTH=32;es.SHARED_KEY_LENGTH=32;function yc(t){var e=new Float64Array(16);if(t)for(var r=0;r<t.length;r++)e[r]=t[r];return e}var IEe=new Uint8Array(32);IEe[0]=9;var Nvt=yc([56129,1]);function jO(t){for(var e=1,r=0;r<16;r++){var i=t[r]+e+65535;e=Math.floor(i/65536),t[r]=i-e*65536}t[0]+=e-1+37*(e-1)}function om(t,e,r){for(var i=~(r-1),n=0;n<16;n++){var s=i&(t[n]^e[n]);t[n]^=s,e[n]^=s}}function Dvt(t,e){for(var r=yc(),i=yc(),n=0;n<16;n++)i[n]=e[n];jO(i),jO(i),jO(i);for(var s=0;s<2;s++){r[0]=i[0]-65517;for(var n=1;n<15;n++)r[n]=i[n]-65535-(r[n-1]>>16&1),r[n-1]&=65535;r[15]=i[15]-32767-(r[14]>>16&1);var o=r[15]>>16&1;r[14]&=65535,om(i,r,1-o)}for(var n=0;n<16;n++)t[2*n]=i[n]&255,t[2*n+1]=i[n]>>8}function Mvt(t,e){for(var r=0;r<16;r++)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function S3(t,e,r){for(var i=0;i<16;i++)t[i]=e[i]+r[i]}function x3(t,e,r){for(var i=0;i<16;i++)t[i]=e[i]-r[i]}function yu(t,e,r){var i,n,s=0,o=0,a=0,c=0,l=0,u=0,h=0,d=0,y=0,g=0,m=0,E=0,v=0,A=0,R=0,F=0,q=0,B=0,z=0,G=0,Y=0,P=0,b=0,w=0,S=0,C=0,D=0,W=0,j=0,M=0,_=0,L=r[0],ce=r[1],X=r[2],ne=r[3],oe=r[4],de=r[5],pe=r[6],_e=r[7],k=r[8],K=r[9],$=r[10],Z=r[11],I=r[12],U=r[13],V=r[14],N=r[15];i=e[0],s+=i*L,o+=i*ce,a+=i*X,c+=i*ne,l+=i*oe,u+=i*de,h+=i*pe,d+=i*_e,y+=i*k,g+=i*K,m+=i*$,E+=i*Z,v+=i*I,A+=i*U,R+=i*V,F+=i*N,i=e[1],o+=i*L,a+=i*ce,c+=i*X,l+=i*ne,u+=i*oe,h+=i*de,d+=i*pe,y+=i*_e,g+=i*k,m+=i*K,E+=i*$,v+=i*Z,A+=i*I,R+=i*U,F+=i*V,q+=i*N,i=e[2],a+=i*L,c+=i*ce,l+=i*X,u+=i*ne,h+=i*oe,d+=i*de,y+=i*pe,g+=i*_e,m+=i*k,E+=i*K,v+=i*$,A+=i*Z,R+=i*I,F+=i*U,q+=i*V,B+=i*N,i=e[3],c+=i*L,l+=i*ce,u+=i*X,h+=i*ne,d+=i*oe,y+=i*de,g+=i*pe,m+=i*_e,E+=i*k,v+=i*K,A+=i*$,R+=i*Z,F+=i*I,q+=i*U,B+=i*V,z+=i*N,i=e[4],l+=i*L,u+=i*ce,h+=i*X,d+=i*ne,y+=i*oe,g+=i*de,m+=i*pe,E+=i*_e,v+=i*k,A+=i*K,R+=i*$,F+=i*Z,q+=i*I,B+=i*U,z+=i*V,G+=i*N,i=e[5],u+=i*L,h+=i*ce,d+=i*X,y+=i*ne,g+=i*oe,m+=i*de,E+=i*pe,v+=i*_e,A+=i*k,R+=i*K,F+=i*$,q+=i*Z,B+=i*I,z+=i*U,G+=i*V,Y+=i*N,i=e[6],h+=i*L,d+=i*ce,y+=i*X,g+=i*ne,m+=i*oe,E+=i*de,v+=i*pe,A+=i*_e,R+=i*k,F+=i*K,q+=i*$,B+=i*Z,z+=i*I,G+=i*U,Y+=i*V,P+=i*N,i=e[7],d+=i*L,y+=i*ce,g+=i*X,m+=i*ne,E+=i*oe,v+=i*de,A+=i*pe,R+=i*_e,F+=i*k,q+=i*K,B+=i*$,z+=i*Z,G+=i*I,Y+=i*U,P+=i*V,b+=i*N,i=e[8],y+=i*L,g+=i*ce,m+=i*X,E+=i*ne,v+=i*oe,A+=i*de,R+=i*pe,F+=i*_e,q+=i*k,B+=i*K,z+=i*$,G+=i*Z,Y+=i*I,P+=i*U,b+=i*V,w+=i*N,i=e[9],g+=i*L,m+=i*ce,E+=i*X,v+=i*ne,A+=i*oe,R+=i*de,F+=i*pe,q+=i*_e,B+=i*k,z+=i*K,G+=i*$,Y+=i*Z,P+=i*I,b+=i*U,w+=i*V,S+=i*N,i=e[10],m+=i*L,E+=i*ce,v+=i*X,A+=i*ne,R+=i*oe,F+=i*de,q+=i*pe,B+=i*_e,z+=i*k,G+=i*K,Y+=i*$,P+=i*Z,b+=i*I,w+=i*U,S+=i*V,C+=i*N,i=e[11],E+=i*L,v+=i*ce,A+=i*X,R+=i*ne,F+=i*oe,q+=i*de,B+=i*pe,z+=i*_e,G+=i*k,Y+=i*K,P+=i*$,b+=i*Z,w+=i*I,S+=i*U,C+=i*V,D+=i*N,i=e[12],v+=i*L,A+=i*ce,R+=i*X,F+=i*ne,q+=i*oe,B+=i*de,z+=i*pe,G+=i*_e,Y+=i*k,P+=i*K,b+=i*$,w+=i*Z,S+=i*I,C+=i*U,D+=i*V,W+=i*N,i=e[13],A+=i*L,R+=i*ce,F+=i*X,q+=i*ne,B+=i*oe,z+=i*de,G+=i*pe,Y+=i*_e,P+=i*k,b+=i*K,w+=i*$,S+=i*Z,C+=i*I,D+=i*U,W+=i*V,j+=i*N,i=e[14],R+=i*L,F+=i*ce,q+=i*X,B+=i*ne,z+=i*oe,G+=i*de,Y+=i*pe,P+=i*_e,b+=i*k,w+=i*K,S+=i*$,C+=i*Z,D+=i*I,W+=i*U,j+=i*V,M+=i*N,i=e[15],F+=i*L,q+=i*ce,B+=i*X,z+=i*ne,G+=i*oe,Y+=i*de,P+=i*pe,b+=i*_e,w+=i*k,S+=i*K,C+=i*$,D+=i*Z,W+=i*I,j+=i*U,M+=i*V,_+=i*N,s+=38*q,o+=38*B,a+=38*z,c+=38*G,l+=38*Y,u+=38*P,h+=38*b,d+=38*w,y+=38*S,g+=38*C,m+=38*D,E+=38*W,v+=38*j,A+=38*M,R+=38*_,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),t[0]=s,t[1]=o,t[2]=a,t[3]=c,t[4]=l,t[5]=u,t[6]=h,t[7]=d,t[8]=y,t[9]=g,t[10]=m,t[11]=E,t[12]=v,t[13]=A,t[14]=R,t[15]=F}function am(t,e){yu(t,e,e)}function Lvt(t,e){for(var r=yc(),i=0;i<16;i++)r[i]=e[i];for(var i=253;i>=0;i--)am(r,r),i!==2&&i!==4&&yu(r,r,e);for(var i=0;i<16;i++)t[i]=r[i]}function VO(t,e){for(var r=new Uint8Array(32),i=new Float64Array(80),n=yc(),s=yc(),o=yc(),a=yc(),c=yc(),l=yc(),u=0;u<31;u++)r[u]=t[u];r[31]=t[31]&127|64,r[0]&=248,Mvt(i,e);for(var u=0;u<16;u++)s[u]=i[u];n[0]=a[0]=1;for(var u=254;u>=0;--u){var h=r[u>>>3]>>>(u&7)&1;om(n,s,h),om(o,a,h),S3(c,n,o),x3(n,n,o),S3(o,s,a),x3(s,s,a),am(a,c),am(l,n),yu(n,o,n),yu(o,s,c),S3(c,n,o),x3(n,n,o),am(s,n),x3(o,a,l),yu(n,o,Nvt),S3(n,n,a),yu(o,o,n),yu(n,a,l),yu(a,s,i),am(s,c),om(n,s,h),om(o,a,h)}for(var u=0;u<16;u++)i[u+16]=n[u],i[u+32]=o[u],i[u+48]=s[u],i[u+64]=a[u];var d=i.subarray(32),y=i.subarray(16);Lvt(d,d),yu(y,y,d);var g=new Uint8Array(32);return Dvt(g,y),g}es.scalarMult=VO;function TEe(t){return VO(t,IEe)}es.scalarMultBase=TEe;function REe(t){if(t.length!==es.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+es.SECRET_KEY_LENGTH+" bytes");var e=new Uint8Array(t),r=TEe(e);return{publicKey:r,secretKey:e}}es.generateKeyPairFromSeed=REe;function Uvt(t){var e=qvt.randomBytes(32,t),r=REe(e);return Bvt.wipe(e),r}es.generateKeyPair=Uvt;function Fvt(t,e,r){if(r===void 0&&(r=!1),t.length!==es.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==es.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var i=VO(t,e);if(r){for(var n=0,s=0;s<i.length;s++)n|=i[s];if(n===0)throw new Error("X25519: invalid shared key")}return i}es.sharedKey=Fvt});var CEe=p((W9t,PEe)=>{f();PEe.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var qEe=p((Y9t,kEe)=>{f();"use strict";var Kvt=CEe(),jvt=I0(),OEe=$o();kEe.exports=(t,e={})=>{let r=jvt(t),i=OEe.decode.fromReader(r.reader,e),n=!1,s={read:async o=>{let{value:a,done:c}=await r.reader.next(o);if(c&&a.length<o)throw new Error("Couldn't read enough bytes");if(n=c,!a)throw new Error("Value is null");return a},readLP:async()=>{let{value:o,done:a}=await i.next();if(n=a,!o)throw new Error("Value is null");return o},readPB:async o=>{let a=await s.readLP();if(!a)throw new Error("Value is null");let c=Kvt(a)?a:a.slice();return o.decode(c)},write:o=>{r.writer.push(o)},writeLP:o=>{s.write(OEe.encode.single(o,e))},writePB:(o,a)=>{s.writeLP(a.encode(o))},pb:o=>({read:()=>s.readPB(o),write:a=>s.writePB(a,o)}),unwrap:()=>(r.rest(),r.stream)};return s}});var NEe=p((X9t,BEe)=>{f();"use strict";var Vvt=DE();BEe.exports=function(){let e,r,i=async s=>{if(e)throw new Error("already piped");e=Vvt(s),r&&r(e)},n={[Symbol.asyncIterator](){return this},next(){return e?e.next():new Promise(s=>{r=o=>{r=null,s(o.next())}})}};return{sink:i,source:n}}});var LEe=p((Q9t,MEe)=>{f();var DEe=NEe();MEe.exports=function(){var t=DEe(),e=DEe();return[{source:t.source,sink:e.sink},{source:e.source,sink:t.sink}]}});var UEe=p(zO=>{f();"use strict";Object.defineProperty(zO,"__esModule",{value:!0});function zvt(t){return typeof t.saveState!="undefined"&&typeof t.restoreState!="undefined"&&typeof t.cleanSavedState!="undefined"}zO.isSerializableHash=zvt});var I3=p(oy=>{f();"use strict";Object.defineProperty(oy,"__esModule",{value:!0});function Hvt(t,e,r){return~(t-1)&e|t-1&r}oy.select=Hvt;function $vt(t,e){return(t|0)-(e|0)-1>>>31&1}oy.lessOrEqual=$vt;function FEe(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}oy.compare=FEe;function Gvt(t,e){return t.length===0||e.length===0?!1:FEe(t,e)!==0}oy.equal=Gvt});var jEe=p(cm=>{f();"use strict";Object.defineProperty(cm,"__esModule",{value:!0});var gc=UEe(),Wvt=I3(),Yvt=pc(),KEe=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=54^92;this._outer.update(i),gc.isSerializableHash(this._inner)&&gc.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Yvt.wipe(i)}return t.prototype.reset=function(){if(!gc.isSerializableHash(this._inner)||!gc.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){gc.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),gc.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!gc.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!gc.isSerializableHash(this._inner)||!gc.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!gc.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();cm.HMAC=KEe;function Xvt(t,e,r){var i=new KEe(t,e);i.update(r);var n=i.digest();return i.clean(),n}cm.hmac=Xvt;cm.equal=Wvt.equal});var HEe=p(HO=>{f();"use strict";Object.defineProperty(HO,"__esModule",{value:!0});var VEe=jEe(),zEe=pc(),Qvt=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=VEe.hmac(this._hash,i,r);this._hmac=new VEe.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),zEe.wipe(this._buffer),zEe.wipe(this._counter),this._bufpos=0},t}();HO.HKDF=Qvt});var GO=p(jl=>{f();"use strict";Object.defineProperty(jl,"__esModule",{value:!0});var T3=sm(),R3=pc();jl.DIGEST_LENGTH=32;jl.BLOCK_SIZE=64;var $Ee=function(){function t(){this.digestLength=jl.DIGEST_LENGTH,this.blockSize=jl.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return t.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},t.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},t.prototype.clean=function(){R3.wipe(this._buffer),R3.wipe(this._temp),this.reset()},t.prototype.update=function(e,r){if(r===void 0&&(r=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var i=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&r>0;)this._buffer[this._bufferLength++]=e[i++],r--;this._bufferLength===this.blockSize&&($O(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(i=$O(this._temp,this._state,e,i,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[i++],r--;return this},t.prototype.finish=function(e){if(!this._finished){var r=this._bytesHashed,i=this._bufferLength,n=r/536870912|0,s=r<<3,o=r%64<56?64:128;this._buffer[i]=128;for(var a=i+1;a<o-8;a++)this._buffer[a]=0;T3.writeUint32BE(n,this._buffer,o-8),T3.writeUint32BE(s,this._buffer,o-4),$O(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(var a=0;a<this.digestLength/4;a++)T3.writeUint32BE(this._state[a],e,a*4);return this},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},t.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},t.prototype.cleanSavedState=function(e){R3.wipe(e.state),e.buffer&&R3.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},t}();jl.SHA256=$Ee;var Zvt=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function $O(t,e,r,i,n){for(;n>=64;){for(var s=e[0],o=e[1],a=e[2],c=e[3],l=e[4],u=e[5],h=e[6],d=e[7],y=0;y<16;y++){var g=i+y*4;t[y]=T3.readUint32BE(r,g)}for(var y=16;y<64;y++){var m=t[y-2],E=(m>>>17|m<<32-17)^(m>>>19|m<<32-19)^m>>>10;m=t[y-15];var v=(m>>>7|m<<32-7)^(m>>>18|m<<32-18)^m>>>3;t[y]=(E+t[y-7]|0)+(v+t[y-16]|0)}for(var y=0;y<64;y++){var E=(((l>>>6|l<<32-6)^(l>>>11|l<<32-11)^(l>>>25|l<<32-25))+(l&u^~l&h)|0)+(d+(Zvt[y]+t[y]|0)|0)|0,v=((s>>>2|s<<32-2)^(s>>>13|s<<32-13)^(s>>>22|s<<32-22))+(s&o^s&a^o&a)|0;d=h,h=u,u=l,l=c+E|0,c=a,a=o,o=s,s=E+v|0}e[0]+=s,e[1]+=o,e[2]+=a,e[3]+=c,e[4]+=l,e[5]+=u,e[6]+=h,e[7]+=d,i+=64,n-=64}return i}function Jvt(t){var e=new $Ee;e.update(t);var r=e.digest();return e.clean(),r}jl.hash=Jvt});var WEe=p((GEe,um)=>{f();"use strict";(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof aa=="function"&&typeof um=="object"&&um&&um.exports&&(um.exports=e(Bi()))})(GEe,function(t){"use strict";var e=t.Reader,r=t.Writer,i=t.util,n=t.roots["libp2p-noise"]||(t.roots["libp2p-noise"]={});return n.pb=function(){var s={};return s.NoiseHandshakePayload=function(){function o(a){if(a)for(var c=Object.keys(a),l=0;l<c.length;++l)a[c[l]]!=null&&(this[c[l]]=a[c[l]])}return o.prototype.identityKey=i.newBuffer([]),o.prototype.identitySig=i.newBuffer([]),o.prototype.data=i.newBuffer([]),o.create=function(c){return new o(c)},o.encode=function(c,l){return l||(l=r.create()),c.identityKey!=null&&Object.hasOwnProperty.call(c,"identityKey")&&l.uint32(10).bytes(c.identityKey),c.identitySig!=null&&Object.hasOwnProperty.call(c,"identitySig")&&l.uint32(18).bytes(c.identitySig),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&l.uint32(26).bytes(c.data),l},o.encodeDelimited=function(c,l){return this.encode(c,l).ldelim()},o.decode=function(c,l){c instanceof e||(c=e.create(c));for(var u=l===void 0?c.len:c.pos+l,h=new n.pb.NoiseHandshakePayload;c.pos<u;){var d=c.uint32();switch(d>>>3){case 1:h.identityKey=c.bytes();break;case 2:h.identitySig=c.bytes();break;case 3:h.data=c.bytes();break;default:c.skipType(d&7);break}}return h},o.decodeDelimited=function(c){return c instanceof e||(c=new e(c)),this.decode(c,c.uint32())},o.verify=function(c){return typeof c!="object"||c===null?"object expected":c.identityKey!=null&&c.hasOwnProperty("identityKey")&&!(c.identityKey&&typeof c.identityKey.length=="number"||i.isString(c.identityKey))?"identityKey: buffer expected":c.identitySig!=null&&c.hasOwnProperty("identitySig")&&!(c.identitySig&&typeof c.identitySig.length=="number"||i.isString(c.identitySig))?"identitySig: buffer expected":c.data!=null&&c.hasOwnProperty("data")&&!(c.data&&typeof c.data.length=="number"||i.isString(c.data))?"data: buffer expected":null},o.fromObject=function(c){if(c instanceof n.pb.NoiseHandshakePayload)return c;var l=new n.pb.NoiseHandshakePayload;return c.identityKey!=null&&(typeof c.identityKey=="string"?i.base64.decode(c.identityKey,l.identityKey=i.newBuffer(i.base64.length(c.identityKey)),0):c.identityKey.length&&(l.identityKey=c.identityKey)),c.identitySig!=null&&(typeof c.identitySig=="string"?i.base64.decode(c.identitySig,l.identitySig=i.newBuffer(i.base64.length(c.identitySig)),0):c.identitySig.length&&(l.identitySig=c.identitySig)),c.data!=null&&(typeof c.data=="string"?i.base64.decode(c.data,l.data=i.newBuffer(i.base64.length(c.data)),0):c.data.length&&(l.data=c.data)),l},o.toObject=function(c,l){l||(l={});var u={};return l.defaults&&(l.bytes===String?u.identityKey="":(u.identityKey=[],l.bytes!==Array&&(u.identityKey=i.newBuffer(u.identityKey))),l.bytes===String?u.identitySig="":(u.identitySig=[],l.bytes!==Array&&(u.identitySig=i.newBuffer(u.identitySig))),l.bytes===String?u.data="":(u.data=[],l.bytes!==Array&&(u.data=i.newBuffer(u.data)))),c.identityKey!=null&&c.hasOwnProperty("identityKey")&&(u.identityKey=l.bytes===String?i.base64.encode(c.identityKey,0,c.identityKey.length):l.bytes===Array?Array.prototype.slice.call(c.identityKey):c.identityKey),c.identitySig!=null&&c.hasOwnProperty("identitySig")&&(u.identitySig=l.bytes===String?i.base64.encode(c.identitySig,0,c.identitySig.length):l.bytes===Array?Array.prototype.slice.call(c.identitySig):c.identitySig),c.data!=null&&c.hasOwnProperty("data")&&(u.data=l.bytes===String?i.base64.encode(c.data,0,c.data.length):l.bytes===Array?Array.prototype.slice.call(c.data):c.data),u},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s}(),n})});var Vl=p(zt=>{f();"use strict";var ewt=zt&&zt.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),twt=zt&&zt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),rwt=zt&&zt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ewt(e,t,r);return twt(e,t),e},YEe=zt&&zt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(zt,"__esModule",{value:!0});zt.isValidPublicKey=zt.getHkdf=zt.verifySignedPayload=zt.getHandshakePayload=zt.decodePayload=zt.getPeerIdFromPayload=zt.signPayload=zt.createHandshakePayload=zt.getPayload=zt.generateKeypair=void 0;var iwt=HEe(),nwt=GO(),swt=rwt(A3()),ts=ft(),WO=YEe(et()),owt=Ma(),awt=WEe(),cwt=YEe(yi()),P3=awt.pb.NoiseHandshakePayload;function uwt(){let t=swt.generateKeyPair();return{publicKey:ts.Buffer.from(t.publicKey.buffer,t.publicKey.byteOffset,t.publicKey.length),privateKey:ts.Buffer.from(t.secretKey.buffer,t.secretKey.byteOffset,t.secretKey.length)}}zt.generateKeypair=uwt;async function lwt(t,e,r){let i=await QEe(t,YO(e)),n=r??ts.Buffer.alloc(0);return XEe(t.marshalPubKey(),i,n)}zt.getPayload=lwt;function XEe(t,e,r){let i=P3.create({identityKey:ts.Buffer.from(t),identitySig:e,data:r??null});return ts.Buffer.from(P3.encode(i).finish())}zt.createHandshakePayload=XEe;async function QEe(t,e){return ts.Buffer.from(await t.privKey.sign(e))}zt.signPayload=QEe;async function fwt(t){return await WO.default.createFromPubKey(ts.Buffer.from(t.identityKey))}zt.getPeerIdFromPayload=fwt;function hwt(t){return P3.toObject(P3.decode(ts.Buffer.from(t)))}zt.decodePayload=hwt;function YO(t){return ts.Buffer.concat([ts.Buffer.from("noise-libp2p-static-key:"),t])}zt.getHandshakePayload=YO;async function dwt(t,e){let r=await WO.default.createFromPubKey(e);return cwt.default(r.id,t)}async function pwt(t,e,r){let i=ts.Buffer.from(e.identityKey);if(!await dwt(r.id,i))throw new Error("Peer ID doesn't match libp2p public key.");let n=YO(t),s=owt.keys.unmarshalPublicKey(i);if(!e.identitySig||!s.verify(n,ts.Buffer.from(e.identitySig)))throw new Error("Static key doesn't match to peer that signed payload!");return await WO.default.createFromPubKey(i)}zt.verifySignedPayload=pwt;function ywt(t,e){let i=new iwt.HKDF(nwt.SHA256,e,t).expand(96),n=ts.Buffer.from(i.buffer,i.byteOffset,i.length),s=n.slice(0,32),o=n.slice(32,64),a=n.slice(64,96);return[s,o,a]}zt.getHkdf=ywt;function gwt(t){return!(!ts.Buffer.isBuffer(t)||t.length!==32)}zt.isValidPublicKey=gwt});var JEe=p(C3=>{f();"use strict";Object.defineProperty(C3,"__esModule",{value:!0});var wn=sm(),XO=pc(),bwt=20;function mwt(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],c=r[7]<<24|r[6]<<16|r[5]<<8|r[4],l=r[11]<<24|r[10]<<16|r[9]<<8|r[8],u=r[15]<<24|r[14]<<16|r[13]<<8|r[12],h=r[19]<<24|r[18]<<16|r[17]<<8|r[16],d=r[23]<<24|r[22]<<16|r[21]<<8|r[20],y=r[27]<<24|r[26]<<16|r[25]<<8|r[24],g=r[31]<<24|r[30]<<16|r[29]<<8|r[28],m=e[3]<<24|e[2]<<16|e[1]<<8|e[0],E=e[7]<<24|e[6]<<16|e[5]<<8|e[4],v=e[11]<<24|e[10]<<16|e[9]<<8|e[8],A=e[15]<<24|e[14]<<16|e[13]<<8|e[12],R=i,F=n,q=s,B=o,z=a,G=c,Y=l,P=u,b=h,w=d,S=y,C=g,D=m,W=E,j=v,M=A,_=0;_<bwt;_+=2)R=R+z|0,D^=R,D=D>>>32-16|D<<16,b=b+D|0,z^=b,z=z>>>32-12|z<<12,F=F+G|0,W^=F,W=W>>>32-16|W<<16,w=w+W|0,G^=w,G=G>>>32-12|G<<12,q=q+Y|0,j^=q,j=j>>>32-16|j<<16,S=S+j|0,Y^=S,Y=Y>>>32-12|Y<<12,B=B+P|0,M^=B,M=M>>>32-16|M<<16,C=C+M|0,P^=C,P=P>>>32-12|P<<12,q=q+Y|0,j^=q,j=j>>>32-8|j<<8,S=S+j|0,Y^=S,Y=Y>>>32-7|Y<<7,B=B+P|0,M^=B,M=M>>>32-8|M<<8,C=C+M|0,P^=C,P=P>>>32-7|P<<7,F=F+G|0,W^=F,W=W>>>32-8|W<<8,w=w+W|0,G^=w,G=G>>>32-7|G<<7,R=R+z|0,D^=R,D=D>>>32-8|D<<8,b=b+D|0,z^=b,z=z>>>32-7|z<<7,R=R+G|0,M^=R,M=M>>>32-16|M<<16,S=S+M|0,G^=S,G=G>>>32-12|G<<12,F=F+Y|0,D^=F,D=D>>>32-16|D<<16,C=C+D|0,Y^=C,Y=Y>>>32-12|Y<<12,q=q+P|0,W^=q,W=W>>>32-16|W<<16,b=b+W|0,P^=b,P=P>>>32-12|P<<12,B=B+z|0,j^=B,j=j>>>32-16|j<<16,w=w+j|0,z^=w,z=z>>>32-12|z<<12,q=q+P|0,W^=q,W=W>>>32-8|W<<8,b=b+W|0,P^=b,P=P>>>32-7|P<<7,B=B+z|0,j^=B,j=j>>>32-8|j<<8,w=w+j|0,z^=w,z=z>>>32-7|z<<7,F=F+Y|0,D^=F,D=D>>>32-8|D<<8,C=C+D|0,Y^=C,Y=Y>>>32-7|Y<<7,R=R+G|0,M^=R,M=M>>>32-8|M<<8,S=S+M|0,G^=S,G=G>>>32-7|G<<7;wn.writeUint32LE(R+i|0,t,0),wn.writeUint32LE(F+n|0,t,4),wn.writeUint32LE(q+s|0,t,8),wn.writeUint32LE(B+o|0,t,12),wn.writeUint32LE(z+a|0,t,16),wn.writeUint32LE(G+c|0,t,20),wn.writeUint32LE(Y+l|0,t,24),wn.writeUint32LE(P+u|0,t,28),wn.writeUint32LE(b+h|0,t,32),wn.writeUint32LE(w+d|0,t,36),wn.writeUint32LE(S+y|0,t,40),wn.writeUint32LE(C+g|0,t,44),wn.writeUint32LE(D+m|0,t,48),wn.writeUint32LE(W+E|0,t,52),wn.writeUint32LE(j+v|0,t,56),wn.writeUint32LE(M+A|0,t,60)}function ZEe(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var a=new Uint8Array(64),c=0;c<r.length;c+=64){mwt(a,s,t);for(var l=c;l<c+64&&l<r.length;l++)i[l]=r[l]^a[l-c];wwt(s,0,o)}return XO.wipe(a),n===0&&XO.wipe(s),i}C3.streamXOR=ZEe;function vwt(t,e,r,i){return i===void 0&&(i=0),XO.wipe(r),ZEe(t,e,r,r,i)}C3.stream=vwt;function wwt(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}});var tSe=p(gu=>{f();"use strict";Object.defineProperty(gu,"__esModule",{value:!0});var _wt=I3(),O3=pc();gu.DIGEST_LENGTH=16;var eSe=function(){function t(e){this.digestLength=gu.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=r&8191;var i=e[2]|e[3]<<8;this._r[1]=(r>>>13|i<<3)&8191;var n=e[4]|e[5]<<8;this._r[2]=(i>>>10|n<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(n>>>7|s<<9)&8191;var o=e[8]|e[9]<<8;this._r[4]=(s>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(a>>>11|c<<5)&8065;var l=e[14]|e[15]<<8;this._r[8]=(c>>>8|l<<8)&8191,this._r[9]=l>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return t.prototype._blocks=function(e,r,i){for(var n=this._fin?0:1<<11,s=this._h[0],o=this._h[1],a=this._h[2],c=this._h[3],l=this._h[4],u=this._h[5],h=this._h[6],d=this._h[7],y=this._h[8],g=this._h[9],m=this._r[0],E=this._r[1],v=this._r[2],A=this._r[3],R=this._r[4],F=this._r[5],q=this._r[6],B=this._r[7],z=this._r[8],G=this._r[9];i>=16;){var Y=e[r+0]|e[r+1]<<8;s+=Y&8191;var P=e[r+2]|e[r+3]<<8;o+=(Y>>>13|P<<3)&8191;var b=e[r+4]|e[r+5]<<8;a+=(P>>>10|b<<6)&8191;var w=e[r+6]|e[r+7]<<8;c+=(b>>>7|w<<9)&8191;var S=e[r+8]|e[r+9]<<8;l+=(w>>>4|S<<12)&8191,u+=S>>>1&8191;var C=e[r+10]|e[r+11]<<8;h+=(S>>>14|C<<2)&8191;var D=e[r+12]|e[r+13]<<8;d+=(C>>>11|D<<5)&8191;var W=e[r+14]|e[r+15]<<8;y+=(D>>>8|W<<8)&8191,g+=W>>>5|n;var j=0,M=j;M+=s*m,M+=o*(5*G),M+=a*(5*z),M+=c*(5*B),M+=l*(5*q),j=M>>>13,M&=8191,M+=u*(5*F),M+=h*(5*R),M+=d*(5*A),M+=y*(5*v),M+=g*(5*E),j+=M>>>13,M&=8191;var _=j;_+=s*E,_+=o*m,_+=a*(5*G),_+=c*(5*z),_+=l*(5*B),j=_>>>13,_&=8191,_+=u*(5*q),_+=h*(5*F),_+=d*(5*R),_+=y*(5*A),_+=g*(5*v),j+=_>>>13,_&=8191;var L=j;L+=s*v,L+=o*E,L+=a*m,L+=c*(5*G),L+=l*(5*z),j=L>>>13,L&=8191,L+=u*(5*B),L+=h*(5*q),L+=d*(5*F),L+=y*(5*R),L+=g*(5*A),j+=L>>>13,L&=8191;var ce=j;ce+=s*A,ce+=o*v,ce+=a*E,ce+=c*m,ce+=l*(5*G),j=ce>>>13,ce&=8191,ce+=u*(5*z),ce+=h*(5*B),ce+=d*(5*q),ce+=y*(5*F),ce+=g*(5*R),j+=ce>>>13,ce&=8191;var X=j;X+=s*R,X+=o*A,X+=a*v,X+=c*E,X+=l*m,j=X>>>13,X&=8191,X+=u*(5*G),X+=h*(5*z),X+=d*(5*B),X+=y*(5*q),X+=g*(5*F),j+=X>>>13,X&=8191;var ne=j;ne+=s*F,ne+=o*R,ne+=a*A,ne+=c*v,ne+=l*E,j=ne>>>13,ne&=8191,ne+=u*m,ne+=h*(5*G),ne+=d*(5*z),ne+=y*(5*B),ne+=g*(5*q),j+=ne>>>13,ne&=8191;var oe=j;oe+=s*q,oe+=o*F,oe+=a*R,oe+=c*A,oe+=l*v,j=oe>>>13,oe&=8191,oe+=u*E,oe+=h*m,oe+=d*(5*G),oe+=y*(5*z),oe+=g*(5*B),j+=oe>>>13,oe&=8191;var de=j;de+=s*B,de+=o*q,de+=a*F,de+=c*R,de+=l*A,j=de>>>13,de&=8191,de+=u*v,de+=h*E,de+=d*m,de+=y*(5*G),de+=g*(5*z),j+=de>>>13,de&=8191;var pe=j;pe+=s*z,pe+=o*B,pe+=a*q,pe+=c*F,pe+=l*R,j=pe>>>13,pe&=8191,pe+=u*A,pe+=h*v,pe+=d*E,pe+=y*m,pe+=g*(5*G),j+=pe>>>13,pe&=8191;var _e=j;_e+=s*G,_e+=o*z,_e+=a*B,_e+=c*q,_e+=l*F,j=_e>>>13,_e&=8191,_e+=u*R,_e+=h*A,_e+=d*v,_e+=y*E,_e+=g*m,j+=_e>>>13,_e&=8191,j=(j<<2)+j|0,j=j+M|0,M=j&8191,j=j>>>13,_+=j,s=M,o=_,a=L,c=ce,l=X,u=ne,h=oe,d=de,y=pe,g=_e,r+=16,i-=16}this._h[0]=s,this._h[1]=o,this._h[2]=a,this._h[3]=c,this._h[4]=l,this._h[5]=u,this._h[6]=h,this._h[7]=d,this._h[8]=y,this._h[9]=g},t.prototype.finish=function(e,r){r===void 0&&(r=0);var i=new Uint16Array(10),n,s,o,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=n,n=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=n*5,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,i[0]=this._h[0]+5,n=i[0]>>>13,i[0]&=8191,a=1;a<10;a++)i[a]=this._h[a]+n,n=i[a]>>>13,i[a]&=8191;for(i[9]-=1<<13,s=(n^1)-1,a=0;a<10;a++)i[a]&=s;for(s=~s,a=0;a<10;a++)this._h[a]=this._h[a]&s|i[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,o=this._h[0]+this._pad[0],this._h[0]=o&65535,a=1;a<8;a++)o=(this._h[a]+this._pad[a]|0)+(o>>>16)|0,this._h[a]=o&65535;return e[r+0]=this._h[0]>>>0,e[r+1]=this._h[0]>>>8,e[r+2]=this._h[1]>>>0,e[r+3]=this._h[1]>>>8,e[r+4]=this._h[2]>>>0,e[r+5]=this._h[2]>>>8,e[r+6]=this._h[3]>>>0,e[r+7]=this._h[3]>>>8,e[r+8]=this._h[4]>>>0,e[r+9]=this._h[4]>>>8,e[r+10]=this._h[5]>>>0,e[r+11]=this._h[5]>>>8,e[r+12]=this._h[6]>>>0,e[r+13]=this._h[6]>>>8,e[r+14]=this._h[7]>>>0,e[r+15]=this._h[7]>>>8,this._finished=!0,this},t.prototype.update=function(e){var r=0,i=e.length,n;if(this._leftover){n=16-this._leftover,n>i&&(n=i);for(var s=0;s<n;s++)this._buffer[this._leftover+s]=e[r+s];if(i-=n,r+=n,this._leftover+=n,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(i>=16&&(n=i-i%16,this._blocks(e,r,n),r+=n,i-=n),i){for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[r+s];this._leftover+=i}return this},t.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},t.prototype.clean=function(){return O3.wipe(this._buffer),O3.wipe(this._r),O3.wipe(this._h),O3.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},t}();gu.Poly1305=eSe;function Ewt(t,e){var r=new eSe(t);r.update(e);var i=r.digest();return r.clean(),i}gu.oneTimeAuth=Ewt;function Swt(t,e){return t.length!==gu.DIGEST_LENGTH||e.length!==gu.DIGEST_LENGTH?!1:_wt.equal(t,e)}gu.equal=Swt});var nSe=p(bu=>{f();"use strict";Object.defineProperty(bu,"__esModule",{value:!0});var k3=JEe(),xwt=tSe(),lm=pc(),rSe=sm(),Awt=I3();bu.KEY_LENGTH=32;bu.NONCE_LENGTH=12;bu.TAG_LENGTH=16;var iSe=new Uint8Array(16),Iwt=function(){function t(e){if(this.nonceLength=bu.NONCE_LENGTH,this.tagLength=bu.TAG_LENGTH,e.length!==bu.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return t.prototype.seal=function(e,r,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);k3.stream(this._key,s,o,4);var a=r.length+this.tagLength,c;if(n){if(n.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");c=n}else c=new Uint8Array(a);return k3.streamXOR(this._key,s,r,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),o,c.subarray(0,c.length-this.tagLength),i),lm.wipe(s),c},t.prototype.open=function(e,r,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);k3.stream(this._key,s,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,r.subarray(0,r.length-this.tagLength),i),!Awt.equal(a,r.subarray(r.length-this.tagLength,r.length)))return null;var c=r.length-this.tagLength,l;if(n){if(n.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");l=n}else l=new Uint8Array(c);return k3.streamXOR(this._key,s,r.subarray(0,r.length-this.tagLength),l,4),lm.wipe(s),l},t.prototype.clean=function(){return lm.wipe(this._key),this},t.prototype._authenticate=function(e,r,i,n){var s=new xwt.Poly1305(r);n&&(s.update(n),n.length%16>0&&s.update(iSe.subarray(n.length%16))),s.update(i),i.length%16>0&&s.update(iSe.subarray(i.length%16));var o=new Uint8Array(8);n&&rSe.writeUint64LE(n.length,o),s.update(o),rSe.writeUint64LE(i.length,o),s.update(o);for(var a=s.digest(),c=0;c<a.length;c++)e[c]=a[c];s.clean(),lm.wipe(a),lm.wipe(o)},t}();bu.ChaCha20Poly1305=Iwt});var q3=p(mu=>{f();"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.DUMP_SESSION_KEYS=mu.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=mu.NOISE_MSG_MAX_LENGTH_BYTES=void 0;mu.NOISE_MSG_MAX_LENGTH_BYTES=65535;mu.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=mu.NOISE_MSG_MAX_LENGTH_BYTES-16;mu.DUMP_SESSION_KEYS=process.env.DUMP_SESSION_KEYS});var ay=p(rn=>{f();"use strict";var Twt=rn&&rn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(rn,"__esModule",{value:!0});rn.logCipherState=rn.logRemoteEphemeralKey=rn.logRemoteStaticKey=rn.logLocalEphemeralKeys=rn.logLocalStaticKeys=rn.logger=void 0;var Rwt=Twt(me()),Pwt=q3();rn.logger=Rwt.default("libp2p:noise");var oo;Pwt.DUMP_SESSION_KEYS?oo=rn.logger:oo=()=>{};function Cwt(t){oo(`LOCAL_STATIC_PUBLIC_KEY ${t.publicKey.toString("hex")}`),oo(`LOCAL_STATIC_PRIVATE_KEY ${t.privateKey.toString("hex")}`)}rn.logLocalStaticKeys=Cwt;function Owt(t){t?(oo(`LOCAL_PUBLIC_EPHEMERAL_KEY ${t.publicKey.toString("hex")}`),oo(`LOCAL_PRIVATE_EPHEMERAL_KEY ${t.privateKey.toString("hex")}`)):oo("Missing local ephemeral keys.")}rn.logLocalEphemeralKeys=Owt;function kwt(t){oo(`REMOTE_STATIC_PUBLIC_KEY ${t.toString("hex")}`)}rn.logRemoteStaticKey=kwt;function qwt(t){oo(`REMOTE_EPHEMERAL_PUBLIC_KEY ${t.toString("hex")}`)}rn.logRemoteEphemeralKey=qwt;function Bwt(t){t.cs1&&t.cs2?(oo(`CIPHER_STATE_1 ${t.cs1.n} ${t.cs1.k.toString("hex")}`),oo(`CIPHER_STATE_2 ${t.cs2.n} ${t.cs2.k.toString("hex")}`)):oo("Missing cipher state.")}rn.logCipherState=Bwt});var QO=p(_s=>{f();"use strict";var Nwt=_s&&_s.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Dwt=_s&&_s.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),sSe=_s&&_s.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Nwt(e,t,r);return Dwt(e,t),e};Object.defineProperty(_s,"__esModule",{value:!0});_s.AbstractHandshake=_s.MIN_NONCE=void 0;var nn=ft(),Mwt=sSe(A3()),Lwt=sSe(GO()),oSe=nSe(),aSe=Vl(),Uwt=ay();_s.MIN_NONCE=0;var cSe=class{encryptWithAd(e,r,i){let n=this.encrypt(e.k,e.n,r,i);return this.setNonce(e,this.incrementNonce(e.n)),n}decryptWithAd(e,r,i){let{plaintext:n,valid:s}=this.decrypt(e.k,e.n,r,i);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:n,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,r){e.n=r}createEmptyKey(){return nn.Buffer.alloc(32)}isEmptyKey(e){return this.createEmptyKey().equals(e)}incrementNonce(e){return e+1}nonceToBytes(e){let r=nn.Buffer.alloc(12);return r.writeUInt32LE(e,4),r}encrypt(e,r,i,n){let s=this.nonceToBytes(r),a=new oSe.ChaCha20Poly1305(e).seal(s,n,i);return nn.Buffer.from(a.buffer,a.byteOffset,a.length)}encryptAndHash(e,r){let i;return this.hasKey(e.cs)?i=this.encryptWithAd(e.cs,e.h,r):i=r,this.mixHash(e,i),i}decrypt(e,r,i,n){let s=this.nonceToBytes(r),a=new oSe.ChaCha20Poly1305(e).open(s,n,i);return a?{plaintext:nn.Buffer.from(a.buffer,a.byteOffset,a.length),valid:!0}:{plaintext:nn.Buffer.from(""),valid:!1}}decryptAndHash(e,r){let i,n=!0;return this.hasKey(e.cs)?{plaintext:i,valid:n}=this.decryptWithAd(e.cs,e.h,r):i=r,this.mixHash(e,r),{plaintext:i,valid:n}}dh(e,r){try{let i=Mwt.sharedKey(e,r),n=nn.Buffer.from(i.buffer,i.byteOffset,i.length),s=nn.Buffer.alloc(32);return n.copy(s),s}catch(i){return Uwt.logger(i.message),nn.Buffer.alloc(32)}}mixHash(e,r){e.h=this.getHash(e.h,r)}getHash(e,r){let i=Lwt.hash(nn.Buffer.from([...e,...r]));return nn.Buffer.from(i.buffer,i.byteOffset,i.length)}mixKey(e,r){let[i,n]=aSe.getHkdf(e.ck,r);e.cs=this.initializeKey(n),e.ck=i}initializeKey(e){let r=_s.MIN_NONCE;return{k:e,n:r}}initializeSymmetric(e){let r=nn.Buffer.from(e,"utf-8"),i=this.hashProtocolName(r),n=i,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:n,h:i}}hashProtocolName(e){if(e.length<=32){let r=nn.Buffer.alloc(32);return e.copy(r),r}else return this.getHash(e,nn.Buffer.alloc(0))}split(e){let[r,i]=aSe.getHkdf(e.ck,nn.Buffer.alloc(0)),n=this.initializeKey(r),s=this.initializeKey(i);return{cs1:n,cs2:s}}writeMessageRegular(e,r){let i=this.encryptWithAd(e,nn.Buffer.alloc(0),r),n=this.createEmptyKey(),s=nn.Buffer.alloc(0);return{ne:n,ns:s,ciphertext:i}}readMessageRegular(e,r){return this.decryptWithAd(e,nn.Buffer.alloc(0),r.ciphertext)}};_s.AbstractHandshake=cSe});var lSe=p(B3=>{f();"use strict";Object.defineProperty(B3,"__esModule",{value:!0});B3.XX=void 0;var jh=ft(),cy=Vl(),Fwt=QO(),uSe=class extends Fwt.AbstractHandshake{initializeInitiator(e,r,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=jh.Buffer.alloc(32);return{ss:o,s:r,rs:i,psk:n,re:a}}initializeResponder(e,r,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=jh.Buffer.alloc(32);return{ss:o,s:r,rs:i,psk:n,re:a}}writeMessageA(e,r,i){let n=jh.Buffer.alloc(0);i!==void 0?e.e=i:e.e=cy.generateKeypair();let s=e.e.publicKey;this.mixHash(e.ss,s);let o=this.encryptAndHash(e.ss,r);return{ne:s,ns:n,ciphertext:o}}writeMessageB(e,r){e.e=cy.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let n=jh.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,r);return{ne:i,ns:s,ciphertext:o}}writeMessageC(e,r){let i=jh.Buffer.from(e.s.publicKey),n=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,r),a={ne:this.createEmptyKey(),ns:n,ciphertext:s},{cs1:c,cs2:l}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:l}}readMessageA(e,r){return cy.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,r.ciphertext)}readMessageB(e,r){if(cy.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ns);n&&i.length===32&&cy.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:s,valid:n&&o}}readMessageC(e,r){let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ns);if(n&&i.length===32&&cy.isValidPublicKey(i)&&(e.rs=i),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:n&&o,cs1:a,cs2:c}}initSession(e,r,i){let n=this.createEmptyKey(),s=jh.Buffer.alloc(32),o;return e?o=this.initializeInitiator(r,i,s,n):o=this.initializeResponder(r,i,s,n),{hs:o,i:e,mc:0}}sendMessage(e,r,i){let n;if(e.mc===0)n=this.writeMessageA(e.hs,r,i);else if(e.mc===1)n=this.writeMessageB(e.hs,r);else if(e.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(e.hs,r);n=o,e.h=s,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,r){let i=jh.Buffer.alloc(0),n=!1;if(e.mc===0)({plaintext:i,valid:n}=this.readMessageA(e.hs,r));else if(e.mc===1)({plaintext:i,valid:n}=this.readMessageB(e.hs,r));else if(e.mc===2){let{h:s,plaintext:o,valid:a,cs1:c,cs2:l}=this.readMessageC(e.hs,r);i=o,n=a,e.h=s,e.cs1=c,e.cs2=l}return e.mc++,{plaintext:i,valid:n}}};B3.XX=uSe});var fm=p(vi=>{f();"use strict";Object.defineProperty(vi,"__esModule",{value:!0});vi.decode2=vi.decode1=vi.decode0=vi.encode2=vi.encode1=vi.encode0=vi.uint16BEDecode=vi.uint16BEEncode=void 0;var uy=ft(),Kwt=(t,e,r)=>(e=e||uy.Buffer.allocUnsafe(2),e.writeUInt16BE(t,r),e);vi.uint16BEEncode=Kwt;vi.uint16BEEncode.bytes=2;var jwt=t=>{if(t.length<2)throw RangeError("Could not decode int16BE");return t.readUInt16BE(0)};vi.uint16BEDecode=jwt;vi.uint16BEDecode.bytes=2;function Vwt(t){return uy.Buffer.concat([t.ne,t.ciphertext])}vi.encode0=Vwt;function zwt(t){return uy.Buffer.concat([t.ne,t.ns,t.ciphertext])}vi.encode1=zwt;function Hwt(t){return uy.Buffer.concat([t.ns,t.ciphertext])}vi.encode2=Hwt;function $wt(t){if(t.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:t.slice(0,32),ciphertext:t.slice(32,t.length),ns:uy.Buffer.alloc(0)}}vi.decode0=$wt;function Gwt(t){if(t.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:t.slice(0,32),ns:t.slice(32,80),ciphertext:t.slice(80,t.length)}}vi.decode1=Gwt;function Wwt(t){if(t.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:uy.Buffer.alloc(0),ns:t.slice(0,48),ciphertext:t.slice(48,t.length)}}vi.decode2=Wwt});var ZO=p(N3=>{f();"use strict";Object.defineProperty(N3,"__esModule",{value:!0});N3.XXHandshake=void 0;var hm=ft(),Ywt=lSe(),ly=Vl(),hi=ay(),fy=fm(),fSe=class{constructor(e,r,i,n,s,o,a){this.isInitiator=e,this.payload=r,this.prologue=i,this.staticKeypair=n,this.connection=s,o&&(this.remotePeer=o),this.xx=a??new Ywt.XX,this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=hm.Buffer.alloc(0)}async propose(){if(hi.logLocalStaticKeys(this.session.hs.s),this.isInitiator){hi.logger("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,hm.Buffer.alloc(0));this.connection.writeLP(fy.encode0(e)),hi.logger("Stage 0 - Initiator finished sending first message."),hi.logLocalEphemeralKeys(this.session.hs.e)}else{hi.logger("Stage 0 - Responder waiting to receive first message...");let e=fy.decode0((await this.connection.readLP()).slice()),{valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new Error("xx handshake stage 0 validation fail");hi.logger("Stage 0 - Responder received first message."),hi.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){hi.logger("Stage 1 - Initiator waiting to receive first message from responder...");let e=fy.decode1((await this.connection.readLP()).slice()),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 1 validation fail");hi.logger("Stage 1 - Initiator received the message."),hi.logRemoteEphemeralKey(this.session.hs.re),hi.logRemoteStaticKey(this.session.hs.rs),hi.logger("Initiator going to check remote's signature...");try{let n=await ly.decodePayload(r);this.remotePeer=this.remotePeer||await ly.getPeerIdFromPayload(n),this.remotePeer=await ly.verifySignedPayload(e.ns,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}hi.logger("All good with the signature!")}else{hi.logger("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(fy.encode1(e)),hi.logger("Stage 1 - Responder sent the second handshake message with signed payload."),hi.logLocalEphemeralKeys(this.session.hs.e)}}async finish(){if(this.isInitiator){hi.logger("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(fy.encode2(e)),hi.logger("Stage 2 - Initiator sent message with signed payload.")}else{hi.logger("Stage 2 - Responder waiting for third handshake message...");let e=fy.decode2((await this.connection.readLP()).slice()),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 2 validation fail");hi.logger("Stage 2 - Responder received the message, finished handshake.");try{let n=await ly.decodePayload(r);this.remotePeer=this.remotePeer||await ly.getPeerIdFromPayload(n),await ly.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}}hi.logCipherState(this.session)}encrypt(e,r){let i=this.getCS(r);return this.xx.encryptWithAd(i,hm.Buffer.alloc(0),e)}decrypt(e,r){let i=this.getCS(r,!1);return this.xx.decryptWithAd(i,hm.Buffer.alloc(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=hm.Buffer.from(e.buffer,e.byteOffset,e.length))}};N3.XXHandshake=fSe});var dSe=p(M3=>{f();"use strict";Object.defineProperty(M3,"__esModule",{value:!0});M3.IK=void 0;var D3=ft(),dm=Vl(),Xwt=QO(),hSe=class extends Xwt.AbstractHandshake{initSession(e,r,i,n){let s=this.createEmptyKey(),o;return e?o=this.initializeInitiator(r,i,n,s):o=this.initializeResponder(r,i,n,s),{hs:o,i:e,mc:0}}sendMessage(e,r){let i;if(e.mc===0)i=this.writeMessageA(e.hs,r);else if(e.mc===1){let{messageBuffer:n,h:s,cs1:o,cs2:a}=this.writeMessageB(e.hs,r);i=n,e.h=s,e.cs1=o,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,r){let i=D3.Buffer.alloc(0),n=!1;if(e.mc===0&&({plaintext:i,valid:n}=this.readMessageA(e.hs,r)),e.mc===1){let{plaintext:s,valid:o,h:a,cs1:c,cs2:l}=this.readMessageB(e.hs,r);i=s,n=o,e.h=a,e.cs1=c,e.cs2=l}return e.mc++,{plaintext:i,valid:n}}writeMessageA(e,r){e.e=dm.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=D3.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let o=this.encryptAndHash(e.ss,r);return{ne:i,ns:s,ciphertext:o}}writeMessageB(e,r){e.e=dm.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=this.encryptAndHash(e.ss,r),s=this.createEmptyKey(),o={ne:i,ns:s,ciphertext:n},{cs1:a,cs2:c}=this.split(e.ss);return{messageBuffer:o,cs1:a,cs2:c,h:e.ss.h}}readMessageA(e,r){dm.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ns);n&&i.length===32&&dm.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:s,valid:n&&o}}readMessageB(e,r){if(dm.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:s,cs2:o}=this.split(e.ss);return{h:e.ss.h,valid:n,plaintext:i,cs1:s,cs2:o}}initializeInitiator(e,r,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,i);let a=D3.Buffer.alloc(32);return{ss:o,s:r,rs:i,re:a,psk:n}}initializeResponder(e,r,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,r.publicKey);let a=D3.Buffer.alloc(32);return{ss:o,s:r,rs:i,re:a,psk:n}}};M3.IK=hSe});var ySe=p(L3=>{f();"use strict";Object.defineProperty(L3,"__esModule",{value:!0});L3.FailedIKError=void 0;var pSe=class extends Error{constructor(e,r){super(r);this.initialMsg=e,this.name="FailedIKhandshake"}};L3.FailedIKError=pSe});var mSe=p(F3=>{f();"use strict";Object.defineProperty(F3,"__esModule",{value:!0});F3.IKHandshake=void 0;var Qwt=dSe(),hy=ft(),U3=fm(),dy=Vl(),gSe=ySe(),Pi=ay(),bSe=class{constructor(e,r,i,n,s,o,a,c){this.isInitiator=e,this.payload=hy.Buffer.from(r),this.prologue=i,this.staticKeypair=n,this.connection=s,a&&(this.remotePeer=a),this.ik=c??new Qwt.IK,this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,o),this.remoteEarlyData=hy.Buffer.alloc(0)}async stage0(){if(Pi.logLocalStaticKeys(this.session.hs.s),Pi.logRemoteStaticKey(this.session.hs.rs),this.isInitiator){Pi.logger("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(U3.encode1(e)),Pi.logger("IK Stage 0 - Initiator sent message."),Pi.logLocalEphemeralKeys(this.session.hs.e)}else{Pi.logger("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let r=U3.decode1(e.slice()),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,r);if(!n)throw new Error("ik handshake stage 0 decryption validation fail");Pi.logger("IK Stage 0 - Responder got message, going to verify payload.");let s=await dy.decodePayload(i);this.remotePeer=this.remotePeer||await dy.getPeerIdFromPayload(s),await dy.verifySignedPayload(this.session.hs.rs,s,this.remotePeer),this.setRemoteEarlyData(s.data),Pi.logger("IK Stage 0 - Responder successfully verified payload!"),Pi.logRemoteEphemeralKey(this.session.hs.re)}catch(r){let i=r;throw Pi.logger("Responder breaking up with IK handshake in stage 0."),new gSe.FailedIKError(e,`Error occurred while verifying initiator's signed payload: ${i.message}`)}}}async stage1(){if(this.isInitiator){Pi.logger("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),r=U3.decode0(hy.Buffer.from(e)),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,r);Pi.logger("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!n)throw new Error("ik stage 1 decryption validation fail");let s=await dy.decodePayload(i);this.remotePeer=this.remotePeer||await dy.getPeerIdFromPayload(s),await dy.verifySignedPayload(r.ns.slice(0,32),s,this.remotePeer),this.setRemoteEarlyData(s.data),Pi.logger("IK Stage 1 - Initiator successfully verified payload!"),Pi.logRemoteEphemeralKey(this.session.hs.re)}catch(s){let o=s;throw Pi.logger("Initiator breaking up with IK handshake in stage 1."),new gSe.FailedIKError(e,`Error occurred while verifying responder's signed payload: ${o.message}`)}}else{Pi.logger("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(U3.encode0(e)),Pi.logger("IK Stage 1 - Responder sent message..."),Pi.logLocalEphemeralKeys(this.session.hs.e)}Pi.logCipherState(this.session)}decrypt(e,r){let i=this.getCS(r,!1);return this.ik.decryptWithAd(i,hy.Buffer.alloc(0),e)}encrypt(e,r){let i=this.getCS(r);return this.ik.encryptWithAd(i,hy.Buffer.alloc(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=hy.Buffer.from(e.buffer,e.byteOffset,e.length))}};F3.IKHandshake=bSe});var _Se=p(K3=>{f();"use strict";Object.defineProperty(K3,"__esModule",{value:!0});K3.XXFallbackHandshake=void 0;var JO=ft(),Zwt=ZO(),ek=Vl(),ao=ay(),vSe=fm(),wSe=class extends Zwt.XXHandshake{constructor(e,r,i,n,s,o,a,c,l){super(e,r,i,n,s,a,l);c&&(this.ephemeralKeys=c),this.initialMsg=o}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,JO.Buffer.alloc(0),this.ephemeralKeys),ao.logger("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),ao.logLocalEphemeralKeys(this.session.hs.e);else{ao.logger("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=vSe.decode0(this.initialMsg),{valid:r}=this.xx.recvMessage(this.session,{ne:e.ne,ns:JO.Buffer.alloc(0),ciphertext:JO.Buffer.alloc(0)});if(!r)throw new Error("xx fallback stage 0 decryption validation fail");ao.logger("XX Fallback Stage 0 - Responder used received message from IK."),ao.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=vSe.decode1(this.initialMsg),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx fallback stage 1 decryption validation fail");ao.logger("XX Fallback Stage 1 - Initiator used received message from IK."),ao.logRemoteEphemeralKey(this.session.hs.re),ao.logRemoteStaticKey(this.session.hs.rs),ao.logger("Initiator going to check remote's signature...");try{let n=await ek.decodePayload(r);this.remotePeer=this.remotePeer||await ek.getPeerIdFromPayload(n),await ek.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload from responder: ${s.message}`)}ao.logger("All good with the signature!")}else ao.logger("XX Fallback Stage 1 - Responder start"),await super.exchange(),ao.logger("XX Fallback Stage 1 - Responder end")}};K3.XXFallbackHandshake=wSe});var SSe=p(py=>{f();"use strict";Object.defineProperty(py,"__esModule",{value:!0});py.decryptStream=py.encryptStream=void 0;var ESe=ft(),j3=q3();function Jwt(t){return async function*(e){for await(let r of e){let i=ESe.Buffer.from(r.buffer,r.byteOffset,r.length);for(let n=0;n<i.length;n+=j3.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let s=n+j3.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;s>i.length&&(s=i.length),yield t.encrypt(i.slice(n,s),t.session)}}}}py.encryptStream=Jwt;function e_t(t){return async function*(e){for await(let r of e){let i=ESe.Buffer.from(r.buffer,r.byteOffset,r.length);for(let n=0;n<i.length;n+=j3.NOISE_MSG_MAX_LENGTH_BYTES){let s=n+j3.NOISE_MSG_MAX_LENGTH_BYTES;s>i.length&&(s=i.length);let o=i.slice(n,s),{plaintext:a,valid:c}=await t.decrypt(o,t.session);if(!c)throw new Error("Failed to validate decrypted chunk");yield a}}}}py.decryptStream=e_t});var ASe=p(V3=>{f();"use strict";Object.defineProperty(V3,"__esModule",{value:!0});V3.KeyCache=void 0;var xSe=class{constructor(){this.storage=new Map}store(e,r){this.storage.set(e.id,r)}load(e){var r;return e&&(r=this.storage.get(e.id))!==null&&r!==void 0?r:null}resetStorage(){this.storage.clear()}},t_t=new xSe;V3.KeyCache=t_t});var rk=p(co=>{f();"use strict";var r_t=co&&co.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),i_t=co&&co.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n_t=co&&co.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&r_t(e,t,r);return i_t(e,t),e},z3=co&&co.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(co,"__esModule",{value:!0});co.Noise=void 0;var s_t=n_t(A3()),pm=ft(),ISe=z3(qEe()),o_t=z3(LEe()),TSe=z3(PS()),a_t=z3(Pr()),RSe=$o(),c_t=ZO(),u_t=mSe(),l_t=_Se(),PSe=Vl(),yy=fm(),CSe=SSe(),tk=ASe(),f_t=ay(),OSe=q3(),kSe=class{constructor(e,r){if(this.protocol="/noise",this.prologue=pm.Buffer.alloc(0),this.earlyData=r??pm.Buffer.alloc(0),this.useNoisePipes=!1,e){let i=s_t.generateKeyPairFromSeed(e);this.staticKeys={privateKey:pm.Buffer.from(i.secretKey.buffer,i.secretKey.byteOffset,i.secretKey.length),publicKey:pm.Buffer.from(i.publicKey.buffer,i.publicKey.byteOffset,i.publicKey.length)}}else this.staticKeys=PSe.generateKeypair()}async secureOutbound(e,r,i){let n=ISe.default(r,{lengthEncoder:yy.uint16BEEncode,lengthDecoder:yy.uint16BEDecode,maxDataLength:OSe.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async secureInbound(e,r,i){let n=ISe.default(r,{lengthEncoder:yy.uint16BEEncode,lengthDecoder:yy.uint16BEDecode,maxDataLength:OSe.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async performHandshake(e){var r;let i=await PSe.getPayload(e.localPeer,this.staticKeys.publicKey,this.earlyData),n=this.useNoisePipes;if(e.isInitiator&&tk.KeyCache.load(e.remotePeer)===null&&(n=!1),n){let{remotePeer:s,connection:o,isInitiator:a}=e,c=new u_t.IKHandshake(a,i,this.prologue,this.staticKeys,o,(r=tk.KeyCache.load(e.remotePeer))!==null&&r!==void 0?r:pm.Buffer.alloc(32),s);try{return await this.performIKHandshake(c)}catch(l){let u;return e.isInitiator&&(u=c.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,i,l.initialMsg,u)}}else return await this.performXXHandshake(e,i)}async performXXFallbackHandshake(e,r,i,n){let{isInitiator:s,remotePeer:o,connection:a}=e,c=new l_t.XXFallbackHandshake(s,r,this.prologue,this.staticKeys,a,i,o,n);try{await c.propose(),await c.exchange(),await c.finish()}catch(l){f_t.logger(l);let u=l;throw new Error(`Error occurred during XX Fallback handshake: ${u.message}`)}return c}async performXXHandshake(e,r){let{isInitiator:i,remotePeer:n,connection:s}=e,o=new c_t.XXHandshake(i,r,this.prologue,this.staticKeys,s,n);try{await o.propose(),await o.exchange(),await o.finish(),this.useNoisePipes&&o.remotePeer&&tk.KeyCache.store(o.remotePeer,o.getRemoteStaticKey())}catch(a){let c=a;throw new Error(`Error occurred during XX handshake: ${c.message}`)}return o}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,r){let[i,n]=o_t.default(),s=e.unwrap();return await a_t.default(i,TSe.default,CSe.encryptStream(r),RSe.encode({lengthEncoder:yy.uint16BEEncode}),s,RSe.decode({lengthDecoder:yy.uint16BEDecode}),TSe.default,CSe.decryptStream(r),i),n}};co.Noise=kSe});var qSe=p(vu=>{f();"use strict";var h_t=vu&&vu.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),d_t=vu&&vu.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&h_t(e,t,r)};Object.defineProperty(vu,"__esModule",{value:!0});vu.NOISE=void 0;var p_t=rk();d_t(rk(),vu);vu.NOISE=new p_t.Noise});var DSe=p((_Ut,NSe)=>{f();"use strict";var y_t=zC(),{EventEmitter:g_t}=vr();function BSe(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0,i=t.length;r<i;++r)if(t[r]!==e[r])return!1;return!0}function ik(){return{contacts:[],dontSplit:!1,left:null,right:null}}function ym(t,e){if(!(e instanceof Uint8Array))throw new TypeError(t+" is not a Uint8Array")}var gm=class extends g_t{constructor(e={}){super();this.localNodeId=e.localNodeId||y_t(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||gm.distance,this.arbiter=e.arbiter||gm.arbiter,this.metadata=Object.assign({},e.metadata),ym("option.localNodeId as parameter 1",this.localNodeId),this.root=ik()}static arbiter(e,r){return e.vectorClock>r.vectorClock?e:r}static distance(e,r){let i=0,n=0,s=Math.min(e.length,r.length),o=Math.max(e.length,r.length);for(;n<s;++n)i=i*256+(e[n]^r[n]);for(;n<o;++n)i=i*256+255;return i}add(e){ym("contact.id",(e||{}).id);let r=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e.id,r++);let n=this._indexOf(i,e.id);return n>=0?(this._update(i,n,e),this):i.contacts.length<this.numberOfNodesPerKBucket?(i.contacts.push(e),this.emit("added",e),this):i.dontSplit?(this.emit("ping",i.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(i,r),this.add(e))}closest(e,r=1/0){if(ym("id",e),!Number.isInteger(r)&&r!==1/0||r<=0)throw new TypeError("n is not positive number");let i=[];for(let n=[this.root],s=0;n.length>0&&i.length<r;){let o=n.pop();if(o.contacts===null){let a=this._determineNode(o,e,s++);n.push(o.left===a?o.right:o.left),n.push(a)}else i=i.concat(o.contacts)}return i.map(n=>[this.distance(n.id,e),n]).sort((n,s)=>n[0]-s[0]).slice(0,r).map(n=>n[1])}count(){let e=0;for(let r=[this.root];r.length>0;){let i=r.pop();i.contacts===null?r.push(i.right,i.left):e+=i.contacts.length}return e}_determineNode(e,r,i){let n=i>>3,s=i%8;return r.length<=n&&s!==0?e.left:r[n]&1<<7-s?e.right:e.left}get(e){ym("id",e);let r=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,r++);let n=this._indexOf(i,e);return n>=0?i.contacts[n]:null}_indexOf(e,r){for(let i=0;i<e.contacts.length;++i)if(BSe(e.contacts[i].id,r))return i;return-1}remove(e){ym("the id as parameter 1",e);let r=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,r++);let n=this._indexOf(i,e);if(n>=0){let s=i.contacts.splice(n,1)[0];this.emit("removed",s)}return this}_split(e,r){e.left=ik(),e.right=ik();for(let s of e.contacts)this._determineNode(e,s.id,r).contacts.push(s);e.contacts=null;let i=this._determineNode(e,this.localNodeId,r),n=e.left===i?e.right:e.left;n.dontSplit=!0}toArray(){let e=[];for(let r=[this.root];r.length>0;){let i=r.pop();i.contacts===null?r.push(i.right,i.left):e=e.concat(i.contacts)}return e}*toIterable(){for(let e=[this.root];e.length>0;){let r=e.pop();r.contacts===null?e.push(r.right,r.left):yield*r.contacts}}_update(e,r,i){if(!BSe(e.contacts[r].id,i.id))throw new Error("wrong index for _update");let n=e.contacts[r],s=this.arbiter(n,i);s===n&&n!==i||(e.contacts.splice(r,1),e.contacts.push(s),this.emit("updated",n,s))}};NSe.exports=gm});var H3=p((EUt,MSe)=>{f();MSe.exports=zl;function zl(t,e){if(t.length!==e.length)throw new Error("Inputs should have the same length");for(var r=Buffer.allocUnsafe(t.length),i=0;i<t.length;i++)r[i]=t[i]^e[i];return r}zl.compare=function(e,r){if(e.length!==r.length)throw new Error("Inputs should have the same length");for(var i=0;i<e.length;i++)if(e[i]!==r[i])return e[i]<r[i]?-1:1;return 0};zl.gt=function(e,r){return zl.compare(e,r)===1};zl.lt=function(e,r){return zl.compare(e,r)===-1};zl.eq=function(e,r){return zl.compare(e,r)===0}});var $3=p((SUt,LSe)=>{f();"use strict";var b_t=BP();LSe.exports=async(t,e,{concurrency:r=1/0,stopOnError:i=!0}={})=>new Promise((n,s)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(r)||r===1/0)&&r>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${r}\` (${typeof r})`);let o=[],a=[],c=t[Symbol.iterator](),l=!1,u=!1,h=0,d=0,y=()=>{if(l)return;let g=c.next(),m=d;if(d++,g.done){u=!0,h===0&&(!i&&a.length!==0?s(new b_t(a)):n(o));return}h++,(async()=>{try{let E=await g.value;o[m]=await e(E,m),h--,y()}catch(E){i?(l=!0,s(E)):(a.push(E),h--,y())}})()};for(let g=0;g<r&&(y(),!u);g++);})});var gy=p((xUt,G3)=>{f();"use strict";var nk=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},USe=(t,e,r,i)=>{let n,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){o(t);return}i={customTimers:{setTimeout,clearTimeout},...i},n=i.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{o(r())}catch(u){a(u)}return}let c=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,l=r instanceof Error?r:new nk(c);typeof t.cancel=="function"&&t.cancel(),a(l)},e),(async()=>{try{o(await t)}catch(c){a(c)}finally{i.customTimers.clearTimeout.call(void 0,n)}})()});return s.clear=()=>{clearTimeout(n),n=void 0},s};G3.exports=USe;G3.exports.default=USe;G3.exports.TimeoutError=nk});var pi=p(di=>{f();"use strict";var sk=me(),{sha256:FSe}=(ai(),$r),{base58btc:m_t}=(si(),ni),{Key:v_t}=Ft(),KSe=H3(),w_t=$3(),{Record:__t}=Mf(),E_t=et(),S_t=ae(),x_t=un(),jSe=ct(),VSe=Je(),zSe=gy();di.convertBuffer=async t=>(await FSe.digest(t)).digest;di.convertPeerId=async t=>(await FSe.digest(t.id)).digest;di.bufferToKey=t=>new v_t("/"+di.encodeBase32(t),!1);di.keyForPublicKey=t=>x_t([jSe("/pk/"),t.id]);di.isPublicKeyKey=t=>VSe(t.slice(0,4))==="/pk/";di.fromPublicKeyKey=t=>new E_t(t.slice(4));di.now=()=>Date.now();di.encodeBase32=t=>VSe(t,"base32");di.decodeBase32=t=>jSe(t,"base32");di.sortClosestPeers=async(t,e)=>(await w_t(t,async i=>{let n=await di.convertPeerId(i);return{peer:i,distance:KSe(n,e)}})).sort(di.xorCompare).map(i=>i.peer);di.xorCompare=(t,e)=>KSe.compare(t.distance,e.distance);di.pathSize=(t,e)=>Math.ceil(t/e);di.createPutRecord=(t,e)=>{let r=new Date;return new __t(t,e,r).serialize()};di.logger=(t,e)=>{let r=["libp2p","dht"];return e&&r.push(e),t&&r.push(`${t.toB58String().slice(0,8)}`),sk.formatters.b=n=>m_t.baseEncode(n),Object.assign(sk(r.join(":")),{error:sk(r.concat(["error"]).join(":"))})};di.TimeoutError=class extends Error{get code(){return"ETIMEDOUT"}};di.withTimeout=(t,e)=>{async function r(...i){if(!e)return t(...i);let n;try{n=await zSe(t(...i),e)}catch(s){throw s instanceof zSe.TimeoutError?S_t(s,"ETIMEDOUT"):s}return n}return r};di.mapParallel=async function(t,e){let r=[];for await(let i of t)r.push(e(i));return Promise.all(r)}});var GSe=p((TUt,$Se)=>{f();"use strict";var A_t=DSe(),W3=pi(),HSe=class{constructor(e,r){this.self=e,this._onPing=this._onPing.bind(this),this._onInit(r)}async _onInit(e){let r=await W3.convertPeerId(this.self);this.kb=new A_t({localNodeId:r,numberOfNodesPerKBucket:e,numberOfNodesToPing:1}),this.kb.on("ping",this._onPing)}_onPing(e,r){let i=e[0];i&&this.kb.remove(i.id),this.kb.add(r)}get size(){return this.kb.count()}async find(e){let r=await W3.convertPeerId(e),i=this.closestPeer(r);if(i&&e.equals(i))return i}closestPeer(e){let r=this.closestPeers(e,1);if(r.length>0)return r[0]}closestPeers(e,r){return this.kb.closest(e,r).map(n=>n.peer)}async add(e){let r=await W3.convertPeerId(e);this.kb.add({id:r,peer:e})}async remove(e){let r=await W3.convertPeerId(e);this.kb.remove(r)}};$Se.exports=HSe});var Hl=p(Mn=>{f();"use strict";var Y3=Mn.second=1e3,WSe=Mn.minute=60*Y3,ok=Mn.hour=60*WSe;Mn.MAX_RECORD_AGE=36*ok;Mn.PROTOCOL_DHT="/kad/1.0.0";Mn.PROVIDERS_KEY_PREFIX="/providers/";Mn.PROVIDERS_LRU_CACHE_SIZE=256;Mn.PROVIDERS_VALIDITY=24*ok;Mn.PROVIDERS_CLEANUP_INTERVAL=ok;Mn.READ_MESSAGE_TIMEOUT=10*Y3;Mn.GET_MANY_RECORD_COUNT=16;Mn.K=20;Mn.ALPHA=3;Mn.defaultRandomWalk={enabled:!0,queriesPerPeriod:1,interval:5*WSe,timeout:10*Y3,delay:10*Y3}});var XSe=p((PUt,YSe)=>{f();"use strict";var $l=Bi(),by=$l.Reader,ak=$l.Writer,$e=$l.util,ti=$l.roots["libp2p-dht-message"]||($l.roots["libp2p-dht-message"]={});ti.Record=function(){function t(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}t.prototype.key=null,t.prototype.value=null,t.prototype.author=null,t.prototype.signature=null,t.prototype.timeReceived=null;var e;return Object.defineProperty(t.prototype,"_key",{get:$e.oneOfGetter(e=["key"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_value",{get:$e.oneOfGetter(e=["value"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_author",{get:$e.oneOfGetter(e=["author"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_signature",{get:$e.oneOfGetter(e=["signature"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_timeReceived",{get:$e.oneOfGetter(e=["timeReceived"]),set:$e.oneOfSetter(e)}),t.encode=function(i,n){return n||(n=ak.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(10).bytes(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&n.uint32(18).bytes(i.value),i.author!=null&&Object.hasOwnProperty.call(i,"author")&&n.uint32(26).bytes(i.author),i.signature!=null&&Object.hasOwnProperty.call(i,"signature")&&n.uint32(34).bytes(i.signature),i.timeReceived!=null&&Object.hasOwnProperty.call(i,"timeReceived")&&n.uint32(42).string(i.timeReceived),n},t.decode=function(i,n){i instanceof by||(i=by.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new ti.Record;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.key=i.bytes();break;case 2:o.value=i.bytes();break;case 3:o.author=i.bytes();break;case 4:o.signature=i.bytes();break;case 5:o.timeReceived=i.string();break;default:i.skipType(a&7);break}}return o},t.fromObject=function(i){if(i instanceof ti.Record)return i;var n=new ti.Record;return i.key!=null&&(typeof i.key=="string"?$e.base64.decode(i.key,n.key=$e.newBuffer($e.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.value!=null&&(typeof i.value=="string"?$e.base64.decode(i.value,n.value=$e.newBuffer($e.base64.length(i.value)),0):i.value.length&&(n.value=i.value)),i.author!=null&&(typeof i.author=="string"?$e.base64.decode(i.author,n.author=$e.newBuffer($e.base64.length(i.author)),0):i.author.length&&(n.author=i.author)),i.signature!=null&&(typeof i.signature=="string"?$e.base64.decode(i.signature,n.signature=$e.newBuffer($e.base64.length(i.signature)),0):i.signature.length&&(n.signature=i.signature)),i.timeReceived!=null&&(n.timeReceived=String(i.timeReceived)),n},t.toObject=function(i,n){n||(n={});var s={};return i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?$e.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.value!=null&&i.hasOwnProperty("value")&&(s.value=n.bytes===String?$e.base64.encode(i.value,0,i.value.length):n.bytes===Array?Array.prototype.slice.call(i.value):i.value,n.oneofs&&(s._value="value")),i.author!=null&&i.hasOwnProperty("author")&&(s.author=n.bytes===String?$e.base64.encode(i.author,0,i.author.length):n.bytes===Array?Array.prototype.slice.call(i.author):i.author,n.oneofs&&(s._author="author")),i.signature!=null&&i.hasOwnProperty("signature")&&(s.signature=n.bytes===String?$e.base64.encode(i.signature,0,i.signature.length):n.bytes===Array?Array.prototype.slice.call(i.signature):i.signature,n.oneofs&&(s._signature="signature")),i.timeReceived!=null&&i.hasOwnProperty("timeReceived")&&(s.timeReceived=i.timeReceived,n.oneofs&&(s._timeReceived="timeReceived")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,$l.util.toJSONOptions)},t}();ti.Message=function(){function t(r){if(this.closerPeers=[],this.providerPeers=[],r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}t.prototype.type=null,t.prototype.clusterLevelRaw=null,t.prototype.key=null,t.prototype.record=null,t.prototype.closerPeers=$e.emptyArray,t.prototype.providerPeers=$e.emptyArray;var e;return Object.defineProperty(t.prototype,"_type",{get:$e.oneOfGetter(e=["type"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_clusterLevelRaw",{get:$e.oneOfGetter(e=["clusterLevelRaw"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_key",{get:$e.oneOfGetter(e=["key"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_record",{get:$e.oneOfGetter(e=["record"]),set:$e.oneOfSetter(e)}),t.encode=function(i,n){if(n||(n=ak.create()),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(8).int32(i.type),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(18).bytes(i.key),i.record!=null&&Object.hasOwnProperty.call(i,"record")&&n.uint32(26).bytes(i.record),i.closerPeers!=null&&i.closerPeers.length)for(var s=0;s<i.closerPeers.length;++s)ti.Message.Peer.encode(i.closerPeers[s],n.uint32(66).fork()).ldelim();if(i.providerPeers!=null&&i.providerPeers.length)for(var s=0;s<i.providerPeers.length;++s)ti.Message.Peer.encode(i.providerPeers[s],n.uint32(74).fork()).ldelim();return i.clusterLevelRaw!=null&&Object.hasOwnProperty.call(i,"clusterLevelRaw")&&n.uint32(80).int32(i.clusterLevelRaw),n},t.decode=function(i,n){i instanceof by||(i=by.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new ti.Message;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.type=i.int32();break;case 10:o.clusterLevelRaw=i.int32();break;case 2:o.key=i.bytes();break;case 3:o.record=i.bytes();break;case 8:o.closerPeers&&o.closerPeers.length||(o.closerPeers=[]),o.closerPeers.push(ti.Message.Peer.decode(i,i.uint32()));break;case 9:o.providerPeers&&o.providerPeers.length||(o.providerPeers=[]),o.providerPeers.push(ti.Message.Peer.decode(i,i.uint32()));break;default:i.skipType(a&7);break}}return o},t.fromObject=function(i){if(i instanceof ti.Message)return i;var n=new ti.Message;switch(i.type){case"PUT_VALUE":case 0:n.type=0;break;case"GET_VALUE":case 1:n.type=1;break;case"ADD_PROVIDER":case 2:n.type=2;break;case"GET_PROVIDERS":case 3:n.type=3;break;case"FIND_NODE":case 4:n.type=4;break;case"PING":case 5:n.type=5;break}if(i.clusterLevelRaw!=null&&(n.clusterLevelRaw=i.clusterLevelRaw|0),i.key!=null&&(typeof i.key=="string"?$e.base64.decode(i.key,n.key=$e.newBuffer($e.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.record!=null&&(typeof i.record=="string"?$e.base64.decode(i.record,n.record=$e.newBuffer($e.base64.length(i.record)),0):i.record.length&&(n.record=i.record)),i.closerPeers){if(!Array.isArray(i.closerPeers))throw TypeError(".Message.closerPeers: array expected");n.closerPeers=[];for(var s=0;s<i.closerPeers.length;++s){if(typeof i.closerPeers[s]!="object")throw TypeError(".Message.closerPeers: object expected");n.closerPeers[s]=ti.Message.Peer.fromObject(i.closerPeers[s])}}if(i.providerPeers){if(!Array.isArray(i.providerPeers))throw TypeError(".Message.providerPeers: array expected");n.providerPeers=[];for(var s=0;s<i.providerPeers.length;++s){if(typeof i.providerPeers[s]!="object")throw TypeError(".Message.providerPeers: object expected");n.providerPeers[s]=ti.Message.Peer.fromObject(i.providerPeers[s])}}return n},t.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.closerPeers=[],s.providerPeers=[]),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?ti.Message.MessageType[i.type]:i.type,n.oneofs&&(s._type="type")),i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?$e.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.record!=null&&i.hasOwnProperty("record")&&(s.record=n.bytes===String?$e.base64.encode(i.record,0,i.record.length):n.bytes===Array?Array.prototype.slice.call(i.record):i.record,n.oneofs&&(s._record="record")),i.closerPeers&&i.closerPeers.length){s.closerPeers=[];for(var o=0;o<i.closerPeers.length;++o)s.closerPeers[o]=ti.Message.Peer.toObject(i.closerPeers[o],n)}if(i.providerPeers&&i.providerPeers.length){s.providerPeers=[];for(var o=0;o<i.providerPeers.length;++o)s.providerPeers[o]=ti.Message.Peer.toObject(i.providerPeers[o],n)}return i.clusterLevelRaw!=null&&i.hasOwnProperty("clusterLevelRaw")&&(s.clusterLevelRaw=i.clusterLevelRaw,n.oneofs&&(s._clusterLevelRaw="clusterLevelRaw")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,$l.util.toJSONOptions)},t.MessageType=function(){var r={},i=Object.create(r);return i[r[0]="PUT_VALUE"]=0,i[r[1]="GET_VALUE"]=1,i[r[2]="ADD_PROVIDER"]=2,i[r[3]="GET_PROVIDERS"]=3,i[r[4]="FIND_NODE"]=4,i[r[5]="PING"]=5,i}(),t.ConnectionType=function(){var r={},i=Object.create(r);return i[r[0]="NOT_CONNECTED"]=0,i[r[1]="CONNECTED"]=1,i[r[2]="CAN_CONNECT"]=2,i[r[3]="CANNOT_CONNECT"]=3,i}(),t.Peer=function(){function r(n){if(this.addrs=[],n)for(var s=Object.keys(n),o=0;o<s.length;++o)n[s[o]]!=null&&(this[s[o]]=n[s[o]])}r.prototype.id=null,r.prototype.addrs=$e.emptyArray,r.prototype.connection=null;var i;return Object.defineProperty(r.prototype,"_id",{get:$e.oneOfGetter(i=["id"]),set:$e.oneOfSetter(i)}),Object.defineProperty(r.prototype,"_connection",{get:$e.oneOfGetter(i=["connection"]),set:$e.oneOfSetter(i)}),r.encode=function(s,o){if(o||(o=ak.create()),s.id!=null&&Object.hasOwnProperty.call(s,"id")&&o.uint32(10).bytes(s.id),s.addrs!=null&&s.addrs.length)for(var a=0;a<s.addrs.length;++a)o.uint32(18).bytes(s.addrs[a]);return s.connection!=null&&Object.hasOwnProperty.call(s,"connection")&&o.uint32(24).int32(s.connection),o},r.decode=function(s,o){s instanceof by||(s=by.create(s));for(var a=o===void 0?s.len:s.pos+o,c=new ti.Message.Peer;s.pos<a;){var l=s.uint32();switch(l>>>3){case 1:c.id=s.bytes();break;case 2:c.addrs&&c.addrs.length||(c.addrs=[]),c.addrs.push(s.bytes());break;case 3:c.connection=s.int32();break;default:s.skipType(l&7);break}}return c},r.fromObject=function(s){if(s instanceof ti.Message.Peer)return s;var o=new ti.Message.Peer;if(s.id!=null&&(typeof s.id=="string"?$e.base64.decode(s.id,o.id=$e.newBuffer($e.base64.length(s.id)),0):s.id.length&&(o.id=s.id)),s.addrs){if(!Array.isArray(s.addrs))throw TypeError(".Message.Peer.addrs: array expected");o.addrs=[];for(var a=0;a<s.addrs.length;++a)typeof s.addrs[a]=="string"?$e.base64.decode(s.addrs[a],o.addrs[a]=$e.newBuffer($e.base64.length(s.addrs[a])),0):s.addrs[a].length&&(o.addrs[a]=s.addrs[a])}switch(s.connection){case"NOT_CONNECTED":case 0:o.connection=0;break;case"CONNECTED":case 1:o.connection=1;break;case"CAN_CONNECT":case 2:o.connection=2;break;case"CANNOT_CONNECT":case 3:o.connection=3;break}return o},r.toObject=function(s,o){o||(o={});var a={};if((o.arrays||o.defaults)&&(a.addrs=[]),s.id!=null&&s.hasOwnProperty("id")&&(a.id=o.bytes===String?$e.base64.encode(s.id,0,s.id.length):o.bytes===Array?Array.prototype.slice.call(s.id):s.id,o.oneofs&&(a._id="id")),s.addrs&&s.addrs.length){a.addrs=[];for(var c=0;c<s.addrs.length;++c)a.addrs[c]=o.bytes===String?$e.base64.encode(s.addrs[c],0,s.addrs[c].length):o.bytes===Array?Array.prototype.slice.call(s.addrs[c]):s.addrs[c]}return s.connection!=null&&s.hasOwnProperty("connection")&&(a.connection=o.enums===String?ti.Message.ConnectionType[s.connection]:s.connection,o.oneofs&&(a._connection="connection")),a},r.prototype.toJSON=function(){return this.constructor.toObject(this,$l.util.toJSONOptions)},r}(),t}();YSe.exports=ti});var bc=p((CUt,e3e)=>{f();"use strict";var I_t=et(),{Multiaddr:T_t}=tt(),{Record:R_t}=Mf(),X3=XSe(),P_t=X3.Message.MessageType,QSe=X3.Message.ConnectionType,my=class{constructor(e,r,i){if(r&&!(r instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=r,this._clusterLevelRaw=i,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let e=this._clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this._clusterLevelRaw=e}serialize(){let e={key:this.key,type:this.type,clusterLevelRaw:this._clusterLevelRaw,closerPeers:this.closerPeers.map(ZSe),providerPeers:this.providerPeers.map(ZSe),record:void 0};return this.record&&(this.record instanceof Uint8Array?e.record=this.record:e.record=this.record.serialize()),X3.Message.encode(e).finish()}static deserialize(e){let r=X3.Message.decode(e),i=new my(r.type||0,r.key||Uint8Array.from([]),r.clusterLevelRaw||0);return i.closerPeers=r.closerPeers.map(JSe),i.providerPeers=r.providerPeers.map(JSe),r.record&&r.record.length&&(i.record=R_t.deserialize(r.record)),i}};my.TYPES=P_t;my.CONNECTION_TYPES=QSe;function ZSe(t){return{id:t.id.id,addrs:(t.multiaddrs||[]).map(r=>r.bytes),connection:QSe.CONNECTED}}function JSe(t){return{id:new I_t(t.id),multiaddrs:(t.addrs||[]).map(e=>new T_t(e))}}e3e.exports=my});var i3e=p((OUt,r3e)=>{f();"use strict";var{Record:C_t}=Mf(),O_t=ae(),t3e=bc(),ck=pi();r3e.exports=t=>{let e=ck.logger(t.peerId,"rpc:get-value");async function r(i,n){let s=n.key;if(e("key: %b",s),!s||s.length===0)throw O_t(new Error("Invalid key"),"ERR_INVALID_KEY");let o=new t3e(t3e.TYPES.GET_VALUE,s,n.clusterLevel);if(ck.isPublicKeyKey(s)){e("is public key");let l=ck.fromPublicKeyKey(s),u;if(t._isSelf(l))u=t.peerId;else{let h=t.peerStore.get(l);u=h&&h.id}if(u&&u.pubKey)return e("returning found public key"),o.record=new C_t(s,u.pubKey.bytes),o}let[a,c]=await Promise.all([t._checkLocalDatastore(s),t._betterPeersToQuery(n,i)]);return a&&(e("got record"),o.record=a),c.length>0&&(e("got closer %s",c.length),o.closerPeers=c),o}return r}});var o3e=p((kUt,s3e)=>{f();"use strict";var n3e=pi(),k_t=ae();s3e.exports=t=>{let e=n3e.logger(t.peerId,"rpc:put-value");async function r(i,n){let s=n.key;e("key: %b",s);let o=n.record;if(!o){let c=`Empty record from: ${i.toB58String()}`;throw e.error(c),k_t(new Error(c),"ERR_EMPTY_RECORD")}await t._verifyRecordLocally(o),o.timeReceived=new Date;let a=n3e.bufferToKey(o.key);return await t.datastore.put(a,o.serialize()),t.onPut(o,i),n}return r}});var c3e=p((qUt,a3e)=>{f();"use strict";var q_t=yi(),B_t=bc(),N_t=pi();a3e.exports=t=>{let e=N_t.logger(t.peerId,"rpc:find-node");async function r(i,n){e("start");let s;q_t(n.key,t.peerId.id)?s=[{id:t.peerId,multiaddrs:t.libp2p.multiaddrs}]:s=await t._betterPeersToQuery(n,i);let o=new B_t(n.type,new Uint8Array(0),n.clusterLevel);return s.length>0?o.closerPeers=s:e("handle FindNode %s: could not find anything",i.toB58String()),o}return r}});var f3e=p((BUt,l3e)=>{f();"use strict";var{CID:D_t}=(Ae(),Ce),u3e=ae(),M_t=pi();l3e.exports=t=>{let e=M_t.logger(t.peerId,"rpc:add-provider");async function r(i,n){if(e("start"),!n.key||n.key.length===0)throw u3e(new Error("Missing key"),"ERR_MISSING_KEY");let s;try{s=D_t.decode(n.key)}catch(o){let a=`Invalid CID: ${o.message}`;throw u3e(new Error(a),"ERR_INVALID_CID")}return n.providerPeers.forEach(o=>{if(!o.id.isEqual(i)){e("invalid provider peer %s from %s",o.id.toB58String(),i.toB58String());return}if(o.multiaddrs.length<1){e("no valid addresses for provider %s. Ignore",i.toB58String());return}if(e("received provider %s for %s (addrs %s)",i.toB58String(),s.toString(),o.multiaddrs.map(a=>a.toString())),!t._isSelf(o.id))return t.peerStore.addressBook.add(o.id,o.multiaddrs),t.providers.addProvider(s,o.id)}),t.providers.addProvider(s,i)}return r}});var p3e=p((NUt,d3e)=>{f();"use strict";var{CID:L_t}=(Ae(),Ce),U_t=ae(),F_t=bc(),h3e=pi();d3e.exports=t=>{let e=h3e.logger(t.peerId,"rpc:get-providers");async function r(i,n){let s;try{s=L_t.decode(n.key)}catch(y){throw U_t(new Error(`Invalid CID: ${y.message}`),"ERR_INVALID_CID")}e("%s",s.toString());let o=h3e.bufferToKey(s.bytes),[a,c,l]=await Promise.all([t.datastore.has(o),t.providers.getProviders(s),t._betterPeersToQuery(n,i)]),u=c.map(y=>({id:y,multiaddrs:[]})),h=l.map(y=>({id:y.id,multiaddrs:[]}));a&&u.push({id:t.peerId,multiaddrs:[]});let d=new F_t(n.type,n.key,n.clusterLevel);return u.length>0&&(d.providerPeers=u),h.length>0&&(d.closerPeers=h),e("got %s providers %s closerPeers",u.length,h.length),d}return r}});var g3e=p((DUt,y3e)=>{f();"use strict";var K_t=pi();y3e.exports=t=>{let e=K_t.logger(t.peerId,"rpc:ping");function r(i,n){return e("from %s",i.toB58String()),n}return r}});var m3e=p((MUt,b3e)=>{f();"use strict";var vy=bc().TYPES;b3e.exports=t=>{let e={[vy.GET_VALUE]:i3e()(t),[vy.PUT_VALUE]:o3e()(t),[vy.FIND_NODE]:c3e()(t),[vy.ADD_PROVIDER]:f3e()(t),[vy.GET_PROVIDERS]:p3e()(t),[vy.PING]:g3e()(t)};function r(i){return e[i]}return r}});var _3e=p((LUt,w3e)=>{f();"use strict";var{pipe:j_t}=Pr(),v3e=$o(),V_t=bc(),z_t=m3e(),H_t=pi();w3e.exports=t=>{let e=H_t.logger(t.peerId,"rpc"),r=z_t(t);async function i(s,o){let a=r(o.type);try{await t._add(s)}catch(c){e.error("Failed to update the kbucket store",c)}if(!a){e.error(`no handler found for message type: ${o.type}`);return}return a(s,o)}async function n({stream:s,connection:o}){let a=o.remotePeer;try{await t._add(a)}catch(l){e.error(l)}let c=a.toB58String();e("from: %s",c),await j_t(s.source,v3e.decode(),l=>async function*(){for await(let u of l){let h=V_t.deserialize(u.slice()),d=await i(a,h);d&&(yield d.serialize())}}(),v3e.encode(),s.sink)}return n}});var A3e=p((UUt,x3e)=>{f();"use strict";var Q3=ae(),{pipe:E3e}=Pr(),uk=$o(),$_t=gy(),{consume:G_t}=Tp(),W_t=lp(),Y_t=kE(),X_t=_3e(),Q_t=Hl(),Z_t=bc(),J_t=pi(),S3e=class{constructor(e){this.dht=e,this.readMessageTimeout=Q_t.READ_MESSAGE_TIMEOUT,this._log=J_t.logger(this.dht.peerId,"net"),this._rpc=X_t(this.dht),this._onPeerConnected=this._onPeerConnected.bind(this),this._running=!1}start(){if(this._running)return;if(!this.dht.isStarted)throw Q3(new Error("Can not start network"),"ERR_CANNOT_START_NETWORK");this._running=!0,this.dht._clientMode===!1&&this.dht.registrar.handle(this.dht.protocol,this._rpc);let e=new Y_t({multicodecs:[this.dht.protocol],handlers:{onConnect:this._onPeerConnected,onDisconnect:()=>{}}});this._registrarId=this.dht.registrar.register(e)}stop(){!this.dht.isStarted&&!this.isStarted||(this._running=!1,this._registrarId&&this.dht.registrar.unregister(this._registrarId))}get isStarted(){return this._running}get isConnected(){return this.dht.isStarted&&this.isStarted}async _onPeerConnected(e){await this.dht._add(e),this._log("added to the routing table: %s",e.toB58String())}async sendRequest(e,r){if(!this.isConnected)throw Q3(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeReadMessage(s,r.serialize())}async sendMessage(e,r){if(!this.isConnected)throw Q3(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeMessage(s,r.serialize())}async _writeReadMessage(e,r){return $_t(e2t(e,r),this.readMessageTimeout)}_writeMessage(e,r){return E3e([r],uk.encode(),e,G_t)}};async function e2t(t,e){let r=await E3e([e],uk.encode(),t,uk.decode(),async i=>{let n=await W_t(i);if(n)return n.slice()});if(r.length===0)throw Q3(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED");return Z_t.deserialize(r)}x3e.exports=S3e});var P3e=p((FUt,R3e)=>{f();"use strict";var Z3=H3(),I3e=pi(),t2t=$3(),r2t=yi(),T3e=class{constructor(e,r){this.originDhtKey=e,this.capacity=r,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(n=>r2t(n.peerId.id,e.id)))return;let r=await I3e.convertPeerId(e),i={peerId:e,distance:Z3(this.originDhtKey,r)};this.peerDistances.push(i),this.peerDistances.sort((n,s)=>Z3.compare(n.distance,s.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(!e.length)return!1;if(!this.length)return!0;let r=await t2t(e,n=>I3e.convertPeerId(n)),i=this.peerDistances[this.peerDistances.length-1].distance;for(let n of r){let s=Z3(this.originDhtKey,n);if(Z3.compare(s,i)<0)return!0}return!1}};R3e.exports=T3e});var O3e=p((lk,C3e)=>{f();(function(){var t,e,r,i,n,s,o,a,c,l,u,h,d,y,g;r=Math.floor,l=Math.min,e=function(m,E){return m<E?-1:m>E?1:0},c=function(m,E,v,A,R){var F;if(v==null&&(v=0),R==null&&(R=e),v<0)throw new Error("lo must be non-negative");for(A==null&&(A=m.length);v<A;)F=r((v+A)/2),R(E,m[F])<0?A=F:v=F+1;return[].splice.apply(m,[v,v-v].concat(E)),E},s=function(m,E,v){return v==null&&(v=e),m.push(E),y(m,0,m.length-1,v)},n=function(m,E){var v,A;return E==null&&(E=e),v=m.pop(),m.length?(A=m[0],m[0]=v,g(m,0,E)):A=v,A},a=function(m,E,v){var A;return v==null&&(v=e),A=m[0],m[0]=E,g(m,0,v),A},o=function(m,E,v){var A;return v==null&&(v=e),m.length&&v(m[0],E)<0&&(A=[m[0],E],E=A[0],m[0]=A[1],g(m,0,v)),E},i=function(m,E){var v,A,R,F,q,B,z,G;for(E==null&&(E=e),B=function(){G=[];for(var Y=0,P=r(m.length/2);0<=P?Y<P:Y>P;0<=P?Y++:Y--)G.push(Y);return G}.apply(this).reverse(),z=[],A=0,F=B.length;A<F;A++)v=B[A],z.push(g(m,v,E));return z},d=function(m,E,v){var A;if(v==null&&(v=e),A=m.indexOf(E),A!==-1)return y(m,0,A,v),g(m,A,v)},u=function(m,E,v){var A,R,F,q,B;if(v==null&&(v=e),R=m.slice(0,E),!R.length)return R;for(i(R,v),B=m.slice(E),F=0,q=B.length;F<q;F++)A=B[F],o(R,A,v);return R.sort(v).reverse()},h=function(m,E,v){var A,R,F,q,B,z,G,Y,P,b;if(v==null&&(v=e),E*10<=m.length){if(q=m.slice(0,E).sort(v),!q.length)return q;for(F=q[q.length-1],Y=m.slice(E),B=0,G=Y.length;B<G;B++)A=Y[B],v(A,F)<0&&(c(q,A,0,null,v),q.pop(),F=q[q.length-1]);return q}for(i(m,v),b=[],R=z=0,P=l(E,m.length);0<=P?z<P:z>P;R=0<=P?++z:--z)b.push(n(m,v));return b},y=function(m,E,v,A){var R,F,q;for(A==null&&(A=e),R=m[v];v>E;){if(q=v-1>>1,F=m[q],A(R,F)<0){m[v]=F,v=q;continue}break}return m[v]=R},g=function(m,E,v){var A,R,F,q,B;for(v==null&&(v=e),R=m.length,B=E,F=m[E],A=2*E+1;A<R;)q=A+1,q<R&&!(v(m[A],m[q])<0)&&(A=q),m[E]=m[A],E=A,A=2*E+1;return m[E]=F,y(m,B,E,v)},t=function(){m.push=s,m.pop=n,m.replace=a,m.pushpop=o,m.heapify=i,m.updateItem=d,m.nlargest=u,m.nsmallest=h;function m(E){this.cmp=E??e,this.nodes=[]}return m.prototype.push=function(E){return s(this.nodes,E,this.cmp)},m.prototype.pop=function(){return n(this.nodes,this.cmp)},m.prototype.peek=function(){return this.nodes[0]},m.prototype.contains=function(E){return this.nodes.indexOf(E)!==-1},m.prototype.replace=function(E){return a(this.nodes,E,this.cmp)},m.prototype.pushpop=function(E){return o(this.nodes,E,this.cmp)},m.prototype.heapify=function(){return i(this.nodes,this.cmp)},m.prototype.updateItem=function(E){return d(this.nodes,E,this.cmp)},m.prototype.clear=function(){return this.nodes=[]},m.prototype.empty=function(){return this.nodes.length===0},m.prototype.size=function(){return this.nodes.length},m.prototype.clone=function(){var E;return E=new m,E.nodes=this.nodes.slice(0),E},m.prototype.toArray=function(){return this.nodes.slice(0)},m.prototype.insert=m.prototype.push,m.prototype.top=m.prototype.peek,m.prototype.front=m.prototype.peek,m.prototype.has=m.prototype.contains,m.prototype.copy=m.prototype.clone,m}(),function(m,E){return typeof define=="function"&&define.amd?define([],E):typeof lk=="object"?C3e.exports=E():m.Heap=E()}(this,function(){return t})}).call(lk)});var q3e=p((KUt,k3e)=>{f();k3e.exports=O3e()});var N3e=p((jUt,B3e)=>{f();"use strict";var i2t=q3e(),n2t=H3(),s2t=me(),J3=pi(),fk=s2t("libp2p:dht:peer-queue"),bm=class{static async fromPeerId(e){let r=await J3.convertPeerId(e);return new bm(r)}static async fromKey(e){let r=await J3.convertBuffer(e);return new bm(r)}constructor(e){fk("create: %b",e),this.from=e,this.heap=new i2t(J3.xorCompare)}async enqueue(e){fk("enqueue %s",e.toB58String());let r=await J3.convertPeerId(e),i={id:e,distance:n2t(this.from,r)};this.heap.push(i)}dequeue(){let e=this.heap.pop();return fk("dequeue %s",e.id.toB58String()),e.id}get length(){return this.heap.size()}};B3e.exports=bm});var L3e=p((VUt,M3e)=>{f();"use strict";var o2t=N3e(),a2t=pi(),c2t=3e4,D3e=class{constructor(e,r){if(this.run=e,this.queryFunc=a2t.withTimeout(r,c2t),!this.queryFunc)throw new Error("Path requires a `queryFn` to be specified");if(typeof this.queryFunc!="function")throw new Error("Path expected `queryFn` to be a function. Got "+typeof this.queryFunc);this.initialPeers=[],this.peersToQuery=null,this.res=null}addInitialPeer(e){this.initialPeers.push(e)}async execute(){let e=await o2t.fromKey(this.run.query.key);this.peersToQuery=e,await Promise.all(this.initialPeers.map(r=>this.addPeerToQuery(r))),await this.run.workerQueue(this)}async addPeerToQuery(e){this.run.query.dht._isSelf(e)||this.run.peersSeen.has(e.toB58String())||this.peersToQuery&&await this.peersToQuery.enqueue(e)}};M3e.exports=D3e});var K3e=p((zUt,F3e)=>{f();"use strict";var{default:u2t}=Kc(),U3e=class{constructor(e,r,i,n){this.dht=e,this.run=r,this.path=i,this.log=n,this.concurrency=this.dht.concurrency,this.queue=this.setupQueue(),this.execution=null,this.queuedPeerIds=new Set}setupQueue(){let e=new u2t({concurrency:this.concurrency});return e.on("idle",()=>{this.path.peersToQuery&&!this.path.peersToQuery.length&&(this.log("queue:drain"),this.stop())}),e.on("next",()=>{!this.running||e.pending<this.concurrency&&this.fill()}),e}stop(e){!this.running||(this.running=!1,this.queue.clear(),this.log("worker:stop, %d workers still running",this.run.workers.filter(r=>r.running).length),this.execution&&(e?this.execution.reject(e):this.execution.resolve()))}async execute(){this.running=!0,this.execution=null;let e=new Promise((r,i)=>{this.execution={resolve:r,reject:i}});this.fill(),await e}fill(){if(!!this.path.peersToQuery)for(;this.queue.pending+this.queue.size<this.concurrency&&this.path.peersToQuery.length>0;){let e=this.path.peersToQuery.dequeue();this.queuedPeerIds.add(e),this.queue.add(()=>this.processNext(e).catch(r=>{this.log.error("queue",r),this.stop(r)}).finally(()=>{this.queuedPeerIds.delete(e)}))}}async processNext(e){if(!this.running||this.run.peersSeen.has(e.toB58String()))return;let r,i;try{r=await this.run.continueQuerying(this)}catch(o){i=o}if(!this.running)return;if(i)throw i;if(!r){this.stop();return}if(this.run.peersSeen.has(e.toB58String()))return;this.run.peersSeen.add(e.toB58String()),this.log("queue:work");let n,s;try{n=await this.execQuery(e)}catch(o){s=o}if(!!this.running){if(this.log("queue:work:done",s,n),s)throw s;if(n&&n.queryComplete){this.log("query:complete"),this.run.stop();return}n&&n.pathComplete&&this.stop()}}async execQuery(e){let r,i;try{r=await this.path.queryFunc(e)}catch(n){i=n}if(!!this.running){if(i){this.run.errors.push(i);return}if(this.run.peersQueried&&await this.run.peersQueried.add(e),!!r){if(r.pathComplete||r.queryComplete)return this.path.res=r,{pathComplete:r.pathComplete,queryComplete:r.queryComplete};if(r.closerPeers&&r.closerPeers.length>0){let n=async s=>{this.dht._isSelf(s.id)||(this.dht._peerDiscovered(s.id,s.multiaddrs),await this.path.addPeerToQuery(s.id))};await Promise.all(r.closerPeers.map(n))}}}}};F3e.exports=U3e});var z3e=p((HUt,V3e)=>{f();"use strict";var l2t=P3e(),f2t=vr(),h2t=L3e(),d2t=K3e(),p2t=pi(),j3e=class extends f2t{constructor(e){super();this.query=e,this.running=!1,this.workers=[],this.peersSeen=new Set,this.errors=[],this.peersQueried=null}stop(){if(!!this.running){this.running=!1;for(let e of this.workers)e.stop()}}async execute(e){let r=[],i=Math.min(this.query.dht.disjointPaths,e.length);for(let s=0;s<i;s++)r.push(new h2t(this,this.query.makePath(s,i)));e.forEach((s,o)=>{r[o%i].addInitialPeer(s)}),await this.executePaths(r);let n={finalSet:new Set(this.peersQueried&&this.peersQueried.peers),paths:[]};for(let s of r)s.res&&(s.res.pathComplete||s.res.queryComplete)&&(s.res.success=!0,n.paths.push(s.res));return n}async executePaths(e){this.running=!0,this.emit("start");try{await Promise.all(e.map(r=>r.execute()))}finally{this.stop(),this.emit("complete")}if(this.errors.length===this.peersSeen.size)throw this.errors[0]}async workerQueue(e){await this.init(),await this.startWorker(e)}async startWorker(e){let r=new d2t(this.query.dht,this,e,this.query._log);this.workers.push(r),await r.execute()}async init(){if(!this.peersQueried){if(this.peersQueriedPromise){await this.peersQueriedPromise;return}this.peersQueriedPromise=(async()=>{let e=await p2t.convertBuffer(this.query.key);this.peersQueried=new l2t(e,this.query.dht.kBucketSize)})(),await this.peersQueriedPromise,delete this.peersQueriedPromise}}async continueQuerying(e){if(this.peersQueried&&this.peersQueried.length<this.peersQueried.capacity)return!0;let r=Array.from(e.queuedPeerIds);return!!(this.peersQueried&&await this.peersQueried.anyCloser(r))}};V3e.exports=j3e});var e6=p(($Ut,$3e)=>{f();"use strict";var{base58btc:y2t}=(si(),ni),g2t=pi(),b2t=z3e(),H3e=class{constructor(e,r,i){this.dht=e,this.key=r,this.makePath=i,this._log=g2t.logger(this.dht.peerId,"query:"+y2t.baseEncode(r)),this.running=!1,this._onStart=this._onStart.bind(this),this._onComplete=this._onComplete.bind(this)}async run(e){return this.dht._queryManager.running?e.length===0?(this._log.error("Running query with no peers"),{finalSet:new Set,paths:[]}):(this._run=new b2t(this),this._log(`query running with K=${this.dht.kBucketSize}, A=${this.dht.concurrency}, D=${Math.min(this.dht.disjointPaths,e.length)}`),this._run.once("start",this._onStart),this._run.once("complete",this._onComplete),this._run.execute(e)):(this._log.error("Attempt to run query after shutdown"),{finalSet:new Set,paths:[]})}_onStart(){this.running=!0,this._startTime=Date.now(),this._log("query:start"),this.dht._queryManager.queryStarted(this)}_onComplete(){this.stop()}stop(){this._log(`query:done in ${Date.now()-(this._startTime||0)}ms`),this._run&&this._log(`${this._run.errors.length} of ${this._run.peersSeen.size} peers errored (${this._run.errors.length/this._run.peersSeen.size*100}% fail rate)`),!!this.running&&(this.running=!1,this._run&&(this._run.removeListener("start",this._onStart),this._run.removeListener("complete",this._onComplete),this._run.stop()),this.dht._queryManager.queryCompleted(this))}};$3e.exports=H3e});var X3e=p((GUt,Y3e)=>{f();"use strict";var hk=ae(),m2t=gy(),v2t=yi(),G3e=Je(),W3e=Mf(),dk=Hl(),w2t=e6(),Vh=pi(),_2t=W3e.Record;Y3e.exports=t=>{let e=async(n,s)=>t.datastore.put(Vh.bufferToKey(n),s),r=async n=>{t._log(`getLocal ${G3e(n,"base32")}`);let s=await t.datastore.get(Vh.bufferToKey(n));t._log(`found ${G3e(n,"base32")} in local datastore`);let o=_2t.deserialize(s);return await t._verifyRecordLocally(o),o},i=async(n,s,o)=>{let a=await Vh.createPutRecord(n,o);return Promise.all(s.map(async c=>{if(!v2t(c.val,o)){if(t._isSelf(c.from)){try{await t._putLocal(n,a)}catch(l){t._log.error("Failed error correcting self",l)}return}try{await t._putValueToPeer(n,a,c.from)}catch(l){t._log.error("Failed error correcting entry",l)}}}))};return{async _putLocal(n,s){return e(n,s)},async put(n,s,o={}){t._log("PutValue %b",n);let a=await Vh.createPutRecord(n,s);await e(n,a);let c=0,l=0;await Vh.mapParallel(t.getClosestPeers(n,{shallow:!0}),async h=>{try{c+=1,await t._putValueToPeer(n,a,h),l+=1}catch(d){t._log.error("Failed to put to peer (%b): %s",h.id,d)}});let u=o.minPeers||c;if(u>l){let h=hk(new Error(`Failed to put value to enough peers: ${l}/${u}`),"ERR_NOT_ENOUGH_PUT_PEERS");throw t._log.error(h),h}},async get(n,s={}){s.timeout=s.timeout||dk.minute,t._log("_get %b",n);let o=await t.getMany(n,dk.GET_MANY_RECORD_COUNT,s),a=o.map(u=>u.val),c=0;try{c=W3e.selection.bestRecord(t.selectors,n,a)}catch(u){if(u.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw u}let l=a[c];if(t._log("GetValue %b %s",n,l),!l)throw hk(new Error("best value was not found"),"ERR_NOT_FOUND");return await i(n,o,l),l},async getMany(n,s,o={}){o.timeout=o.timeout||dk.minute,t._log("getMany %b (%s)",n,s);let a=[],c;try{c=await r(n)}catch(g){if(s===0)throw g}if(c&&a.push({val:c.value,from:t.peerId}),a.length>=s)return a;let l=await Vh.convertBuffer(n),u=t.routingTable.closestPeers(l,t.kBucketSize);if(t._log("peers in rt: %d",u.length),u.length===0){let g="Failed to lookup key! No peers from routing table!";if(t._log.error(g),a.length===0)throw hk(new Error(g),"ERR_NO_PEERS_IN_ROUTING_TABLE");return a}let h=a.length;function d(g,m){let E=Vh.pathSize(s-h,m),v=0;async function A(R){let F,q,B;try{let G=await t._getValueOrPeers(R,n);F=G.record,q=G.peers}catch(G){if(G.code!=="ERR_INVALID_RECORD")throw G;B=G}let z={closerPeers:q};return F&&F.value?(a.push({val:F.value,from:R}),v++):B&&(a.push({err:B,from:R}),v++),v>=E&&(z.pathComplete=!0),z}return A}let y=new w2t(t,n,d);try{await m2t(y.run(u),o.timeout)}catch(g){if(a.length===0)throw g}finally{y.stop()}return a}}}});var J3e=p((WUt,Z3e)=>{f();"use strict";var Q3e=class{constructor(){this.list=[]}push(e){return this.has(e.id)?!1:(this.list.push(e),!0)}has(e){let r=this.list.find(i=>i.id.equals(e));return Boolean(r)}toArray(){return this.list.slice()}pop(){return this.list.pop()}get length(){return this.list.length}};Z3e.exports=Q3e});var r6e=p((YUt,t6e)=>{f();"use strict";var E2t=J3e(),e6e=class extends E2t{constructor(e){super();this.limit=e}push(e){return this.length<this.limit?super.push(e):!1}};t6e.exports=e6e});var c6e=p((XUt,a6e)=>{f();"use strict";var S2t=ae(),i6e=gy(),n6e=Hl(),s6e=r6e(),t6=bc(),x2t=e6(),o6e=pi();a6e.exports=t=>{let e=async(r,i)=>{let n=new t6(t6.TYPES.GET_PROVIDERS,i.bytes,0);return t.network.sendRequest(r,n)};return{async provide(r){t._log(`provide: ${r}`);let i=[];await t.providers.addProvider(r,t.peerId);let n=t.libp2p?t.libp2p.multiaddrs:[],s=new t6(t6.TYPES.ADD_PROVIDER,r.bytes,0);s.providerPeers=[{id:t.peerId,multiaddrs:n}];async function o(a){t._log(`putProvider ${r} to ${a.toB58String()}`);try{await t.network.sendMessage(a,s)}catch(c){i.push(c)}}if(await o6e.mapParallel(t.getClosestPeers(r.bytes),o),i.length)throw S2t(new Error(`Failed to provide to ${i.length} of ${t.kBucketSize} peers`),"ERR_SOME_PROVIDES_FAILED",{errors:i})},async*findProviders(r,i={timeout:6e4,maxNumProviders:5}){let n=i.timeout||n6e.minute,s=i.maxNumProviders||n6e.K;t._log(`findProviders ${r}`);let o=new s6e(s);if((await t.providers.getProviders(r)).forEach(d=>{let y=t.peerStore.get(d);y?o.push({id:y.id,multiaddrs:y.addresses.map(g=>g.multiaddr)}):o.push({id:d,multiaddrs:[]})}),o.length>=s){for(let d of o.toArray())yield d;return}let c=[];function l(d,y){let g=o6e.pathSize(s-o.length,y),m=new s6e(g);c.push(m);async function E(v){let A=await e(v,r),R=A.providerPeers;return t._log(`Found ${R.length} provider entries for ${r}`),R.forEach(F=>{m.push({...F})}),m.length>=g?{pathComplete:!0}:{closerPeers:A.closerPeers}}return E}let u=new x2t(t,r.bytes,l),h=t.routingTable.closestPeers(r.bytes,t.kBucketSize);try{await i6e(u.run(h),n)}catch(d){if(d.name!==i6e.TimeoutError.name)throw d}finally{u.stop()}c.forEach(d=>{d.toArray().forEach(y=>{o.push(y)})});for(let d of o.toArray())yield d}}}});var f6e=p((QUt,l6e)=>{f();"use strict";var mm=ae(),A2t=gy(),pk=et(),I2t=Ma(),T2t=Je(),R2t=Hl(),r6=bc(),u6e=e6(),vm=pi();l6e.exports=t=>{let e=async s=>{t._log(`findPeerLocal ${s.toB58String()}`);let o=await t.routingTable.find(s),a=o&&t.peerStore.get(o);if(a)return{id:a.id,multiaddrs:a.addresses.map(c=>c.multiaddr)}},r=async(s,o)=>{let a=new r6(r6.TYPES.GET_VALUE,o,0);return t.network.sendRequest(s,a)},i=async(s,o)=>(t._log(`closerPeersSingle ${T2t(s,"base32")} from ${o.toB58String()}`),(await t.peerRouting._findPeerSingle(o,new pk(s))).closerPeers.filter(c=>!t._isSelf(c.id)).map(c=>(t.peerStore.addressBook.add(c.id,c.multiaddrs),c))),n=async s=>{let o=vm.keyForPublicKey(s),a=await r(s,o);if(!a.record||!a.record.value)throw mm(new Error(`Node not responding with its public key: ${s.toB58String()}`),"ERR_INVALID_RECORD");let c=await pk.createFromPubKey(a.record.value);if(!c.equals(s))throw mm(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");return c.pubKey};return{async _findPeerSingle(s,o){t._log("findPeerSingle %s",s.toB58String());let a=new r6(r6.TYPES.FIND_NODE,o.id,0);return t.network.sendRequest(s,a)},async findPeer(s,o={timeout:6e4}){o.timeout=o.timeout||R2t.minute,t._log("findPeer %s",s.toB58String());let a=await e(s);if(a!=null)return t._log("found local"),a;let c=await vm.convertPeerId(s),l=t.routingTable.closestPeers(c,t.kBucketSize);if(l.length===0)throw mm(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED");if(l.find(m=>m.isEqual(s))){let m=t.peerStore.get(s);if(m)return t._log("found in peerStore"),{id:m.id,multiaddrs:m.addresses.map(E=>E.multiaddr)}}let h=new u6e(t,s.id,()=>async E=>{let v=await this._findPeerSingle(E,s),A=v.closerPeers.find(R=>R.id.isEqual(s));return A?{peer:A,queryComplete:!0}:{closerPeers:v.closerPeers}}),d;try{d=await A2t(h.run(l),o.timeout)}finally{h.stop()}let y=!1;if(d.paths.forEach(m=>{m.success&&m.peer&&(y=!0,t.peerStore.addressBook.add(m.peer.id,m.peer.multiaddrs))}),t._log("findPeer %s: %s",s.toB58String(),y),!y)throw mm(new Error("No peer found"),"ERR_NOT_FOUND");let g=t.peerStore.get(s);if(!g)throw mm(new Error("No peer found in peer store"),"ERR_NOT_FOUND");return{id:g.id,multiaddrs:g.addresses.map(m=>m.multiaddr)}},async*getClosestPeers(s,o={shallow:!1}){t._log("getClosestPeers to %b",s);let a=await vm.convertBuffer(s),c=t.routingTable.closestPeers(a,t.kBucketSize),u=await new u6e(t,s,()=>async d=>({closerPeers:await i(s,d),pathComplete:o.shallow?!0:void 0})).run(c);if(!u||!u.finalSet)return[];let h=await vm.sortClosestPeers(Array.from(u.finalSet),a);for(let d of h.slice(0,t.kBucketSize))yield d},async getPublicKey(s){t._log("getPublicKey %s",s.toB58String());let o=t.peerStore.get(s);if(o&&o.id.pubKey)return t._log("getPublicKey: found local copy"),o.id.pubKey;let a;try{a=await n(s)}catch(u){let h=vm.keyForPublicKey(s),d=await t.get(h);a=I2t.keys.unmarshalPublicKey(d)}let c=new pk(s.id,void 0,a),l=(o&&o.addresses||[]).map(u=>u.multiaddr);return t.peerStore.addressBook.add(c,l),t.peerStore.keyBook.set(c,a),a}}}});var b6e=p((ZUt,g6e)=>{f();"use strict";var P2t=eb(),h6e=os(),C2t=et(),{Key:O2t}=Ft(),{default:k2t}=Kc(),wm=Hl(),_m=pi(),d6e=class{constructor(e,r,i){this.datastore=e,this._log=_m.logger(r,"providers"),this.cleanupInterval=wm.PROVIDERS_CLEANUP_INTERVAL,this.provideValidity=wm.PROVIDERS_VALIDITY,this.lruCacheSize=i||wm.PROVIDERS_LRU_CACHE_SIZE,this.providers=P2t(this.lruCacheSize),this.syncQueue=new k2t({concurrency:1})}start(){this._cleaner=setInterval(()=>this._cleanup(),this.cleanupInterval)}stop(){this._cleaner&&(clearInterval(this._cleaner),this._cleaner=null)}_cleanup(){return this.syncQueue.add(async()=>{this._log("start cleanup");let e=Date.now(),r=0,i=0,n=new Map,s=this.datastore.batch(),o=this.datastore.query({prefix:wm.PROVIDERS_KEY_PREFIX});for await(let a of o)try{let{cid:c,peerId:l}=p6e(a.key),u=y6e(a.value),h=Date.now(),d=h-u,y=d>this.provideValidity;if(this._log("comparing: %d - %d = %d > %d %s",h,u,d,this.provideValidity,y?"(expired)":""),y){i++,s.delete(a.key);let g=n.get(c)||new Set;g.add(l),n.set(c,g)}r++}catch(c){this._log.error(c.message)}this._log("deleting %d / %d entries",i,r),n.size&&await s.commit();for(let[a,c]of n){let l=Em(a),u=this.providers.get(l);if(u){for(let h of c)u.delete(h);u.size===0?this.providers.remove(l):this.providers.set(l,u)}}this._log("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){let r=Em(e),i=this.providers.get(r);return i||(i=await B2t(this.datastore,e),this.providers.set(r,i)),i}async addProvider(e,r){return this.syncQueue.add(async()=>{this._log("addProvider %s",e.toString());let i=await this._getProvidersMap(e);this._log("loaded %s provs",i.size);let n=new Date;i.set(_m.encodeBase32(r.id),n);let s=Em(e);return this.providers.set(s,i),q2t(this.datastore,e,r,n)})}async getProviders(e){return this.syncQueue.add(async()=>(this._log("getProviders %s",e.toString()),[...(await this._getProvidersMap(e)).keys()].map(i=>new C2t(_m.decodeBase32(i)))))}};function Em(t){return t=typeof t=="string"?t:_m.encodeBase32(t.bytes),wm.PROVIDERS_KEY_PREFIX+t}async function q2t(t,e,r,i){let n=[Em(e),"/",_m.encodeBase32(r.id)].join(""),s=new O2t(n),o=Uint8Array.from(h6e.encode(i.getTime()));return t.put(s,o)}function p6e(t){let e=t.toString().split("/");if(e.length!==4)throw new Error("incorrectly formatted provider entry key in datastore: "+t);return{cid:e[2],peerId:e[3]}}async function B2t(t,e){let r=new Map,i=t.query({prefix:Em(e)});for await(let n of i){let{peerId:s}=p6e(n.key);r.set(s,y6e(n.value))}return r}function y6e(t){return h6e.decode(t)}g6e.exports=d6e});var v6e=p((JUt,yk)=>{f();"use strict";var N2t=$3(),m6e=async(t,e,r)=>N2t(new Array(t).fill(),(i,n)=>e(n),r);yk.exports=m6e;yk.exports.default=m6e});var E6e=p((eFt,_6e)=>{f();"use strict";var D2t=Ma(),{sha256:M2t}=(ai(),$r),L2t=et(),{AbortController:U2t}=Ql(),F2t=ae(),K2t=v6e(),j2t=Hl(),{logger:V2t}=pi(),w6e=class{constructor(e,r){if(!e)throw new Error("Random Walk needs an instance of the Kademlia DHT");this._kadDHT=e,this._options={...j2t.defaultRandomWalk,...r},this.log=V2t(e.peerId,"random-walk"),this._timeoutId=void 0}start(){this._running||(this._running=!0,!(this._timeoutId||!this._options.enabled)&&(this._timeoutId=setTimeout(()=>{this._runPeriodically()},this._options.delay)))}stop(){this._running=!1,this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0),this._controller&&this._controller.abort()}async _runPeriodically(){for(;this._timeoutId;){try{await this._walk(this._options.queriesPerPeriod,this._options.timeout)}catch(e){this._kadDHT._log.error("random-walk:error",e)}if(!this._running)return;await new Promise(e=>{this._timeoutId=setTimeout(e,this._options.interval)})}}async _walk(e,r){this.log("start"),this._controller=new U2t;try{await K2t(e,async i=>{this.log("running query %d",i);try{let n=await this._randomPeerId();if(!this._controller)return;await this._query(n,{timeout:r,signal:this._controller.signal})}catch(n){if(n&&n.code!=="ETIMEDOUT")throw this.log.error("query %d finished with error",i,n),n}this.log("finished query %d",i)})}finally{this._controller=null,this.log("finished queries")}}async _query(e,r){this.log("query:%s",e.toB58String());let i;try{i=await this._kadDHT.findPeer(e,r)}catch(n){if(n&&n.code==="ERR_NOT_FOUND")return;throw n}throw this.log("query:found",i),F2t(new Error(`random-walk: ACTUALLY FOUND PEER: ${i}, ${e.toB58String()}`),"ERR_FOUND_RANDOM_PEER")}async _randomPeerId(){let e=await M2t.digest(D2t.randomBytes(16));return new L2t(e.bytes)}};_6e.exports=w6e});var A6e=p((tFt,x6e)=>{f();"use strict";var S6e=class{constructor(){this.queries=new Set,this.running=!1}queryStarted(e){this.queries.add(e)}queryCompleted(e){this.queries.delete(e)}start(){this.running=!0}stop(){this.running=!1;for(let e of this.queries)e.stop();this.queries.clear()}};x6e.exports=S6e});var R6e=p((rFt,mk)=>{f();"use strict";var{EventEmitter:z2t}=vr(),i6=ae(),Sm=Mf(),{MemoryDatastore:H2t}=Ft(),I6e=yi(),gk=Je(),$2t=GSe(),wy=pi(),xm=Hl(),G2t=A3e(),W2t=X3e(),Y2t=c6e(),X2t=f6e(),n6=bc(),Q2t=b6e(),Z2t=E6e(),J2t=A6e(),bk=Sm.Record,T6e=class extends z2t{constructor({libp2p:e,dialer:r,peerId:i,peerStore:n,registrar:s,protocolPrefix:o="/ipfs",forceProtocolLegacy:a=!1,datastore:c=new H2t,kBucketSize:l=xm.K,clientMode:u=!1,concurrency:h=xm.ALPHA,validators:d={},selectors:y={},randomWalk:g={enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:3e4,delay:1e4},onPut:m=()=>{},onRemove:E=()=>{}}){super();if(!r)throw new Error("libp2p-kad-dht requires an instance of Dialer");this.libp2p=e,this.dialer=r,this.peerId=i,this.peerStore=n,this.registrar=s,this.protocol=o+(a?"":xm.PROTOCOL_DHT),this.kBucketSize=l,this._clientMode=u,this.concurrency=h,this.disjointPaths=Math.ceil(this.kBucketSize/2),this.routingTable=new $2t(this.peerId,this.kBucketSize),this.datastore=c,this.providers=new Q2t(this.datastore,this.peerId),this.validators={pk:Sm.validator.validators.pk,...d},this.selectors={pk:Sm.selection.selectors.pk,...y},this.network=new G2t(this),this._log=wy.logger(this.peerId),this.randomWalk=new Z2t(this,g),this._queryManager=new J2t,this._running=!1,this.contentFetching=W2t(this),this.contentRouting=Y2t(this),this.peerRouting=X2t(this),this.onPut=m,this.onRemove=E}get isStarted(){return this._running}start(){this._running||(this._running=!0,this.providers.start(),this._queryManager.start(),this.network.start(),this.randomWalk.start())}stop(){this._running=!1,this.randomWalk.stop(),this.network.stop(),this._queryManager.stop(),this.providers.stop()}async put(e,r,i={}){return this.contentFetching.put(e,r,i)}async get(e,r={}){return this.contentFetching.get(e,r)}async getMany(e,r,i={}){return this.contentFetching.getMany(e,r,i)}async removeLocal(e){this._log(`removeLocal: ${gk(e,"base32")}`);let r=wy.bufferToKey(e);try{await this.datastore.delete(r)}catch(i){if(i.code==="ERR_NOT_FOUND")return;throw i}}async _putLocal(e,r){this._log(`_putLocal: ${gk(e,"base32")}`);let i=wy.bufferToKey(e);await this.datastore.put(i,r)}async provide(e){return this.contentRouting.provide(e)}async*findProviders(e,r={timeout:6e3,maxNumProviders:5}){for await(let i of this.contentRouting.findProviders(e,r))yield i}async findPeer(e,r={timeout:6e4}){return this.peerRouting.findPeer(e,r)}async*getClosestPeers(e,r={shallow:!1}){yield*this.peerRouting.getClosestPeers(e,r)}getPublicKey(e){return this.peerRouting.getPublicKey(e)}_peerDiscovered(e,r){this.emit("peer",{id:e,multiaddrs:r})}async _nearestPeersToQuery(e){let r=await wy.convertBuffer(e.key);return this.routingTable.closestPeers(r,this.kBucketSize).map(n=>{let s=this.peerStore.get(n);return{id:n,multiaddrs:s?s.addresses.map(o=>o.multiaddr):[]}})}async _betterPeersToQuery(e,r){return this._log("betterPeersToQuery"),(await this._nearestPeersToQuery(e)).filter(n=>this._isSelf(n.id)?(this._log.error("trying to return self as closer"),!1):!n.id.isEqual(r))}async _checkLocalDatastore(e){this._log(`checkLocalDatastore: ${gk(e)} %b`,e);let r=wy.bufferToKey(e),i;try{i=await this.datastore.get(r)}catch(s){if(s.code==="ERR_NOT_FOUND")return;throw s}let n=bk.deserialize(i);if(!n)throw i6(new Error("Invalid record"),"ERR_INVALID_RECORD");if(n.timeReceived==null||wy.now()-n.timeReceived.getTime()>xm.MAX_RECORD_AGE){await this.datastore.delete(r),this.onRemove(n);return}return n}async _add(e){await this.routingTable.add(e)}async _verifyRecordLocally(e){this._log("verifyRecordLocally"),await Sm.validator.verifyRecord(this.validators,e)}_isSelf(e){return e&&I6e(this.peerId.id,e.id)}async _putValueToPeer(e,r,i){let n=new n6(n6.TYPES.PUT_VALUE,e,0);n.record=bk.deserialize(r);let s=await this.network.sendRequest(i,n);if(s.record&&!I6e(s.record.value,bk.deserialize(r).value))throw i6(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")}async _getValueOrPeers(e,r){let i=await this._getValueSingle(e,r),n=i.closerPeers,s=i.record;if(s){try{await this._verifyRecordOnline(s)}catch(o){let a="invalid record received, discarded";throw this._log(a),i6(new Error(a),"ERR_INVALID_RECORD")}return{record:s,peers:n}}if(n.length>0)return{peers:n};throw i6(new Error("Not found"),"ERR_NOT_FOUND")}async _getValueSingle(e,r){let i=new n6(n6.TYPES.GET_VALUE,r,0);return this.network.sendRequest(e,i)}async _verifyRecordOnline(e){await Sm.validator.verifyRecord(this.validators,e)}};mk.exports=T6e;mk.exports.multicodec="/ipfs"+xm.PROTOCOL_DHT});var O6e=p((iFt,C6e)=>{f();"use strict";var eEt=Ywe(),tEt=V2e(),rEt=fEe(),{NOISE:iEt}=qSe(),nEt=R6e(),sEt=K8(),P6e=i5();C6e.exports=()=>({dialer:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4},modules:{transport:[eEt,tEt],streamMuxer:[rEt],connEncryption:[iEt],peerDiscovery:[],dht:nEt,pubsub:sEt},config:{peerDiscovery:{autoDial:!0,bootstrap:{enabled:!0},webRTCStar:{enabled:!0}},dht:{kBucketSize:20,enabled:!1,clientMode:!0,randomWalk:{enabled:!1},validators:{ipns:P6e.validator},selectors:{ipns:P6e.selector}},pubsub:{enabled:!0,emitSelf:!0},nat:{enabled:!1}},metrics:{enabled:!0},peerStore:{persistence:!0,threshold:1}})});var N6e=p((vk,B6e)=>{f();"use strict";var oEt=et(),{Multiaddr:aEt}=tt(),cEt=Sf(),{EventEmitter:uEt}=vr(),k6e=me(),s6=Object.assign(k6e("libp2p:bootstrap"),{error:k6e("libp2p:bootstrap:error")}),q6e=class extends uEt{constructor(e={list:[]}){if(!e.list||!e.list.length)throw new Error("Bootstrap requires a list of peer addresses");super();this._list=e.list,this._interval=e.interval||1e4,this._timer=null}start(){this._timer||(this._timer=setInterval(()=>this._discoverBootstrapPeers(),this._interval),s6("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){!this._timer||this._list.forEach(e=>{if(!cEt.P2P.matches(e))return s6.error("Invalid multiaddr");let r=new aEt(e),i=r.getPeerId();if(!i){s6.error("Invalid bootstrap multiaddr without peer id");return}let n=oEt.createFromB58String(i);try{this.emit("peer",{id:n,multiaddrs:[r]})}catch(s){s6.error("Invalid bootstrap peer id",s)}})}stop(){this._timer&&clearInterval(this._timer),this._timer=null}};vk=B6e.exports=q6e;vk.tag="bootstrap"});var wk=p((nFt,M6e)=>{f();"use strict";var Lt=vb(),lEt=wr().bind({ignoreUndefined:!0}),fEt=ae(),D6e=$ue(),hEt=Zue(),dEt=nle(),{create:pEt}=F0e(),{Multiaddr:yEt}=tt(),gEt=f2().version;M6e.exports=({options:t={},peerId:e,multiaddrs:r=[],repo:i,keychainConfig:n={},config:s={}})=>{let{datastore:o,keys:a}=i,c=bEt({options:t,config:s,datastore:o,keys:a,keychainConfig:n,peerId:e,multiaddrs:r});return typeof t.libp2p=="function"?t.libp2p({libp2pOptions:c,options:t,config:s,datastore:o,peerId:e}):Zve().create(c)};function bEt({options:t,config:e,datastore:r,keys:i,keychainConfig:n,peerId:s,multiaddrs:o}){let a=()=>{let m=Lt(e,"Pubsub.Router")||"gossipsub";if(!D6e[m])throw fEt(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${m} router.`),"ERR_NOT_SUPPORTED");return D6e[m]},c={datastore:r,peerId:s,modules:{}},l={modules:{pubsub:a(),contentRouting:[],peerRouting:[]},config:{peerDiscovery:{mdns:{enabled:Lt(t,"config.Discovery.MDNS.Enabled",Lt(e,"Discovery.MDNS.Enabled",!0))},webRTCStar:{enabled:Lt(t,"config.Discovery.webRTCStar.Enabled",Lt(e,"Discovery.webRTCStar.Enabled",!0))},bootstrap:{list:Lt(t,"config.Bootstrap",Lt(e,"Bootstrap",[]))}},relay:{enabled:Lt(t,"relay.enabled",Lt(e,"relay.enabled",!0)),hop:{enabled:Lt(t,"relay.hop.enabled",Lt(e,"relay.hop.enabled",!1)),active:Lt(t,"relay.hop.active",Lt(e,"relay.hop.active",!1))}},dht:{enabled:Lt(e,"Routing.Type","none")!=="none",clientMode:Lt(e,"Routing.Type","dht")!=="dhtserver",kBucketSize:Lt(t,"dht.kBucketSize",20)},pubsub:{enabled:Lt(t,"config.Pubsub.Enabled",Lt(e,"Pubsub.Enabled",!0))},nat:{enabled:!Lt(e,"Swarm.DisableNatPortMap",!1)}},addresses:{listen:o.map(m=>m.toString()),announce:Lt(t,"addresses.announce",Lt(e,"Addresses.Announce",[])),noAnnounce:Lt(t,"addresses.noAnnounce",Lt(e,"Addresses.NoAnnounce",[]))},connectionManager:Lt(t,"connectionManager",{maxConnections:Lt(t,"config.Swarm.ConnMgr.HighWater",Lt(e,"Swarm.ConnMgr.HighWater")),minConnections:Lt(t,"config.Swarm.ConnMgr.LowWater",Lt(e,"Swarm.ConnMgr.LowWater"))}),keychain:{datastore:i,...n},host:{agentVersion:`js-ipfs/${gEt}`}},u=O6e(),h=Lt(t,"libp2p",void 0);typeof h=="function"&&(h=void 0);let d=lEt(c,u(),l,h);Lt(d,"config.peerDiscovery.bootstrap.list",[]).length>0&&d.modules.peerDiscovery.push(N6e());let g=Lt(t,"config.Addresses.Delegates",Lt(e,"Addresses.Delegates",[]));if(g.length>0){let m=g[Math.floor(Math.random()*g.length)],E=new yEt(m).toOptions(),v={host:E.host,protocol:parseInt(E.port)===443?"https":"http",port:E.port},A=pEt(v);l.modules.contentRouting=l.modules.contentRouting||[],l.modules.contentRouting.push(new dEt(s,A)),l.modules.peerRouting=l.modules.peerRouting||[],l.modules.peerRouting.push(new hEt(A))}return d}});var V6e=p((sFt,j6e)=>{f();"use strict";var Am=me()("ipfs:components:peer:storage"),mEt=Xae(),vEt=P_(),{ERR_REPO_NOT_INITIALIZED:wEt}=Of().errors,_Et=ct(),EEt=Je(),_k=et(),L6e=wr().bind({ignoreUndefined:!0}),SEt=TT(),{NotEnabledError:xEt,NotInitializedError:AEt}=Qu(),U6e=wk(),o6=class{constructor(e,r,i,n,s){this.print=n,this.peerId=e,this.keychain=r,this.repo=i,this.print=n,this.isNew=s}static async start(e,r,i){let{repoAutoMigrate:n,repo:s,onMigrationProgress:o}=i,a=typeof s=="string"||s==null?mEt(e,r,{path:s,autoMigrate:n,onMigrationProgress:o}):s,{peerId:c,keychain:l,isNew:u}=await IEt(e,a,i);return new o6(c,l,a,e,u)}};j6e.exports=o6;var IEt=async(t,e,r)=>{if(!e.closed)return{...await F6e(e,r),isNew:!1};try{return await e.open(),{...await F6e(e,r),isNew:!1}}catch(i){if(i.code!==wEt)throw i;if(r.init&&r.init.allowNew===!1)throw new xEt("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await TEt(t,e,r),isNew:!0}}},TEt=async(t,e,r)=>{let i=r.init||{},n=await e.exists();if(Am("repo exists?",n),n===!0)throw new Error("repo already exists");let s=i.privateKey?await REt(i.privateKey):await PEt(t,i),o=CEt(s);Am("peer identity: %s",o.PeerID);let a={...L6e(K6e(vEt(),i.profiles),r.config),Identity:o};await e.init(a),await e.open(),Am("repo opened");let c={pass:r.pass};try{c.dek=await e.config.get("Keychain.DEK")}catch(u){if(u.code!=="ERR_NOT_FOUND")throw u}let l=await U6e({options:void 0,multiaddrs:void 0,peerId:s,repo:e,config:a,keychainConfig:c});return l.keychain&&l.keychain.opts&&(await l.loadKeychain(),await e.config.set("Keychain",{DEK:l.keychain.opts.dek})),{peerId:s,keychain:l.keychain}},REt=t=>(Am("using user-supplied private-key"),typeof t=="object"?t:_k.createFromPrivKey(_Et(t,"base64pad"))),PEt=(t,{algorithm:e="Ed25519",bits:r=2048})=>(t("generating %s keypair...",e),_k.create({keyType:e,bits:r})),CEt=t=>({PeerID:t.toB58String(),PrivKey:EEt(t.privKey.bytes,"base64pad")}),F6e=async(t,e)=>{let r=e.config,i=e.init&&e.init.profiles||[],n=e.pass,s=await t.config.getAll(),o=OEt(K6e(s,i),r);if(s!==o&&await t.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new AEt("No private key was found in the config, please intialize the repo");let a=await _k.createFromPrivKey(o.Identity.PrivKey),c=await U6e({options:void 0,multiaddrs:void 0,peerId:a,repo:t,config:o,keychainConfig:{pass:n,...o.Keychain}});return c.keychain&&await c.loadKeychain(),{peerId:a,keychain:c.keychain}},OEt=(t,e)=>e?L6e(t,e):t,K6e=(t,e)=>(e||[]).reduce((r,i)=>{let n=SEt.profiles[i];if(!n)throw new Error(`Could not find profile with name '${i}'`);return Am("applying profile %s",i),n.transform(r)},t)});var G6e=p((oFt,$6e)=>{f();$6e.exports=H6e;var z6e=128,kEt=127,qEt=~kEt,BEt=Math.pow(2,31);function H6e(t,e,r){e=e||[],r=r||0;for(var i=r;t>=BEt;)e[r++]=t&255|z6e,t/=128;for(;t&qEt;)e[r++]=t&255|z6e,t>>>=7;return e[r]=t|0,H6e.bytes=r-i+1,e}});var X6e=p((aFt,Y6e)=>{f();Y6e.exports=Ek;var NEt=128,W6e=127;function Ek(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o)throw Ek.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&W6e)<<i:(s&W6e)*Math.pow(2,i),i+=7}while(s>=NEt);return Ek.bytes=n-e,r}});var Z6e=p((cFt,Q6e)=>{f();var DEt=Math.pow(2,7),MEt=Math.pow(2,14),LEt=Math.pow(2,21),UEt=Math.pow(2,28),FEt=Math.pow(2,35),KEt=Math.pow(2,42),jEt=Math.pow(2,49),VEt=Math.pow(2,56),zEt=Math.pow(2,63);Q6e.exports=function(t){return t<DEt?1:t<MEt?2:t<LEt?3:t<UEt?4:t<FEt?5:t<KEt?6:t<jEt?7:t<VEt?8:t<zEt?9:10}});var exe=p((uFt,J6e)=>{f();J6e.exports={encode:G6e(),decode:X6e(),encodingLength:Z6e()}});var ixe=p((lFt,rxe)=>{f();"use strict";var txe=exe();rxe.exports=t=>{if(!(t instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;t.length>0;){let r=txe.decode(t);e.push(r),t=t.slice(txe.decode.bytes)}return e}});var oxe=p((fFt,sxe)=>{f();"use strict";var{base58btc:HEt}=(si(),ni),nxe=class{constructor(e,r,i){this._refCounter=1,this.cid=e,this.priority=r||1,this.wantType=i}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(HEt)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};sxe.exports=nxe});var Im=p((hFt,cxe)=>{f();"use strict";var axe=oxe(),{base58btc:a6}=(si(),ni),$Et=(t,e)=>Array.prototype.slice.call(e,0).sort((r,i)=>{let n=t(r),s=t(i);return n<s?-1:n>s?1:0}),Sk=class{constructor(e){this.set=new Map,this._stats=e}get length(){return this.set.size}add(e,r,i){let n=_y(),s=e.toString(a6),o=this.set.get(s);o?(o.inc(),o.priority=r,o.wantType===n.WantType.Have&&i===n.WantType.Block&&(o.wantType=i)):(this.set.set(s,new axe(e,r,i)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){let r=e.toString(a6),i=this.set.get(r);!i||(i.dec(),!i.hasRefs()&&(this.set.delete(r),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map($Et(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let r=e.toString(a6);return this.set.has(r)}get(e){let r=e.toString(a6);return this.set.get(r)}};Sk.Entry=axe;cxe.exports=Sk});var xk=p((pFt,uxe)=>{f();"use strict";var GEt=Im().Entry,{base58btc:WEt}=(si(),ni);uxe.exports=class{constructor(e,r,i,n,s){this.entry=new GEt(e,r,i),this.cancel=Boolean(n),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(WEt)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}});var Gl=p((yFt,hxe)=>{f();"use strict";var lxe=me(),YEt=yi(),fxe=xk(),XEt=(t,e)=>{let r=["bitswap"];return e&&r.push(e),t&&r.push(`${t.toB58String().slice(0,8)}`),Object.assign(lxe(r.join(":")),{error:lxe(r.concat(["error"]).join(":"))})},Ak=(t,e,r)=>{let i=0,n=r.length;for(;i<n;){if(t(e,r[i]))return!0;i+=1}return!1},QEt=(t,e)=>{let r=0,i=e.length,n=[],s;for(;r<i;)s=e[r],Ak(t,s,n)||(n[n.length]=s),r+=1;return n},ZEt=(t,e)=>e.reduce((r,i)=>{let n=t(i);return r[n]?r[n].push(i):r[n]=[i],r},{}),JEt=(t,e,r)=>e.filter(i=>!Ak(t,i,r)),eSt=(t,e)=>Array.prototype.slice.call(e,0).sort((r,i)=>{let n=t(r),s=t(i);return n<s?-1:n>s?1:0}),tSt=(t,e)=>{if(t.size!==e.size)return!1;for(let[r,i]of t){let n=e.get(r);if(n===void 0||i instanceof Uint8Array&&n instanceof Uint8Array&&!YEt(i,n)||i instanceof fxe&&n instanceof fxe&&!i.equals(n))return!1}return!0};hxe.exports={logger:XEt,includesWith:Ak,uniqWith:QEt,groupBy:ZEt,pullAllWith:JEt,sortBy:eSt,isMapEqual:tSt}});var pxe=p((gFt,dxe)=>{f();"use strict";var mc=Bi(),vc=mc.Reader,Tm=mc.Writer,Ut=mc.util,Tt=mc.roots["ipfs-bitswap"]||(mc.roots["ipfs-bitswap"]={});Tt.Message=function(){function t(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.wantlist=null,t.prototype.blocks=Ut.emptyArray,t.prototype.payload=Ut.emptyArray,t.prototype.blockPresences=Ut.emptyArray,t.prototype.pendingBytes=0,t.encode=function(r,i){if(i||(i=Tm.create()),r.wantlist!=null&&Object.hasOwnProperty.call(r,"wantlist")&&Tt.Message.Wantlist.encode(r.wantlist,i.uint32(10).fork()).ldelim(),r.blocks!=null&&r.blocks.length)for(var n=0;n<r.blocks.length;++n)i.uint32(18).bytes(r.blocks[n]);if(r.payload!=null&&r.payload.length)for(var n=0;n<r.payload.length;++n)Tt.Message.Block.encode(r.payload[n],i.uint32(26).fork()).ldelim();if(r.blockPresences!=null&&r.blockPresences.length)for(var n=0;n<r.blockPresences.length;++n)Tt.Message.BlockPresence.encode(r.blockPresences[n],i.uint32(34).fork()).ldelim();return r.pendingBytes!=null&&Object.hasOwnProperty.call(r,"pendingBytes")&&i.uint32(40).int32(r.pendingBytes),i},t.decode=function(r,i){r instanceof vc||(r=vc.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Tt.Message;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.wantlist=Tt.Message.Wantlist.decode(r,r.uint32());break;case 2:s.blocks&&s.blocks.length||(s.blocks=[]),s.blocks.push(r.bytes());break;case 3:s.payload&&s.payload.length||(s.payload=[]),s.payload.push(Tt.Message.Block.decode(r,r.uint32()));break;case 4:s.blockPresences&&s.blockPresences.length||(s.blockPresences=[]),s.blockPresences.push(Tt.Message.BlockPresence.decode(r,r.uint32()));break;case 5:s.pendingBytes=r.int32();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Tt.Message)return r;var i=new Tt.Message;if(r.wantlist!=null){if(typeof r.wantlist!="object")throw TypeError(".Message.wantlist: object expected");i.wantlist=Tt.Message.Wantlist.fromObject(r.wantlist)}if(r.blocks){if(!Array.isArray(r.blocks))throw TypeError(".Message.blocks: array expected");i.blocks=[];for(var n=0;n<r.blocks.length;++n)typeof r.blocks[n]=="string"?Ut.base64.decode(r.blocks[n],i.blocks[n]=Ut.newBuffer(Ut.base64.length(r.blocks[n])),0):r.blocks[n].length&&(i.blocks[n]=r.blocks[n])}if(r.payload){if(!Array.isArray(r.payload))throw TypeError(".Message.payload: array expected");i.payload=[];for(var n=0;n<r.payload.length;++n){if(typeof r.payload[n]!="object")throw TypeError(".Message.payload: object expected");i.payload[n]=Tt.Message.Block.fromObject(r.payload[n])}}if(r.blockPresences){if(!Array.isArray(r.blockPresences))throw TypeError(".Message.blockPresences: array expected");i.blockPresences=[];for(var n=0;n<r.blockPresences.length;++n){if(typeof r.blockPresences[n]!="object")throw TypeError(".Message.blockPresences: object expected");i.blockPresences[n]=Tt.Message.BlockPresence.fromObject(r.blockPresences[n])}}return r.pendingBytes!=null&&(i.pendingBytes=r.pendingBytes|0),i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocks=[],n.payload=[],n.blockPresences=[]),i.defaults&&(n.wantlist=null,n.pendingBytes=0),r.wantlist!=null&&r.hasOwnProperty("wantlist")&&(n.wantlist=Tt.Message.Wantlist.toObject(r.wantlist,i)),r.blocks&&r.blocks.length){n.blocks=[];for(var s=0;s<r.blocks.length;++s)n.blocks[s]=i.bytes===String?Ut.base64.encode(r.blocks[s],0,r.blocks[s].length):i.bytes===Array?Array.prototype.slice.call(r.blocks[s]):r.blocks[s]}if(r.payload&&r.payload.length){n.payload=[];for(var s=0;s<r.payload.length;++s)n.payload[s]=Tt.Message.Block.toObject(r.payload[s],i)}if(r.blockPresences&&r.blockPresences.length){n.blockPresences=[];for(var s=0;s<r.blockPresences.length;++s)n.blockPresences[s]=Tt.Message.BlockPresence.toObject(r.blockPresences[s],i)}return r.pendingBytes!=null&&r.hasOwnProperty("pendingBytes")&&(n.pendingBytes=r.pendingBytes),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,mc.util.toJSONOptions)},t.Wantlist=function(){function e(r){if(this.entries=[],r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.entries=Ut.emptyArray,e.prototype.full=!1,e.encode=function(i,n){if(n||(n=Tm.create()),i.entries!=null&&i.entries.length)for(var s=0;s<i.entries.length;++s)Tt.Message.Wantlist.Entry.encode(i.entries[s],n.uint32(10).fork()).ldelim();return i.full!=null&&Object.hasOwnProperty.call(i,"full")&&n.uint32(16).bool(i.full),n},e.decode=function(i,n){i instanceof vc||(i=vc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Tt.Message.Wantlist;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.entries&&o.entries.length||(o.entries=[]),o.entries.push(Tt.Message.Wantlist.Entry.decode(i,i.uint32()));break;case 2:o.full=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Tt.Message.Wantlist)return i;var n=new Tt.Message.Wantlist;if(i.entries){if(!Array.isArray(i.entries))throw TypeError(".Message.Wantlist.entries: array expected");n.entries=[];for(var s=0;s<i.entries.length;++s){if(typeof i.entries[s]!="object")throw TypeError(".Message.Wantlist.entries: object expected");n.entries[s]=Tt.Message.Wantlist.Entry.fromObject(i.entries[s])}}return i.full!=null&&(n.full=Boolean(i.full)),n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.entries=[]),n.defaults&&(s.full=!1),i.entries&&i.entries.length){s.entries=[];for(var o=0;o<i.entries.length;++o)s.entries[o]=Tt.Message.Wantlist.Entry.toObject(i.entries[o],n)}return i.full!=null&&i.hasOwnProperty("full")&&(s.full=i.full),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,mc.util.toJSONOptions)},e.WantType=function(){var r={},i=Object.create(r);return i[r[0]="Block"]=0,i[r[1]="Have"]=1,i}(),e.Entry=function(){function r(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return r.prototype.block=Ut.newBuffer([]),r.prototype.priority=0,r.prototype.cancel=!1,r.prototype.wantType=0,r.prototype.sendDontHave=!1,r.encode=function(n,s){return s||(s=Tm.create()),n.block!=null&&Object.hasOwnProperty.call(n,"block")&&s.uint32(10).bytes(n.block),n.priority!=null&&Object.hasOwnProperty.call(n,"priority")&&s.uint32(16).int32(n.priority),n.cancel!=null&&Object.hasOwnProperty.call(n,"cancel")&&s.uint32(24).bool(n.cancel),n.wantType!=null&&Object.hasOwnProperty.call(n,"wantType")&&s.uint32(32).int32(n.wantType),n.sendDontHave!=null&&Object.hasOwnProperty.call(n,"sendDontHave")&&s.uint32(40).bool(n.sendDontHave),s},r.decode=function(n,s){n instanceof vc||(n=vc.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Tt.Message.Wantlist.Entry;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.block=n.bytes();break;case 2:a.priority=n.int32();break;case 3:a.cancel=n.bool();break;case 4:a.wantType=n.int32();break;case 5:a.sendDontHave=n.bool();break;default:n.skipType(c&7);break}}return a},r.fromObject=function(n){if(n instanceof Tt.Message.Wantlist.Entry)return n;var s=new Tt.Message.Wantlist.Entry;switch(n.block!=null&&(typeof n.block=="string"?Ut.base64.decode(n.block,s.block=Ut.newBuffer(Ut.base64.length(n.block)),0):n.block.length&&(s.block=n.block)),n.priority!=null&&(s.priority=n.priority|0),n.cancel!=null&&(s.cancel=Boolean(n.cancel)),n.wantType){case"Block":case 0:s.wantType=0;break;case"Have":case 1:s.wantType=1;break}return n.sendDontHave!=null&&(s.sendDontHave=Boolean(n.sendDontHave)),s},r.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.block="":(o.block=[],s.bytes!==Array&&(o.block=Ut.newBuffer(o.block))),o.priority=0,o.cancel=!1,o.wantType=s.enums===String?"Block":0,o.sendDontHave=!1),n.block!=null&&n.hasOwnProperty("block")&&(o.block=s.bytes===String?Ut.base64.encode(n.block,0,n.block.length):s.bytes===Array?Array.prototype.slice.call(n.block):n.block),n.priority!=null&&n.hasOwnProperty("priority")&&(o.priority=n.priority),n.cancel!=null&&n.hasOwnProperty("cancel")&&(o.cancel=n.cancel),n.wantType!=null&&n.hasOwnProperty("wantType")&&(o.wantType=s.enums===String?Tt.Message.Wantlist.WantType[n.wantType]:n.wantType),n.sendDontHave!=null&&n.hasOwnProperty("sendDontHave")&&(o.sendDontHave=n.sendDontHave),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,mc.util.toJSONOptions)},r}(),e}(),t.Block=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.prefix=Ut.newBuffer([]),e.prototype.data=Ut.newBuffer([]),e.encode=function(i,n){return n||(n=Tm.create()),i.prefix!=null&&Object.hasOwnProperty.call(i,"prefix")&&n.uint32(10).bytes(i.prefix),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&n.uint32(18).bytes(i.data),n},e.decode=function(i,n){i instanceof vc||(i=vc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Tt.Message.Block;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.prefix=i.bytes();break;case 2:o.data=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Tt.Message.Block)return i;var n=new Tt.Message.Block;return i.prefix!=null&&(typeof i.prefix=="string"?Ut.base64.decode(i.prefix,n.prefix=Ut.newBuffer(Ut.base64.length(i.prefix)),0):i.prefix.length&&(n.prefix=i.prefix)),i.data!=null&&(typeof i.data=="string"?Ut.base64.decode(i.data,n.data=Ut.newBuffer(Ut.base64.length(i.data)),0):i.data.length&&(n.data=i.data)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.prefix="":(s.prefix=[],n.bytes!==Array&&(s.prefix=Ut.newBuffer(s.prefix))),n.bytes===String?s.data="":(s.data=[],n.bytes!==Array&&(s.data=Ut.newBuffer(s.data)))),i.prefix!=null&&i.hasOwnProperty("prefix")&&(s.prefix=n.bytes===String?Ut.base64.encode(i.prefix,0,i.prefix.length):n.bytes===Array?Array.prototype.slice.call(i.prefix):i.prefix),i.data!=null&&i.hasOwnProperty("data")&&(s.data=n.bytes===String?Ut.base64.encode(i.data,0,i.data.length):n.bytes===Array?Array.prototype.slice.call(i.data):i.data),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,mc.util.toJSONOptions)},e}(),t.BlockPresenceType=function(){var e={},r=Object.create(e);return r[e[0]="Have"]=0,r[e[1]="DontHave"]=1,r}(),t.BlockPresence=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.cid=Ut.newBuffer([]),e.prototype.type=0,e.encode=function(i,n){return n||(n=Tm.create()),i.cid!=null&&Object.hasOwnProperty.call(i,"cid")&&n.uint32(10).bytes(i.cid),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(16).int32(i.type),n},e.decode=function(i,n){i instanceof vc||(i=vc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Tt.Message.BlockPresence;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.cid=i.bytes();break;case 2:o.type=i.int32();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Tt.Message.BlockPresence)return i;var n=new Tt.Message.BlockPresence;switch(i.cid!=null&&(typeof i.cid=="string"?Ut.base64.decode(i.cid,n.cid=Ut.newBuffer(Ut.base64.length(i.cid)),0):i.cid.length&&(n.cid=i.cid)),i.type){case"Have":case 0:n.type=0;break;case"DontHave":case 1:n.type=1;break}return n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.cid="":(s.cid=[],n.bytes!==Array&&(s.cid=Ut.newBuffer(s.cid))),s.type=n.enums===String?"Have":0),i.cid!=null&&i.hasOwnProperty("cid")&&(s.cid=n.bytes===String?Ut.base64.encode(i.cid,0,i.cid.length):n.bytes===Array?Array.prototype.slice.call(i.cid):i.cid),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?Tt.Message.BlockPresenceType[i.type]:i.type),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,mc.util.toJSONOptions)},e}(),t}();dxe.exports=Tt});var _y=p((bFt,gxe)=>{f();"use strict";var{CID:Ey}=(Bu(),dd),{sha256:Ik}=(ai(),$r),{base58btc:Rm}=(si(),ni),rSt=ixe(),{isMapEqual:Tk}=Gl(),{Message:wu}=pxe(),yxe=xk(),iSt=un(),nSt=ae(),_n=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,r,i,n,s){i==null&&(i=_n.WantType.Block);let o=e.toString(Rm),a=this.wantlist.get(o);a?(a.wantType===i&&(a.priority=r),n&&(a.cancel=Boolean(n)),s&&(a.sendDontHave=Boolean(s)),i===_n.WantType.Block&&a.wantType===_n.WantType.Have&&(a.wantType=i)):this.wantlist.set(o,new yxe(e,r,i,n,s))}addBlock(e,r){let i=e.toString(Rm);this.blocks.set(i,r)}addHave(e){let r=e.toString(Rm);this.blockPresences.has(r)||this.blockPresences.set(r,_n.BlockPresenceType.Have)}addDontHave(e){let r=e.toString(Rm);this.blockPresences.has(r)||this.blockPresences.set(r,_n.BlockPresenceType.DontHave)}cancel(e){let r=e.toString(Rm);this.wantlist.delete(r),this.addEntry(e,0,_n.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(r=>({block:r.cid.bytes,priority:Number(r.priority),cancel:Boolean(r.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return wu.encode(e).finish()}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(r=>({block:r.cid.bytes,priority:Number(r.priority),wantType:r.wantType,cancel:Boolean(r.cancel),sendDontHave:Boolean(r.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(let[r,i]of this.blocks.entries()){let n=Ey.parse(r),s=Uint8Array.from([n.code]),o=n.multihash.bytes.subarray(0,2),a=iSt([[n.version],s,o],1+s.byteLength+o.byteLength);e.payload.push(new wu.Block({prefix:a,data:i}))}for(let[r,i]of this.blockPresences)e.blockPresences.push(new wu.BlockPresence({cid:Ey.parse(r).bytes,type:i}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),wu.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!Tk(this.wantlist,e.wantlist)||!Tk(this.blocks,e.blocks)||!Tk(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),r=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${r}>`}};_n.deserialize=async(t,e={})=>{let r=wu.decode(t),i=r.wantlist&&r.wantlist.full||!1,n=new _n(i);return r.wantlist&&r.wantlist.entries&&r.wantlist.entries.forEach(s=>{if(!s.block)return;let o=Ey.decode(s.block);n.addEntry(o,s.priority||0,s.wantType,Boolean(s.cancel),Boolean(s.sendDontHave))}),r.blockPresences&&r.blockPresences.forEach(s=>{if(!s.cid)return;let o=Ey.decode(s.cid);s.type===_n.BlockPresenceType.Have?n.addHave(o):n.addDontHave(o)}),r.blocks.length>0?(await Promise.all(r.blocks.map(async s=>{let o=await Ik.digest(s),a=Ey.createV0(o);n.addBlock(a,s)})),n):(r.payload.length>0&&(await Promise.all(r.payload.map(async s=>{if(!s.prefix||!s.data)return;let o=rSt(s.prefix),a=o[0],c=o[1],l=o[2],u=l===Ik.code?Ik:e[l];if(!u)throw nSt(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");let h=await u.digest(s.data),d=Ey.create(a,c,h);n.addBlock(d,s.data)})),n.setPendingBytes(r.pendingBytes)),n)};_n.blockPresenceSize=t=>t.bytes.length+1;_n.Entry=yxe;_n.WantType={Block:wu.Wantlist.WantType.Block,Have:wu.Wantlist.WantType.Have};_n.BlockPresenceType={Have:wu.BlockPresenceType.Have,DontHave:wu.BlockPresenceType.DontHave};gxe.exports=_n});var Pm=p((mFt,bxe)=>{f();"use strict";var Rk=1e3;bxe.exports={maxProvidersPerRequest:3,providerRequestTimeout:10*Rk,hasBlockTimeout:15*Rk,provideTimeout:15*Rk,kMaxPriority:Math.pow(2,31)-1,maxListeners:1e3,wantlistSendDebounceMs:1}});var vxe=p((vFt,mxe)=>{f();mxe.exports=sSt;function sSt(t,e,r){var i=null,n=null,s=function(){i&&(clearTimeout(i),n=null,i=null)},o=function(){var c=n;s(),c&&c()},a=function(){if(!e)return t.apply(this,arguments);var c=this,l=arguments,u=r&&!i;if(s(),n=function(){t.apply(c,l)},i=setTimeout(function(){if(i=null,!u){var h=n;return n=null,h()}},e),u)return n()};return a.cancel=s,a.flush=o,a}});var _xe=p((_Ft,wxe)=>{f();"use strict";var oSt=vxe(),aSt=_y(),cSt=Gl().logger,{wantlistSendDebounceMs:uSt}=Pm();wxe.exports=class{constructor(e,r,i){this.peerId=r,this.network=i,this.refcnt=1,this._entries=[],this._log=cSt(e,"msgqueue"),this.sendEntries=oSt(this._sendEntries.bind(this),uSt)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let e=new aSt(!1);this._entries.forEach(r=>{r.cancel?e.cancel(r.cid):e.addEntry(r.cid,r.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(r){this._log.error("cant connect to peer %s: %s",this.peerId.toB58String(),r.message);return}this._log("sending message to peer %s",this.peerId.toB58String()),this.network.sendMessage(this.peerId,e).catch(r=>{this._log.error("send error: %s",r.message)})}}});var Sxe=p((SFt,Exe)=>{f();"use strict";var Pk=_y(),lSt=Im(),fSt=Pm(),hSt=_xe(),dSt=Gl().logger,{base58btc:pSt}=(si(),ni);Exe.exports=class{constructor(e,r,i){this.peers=new Map,this.wantlist=new lSt(i),this.network=r,this._stats=i,this._peerId=e,this._log=dSt(e,"want")}_addEntries(e,r,i){let n=e.map((s,o)=>new Pk.Entry(s,fSt.kMaxPriority-o,Pk.WantType.Block,r));n.forEach(s=>{s.cancel?i?this.wantlist.removeForce(s.cid.toString(pSt)):this.wantlist.remove(s.cid):(this._log("adding to wl"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(n)}_startPeerHandler(e){let r=this.peers.get(e.toB58String());if(r){r.refcnt++;return}r=new hSt(this._peerId,e,this.network);let i=new Pk(!0);for(let n of this.wantlist.entries())i.addEntry(n[1].cid,n[1].priority);return r.addMessage(i),this.peers.set(e.toB58String(),r),r}_stopPeerHandler(e){let r=this.peers.get(e.toB58String());!r||(r.refcnt--,!(r.refcnt>0)&&this.peers.delete(e.toB58String()))}wantBlocks(e,r={}){this._addEntries(e,!1),r&&r.signal&&r.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}}});var Pxe=p((xFt,Rxe)=>{f();"use strict";var xxe=$o(),{pipe:Axe}=Pr(),ySt=kE(),gSt=_y(),Ixe=Pm(),bSt=Gl().logger,Ck="/ipfs/bitswap/1.0.0",Ok="/ipfs/bitswap/1.1.0",kk="/ipfs/bitswap/1.2.0",Txe=class{constructor(e,r,i,n={}){this._log=bSt(e.peerId,"network"),this._libp2p=e,this._bitswap=r,this._protocols=[Ck],n.b100Only||(this._protocols.unshift(Ok),this._protocols.unshift(kk)),this._stats=i,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashers=n.hashers||{}}start(){this._running=!0,this._libp2p.handle(this._protocols,this._onConnection);let e=new ySt({multicodecs:this._protocols,handlers:{onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect}});this._registrarId=this._libp2p.registrar.register(e);for(let r of this._libp2p.peerStore.peers.values()){let i=this._libp2p.connectionManager.get(r.id);i&&this._onPeerConnect(i.remotePeer)}}stop(){this._running=!1,this._libp2p.unhandle(this._protocols),this._registrarId!=null&&this._libp2p.registrar.unregister(this._registrarId)}async _onConnection({protocol:e,stream:r,connection:i}){if(!!this._running){this._log("incoming new bitswap %s connection from %s",e,i.remotePeer.toB58String());try{await Axe(r,xxe.decode(),async n=>{for await(let s of n)try{let o=await gSt.deserialize(s.slice(),this._hashers);await this._bitswap._receiveMessage(i.remotePeer,o)}catch(o){this._bitswap._receiveError(o);break}})}catch(n){this._log(n)}}}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,r,i={}){return this._libp2p.contentRouting.findProviders(e,{timeout:Ixe.providerRequestTimeout,maxNumProviders:r})}async findAndConnect(e,r){let i=[];for await(let n of this.findProviders(e,Ixe.maxProvidersPerRequest,r))this._log(`connecting to provider ${n.id}`),i.push(this.connectTo(n.id,r).catch(s=>{this._log.error(s)}));await Promise.all(i)}async provide(e,r){await this._libp2p.contentRouting.provide(e,r)}async sendMessage(e,r){if(!this._running)throw new Error("network isn't running");let i=e.toB58String();this._log("sendMessage to %s",i,r);let n=await this._libp2p.dial(e),{stream:s,protocol:o}=await n.newStream([kk,Ok,Ck]),a;switch(o){case Ck:a=r.serializeToBitswap100();break;case Ok:case kk:a=r.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+o)}mSt(s,a,this._log),this._updateSentStats(e,r.blocks)}async connectTo(e,r){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,r)}_updateSentStats(e,r){let i=e.toB58String();if(this._stats){for(let n of r.values())this._stats.push(i,"dataSent",n.length);this._stats.push(i,"blocksSent",r.size)}}};async function mSt(t,e,r){try{await Axe([e],xxe.encode(),t)}catch(i){r(i)}}Rxe.exports=Txe});var kxe=p((AFt,Oxe)=>{f();"use strict";var vSt=Im(),Cxe=class{constructor(e){this.partner=e,this.wantlist=new vSt,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,r,i){this.wantlist.add(e,r,i)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};Oxe.exports=Cxe});var Nxe=p((IFt,Bxe)=>{f();"use strict";var qxe=class extends Map{constructor(e,r){super();this._cmp=r||this._defaultSort,this._keys=[];for(let[i,n]of e||[])this.set(i,n)}update(e){if(e<0||e>=this._keys.length)return;let r=this._keys[e];this._keys.splice(e,1);let i=this._find(r);this._keys.splice(i,0,r)}set(e,r){if(this.has(e)){let n=this.indexOf(e);this._keys.splice(n,1)}super.set(e,r);let i=this._find(e);return this._keys.splice(i,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let r=this.indexOf(e);return this._keys.splice(r,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let r=this._find(e);if(this._keys[r]===e)return r;for(let i=1;i<this._keys.length;i++){if(this._keys[r+i]===e)return r+i;if(this._keys[r-i]===e)return r-i}return-1}_find(e){let r=0,i=this._keys.length;for(;r<i;){let n=r+i>>>1,s=this._kCmp(this._keys[n],e);if(s<0)r=n+1;else if(s>0)i=n;else return n}return r}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,r){if(!!e)for(let i of this._keys)e.apply(r,[[i,this.get(i)]])}_defaultSort(e,r){return e[0]<r[0]?-1:r[0]<e[0]?1:0}_kCmp(e,r){return this._cmp([e,this.get(e)],[r,this.get(r)])}};Bxe.exports=qxe});var Fxe=p((TFt,Uxe)=>{f();"use strict";var Dxe=Nxe(),wSt={hasNewInfo(){return!1},merge(){}},Mxe=class{constructor(e=wSt){this._taskMerger=e,this._byPeer=new Dxe([],qk.compare)}pushTasks(e,r){let i=this._byPeer.get(e.toB58String());i||(i=new qk(e,this._taskMerger)),i.pushTasks(r),this._byPeer.set(e.toB58String(),i)}popTasks(e){let r=this._head();if(r===void 0)return{tasks:[],pendingSize:0};let{tasks:i,pendingSize:n}=r.popTasks(e);if(i.length===0)return{tasks:i,pendingSize:n};let s=r.peerId;return r.isIdle()?this._byPeer.delete(s.toB58String()):this._byPeer.update(0),{peerId:s,tasks:i,pendingSize:n}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,r){let i=this._byPeer.get(r.toB58String());i&&i.remove(e)}tasksDone(e,r){let i=this._byPeer.get(e.toB58String());if(!i)return;let n=this._byPeer.indexOf(e.toB58String());for(let s of r)i.taskDone(s);this._byPeer.update(n)}},qk=class{constructor(e,r){this.peerId=e,this._taskMerger=r,this._activeTotalSize=0,this._pending=new Lxe,this._active=new Set}pushTasks(e){for(let r of e)this._pushTask(r)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let r=this._pending.get(e.topic);if(r){e.priority>r.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,r);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let r=[];for(let i of this._active)i.topic===e.topic&&r.push(i);return r.length===0?!0:this._taskMerger.hasNewInfo(e,r)}popTasks(e){let r=0,i=[],n=this._pending.tasks();for(let s=0;s<n.length&&r<e;s++){let o=n[s];i.push(o),r+=o.size,this._pending.delete(o.topic),this._activeTotalSize+=o.size,this._active.add(o)}return{tasks:i,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,r){return e[1]._pending.length===0?1:r[1]._pending.length===0?-1:e[1]._activeTotalSize===r[1]._activeTotalSize?r[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-r[1]._activeTotalSize}},Lxe=class{constructor(){this._tasks=new Dxe([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,r)=>e+r.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,r){let i=this._tasks.get(e);if(!i)return;let n=this._tasks.indexOf(e);i.task.priority=r,this._tasks.update(n)}_compare(e,r){return e[1].task.priority===r[1].task.priority?e[1].created-r[1].created:r[1].task.priority-e[1].task.priority}};Uxe.exports=Mxe});var jxe=p((RFt,Kxe)=>{f();"use strict";var _St={hasNewInfo(t,e){let r=!1,i=!1;for(let n of e)n.data.haveBlock&&(r=!0),n.data.isWantBlock&&(i=!0);return!!(!i&&t.data.isWantBlock||!r&&t.data.haveBlock)},merge(t,e){let r=t.data,i=e.data;!i.haveBlock&&r.haveBlock&&(i.haveBlock=r.haveBlock,i.blockSize=r.blockSize),!i.isWantBlock&&r.isWantBlock&&(i.isWantBlock=!0,(!i.haveBlock||r.haveBlock)&&(i.haveBlock=r.haveBlock,e.size=t.size)),i.isWantBlock&&i.haveBlock&&(e.size=i.blockSize)}};Kxe.exports=_St});var $xe=p((PFt,Hxe)=>{f();"use strict";var{CID:Bk}=(Bu(),dd),{base58btc:c6}=(si(),ni),Cm=_y(),Vxe=Cm.WantType,ESt=Im(),SSt=kxe(),xSt=Fxe(),ASt=jxe(),{logger:ISt}=Gl(),TSt=16*1024,RSt=1024,zxe=class{constructor(e,r,i,n,s={}){this._log=ISt(e,"engine"),this.blockstore=r,this.network=i,this._stats=n,this._opts=this._processOpts(s),this.ledgerMap=new Map,this._running=!1,this._requestQueue=new xSt(ASt)}_processOpts(e){return{maxSizeReplaceHasWithBlock:RSt,targetMessageSize:TSt,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:r,pendingSize:i}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(r.length===0)return;let n=new Cm(!1);n.setPendingBytes(i);let s=[],o=new Map;for(let c of r){let l=Bk.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(s.push(l),o.set(c.topic,c.data)):n.addHave(l):n.addDontHave(l)}let a=await this._getBlocks(s);for(let[c,l]of o){let u=Bk.parse(c),h=a.get(c);h?n.addBlock(u,h):l.sendDontHave&&n.addDontHave(u)}if(n.empty){e&&this._requestQueue.tasksDone(e,r),this._scheduleProcessTasks();return}try{e&&await this.network.sendMessage(e,n);for(let[c,l]of a.entries())e&&this.messageSent(e,Bk.parse(c),l)}catch(c){this._log.error(c)}e&&this._requestQueue.tasksDone(e,r),this._scheduleProcessTasks()}wantlistForPeer(e){let r=e.toB58String(),i=this.ledgerMap.get(r);return i?i.wantlist.sortedEntries():new Map}ledgerForPeer(e){let r=e.toB58String(),i=this.ledgerMap.get(r);return i?{peer:i.partner,value:i.debtRatio(),sent:i.accounting.bytesSent,recv:i.accounting.bytesRecv,exchanged:i.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(!!e.length){for(let r of this.ledgerMap.values())for(let i of e){let n=r.wantlistContains(i.cid);if(!n)continue;let s=i.data.length,o=this._sendAsBlock(n.wantType,s),a=s;o||(a=Cm.blockPresenceSize(n.cid)),this._requestQueue.pushTasks(r.partner,[{topic:n.cid.toString(c6),priority:n.priority,size:a,data:{blockSize:s,isWantBlock:o,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,r){let i=this._findOrCreate(e);if(r.empty)return;if(r.full&&(i.wantlist=new ESt),this._updateBlockAccounting(r.blocks,i),r.wantlist.size===0){this._scheduleProcessTasks();return}let n=[],s=[];r.wantlist.forEach(o=>{o.cancel?(i.cancelWant(o.cid),n.push(o.cid)):(i.wants(o.cid,o.priority,o.wantType),s.push(o))}),this._cancelWants(e,n),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,r){for(let i of r)this._requestQueue.remove(i.toString(c6),e)}async _addWants(e,r){let i=await this._getBlockSizes(r.map(s=>s.cid)),n=[];for(let s of r){let o=s.cid.toString(c6),a=i.get(o);if(a==null)s.sendDontHave&&n.push({topic:o,priority:s.priority,size:Cm.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===Vxe.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{let c=this._sendAsBlock(s.wantType,a),l=a;c||(l=Cm.blockPresenceSize(s.cid)),n.push({topic:o,priority:s.priority,size:l,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,r){return e===Vxe.Block||r<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let r=await this._getBlocks(e);return new Map([...r].map(([i,n])=>[i,n.length]))}async _getBlocks(e){let r=new Map;return await Promise.all(e.map(async i=>{try{let n=await this.blockstore.get(i);r.set(i.toString(c6),n)}catch(n){n.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",i,n)}})),r}_updateBlockAccounting(e,r){for(let i of e.values())this._log("got block (%s bytes)",i.length),r.receivedBytes(i.length)}messageSent(e,r,i){let n=this._findOrCreate(e);n.sentBytes(i.length),n.wantlist.remove(r)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){}_findOrCreate(e){let r=e.toB58String(),i=this.ledgerMap.get(r);if(i)return i;let n=new SSt(e);return this.ledgerMap.set(r,n),this._stats&&this._stats.push(r,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}};Hxe.exports=zxe});var Zxe=p((CFt,Qxe)=>{f();"use strict";var{EventEmitter:PSt}=vr(),Gxe=Je(),CSt=Pm(),OSt=Gl().logger,Wxe=t=>`unwant:${Gxe(t.multihash.bytes,"base64")}`,Yxe=t=>`block:${Gxe(t.multihash.bytes,"base64")}`,Xxe=class extends PSt{constructor(e){super();this.setMaxListeners(CSt.maxListeners),this._log=OSt(e,"notif")}hasBlock(e,r){let i=Yxe(e);this._log(i),this.emit(i,r)}wantBlock(e,r={}){if(!e)throw new Error("Not a valid cid");let i=Yxe(e),n=Wxe(e);return this._log(`wantBlock:${e}`),new Promise((s,o)=>{let a=()=>{this.removeListener(i,c),o(new Error(`Block for ${e} unwanted`))},c=l=>{this.removeListener(n,a),s(l)};this.once(n,a),this.once(i,c),r&&r.signal&&r.signal.addEventListener("abort",()=>{this.removeListener(i,c),this.removeListener(n,a),o(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let r=Wxe(e);this._log(r),this.emit(r)}};Qxe.exports=Xxe});var rAe=p((OFt,tAe)=>{f();"use strict";var{EventEmitter:kSt}=vr(),Jxe=YP(),eAe=class extends kSt{constructor(e,r){super();this._options=r,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(i=>{this._stats[i]=BigInt(0),this._movingAverages[i]={},this._options.movingAverageIntervals.forEach(n=>{(this._movingAverages[i][n]=Jxe(n)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,r){this._enabled&&(this._queue.push([e,r,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){let r=e=this._queue.shift();r&&this._applyOp(r)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;r&&Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let s=n/r*1e3,o=this._movingAverages[e];o||(o=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=o[a];c||(c=o[a]=Jxe(a)),c.push(i,s)})}_applyOp(e){let r=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);Object.prototype.hasOwnProperty.call(this._stats,r)||(this._stats[r]=BigInt(0)),this._stats[r]=BigInt(this._stats[r])+BigInt(i),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=i}};tAe.exports=eAe});var aAe=p((kFt,oAe)=>{f();"use strict";var{EventEmitter:qSt}=vr(),iAe=rAe(),nAe={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},sAe=class extends qSt{constructor(e=[],r=nAe){super();let i=Object.assign({},nAe,r);if(typeof i.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof i.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=e,this._options=i,this._enabled=this._options.enabled,this._global=new iAe(e,i),this._global.on("update",n=>this.emit("update",n)),this._peers=new Map}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let r=typeof e!="string"&&e.toB58String?e.toB58String():`${e}`;return this._peers.get(r)}push(e,r,i){if(this._enabled&&(this._global.push(r,i),e)){let n=this._peers.get(e);n||(n=new iAe(this._initialCounters,this._options),this._peers.set(e,n)),n.push(r,i)}}disconnected(e){let r=e.toB58String(),i=this._peers.get(r);i&&(i.stop(),this._peers.delete(r))}};oAe.exports=sAe});var lAe=p((qFt,uAe)=>{f();"use strict";var BSt=Sxe(),NSt=Pxe(),DSt=$xe(),MSt=Zxe(),LSt=Gl().logger,USt=aAe(),{AbortController:FSt}=sn(),{anySignal:KSt}=Zl(),{BlockstoreAdapter:jSt}=OE(),{CID:VSt}=(Bu(),dd),zSt={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},HSt=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],cAe=class extends jSt{constructor(e,r,i={}){super();this._libp2p=e,this._log=LSt(this.peerId),this._options=Object.assign({},zSt,i),this._stats=new USt(HSt,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new NSt(e,this,this._stats,{hashers:i.hashers}),this.blockstore=r,this.engine=new DSt(this.peerId,r,this.network,this._stats),this.wm=new BSt(this.peerId,this.network,this._stats),this.notifications=new MSt(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,r){try{await this.engine.messageReceived(e,r)}catch(n){this._log("failed to receive message",r)}if(r.blocks.size===0)return;let i=[];for(let[n,s]of r.blocks.entries()){let o=VSt.parse(n);i.push({wasWanted:this.wm.wantlist.contains(o),cid:o,data:s})}this.wm.cancelWants(i.filter(({wasWanted:n})=>n).map(({cid:n})=>n)),await Promise.all(i.map(({cid:n,wasWanted:s,data:o})=>this._handleReceivedBlock(e,n,o,s)))}async _handleReceivedBlock(e,r,i,n){this._log("received block");let s=await this.blockstore.has(r);this._updateReceiveCounters(e.toB58String(),r,i,s),!!n&&await this.put(r,i)}_updateReceiveCounters(e,r,i,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",i.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",i.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,r){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,r={}){let i=(l,u)=>(this.wm.wantBlocks([l],u),this.notifications.wantBlock(l,u)),n=!1,s=async(l,u)=>{try{return await this.blockstore.get(l,u)}catch(h){if(h.code!=="ERR_NOT_FOUND")throw h;return n||(n=!0,this.network.findAndConnect(l).catch(d=>this._log.error(d))),i(l,u)}},o=new FSt,a=r.signal?KSt([r.signal,o.signal]):o.signal,c=await Promise.race([this.notifications.wantBlock(e,{signal:a}),s(e,{signal:a})]);return o.abort(),c}async*getMany(e,r={}){for await(let i of e)yield this.get(i,r)}unwant(e){let r=Array.isArray(e)?e:[e];this.wm.unwantBlocks(r),r.forEach(i=>this.notifications.unwantBlock(i))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,r,i){await this.blockstore.put(e,r),this._sendHaveBlockNotifications(e,r)}async*putMany(e,r){for await(let{key:i,value:n}of this.blockstore.putMany(e,r))this._sendHaveBlockNotifications(i,n),yield{key:i,value:n}}_sendHaveBlockNotifications(e,r){this.notifications.hasBlock(e,r),this.engine.receivedBlocks([{cid:e,data:r}]),this.network.provide(e).catch(i=>{this._log.error("Failed to provide: %s",i.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}start(){this.wm.start(),this.network.start(),this.engine.start(),this.started=!0}stop(){this._stats.stop(),this.wm.stop(),this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}};uAe.exports=cAe});var hAe=p((BFt,fAe)=>{f();"use strict";var $St=lAe(),GSt=(t,e,r={})=>new $St(t,e,r);fAe.exports={createBitswap:GSt}});var gAe=p((NFt,yAe)=>{f();"use strict";var{BlockstoreAdapter:WSt}=OE(),YSt=pp(),dAe=za(),XSt=ja(),pAe=class extends WSt{constructor(e,r){super();this.child=e,this.bitswap=r}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,r,i={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,r,i):await this.child.put(e,r,i))}async*putMany(e,r={}){let i=XSt(e,async({key:n})=>!await this.has(n));this.bitswap.isStarted()?yield*this.bitswap.putMany(i,r):yield*this.child.putMany(i,r)}async get(e,r={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,r):this.child.get(e,r)}async*getMany(e,r={}){let i=dAe(),n=dAe();Promise.resolve().then(async()=>{for await(let s of e)!await this.has(s)&&this.bitswap.isStarted()?i.push(s):n.push(s);i.end(),n.end()}),yield*YSt(this.bitswap.getMany(i,r),this.child.getMany(n,r))}async delete(e,r){await this.child.delete(e,r)}async*deleteMany(e,r){yield*this.child.deleteMany(e,r)}async has(e,r={}){return this.child.has(e,r)}async*query(e,r={}){yield*this.child.query(e,r)}async*queryKeys(e,r={}){yield*this.child.queryKeys(e,r)}};yAe.exports=pAe});var mAe=p((DFt,bAe)=>{f();"use strict";var{createBitswap:QSt}=hAe(),ZSt=wk(),{Multiaddr:JSt}=tt(),e3t=ae(),t3t=gAe(),u6=class{constructor(e,r,i,n,s){this.peerId=e,this.libp2p=r,this.bitswap=i,this.repo=n,this.blockstore=s}static async start({peerId:e,repo:r,print:i,options:n}){r.closed&&await r.open();let s=await r.config.getAll(),o=await ZSt({options:n,repo:r,peerId:e,multiaddrs:r3t(e,s),config:s,keychainConfig:void 0});o.keychain&&await o.loadKeychain(),await o.start();for(let l of o.multiaddrs)i(`Swarm listening on ${l}/p2p/${e.toB58String()}`);let a=QSt(o,r.blocks,{statsEnabled:!0});await a.start();let c=new t3t(r.blocks,a);return r.blocks=c,r.pins.blockstore=c,new u6(e,o,a,r,c)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await Promise.all([e.bitswap.stop(),e.libp2p.stop()])}};bAe.exports=u6;var r3t=(t,e)=>{let r=t.toB58String(),i=[],n=e.Addresses&&e.Addresses.Swarm||[];for(let s of n){let o=new JSt(s);if(o.protoCodes().includes(i3t))throw e3t(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let a=o.getPeerId();a&&a!==r&&(o=o.encapsulate(`/p2p/${r}`)),i.push(o)}return i},i3t=479});var wAe=p((MFt,vAe)=>{f();"use strict";var n3t=Oe();vAe.exports=({network:t})=>{async function e(r={}){let i=[],{libp2p:n}=await t.use(r);for(let[s,o]of n.peerStore.peers.entries())i.push({id:s,addrs:o.addresses.map(a=>a.multiaddr)});return i}return n3t(e)}});var EAe=p((LFt,_Ae)=>{f();"use strict";var s3t=Oe();_Ae.exports=({network:t})=>{async function e(r,i={}){let{libp2p:n}=await t.use(i);await n.dial(r,i)}return s3t(e)}});var xAe=p((UFt,SAe)=>{f();"use strict";var o3t=Oe();SAe.exports=({network:t})=>{async function e(r,i={}){let{libp2p:n}=await t.use(i);await n.hangUp(r)}return o3t(e)}});var IAe=p((FFt,AAe)=>{f();"use strict";var a3t=Oe();AAe.exports=({network:t})=>{async function e(r={}){let{libp2p:i}=await t.use(r);return i.multiaddrs}return a3t(e)}});var RAe=p((KFt,TAe)=>{f();"use strict";var c3t=Oe();TAe.exports=({network:t})=>{async function e(r={}){let{libp2p:i}=await t.use(r),n=[];for(let[s,o]of i.connections)for(let a of o){let c={addr:a.remoteAddr,peer:s};(r.verbose||r.direction)&&(c.direction=a.stat.direction),r.verbose&&(c.muxer=a.stat.multiplexer,c.latency="n/a",c.streams=[]),n.push(c)}return n}return c3t(e)}});var OAe=p((jFt,CAe)=>{f();"use strict";var u3t=wAe(),l3t=EAe(),f3t=xAe(),h3t=IAe(),d3t=RAe(),PAe=class{constructor({network:e}){this.addrs=u3t({network:e}),this.connect=l3t({network:e}),this.disconnect=f3t({network:e}),this.localAddrs=h3t({network:e}),this.peers=d3t({network:e})}};CAe.exports=PAe});var qAe=p((VFt,kAe)=>{f();"use strict";var p3t=et(),Om={success:!0,time:0,text:""},y3t=Oe();kAe.exports=({network:t})=>{async function*e(r,i={}){let{libp2p:n}=await t.use();i.count=i.count||10;let s=p3t.createFromB58String(r),o=n.peerStore.get(s),a=o&&o.id;if(!a){yield{...Om,text:`Looking up peer ${r}`};let u=await n.peerRouting.findPeer(s);a=u&&u.id}if(!a)throw new Error("Peer was not found");yield{...Om,text:`PING ${a.toB58String()}`};let c=0,l=0;for(let u=0;u<i.count;u++)try{let h=await n.ping(a);l+=h,c++,yield{...Om,time:h}}catch(h){yield{...Om,success:!1,text:h.toString()}}if(c){let u=l/c;yield{...Om,text:`Average latency: ${u}ms`}}}return y3t(e)}});var DAe=p((zFt,NAe)=>{f();"use strict";var BAe=et(),{CID:g3t}=(Ae(),Ce),Nk=ae(),{NotEnabledError:b3t}=Qu(),m3t=vb(),Sy=Oe();NAe.exports=({network:t,repo:e})=>{let{get:r,put:i,findProvs:n,findPeer:s,provide:o,query:a}={async get(c,l={}){let{libp2p:u}=await xy(t,l);return u._dht.get(Dk(c),l)},async*put(c,l,u){let{libp2p:h}=await xy(t,u);yield*h._dht.put(Dk(c),l)},async*findProvs(c,l={numProviders:20}){let{libp2p:u}=await xy(t,l);for await(let h of u._dht.findProviders(Dk(c),{maxNumProviders:l.numProviders,signal:l.signal}))yield{id:h.id.toB58String(),addrs:h.addrs}},async findPeer(c,l){let{libp2p:u}=await xy(t,l),h=await u._dht.findPeer(BAe.createFromB58String(c));return{id:h.id.toB58String(),addrs:h.multiaddrs}},async*provide(c,l={recursive:!1}){let{libp2p:u}=await xy(t,l),h=Array.isArray(c)?c:[c];if(!(await Promise.all(h.map(g=>e.blocks.has(g)))).every(g=>g))throw Nk(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(l.recursive)throw Nk(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");for(let g of h)yield u._dht.provide(g)},async*query(c,l){let{libp2p:u}=await xy(t,l);for await(let h of u._dht.getClosestPeers(BAe.createFromB58String(c).toBytes()))yield{id:h.toB58String(),addrs:[]}}};return{get:Sy(r),put:Sy(i),findProvs:Sy(n),findPeer:Sy(s),provide:Sy(o),query:Sy(a)}};var v3t=t=>{try{let e=t.toString().split("/").filter(r=>r&&r!=="ipfs"&&r!=="ipns")[0];return g3t.parse(e).bytes}catch(e){throw Nk(e,"ERR_INVALID_CID")}},Dk=t=>t instanceof Uint8Array?t:v3t(t),xy=async(t,e)=>{let r=await t.use(e);if(m3t(r.libp2p,"_config.dht.enabled",!1))return r;throw new b3t("dht not enabled")}});var LAe=p((HFt,MAe)=>{f();"use strict";var km=Oe(),w3t=ae(),{NotEnabledError:_3t}=Qu(),E3t=vb();MAe.exports=({network:t,config:e})=>{let r=E3t(e||{},"Pubsub.Enabled",!0);return{subscribe:r?km(i):qm,unsubscribe:r?km(n):qm,publish:r?km(s):qm,ls:r?km(o):qm,peers:r?km(a):qm};async function i(c,l,u={}){let{libp2p:h}=await t.use(u);return h.pubsub.subscribe(c,l,u)}async function n(c,l,u={}){let{libp2p:h}=await t.use(u);h.pubsub.unsubscribe(c,l,u)}async function s(c,l,u={}){let{libp2p:h}=await t.use(u);if(!l)throw w3t(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await h.pubsub.publish(c,l)}async function o(c={}){let{libp2p:l}=await t.use(c);return l.pubsub.getTopics()}async function a(c,l={}){let{libp2p:u}=await t.use(l);return u.pubsub.getSubscribers(c)}};var qm=async()=>{throw new _3t("pubsub not enabled")}});var VAe=p(($Ft,jAe)=>{f();"use strict";var S3t=wr().bind({ignoreUndefined:!0}),{isTest:x3t}=Vy(),Mk=me()("ipfs"),UAe=ae(),{UnixFS:A3t}=Ei(),FAe=(At(),xt),I3t=(Uc(),Af),{identity:KAe}=(Pc(),Ea),{bases:T3t,hashes:R3t,codecs:P3t}=(Dv(),Nv),C3t=JF(),{AlreadyInitializedError:O3t}=Qu(),k3t=ct(),q3t=FK(),B3t=jK(),N3t=aj(),D3t=uj(),M3t=hj(),L3t=wH(),U3t=WG(),F3t=_W(),K3t=xW(),j3t=IW(),V3t=DW(),z3t=ZW(),H3t=fY(),$3t=Aee(),G3t=Tee(),W3t=Pee(),Y3t=TT(),X3t=ate(),Q3t=gte(),Z3t=vte(),J3t=Kre(),e6t=oie(),t6t=Oie(),r6t=Uie(),i6t=Hie(),n6t=V6e(),s6t=mAe(),o6t=Vw(),a6t=OAe(),c6t=qAe(),u6t=DAe(),l6t=LAe(),f6t=V8(),h6t=z8(),d6t=H8(),l6=class{constructor({print:e,storage:r,codecs:i,options:n}){let{peerId:s,repo:o,keychain:a}=r,c=o6t.create(s6t),l=Q3t(n.preload),u=N3t(),h=D3t({network:c}),d=new U3t(n),y=Object.values(R3t);(n.ipld&&n.ipld.hashers?n.ipld.hashers:[]).forEach(C=>y.push(C)),this.hashers=new h6t({hashers:y,loadHasher:n.ipld&&n.ipld.loadHasher});let g=Object.values(T3t);(n.ipld&&n.ipld.bases?n.ipld.bases:[]).forEach(C=>g.push(C)),this.bases=new d6t({bases:g,loadBase:n.ipld&&n.ipld.loadBase});let m=new L3t({repo:o,codecs:i}),E=new H3t({codecs:i,hashers:this.hashers,preload:l,repo:o}),v=new F3t({dns:u,ipns:d,repo:o,codecs:i,peerId:s,isOnline:h,keychain:a,options:n}),A=M3t({repo:o,codecs:i,bases:this.bases,name:v}),R=new X3t({repo:o,codecs:i,hashers:this.hashers,preload:l}),F=Object.assign(K3t({repo:o,codecs:i,resolve:A,preload:l}),{local:j3t({repo:r.repo})}),{add:q,addAll:B,cat:z,get:G,ls:Y}=new $3t({preload:l,repo:o,options:n.EXPERIMENTAL}),P=J3t({repo:o,preload:l,hashers:this.hashers,options:n}),b=Z3t({files:P,preload:l,options:n.preload});this.preload=l,this.name=v,this.ipns=d,this.pin=m,this.resolve=A,this.block=E,this.refs=F,this.start=q3t({network:c,peerId:s,repo:o,preload:l,ipns:d,mfsPreload:b,print:e,keychain:a,options:n}),this.stop=B3t({network:c,preload:l,mfsPreload:b,ipns:d,repo:o}),this.dht=u6t({network:c,repo:o}),this.pubsub=l6t({network:c,config:n.config}),this.dns=u,this.isOnline=h,this.id=W3t({network:c,peerId:s}),this.version=G3t({repo:o}),this.bitswap=new V3t({network:c}),this.bootstrap=new z3t({repo:o}),this.config=Y3t({repo:o}),this.ping=c6t({network:c}),this.add=q,this.addAll=B,this.cat=z,this.get=G,this.ls=Y,this.dag=R,this.files=P,this.key=new e6t({keychain:a}),this.object=new t6t({preload:l,codecs:i,repo:o}),this.repo=new r6t({repo:o,hashers:this.hashers}),this.stats=new i6t({repo:o,network:c}),this.swarm=new a6t({network:c}),Object.defineProperty(this,"libp2p",{get(){let C=c.try();return C?C.libp2p:void 0}});let w=()=>Promise.reject(UAe(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),S=async function*(){throw UAe(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=w,this.diag={cmds:w,net:w,sys:w},this.log={level:w,ls:w,tail:S},this.mount=w,this.codecs=i}async init(){throw new O3t}static async create(e={}){e=S3t(y6t(),e);let r=e.init||{},i={name:KAe.name,code:KAe.code,encode:u=>u,decode:u=>u},n=Object.values(P3t);[FAe,I3t,i].concat(e.ipld&&e.ipld.codecs||[]).forEach(u=>n.push(u));let s=new f6t({codecs:n,loadCodec:e.ipld&&e.ipld.loadCodec}),o=e.silent?Mk:console.log,a=await n6t.start(o,s,e),c=await a.repo.config.getAll(),l=new l6({storage:a,print:o,codecs:s,options:{...e,config:c}});if(await l.preload.start(),l.ipns.startOffline(a),a.isNew&&!r.emptyRepo){let u=await p6t(l);Mk("adding default assets"),await C3t({addAll:l.addAll,print:o}),Mk("initializing IPNS keyspace"),await l.ipns.initializeKeyspace(a.peerId.privKey,k3t(`/ipfs/${u}`))}return e.start!==!1&&await l.start(),l}};jAe.exports=l6;var p6t=async t=>{let e=FAe.encode({Data:new A3t({type:"directory"}).marshal(),Links:[]}),r=await t.block.put(e,{mhtype:"sha2-256",format:"dag-pb"});return await t.pin.add(r),r},y6t=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!x3t,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}})});var x6t=p((GFt,zAe)=>{f();"use strict";var g6t=T6(),b6t=L6(),m6t=et(),v6t=Ma(),w6t=zd(),{multiaddr:_6t}=tt(),{CID:E6t}=(Ae(),Ce),{create:S6t}=VAe();zAe.exports={create:S6t,crypto:v6t,isIPFS:w6t,CID:E6t,multiaddr:_6t,PeerId:m6t,globSource:g6t,urlSource:b6t}});return x6t();})();
/*!
  * prr
  * (c) 2013 Rod Vagg <rod@vagg.org>
  * https://github.com/rvagg/prr
  * License: MIT
  */
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
return IpfsCore}));
